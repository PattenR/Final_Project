training!
{'nb_neurons_1': 64, 'nb_neurons_2': 256, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.21875, accuracy on mal data: 0.0957908
step 100, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0987245
step 500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0957908
step 1000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 1100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 1200, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 1300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101403
step 1400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 1500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 1600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 1700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 1800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 2000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 2100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 2200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 2300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 2400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 2500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 2600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 2700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 2800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 2900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 3000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0942602
step 3100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 3200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 3300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 3400, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 3600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 3700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 3800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 3900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 4000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 4100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 4200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 4500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0942602
step 4600, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 4700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 4800, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 4900, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 5000, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 5100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 5200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 5300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 5400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.101403
step 5500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 5600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 5700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 5800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 5900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 6000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 6100, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 6200, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 6300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 6400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 6500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0980867
step 6700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 6800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 6900, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 7000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0980867
step 7100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 7200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 7400, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 7600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 7800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 7900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 8000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 8100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0957908
step 8200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 8300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 8400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 8500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 8700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0942602
step 8800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 8900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 9000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 9100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102168
step 9200, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 9300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 9400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 9500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 9600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 9700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 9800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 9900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101403
step 10000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 10100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 10200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 10300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 10400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101403
step 10500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 10600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 10700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 10800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 10900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 11000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 11100, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 11200, accuracy on validation batch: 0.046875, accuracy on mal data: 0.101658
step 11300, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 11400, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 11500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 11600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 11700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 11900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0942602
step 12000, accuracy on validation batch: 0.125, accuracy on mal data: 0.101658
step 12100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 12200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 12300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 12400, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 12500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 12600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 12700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 12800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 12900, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.10727
step 13000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0942602
step 13100, accuracy on validation batch: 0.125, accuracy on mal data: 0.101403
step 13200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 13300, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 13400, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 13500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 13600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 13700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 13800, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 13900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 14000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 14100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 14200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 14300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 14400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 14500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 14600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 14700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 14800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 14900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0987245
test set: accuracy on test set: 0.113
Done training net
0.113499995451
training!
{'nb_neurons_1': 196, 'nb_neurons_2': 32, 'nb_neurons_3': 128}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 100, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 400, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 1000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 1100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 1200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 1300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 1400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 1500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 1600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 1700, accuracy on validation batch: 0.046875, accuracy on mal data: 0.10727
step 1800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0980867
step 1900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 2000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 2100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 2200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 2300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.102679
step 2400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 2500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 2600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 2700, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 2800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 2900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 3000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 3200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 3300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 3600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 3700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 3800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3900, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 4100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 4200, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 4300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0957908
step 4400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101403
step 4500, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 4600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.101658
step 4700, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.10727
step 4800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 4900, accuracy on validation batch: 0.1875, accuracy on mal data: 0.10727
step 5000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101403
step 5100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 5200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0942602
step 5400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 5500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 5600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 5700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 5900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 6000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0942602
step 6100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101403
step 6200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 6300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 6400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 6500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 6700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 6800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 6900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 7000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 7200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 7400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 7600, accuracy on validation batch: 0.148438, accuracy on mal data: 0.101403
step 7700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 7800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 7900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 8000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0942602
step 8100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 8300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101403
step 8400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 8500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 8800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 8900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 9100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 9300, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 9400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0980867
step 9500, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 9600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.102679
step 9700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 9800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 9900, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 10000, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 10100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 10200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 10300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 10400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10500, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 10600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 10700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 10800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 10900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 11000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 11100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 11200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 11300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 11400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 11500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 11600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 11700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 11800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 11900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 12000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 12100, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 12200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 12300, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 12400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 12500, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 12600, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 12700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 12800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0980867
step 12900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 13000, accuracy on validation batch: 0.125, accuracy on mal data: 0.101658
step 13100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 13200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 13300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 13400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 13500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 13600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 13700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 13800, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 13900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 14000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 14100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 14200, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 14300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 14400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 14500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0980867
step 14600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 14700, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 14800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 14900, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.102679
test set: accuracy on test set: 0.113
Done training net
0.113499995861
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 32, 'nb_neurons_3': 96}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.140625, accuracy on mal data: 0.102168
step 100, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 200, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101403
step 300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 700, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.0980867
step 800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 900, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 1000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101403
step 1100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 1200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1300, accuracy on validation batch: 0.195312, accuracy on mal data: 0.0979592
step 1400, accuracy on validation batch: 0.195312, accuracy on mal data: 0.0979592
step 1500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 1600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 1700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 1800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 2000, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 2100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 2200, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 2300, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 2400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 2500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 2600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 2700, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 2800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 2900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 3000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 3200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 3300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 3400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 3500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 3600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 3700, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 3800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 3900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 4200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 4400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 4500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 4600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 4700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 4800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4900, accuracy on validation batch: 0.210938, accuracy on mal data: 0.0979592
step 5000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 5100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 5200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 5300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 5400, accuracy on validation batch: 0.046875, accuracy on mal data: 0.102679
step 5500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 5600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 5700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 5800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 5900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 6000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 6100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 6200, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 6300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.102679
step 6400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 6500, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 6600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 6700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 6800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 6900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0980867
step 7000, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 7100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 7200, accuracy on validation batch: 0.164062, accuracy on mal data: 0.10727
step 7300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 7400, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 7600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0987245
step 7700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 7900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 8000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101403
step 8100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 8300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 8400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 8500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 8700, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 8800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 8900, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 9100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 9200, accuracy on validation batch: 0.148438, accuracy on mal data: 0.101403
step 9300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.102679
step 9400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 9500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 9600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 9700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 9800, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0980867
step 9900, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0980867
step 10000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 10100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 10300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 10400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 10500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101403
step 10600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 10700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 10800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 10900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 11000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101403
step 11200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 11300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 11400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 11500, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 11600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101403
step 11700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 11800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 11900, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 12000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 12100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 12200, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 12300, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 12400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 12500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 12600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 12700, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102168
step 12800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 12900, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0957908
step 13000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 13100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 13200, accuracy on validation batch: 0.1875, accuracy on mal data: 0.0942602
step 13300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 13400, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 13500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 13600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 13700, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 13800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 13900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.101658
step 14000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 14100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 14200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 14300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 14400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 14500, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101403
step 14600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 14700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 14800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 14900, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
test set: accuracy on test set: 0.096
Done training net
0.0957999963127
training!
{'nb_neurons_1': 196, 'nb_neurons_2': 128, 'nb_neurons_3': 32}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0942602
step 100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 400, accuracy on validation batch: 0.125, accuracy on mal data: 0.101658
step 500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 1000, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0987245
step 1100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 1200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 1300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 1400, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 1500, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 1600, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 1700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 1800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 1900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 2000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 2100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 2200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 2300, accuracy on validation batch: 0.15625, accuracy on mal data: 0.102679
step 2400, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.102679
step 2500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 2600, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 2700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 2800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 2900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 3000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 3100, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.0979592
step 3200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 3300, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 3400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 3500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 3700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 3800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 3900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 4100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 4200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 4300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 4400, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0980867
step 4500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 4700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 4800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 4900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 5100, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 5200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 5300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 5400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 5500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 5600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 5700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 5800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 5900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 6000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 6100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 6200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 6300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.102679
step 6400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 6500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 6700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 6800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 6900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 7000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 7100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 7200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 7300, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 7400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 7600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0942602
step 7700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 7900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 8000, accuracy on validation batch: 0.171875, accuracy on mal data: 0.102679
step 8100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 8300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 8400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 8500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 8700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.102679
step 8800, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 8900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.125, accuracy on mal data: 0.101658
step 9100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0987245
step 9200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 9300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 9400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101403
step 9500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 9600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 9700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0987245
step 9900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 10000, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 10100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 10200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 10300, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 10400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 10600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 10700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 10800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 10900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 11100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 11200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 11300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 11400, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 11500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 11600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101403
step 11700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 11900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 12000, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 12100, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 12200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 12300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 12400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 12500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 12600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 12700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 12800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 12900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 13000, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 13100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 13200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0957908
step 13300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 13400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 13500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 13600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 13700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 13800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.101658
step 13900, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 14000, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 14100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.102679
step 14200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 14300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 14400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 14500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 14600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 14700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 14800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0957908
step 14900, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
test set: accuracy on test set: 0.097
Done training net
0.0973999959044
training!
{'nb_neurons_1': 64, 'nb_neurons_2': 256, 'nb_neurons_3': 196}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 100, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.101658
step 200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 500, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 600, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0980867
step 700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 800, accuracy on validation batch: 0.1875, accuracy on mal data: 0.0980867
step 900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 1000, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 1100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 1200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 1300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 1400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 1500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 1700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 1800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.046875, accuracy on mal data: 0.10727
step 2000, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 2100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 2200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 2300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 2400, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 2500, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 2600, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 2700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 2800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 2900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3000, accuracy on validation batch: 0.171875, accuracy on mal data: 0.10727
step 3100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0987245
step 3200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 3300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3400, accuracy on validation batch: 0.0625, accuracy on mal data: 0.101403
step 3500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 3600, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0987245
step 3700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 3800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 3900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 4100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 4200, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 4300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 4400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 4700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0957908
step 4800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 4900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 5000, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 5100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0942602
step 5300, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0987245
step 5400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 5500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 5600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 5800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 5900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0987245
step 6000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 6100, accuracy on validation batch: 0.15625, accuracy on mal data: 0.101403
step 6200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 6300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 6500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 6600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 6700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 6800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 6900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 7000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0987245
step 7100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101403
step 7200, accuracy on validation batch: 0.125, accuracy on mal data: 0.101658
step 7300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 7400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 7500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 7600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 7700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 7900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 8000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 8100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 8300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0980867
step 8400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 8500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 8800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8900, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 9100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 9200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 9300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 9400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 9500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 9600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 9700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 9800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 9900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 10000, accuracy on validation batch: 0.164062, accuracy on mal data: 0.101403
step 10100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 10200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 10300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 10400, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 10500, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 10600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 10700, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.10727
step 10800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 10900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 11000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 11100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 11200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 11300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 11400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 11500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 11600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 11700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.102679
step 11800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 11900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0957908
step 12000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 12100, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 12200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 12300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 12400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 12500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0957908
step 12600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 12700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 12800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 12900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 13000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 13100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 13200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 13300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101403
step 13400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 13500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 13600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 13700, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 13800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 13900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 14000, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 14100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 14200, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 14300, accuracy on validation batch: 0.125, accuracy on mal data: 0.101403
step 14400, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.101658
step 14500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 14600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 14700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 14800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 14900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
test set: accuracy on test set: 0.113
Done training net
0.113499995731
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 256, 'nb_neurons_3': 96}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 100, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101403
step 500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0942602
step 600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 1000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101403
step 1100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 1200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 1300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.102679
step 1500, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 1600, accuracy on validation batch: 0.164062, accuracy on mal data: 0.10727
step 1700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 1800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 2000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 2100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 2200, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 2300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 2400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 2500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0942602
step 2600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 2700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 2800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 2900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 3000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 3100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 3200, accuracy on validation batch: 0.1875, accuracy on mal data: 0.101658
step 3300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 3500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0980867
step 3700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 3800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101403
step 3900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 4100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0942602
step 4200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 4300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 4400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 4500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 4900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 5000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 5100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 5200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 5300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 5500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 5600, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 5700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 5800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 5900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 6000, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 6100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 6200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 6300, accuracy on validation batch: 0.046875, accuracy on mal data: 0.102679
step 6400, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 6500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 6700, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 6800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 6900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 7000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 7100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 7200, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 7400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 7600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 7700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0980867
step 7900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0957908
step 8000, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 8100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0980867
step 8300, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 8400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 8500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 8700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 8800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 9100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 9200, accuracy on validation batch: 0.0625, accuracy on mal data: 0.101658
step 9300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.102679
step 9400, accuracy on validation batch: 0.125, accuracy on mal data: 0.101403
step 9500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 9600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 9700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 9800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 9900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0942602
step 10000, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 10100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 10200, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0980867
step 10300, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0957908
step 10400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 10500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 10700, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 10800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 10900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 11000, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 11100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 11200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 11300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 11400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 11500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 11600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0957908
step 11700, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 11800, accuracy on validation batch: 0.046875, accuracy on mal data: 0.10727
step 11900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 12000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 12100, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 12200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101658
step 12300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 12400, accuracy on validation batch: 0.171875, accuracy on mal data: 0.101403
step 12500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0987245
step 12600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 12700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 12800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 12900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 13000, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0980867
step 13100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 13200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 13300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 13400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 13500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 13600, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 13700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 13800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 13900, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0980867
step 14000, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 14100, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0942602
step 14200, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 14300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 14400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 14500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 14600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 14700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0957908
step 14800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 14900, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
test set: accuracy on test set: 0.103
Done training net
0.102799996473
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 128, 'nb_neurons_3': 64}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0957908
step 100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 400, accuracy on validation batch: 0.125, accuracy on mal data: 0.101403
step 500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0987245
step 800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 1000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 1100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 1200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 1300, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 1400, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 1500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 1600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0957908
step 1700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 1800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 2000, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 2100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 2200, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 2300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 2400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 2500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 2600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 2700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.102679
step 2800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 2900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 3000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 3100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 3200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 3300, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 3400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 3600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 3700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0942602
step 3800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0980867
step 3900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 4000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4100, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 4200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 4300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 4400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 4500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4600, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0980867
step 4700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 4800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 4900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 5000, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 5100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 5200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 5300, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 5400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 5500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 5600, accuracy on validation batch: 0.1875, accuracy on mal data: 0.0979592
step 5700, accuracy on validation batch: 0.179688, accuracy on mal data: 0.102679
step 5800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 5900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 6000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101403
step 6100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 6200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 6300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 6400, accuracy on validation batch: 0.1875, accuracy on mal data: 0.10727
step 6500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 6700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 6900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7000, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 7100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 7200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 7400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 7500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 7600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 7700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 7900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 8000, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 8100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 8300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 8400, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 8500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 8700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 8800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 8900, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0957908
step 9100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 9200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 9400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 9500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 9600, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 9700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0987245
step 9800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0942602
step 9900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 10000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 10100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 10200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 10300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 10400, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 10500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 10600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 10800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 10900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11100, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 11200, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 11300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 11400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 11500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 11600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 11700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 11900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 12000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 12100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 12200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 12300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 12400, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 12500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 12600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 12700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 12800, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 12900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 13000, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 13100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 13200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 13300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0980867
step 13400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 13500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 13600, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 13700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101403
step 13800, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 13900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 14000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 14100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 14200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 14300, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 14400, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 14500, accuracy on validation batch: 0.125, accuracy on mal data: 0.101658
step 14600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.102679
step 14700, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 14800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 14900, accuracy on validation batch: 0.164062, accuracy on mal data: 0.101658
test set: accuracy on test set: 0.101
Done training net
0.100899996869
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 96, 'nb_neurons_3': 16}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0957908
step 100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.101658
step 400, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101403
step 600, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 900, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 1000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0987245
step 1100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0980867
step 1200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 1300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 1400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 1500, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 1600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 1700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 1800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 1900, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 2000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 2100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 2200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 2300, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 2400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 2500, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0957908
step 2600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 2700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 2800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 2900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 3000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 3100, accuracy on validation batch: 0.0625, accuracy on mal data: 0.101658
step 3200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 3300, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 3400, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 3600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 3700, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 3800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 3900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 4100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 4200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 4300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 4400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0980867
step 4500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 4700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 4800, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 4900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 5000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 5300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 5400, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 5500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 5700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 5800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 5900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 6000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 6100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0987245
step 6200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 6300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 6400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 6500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 6600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.102679
step 6700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 6800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0980867
step 6900, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0980867
step 7000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 7100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 7200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 7300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 7400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 7600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 7700, accuracy on validation batch: 0.0625, accuracy on mal data: 0.101403
step 7800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 7900, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 8000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 8100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 8300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 8400, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 8500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.102679
step 8600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 8700, accuracy on validation batch: 0.046875, accuracy on mal data: 0.10727
step 8800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 8900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 9100, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 9200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101403
step 9300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 9400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 9600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 9700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 9800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 9900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 10000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0957908
step 10100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 10200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 10400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 10500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 10600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 10700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 10800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 10900, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 11000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0987245
step 11200, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 11300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 11400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 11500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 11600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 11700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 11900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 12000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 12100, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 12200, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 12300, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.102679
step 12400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0957908
step 12500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.101658
step 12600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 12700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0987245
step 12800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 12900, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 13000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 13100, accuracy on validation batch: 0.0625, accuracy on mal data: 0.101403
step 13200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 13300, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.101658
step 13400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 13500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 13600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 13700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 13800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 13900, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 14000, accuracy on validation batch: 0.179688, accuracy on mal data: 0.10727
step 14100, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 14200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 14300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 14400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 14500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 14600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 14700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0942602
step 14800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 14900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
test set: accuracy on test set: 0.113
Done training net
0.113499995619
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 128, 'nb_neurons_3': 96}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 200, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 600, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0957908
step 700, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.101658
step 800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 1000, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 1100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101403
step 1200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 1300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 1400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 1500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 1600, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 1700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101403
step 1800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 2000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 2100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 2200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 2300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 2400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 2500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 2600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 2700, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 2800, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 2900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101658
step 3000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 3100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 3200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 3300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 3400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 3600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 3700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 3900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 4000, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 4100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4200, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 4300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 4400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4500, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 4600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101658
step 4800, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 4900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5000, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 5100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101658
step 5200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 5300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0957908
step 5400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 5500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 5600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0957908
step 5700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 5900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 6000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6100, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 6200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 6300, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 6400, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 6500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 6600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 6700, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 6800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 7000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 7100, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 7200, accuracy on validation batch: 0.15625, accuracy on mal data: 0.101403
step 7300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 7400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 7500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 7600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 7700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 8000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 8100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0942602
step 8200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 8300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 8400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 8500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0957908
step 8700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 8800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 8900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0980867
step 9100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 9200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 9400, accuracy on validation batch: 0.125, accuracy on mal data: 0.101658
step 9500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 9600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 9700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 9800, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 9900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 10200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 10300, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 10400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 10500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 10600, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0980867
step 10700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 10900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 11000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 11100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 11200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 11300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 11400, accuracy on validation batch: 0.1875, accuracy on mal data: 0.0979592
step 11500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 11600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 11700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 11900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101403
step 12000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 12100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 12200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 12300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 12400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 12500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 12600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 12700, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.101658
step 12800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 12900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 13000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 13100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 13200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 13300, accuracy on validation batch: 0.195312, accuracy on mal data: 0.101658
step 13400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0942602
step 13500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 13600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 13700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 13800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 13900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 14000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101658
step 14100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 14200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 14300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0957908
step 14400, accuracy on validation batch: 0.0625, accuracy on mal data: 0.101403
step 14500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 14600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 14700, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 14800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 14900, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
test set: accuracy on test set: 0.113
Done training net
0.113499995787
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 32, 'nb_neurons_3': 32}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.125, accuracy on mal data: 0.0987245
step 100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 600, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0980867
step 700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 900, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 1000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101658
step 1100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.102679
step 1200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 1300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 1400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 1500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 1600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 1700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 1800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 2000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 2100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 2200, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 2300, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 2400, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 2500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 2600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 2700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 2800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 2900, accuracy on validation batch: 0.15625, accuracy on mal data: 0.101658
step 3000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 3100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 3200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 3300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 3400, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 3600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 3700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 3800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 3900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 4000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 4200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 4300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4500, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 4600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 4700, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 4800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 4900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 5000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 5100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 5300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 5400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 5500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 5700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 5800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 6000, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 6100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 6200, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101658
step 6300, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 6400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 6500, accuracy on validation batch: 0.1875, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 6700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 6900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 7000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 7100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 7200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 7400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 7600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 7700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 7900, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 8000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 8100, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 8200, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 8300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 8400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 8500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 8700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 8800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 8900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0987245
step 9000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 9100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 9200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 9300, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 9400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 9500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 9600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 9700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 9800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 9900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 10000, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 10100, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 10200, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 10300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 10400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 10500, accuracy on validation batch: 0.046875, accuracy on mal data: 0.10727
step 10600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0987245
step 10700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 10800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101403
step 10900, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 11000, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 11100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 11200, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0980867
step 11300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 11500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 11600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 11700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101403
step 11800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 12000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 12100, accuracy on validation batch: 0.164062, accuracy on mal data: 0.10727
step 12200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 12300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 12400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 12500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 12600, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 12700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 12800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 12900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 13000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 13100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 13200, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 13300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 13400, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 13500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 13600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 13700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 13800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 13900, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 14000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 14100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 14200, accuracy on validation batch: 0.1875, accuracy on mal data: 0.0979592
step 14300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 14400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101658
step 14500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 14600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 14700, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 14800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 14900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
test set: accuracy on test set: 0.101
Done training net
0.100999996103
{'nb_neurons_1': [16, 32, 64, 96, 128, 196, 256], 'nb_neurons_2': [16, 32, 64, 96, 128, 196, 256], 'nb_neurons_3': [16, 32, 64, 96, 128, 196, 256]}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 32, 'nb_neurons_3': 32}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 300, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0980867
step 400, accuracy on validation batch: 0.046875, accuracy on mal data: 0.0979592
step 500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 700, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 1000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 1100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 1200, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 1300, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 1400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 1500, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 1600, accuracy on validation batch: 0.148438, accuracy on mal data: 0.102679
step 1700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 1800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.102679
step 2000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 2100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 2200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 2300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 2400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 2500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.102679
step 2600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 2700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 2800, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 2900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 3000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 3100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 3200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 3300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 3400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 3600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 3700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 3800, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 3900, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 4200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4300, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 4400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 4500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 4700, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0980867
step 4800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 4900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 5000, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 5100, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 5200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 5300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5400, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 5500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 5700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 5800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 5900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 6000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101403
step 6100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 6200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 6300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 6400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6500, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 6700, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 6800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0980867
step 6900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7000, accuracy on validation batch: 0.140625, accuracy on mal data: 0.101403
step 7100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0942602
step 7200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 7400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.101658
step 7600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 7700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 7900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 8100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 8300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8400, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0987245
step 8500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 8700, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 8800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 8900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 9000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 9100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 9200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 9300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 9400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 9500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 9600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 9700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 9800, accuracy on validation batch: 0.171875, accuracy on mal data: 0.10727
step 9900, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 10000, accuracy on validation batch: 0.046875, accuracy on mal data: 0.10727
step 10100, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 10200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 10300, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 10400, accuracy on validation batch: 0.046875, accuracy on mal data: 0.10727
step 10500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 10600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 10700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101658
step 10800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 10900, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 11000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101658
step 11100, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 11200, accuracy on validation batch: 0.203125, accuracy on mal data: 0.0979592
step 11300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102168
step 11400, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0980867
step 11500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0987245
step 11600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 11700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 11800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 11900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 12000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 12100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 12200, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 12300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 12400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 12500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 12600, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 12700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 12800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 12900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 13000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 13100, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0980867
step 13200, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 13300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 13400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 13500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 13600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 13700, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 13800, accuracy on validation batch: 0.21875, accuracy on mal data: 0.0979592
step 13900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 14000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 14100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 14200, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 14300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 14400, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 14500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 14600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 14700, accuracy on validation batch: 0.171875, accuracy on mal data: 0.10727
step 14800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0957908
step 14900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
test set: accuracy on test set: 0.101
Done training net
0.100899996385
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 96, 'nb_neurons_3': 16}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0942602
step 100, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 200, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 400, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0987245
step 600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 800, accuracy on validation batch: 0.125, accuracy on mal data: 0.101658
step 900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0957908
step 1000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 1100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 1200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 1400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 1500, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 1600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 1700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1800, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 2000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 2100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 2200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 2300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 2400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 2500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 2600, accuracy on validation batch: 0.046875, accuracy on mal data: 0.10727
step 2700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 2800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 2900, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 3000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 3100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 3200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 3300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 3400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101658
step 3800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 3900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 4000, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 4100, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 4200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 4300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 4400, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 4500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 4600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 4700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 4900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 5000, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 5100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 5200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 5300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 5400, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.10727
step 5500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 5600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 5800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0942602
step 5900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0942602
step 6000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 6100, accuracy on validation batch: 0.046875, accuracy on mal data: 0.101658
step 6200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0957908
step 6300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101403
step 6400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 6500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 6700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 6800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 6900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 7000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 7100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 7200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 7400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 7500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101403
step 7800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 7900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 8000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 8100, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101403
step 8400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 8500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 8600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 8700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0980867
step 8800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 8900, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 9100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 9200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9300, accuracy on validation batch: 0.015625, accuracy on mal data: 0.10727
step 9400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 9500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 9600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0957908
step 9700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 9800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 9900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 10000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 10200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 10300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 10400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 10500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 10700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 10800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0987245
step 10900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 11000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 11100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 11200, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 11300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 11400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 11600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 11700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 11900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 12000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0957908
step 12100, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 12200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 12300, accuracy on validation batch: 0.195312, accuracy on mal data: 0.10727
step 12400, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 12500, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 12600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 12700, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 12800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 12900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 13000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 13100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 13200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 13300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 13400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 13500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 13600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 13700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 13800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 13900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 14000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 14100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 14200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 14300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 14400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.102679
step 14500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 14600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 14700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 14800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 14900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
test set: accuracy on test set: 0.098
Done training net
0.0979999964871
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 128, 'nb_neurons_3': 96}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.102679
step 800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 900, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 1000, accuracy on validation batch: 0.015625, accuracy on mal data: 0.0979592
step 1100, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 1200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 1300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 1400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 1500, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 1600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 1700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 1900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 2000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101658
step 2100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101403
step 2200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 2300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 2400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 2500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 2600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 2700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 2800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 2900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 3000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 3200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 3300, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 3400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 3600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 3700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 3800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 3900, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 4000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 4200, accuracy on validation batch: 0.03125, accuracy on mal data: 0.10727
step 4300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 4400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 4600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 4700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 4800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 5000, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 5100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 5200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.101658
step 5300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 5400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 5600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0980867
step 5700, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 5800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 5900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 6000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 6100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 6200, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 6300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 6400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 6500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0942602
step 6700, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.101403
step 6800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102168
step 6900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 7000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0987245
step 7100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 7200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 7400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7600, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0942602
step 7700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 7800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101658
step 8000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 8100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 8300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 8400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 8500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 8700, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 8800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 8900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 9000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 9200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 9300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 9400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 9600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 9700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 9800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 9900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 10000, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 10100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 10200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 10300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 10400, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 10500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 10600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 10700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 10800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 10900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 11000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0980867
step 11100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 11300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 11400, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 11500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 11600, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 11700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 11900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0980867
step 12000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 12100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 12200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 12300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 12400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101403
step 12500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 12600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 12700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 12800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 12900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 13000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 13100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 13200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 13300, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 13400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 13500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 13600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 13700, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 13800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 13900, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 14000, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0980867
step 14100, accuracy on validation batch: 0.046875, accuracy on mal data: 0.10727
step 14200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 14300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 14400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 14500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 14600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 14700, accuracy on validation batch: 0.046875, accuracy on mal data: 0.0979592
step 14800, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 14900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
test set: accuracy on test set: 0.113
Done training net
0.11349999506
training!
{'nb_neurons_1': 64, 'nb_neurons_2': 256, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101403
step 100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 500, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.102679
step 900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 1000, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 1100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 1200, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 1300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 1400, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 1500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 1600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 1700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 1800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 1900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 2000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 2100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 2200, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 2300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 2400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 2500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 2600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 2700, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 2800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 2900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 3000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 3100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 3200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 3300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3400, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 3600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 3800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 3900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 4100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 4200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 4300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 4400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 4500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 4600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 4800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 5000, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0980867
step 5100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 5200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5400, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 5500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 5700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101658
step 5900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 6000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 6100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 6200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 6300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 6400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 6500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 6700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 6800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101403
step 6900, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.102679
step 7000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 7100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 7400, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 7600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7700, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 7800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 7900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 8000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 8100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 8300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0987245
step 8400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 8500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 8600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 8700, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0980867
step 8800, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 8900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 9100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 9200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 9300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 9400, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 9500, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 9600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0980867
step 9700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101658
step 9800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 9900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 10000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 10100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 10200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 10300, accuracy on validation batch: 0.148438, accuracy on mal data: 0.102679
step 10400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 10500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 10600, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 10700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 10800, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 10900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 11000, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 11100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 11200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 11300, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 11400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 11600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 11700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 11800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101403
step 11900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 12000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 12100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 12200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 12300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 12400, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 12500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 12600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 12700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 12800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 12900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101403
step 13000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 13100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102168
step 13200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 13300, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 13400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 13500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 13600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 13700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 13800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 13900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 14000, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0980867
step 14100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 14200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 14300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 14400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101403
step 14500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 14600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 14700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 14800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 14900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
test set: accuracy on test set: 0.113
Done training net
0.113499996401
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 128, 'nb_neurons_3': 96}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0980867
step 100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 1000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 1100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 1200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 1300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 1400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101403
step 1600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 1700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 1800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 1900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 2000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 2100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 2200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 2300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 2400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0980867
step 2500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 2600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 2700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0942602
step 2800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101403
step 2900, accuracy on validation batch: 0.125, accuracy on mal data: 0.101403
step 3000, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 3100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 3200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 3300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 3400, accuracy on validation batch: 0.125, accuracy on mal data: 0.101658
step 3500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0980867
step 3600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 3700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 3800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 3900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 4100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 4200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 4300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 4500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 4600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 4700, accuracy on validation batch: 0.171875, accuracy on mal data: 0.101658
step 4800, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 4900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 5100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 5200, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 5300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 5400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0957908
step 5500, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 5600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 5700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.101658
step 5800, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 5900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 6000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 6100, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 6200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6300, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 6400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 6500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 6600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102168
step 6700, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 6800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 6900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 7000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 7100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.101403
step 7200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 7400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 7600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 7900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 8000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 8100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 8300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 8400, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 8500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0942602
step 8600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 8700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 8800, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 8900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.140625, accuracy on mal data: 0.102679
step 9100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 9200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.102679
step 9300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 9400, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0980867
step 9500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 9600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 9700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 9800, accuracy on validation batch: 0.046875, accuracy on mal data: 0.0979592
step 9900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101403
step 10000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 10100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 10200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 10300, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 10400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 10500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 10600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 10800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 10900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 11100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0942602
step 11200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11300, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 11400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 11500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 11600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 11700, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 11900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101658
step 12000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 12100, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 12200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 12300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 12400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 12500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 12600, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 12700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 12800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 12900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 13000, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 13100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 13200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0957908
step 13300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 13400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 13500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 13600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 13700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 13800, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 13900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 14000, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 14100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 14200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 14300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 14400, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 14500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 14600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 14700, accuracy on validation batch: 0.125, accuracy on mal data: 0.101658
step 14800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 14900, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
test set: accuracy on test set: 0.103
Done training net
0.102799996473
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 32, 'nb_neurons_3': 32}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 200, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 600, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102168
step 1000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 1100, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 1200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 1400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 1500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0980867
step 1600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 1700, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 1800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 2000, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 2100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 2200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 2300, accuracy on validation batch: 0.046875, accuracy on mal data: 0.10727
step 2400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 2500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0957908
step 2600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 2700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 2800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 2900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0987245
step 3000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 3100, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0942602
step 3200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 3300, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0987245
step 3400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 3600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 3700, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 3800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.125, accuracy on mal data: 0.101658
step 4100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 4200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 4400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 4600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 4900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 5000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 5100, accuracy on validation batch: 0.1875, accuracy on mal data: 0.0979592
step 5200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0942602
step 5300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 5400, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 5500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 5600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 5700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 6000, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 6100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 6200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 6400, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 6500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 6800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 6900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 7000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 7100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 7200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 7400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 7600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 7700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 7900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 8000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 8100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 8200, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 8300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 8400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.102679
step 8500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 8600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 8700, accuracy on validation batch: 0.15625, accuracy on mal data: 0.101658
step 8800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 8900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 9100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 9200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 9300, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 9400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 9500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 9600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 9700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 9800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 9900, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 10000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 10100, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 10200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 10300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 10400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 10500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 10600, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 10700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 10800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 10900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 11000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 11100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 11200, accuracy on validation batch: 0.046875, accuracy on mal data: 0.102679
step 11300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 11400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 11500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 11600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 11700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 11900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 12000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 12100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 12200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 12300, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 12400, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 12500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 12600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 12700, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.10727
step 12800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 12900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 13000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 13100, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 13200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 13300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 13400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 13500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 13600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 13700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 13800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 13900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 14000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 14100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 14200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 14300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 14400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 14500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 14600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 14700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 14800, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 14900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
test set: accuracy on test set: 0.113
Done training net
0.113499995619
training!
{'nb_neurons_1': 256, 'nb_neurons_2': 32, 'nb_neurons_3': 32}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 200, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.101403
step 600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.102679
step 900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 1000, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 1100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 1200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 1300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 1400, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 1500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101658
step 1600, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 1700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 1800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 2000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0987245
step 2100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 2200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 2300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0942602
step 2400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0980867
step 2500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 2600, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0980867
step 2700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 2800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 2900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 3100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 3200, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 3300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 3400, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 3500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 3600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 3700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 3900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 4100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 4200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 4400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 4500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 4600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 4700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 4800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 4900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 5000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 5100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 5200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 5300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5400, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 5500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 5600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 5700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 5800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 5900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101403
step 6000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 6200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 6300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 6400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 6500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 6700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 6800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 7100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 7200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 7300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 7500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 7600, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0980867
step 7700, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 7900, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.0979592
step 8000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 8100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0980867
step 8300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101658
step 8400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 8500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 8600, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 8700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 8800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8900, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 9000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 9100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 9200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0987245
step 9300, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 9400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 9500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 9600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 9700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0957908
step 9800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 9900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 10000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 10200, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 10300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 10400, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 10500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 10600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 10700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 10800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 11000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 11200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 11300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 11400, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0980867
step 11500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 11600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 11700, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 11800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0942602
step 11900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0987245
step 12000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 12100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 12200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0957908
step 12300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0957908
step 12400, accuracy on validation batch: 0.148438, accuracy on mal data: 0.101658
step 12500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 12600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 12700, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 12800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 12900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 13000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 13100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 13200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 13300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 13400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 13500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 13600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.102679
step 13700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 13800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 13900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 14000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 14100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 14200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 14300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 14400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 14500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 14600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 14700, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 14800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 14900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
test set: accuracy on test set: 0.113
Done training net
0.113499995656
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 256, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 200, accuracy on validation batch: 0.125, accuracy on mal data: 0.102168
step 300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0957908
step 600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 1000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 1100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 1200, accuracy on validation batch: 0.164062, accuracy on mal data: 0.10727
step 1300, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 1400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 1500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 1600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 1700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 1800, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 2000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 2100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 2200, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 2300, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 2400, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 2500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 2600, accuracy on validation batch: 0.148438, accuracy on mal data: 0.102679
step 2700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 2800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 2900, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 3000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 3100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.101658
step 3200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 3300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 3400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 3500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 3600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 3700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 3800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 3900, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 4000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0942602
step 4100, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 4200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101658
step 4300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4400, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 4500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 4800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101658
step 4900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 5000, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 5100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0980867
step 5200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 5300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 5400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 5500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 5800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0957908
step 5900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 6000, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 6100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 6200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101403
step 6300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 6400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 6500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 6700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0942602
step 6800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 6900, accuracy on validation batch: 0.03125, accuracy on mal data: 0.102679
step 7000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 7100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 7200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 7400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.125, accuracy on mal data: 0.101658
step 7600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 7700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101403
step 7800, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 7900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 8000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 8100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 8200, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 8300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 8400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 8500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 8700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 8800, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 8900, accuracy on validation batch: 0.125, accuracy on mal data: 0.101658
step 9000, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.102679
step 9100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 9200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 9300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 9400, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 9500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 9600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 9700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 9800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 9900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 10000, accuracy on validation batch: 0.046875, accuracy on mal data: 0.101658
step 10100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 10200, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 10300, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 10400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 10500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 10600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 10700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 10800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0942602
step 10900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 11000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 11100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101403
step 11200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 11300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 11400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 11500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 11600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 11700, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 11900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 12000, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 12100, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 12200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.101658
step 12300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 12400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 12500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 12600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 12700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 12800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 12900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 13000, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 13100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 13200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 13300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 13400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 13500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 13600, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 13700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 13800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 13900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 14000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 14100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0942602
step 14200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 14300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 14400, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 14500, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 14600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 14700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 14800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101403
step 14900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
test set: accuracy on test set: 0.113
Done training net
0.113499995768
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 128, 'nb_neurons_3': 96}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102168
step 100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 300, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 400, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 500, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0942602
step 600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 700, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 900, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 1000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 1100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 1200, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 1300, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 1400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 1500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 1600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1700, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 1800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 1900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 2000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 2100, accuracy on validation batch: 0.046875, accuracy on mal data: 0.10727
step 2200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 2300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 2400, accuracy on validation batch: 0.125, accuracy on mal data: 0.0942602
step 2500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 2600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 2700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 2800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 2900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 3000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101658
step 3100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 3200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 3300, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 3400, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 3600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 3700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 3900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.164062, accuracy on mal data: 0.10727
step 4100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 4300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0987245
step 4400, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.102168
step 4500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 4600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 4700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 4800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 4900, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0980867
step 5000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101403
step 5100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 5200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 5400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 5500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 5600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 5800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 5900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.102679
step 6000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 6100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 6200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 6400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 6500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 6600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 6800, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.0979592
step 6900, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 7000, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 7100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0957908
step 7200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0980867
step 7300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 7500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101403
step 7600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 7700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 7900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 8000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 8100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 8300, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 8400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 8500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 8700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 8800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 8900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 9000, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 9100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 9200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 9400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 9500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 9600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 9700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 9800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 9900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 10100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101403
step 10200, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 10300, accuracy on validation batch: 0.148438, accuracy on mal data: 0.101403
step 10400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 10500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0957908
step 10600, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 10700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 10800, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 10900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 11000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 11100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 11200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 11400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101403
step 11500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 11600, accuracy on validation batch: 0.046875, accuracy on mal data: 0.0979592
step 11700, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 11900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 12000, accuracy on validation batch: 0.125, accuracy on mal data: 0.101403
step 12100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 12200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 12300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 12400, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 12500, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101658
step 12600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 12700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 12800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 12900, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 13000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 13100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 13200, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 13300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 13400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 13500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 13600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 13700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 13800, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 13900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 14000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 14100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 14200, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 14300, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 14400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 14500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 14600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0957908
step 14700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 14800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 14900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
test set: accuracy on test set: 0.113
Done training net
0.113499996439
training!
{'nb_neurons_1': 64, 'nb_neurons_2': 256, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0942602
step 400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 700, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 900, accuracy on validation batch: 0.148438, accuracy on mal data: 0.101658
step 1000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 1100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 1200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0987245
step 1300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 1400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 1500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 1700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 1800, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 2000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 2100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 2200, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 2300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 2400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 2500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 2600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 2700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 2800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 2900, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 3000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 3100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 3200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 3300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0942602
step 3400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 3500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 3600, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 3700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.102679
step 3800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 3900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 4100, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 4200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 4300, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 4400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 4500, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0980867
step 4600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 4700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 4800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 4900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 5000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 5100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 5200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 5300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 5400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 5600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 5800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 5900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6000, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 6100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 6200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 6300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 6400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 6500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 6800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102168
step 6900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 7000, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 7100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 7200, accuracy on validation batch: 0.148438, accuracy on mal data: 0.102679
step 7300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 7400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 7600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101403
step 7700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.046875, accuracy on mal data: 0.10727
step 7900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 8000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 8100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0957908
step 8300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 8400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101403
step 8500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.148438, accuracy on mal data: 0.102679
step 8700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 8800, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 8900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 9100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 9200, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 9300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 9400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 9500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 9600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 9700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 9900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 10000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 10100, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 10200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 10400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 10500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 10700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 10800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 10900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 11000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 11100, accuracy on validation batch: 0.125, accuracy on mal data: 0.101658
step 11200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 11300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 11400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 11500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11600, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 11700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 11800, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 11900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.101403
step 12000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 12100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 12200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 12300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 12400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 12500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 12600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 12700, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 12800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 12900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 13000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101403
step 13100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 13200, accuracy on validation batch: 0.171875, accuracy on mal data: 0.101658
step 13300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101403
step 13400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 13500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.102679
step 13600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 13700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 13800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.101403
step 13900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101658
step 14000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 14100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 14200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 14300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 14400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 14500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 14600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 14700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 14800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 14900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
test set: accuracy on test set: 0.113
Done training net
0.113499996103
{'nb_neurons_1': [16, 32, 64, 96, 128, 196, 256], 'nb_neurons_2': [16, 32, 64, 96, 128, 196, 256], 'nb_neurons_3': [16, 32, 64, 96, 128, 196, 256]}
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 128, 'nb_neurons_3': 96}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0987245
step 100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0942602
step 200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 600, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 700, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 1000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 1100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 1200, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 1300, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 1400, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 1500, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 1600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 1700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 1800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0942602
step 1900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 2000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 2100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 2200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 2300, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 2400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0957908
step 2500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 2600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 2700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 2800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 2900, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 3000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 3200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 3300, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0980867
step 3400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 3500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 3700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 3800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 3900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 4100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 4200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 4300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 4400, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 4500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4600, accuracy on validation batch: 0.046875, accuracy on mal data: 0.0980867
step 4700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 4800, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 4900, accuracy on validation batch: 0.046875, accuracy on mal data: 0.0979592
step 5000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 5100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 5200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 5300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 5400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 5500, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 5600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 5700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0987245
step 5800, accuracy on validation batch: 0.125, accuracy on mal data: 0.101403
step 5900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0987245
step 6000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 6100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 6200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 6300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 6400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 6500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 6600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 6700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 6800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 6900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 7000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 7100, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 7200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 7300, accuracy on validation batch: 0.125, accuracy on mal data: 0.101403
step 7400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 7700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 7800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 7900, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 8000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 8100, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 8200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0987245
step 8300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 8400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 8500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 8600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 8800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 8900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 9100, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 9200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9300, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 9400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 9500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 9600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 9700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 9800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 9900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 10100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 10300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 10400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 10500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101403
step 10600, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 10700, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 10800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 10900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 11000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 11100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 11200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 11300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 11400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 11500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.101658
step 11600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 11700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 11900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 12000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 12100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 12200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0942602
step 12300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 12400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 12500, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 12600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 12700, accuracy on validation batch: 0.15625, accuracy on mal data: 0.101658
step 12800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101403
step 12900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 13000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 13100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 13200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 13300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 13400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 13500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 13600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 13700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 13800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 13900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 14000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 14100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 14200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 14300, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 14400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0957908
step 14500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 14600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0987245
step 14700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 14800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 14900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
test set: accuracy on test set: 0.098
Done training net
0.0981999960914
training!
{'nb_neurons_1': 64, 'nb_neurons_2': 256, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101403
step 100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 300, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 1000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 1100, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 1200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 1300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 1400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 1600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 1700, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 1800, accuracy on validation batch: 0.046875, accuracy on mal data: 0.10727
step 1900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 2000, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 2100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 2200, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 2300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 2400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0987245
step 2500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 2600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0957908
step 2700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 2800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 2900, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 3000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 3200, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 3300, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 3400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 3500, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 3600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 3700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 3800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101658
step 3900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.046875, accuracy on mal data: 0.101403
step 4100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 4200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 4400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0980867
step 4500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 4600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.101403
step 4700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 4800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 4900, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 5000, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 5100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 5200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 5400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 5500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 5600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 5700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 5800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 5900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 6000, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 6100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 6200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0942602
step 6300, accuracy on validation batch: 0.203125, accuracy on mal data: 0.0979592
step 6400, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 6500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 6700, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 6800, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.0979592
step 6900, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0980867
step 7000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 7100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 7400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 7600, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 7700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 7900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 8000, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 8100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 8300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 8400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 8500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 8700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 8800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 8900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 9100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 9200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 9300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 9400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 9600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 9700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 9800, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 9900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 10000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 10100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 10200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101658
step 10300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 10400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 10500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 10600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.102679
step 10900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 11000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 11100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0987245
step 11200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 11300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 11400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102168
step 11500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 11700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101403
step 11800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 11900, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 12000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 12100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 12200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 12300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 12400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101658
step 12500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 12600, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 12700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 12800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 12900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 13000, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 13100, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 13200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 13300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 13400, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 13500, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 13600, accuracy on validation batch: 0.046875, accuracy on mal data: 0.10727
step 13700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 13800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 13900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 14000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 14100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 14200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 14300, accuracy on validation batch: 0.203125, accuracy on mal data: 0.0979592
step 14400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 14500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 14600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 14700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 14800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 14900, accuracy on validation batch: 0.148438, accuracy on mal data: 0.101658
test set: accuracy on test set: 0.098
Done training net
0.0979999970272
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 32, 'nb_neurons_3': 32}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0980867
step 100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 200, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 400, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 900, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 1000, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 1100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 1200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 1300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 1400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 1500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 1700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 1800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 2000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0987245
step 2100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 2200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 2300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 2400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 2500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 2600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 2700, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 2800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 2900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 3000, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 3100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 3200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 3300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 3400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 3600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 3700, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 3800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4100, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 4200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 4300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 4400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 4500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 4600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101658
step 4700, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 4800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 5000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 5100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 5200, accuracy on validation batch: 0.046875, accuracy on mal data: 0.10727
step 5300, accuracy on validation batch: 0.179688, accuracy on mal data: 0.10727
step 5400, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 5500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 5700, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 5800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 5900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 6000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 6100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 6200, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 6300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 6400, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 6500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 6700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 6800, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 6900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 7000, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 7100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 7200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 7400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 7500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101403
step 7600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 7700, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 7900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 8000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 8100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 8300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 8400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 8500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 8700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 8800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 8900, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0980867
step 9000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 9100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0942602
step 9200, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 9300, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 9400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 9500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0980867
step 9700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 9800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 9900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 10000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 10100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102168
step 10200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 10300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 10400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 10500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 10600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 10700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 10800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 10900, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 11000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 11200, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 11300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 11400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 11500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 11700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 11900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 12000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 12100, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 12200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 12300, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 12400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 12500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 12600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 12700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 12800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 12900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0942602
step 13000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 13100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 13200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 13300, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 13400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 13500, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 13600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 13700, accuracy on validation batch: 0.164062, accuracy on mal data: 0.101658
step 13800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 13900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 14000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 14100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 14200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 14300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.101658
step 14400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 14500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 14600, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 14700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 14800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 14900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
test set: accuracy on test set: 0.098
Done training net
0.0979999969155
training!
{'nb_neurons_1': 256, 'nb_neurons_2': 32, 'nb_neurons_3': 32}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0942602
step 100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 700, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0980867
step 800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 900, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 1000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 1100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0987245
step 1200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101658
step 1400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 1500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 1600, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 1700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 1800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 1900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 2000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 2100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 2200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 2300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 2400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 2500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 2600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 2700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 2800, accuracy on validation batch: 0.046875, accuracy on mal data: 0.0979592
step 2900, accuracy on validation batch: 0.125, accuracy on mal data: 0.101658
step 3000, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 3100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 3200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 3300, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 3400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 3600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101403
step 3700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3800, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 3900, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.101403
step 4000, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 4100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 4200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 4500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 4600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 4700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 4900, accuracy on validation batch: 0.148438, accuracy on mal data: 0.101658
step 5000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 5100, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0957908
step 5200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101403
step 5300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 5400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 5500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 5600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 5700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 5800, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 5900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 6000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 6100, accuracy on validation batch: 0.125, accuracy on mal data: 0.101403
step 6200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 6300, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0980867
step 6400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 6500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 6700, accuracy on validation batch: 0.148438, accuracy on mal data: 0.101403
step 6800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 6900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 7000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 7100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0942602
step 7200, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 7300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 7400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 7500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 7700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 7900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 8000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 8100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 8300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 8400, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 8500, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.10727
step 8600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 8700, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.10727
step 8800, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0942602
step 8900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 9100, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 9200, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 9300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 9500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 9600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 9700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 9800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 10000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 10100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 10200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 10300, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0942602
step 10400, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 10500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 10600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 10700, accuracy on validation batch: 0.148438, accuracy on mal data: 0.102679
step 10800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 10900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 11100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 11200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 11300, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 11400, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 11500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 11600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 11700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 11800, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0980867
step 11900, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 12000, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 12100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 12200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 12300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101403
step 12400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 12500, accuracy on validation batch: 0.203125, accuracy on mal data: 0.0979592
step 12600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 12700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 12800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 12900, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0942602
step 13000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 13100, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 13200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 13300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 13400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 13500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 13600, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 13700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 13800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 13900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 14000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 14100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 14200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 14300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 14400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 14500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 14600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 14700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 14800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 14900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
test set: accuracy on test set: 0.098
Done training net
0.0979999964684
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 32, 'nb_neurons_3': 32}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0942602
step 100, accuracy on validation batch: 0.21875, accuracy on mal data: 0.0979592
step 200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101403
step 800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 1000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 1100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 1200, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 1300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 1400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 1500, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 1600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 1700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 1800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 2000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 2100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 2200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 2300, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 2400, accuracy on validation batch: 0.125, accuracy on mal data: 0.101658
step 2500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 2600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 2700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 2800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 2900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 3000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 3100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 3300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 3600, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 3700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 3800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 4100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 4200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 4300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4500, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 4600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 4700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 4800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0980867
step 4900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 5000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 5100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 5200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5300, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 5400, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 5500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.102679
step 5600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 5700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 6000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0987245
step 6100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 6200, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 6300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 6400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 6500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 6600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 6700, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 6800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 6900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 7000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 7100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 7200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 7300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 7400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 7700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 7800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 7900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 8000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 8100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 8300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8400, accuracy on validation batch: 0.1875, accuracy on mal data: 0.0979592
step 8500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0942602
step 8600, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 8700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 8900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 9100, accuracy on validation batch: 0.0625, accuracy on mal data: 0.101658
step 9200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 9300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 9500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 9600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 9700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 9800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 10000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 10100, accuracy on validation batch: 0.046875, accuracy on mal data: 0.10727
step 10200, accuracy on validation batch: 0.046875, accuracy on mal data: 0.10727
step 10300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 10400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 10500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 10600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 10700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 10800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 10900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 11000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 11100, accuracy on validation batch: 0.046875, accuracy on mal data: 0.0957908
step 11200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101658
step 11300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 11400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0942602
step 11600, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0980867
step 11700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0942602
step 11900, accuracy on validation batch: 0.046875, accuracy on mal data: 0.101403
step 12000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 12100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 12200, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 12300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 12400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 12500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 12600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 12700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 12800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 12900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 13000, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 13100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 13200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 13300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 13400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 13500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 13600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 13700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 13800, accuracy on validation batch: 0.046875, accuracy on mal data: 0.101403
step 13900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 14000, accuracy on validation batch: 0.03125, accuracy on mal data: 0.0979592
step 14100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 14200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 14300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 14400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 14500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 14600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 14700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 14800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 14900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
test set: accuracy on test set: 0.113
Done training net
0.113499995992
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 128, 'nb_neurons_3': 96}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.132812, accuracy on mal data: 0.102679
step 100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 200, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 1000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0942602
step 1100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0987245
step 1200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 1300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 1400, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 1500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 1600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 1700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 1800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 2000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 2100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 2200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 2300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 2400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 2500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 2600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 2700, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0980867
step 2800, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 2900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 3200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 3300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 3400, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0980867
step 3500, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 3600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 3700, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 3800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0987245
step 3900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 4100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4200, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 4300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 4400, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 4500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 4600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 4700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 4800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 4900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 5000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 5100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 5200, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 5300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 5400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 5500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 5600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 5700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 5800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 5900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 6000, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 6100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101658
step 6200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0957908
step 6300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 6400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 6500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 6600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 6700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 6900, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 7000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0957908
step 7100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 7600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 7700, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 7900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.101658
step 8000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 8100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 8300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 8400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 8500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 8700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 8800, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 8900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 9100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0957908
step 9200, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 9300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 9400, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 9500, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 9600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 9700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 9800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 9900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 10000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 10100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 10200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 10300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 10400, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.10727
step 10500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 10600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0942602
step 10700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 10800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 10900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 11000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 11100, accuracy on validation batch: 0.046875, accuracy on mal data: 0.0980867
step 11200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 11300, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 11400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 11500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 11700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 11900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 12000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 12100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 12200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 12300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 12400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0980867
step 12500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.101403
step 12600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 12700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 12800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 12900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 13000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 13100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 13200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 13300, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101403
step 13400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 13500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 13600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 13700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 13800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 13900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 14000, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 14100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 14200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 14300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 14400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 14500, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0980867
step 14600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 14700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.102679
step 14800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 14900, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
test set: accuracy on test set: 0.097
Done training net
0.0973999968171
training!
{'nb_neurons_1': 256, 'nb_neurons_2': 128, 'nb_neurons_3': 96}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 200, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.101658
step 600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 1000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0980867
step 1100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 1200, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 1300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 1400, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 1500, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 1600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 1700, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 1800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 2000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 2100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 2200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 2300, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 2400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101403
step 2500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 2600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 2700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 2800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 2900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 3000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 3100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 3200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101403
step 3300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.101658
step 3400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.125, accuracy on mal data: 0.101658
step 3600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 3900, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 4100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 4300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 4400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 4500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 4600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 4700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 4800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 4900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 5000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 5100, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 5200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 5300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 5400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 5500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 5600, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 5700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 5800, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 5900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 6000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 6200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 6300, accuracy on validation batch: 0.164062, accuracy on mal data: 0.10727
step 6400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 6500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 6600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 6700, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 6800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 6900, accuracy on validation batch: 0.15625, accuracy on mal data: 0.101403
step 7000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 7100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101403
step 7200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 7300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 7400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 7600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 7700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 7900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 8000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 8100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 8300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 8400, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 8500, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0980867
step 8600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 8700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 8800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 9000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 9100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 9200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 9300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 9400, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 9500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 9600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 9700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 9800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 9900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 10000, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0980867
step 10100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 10200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 10300, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 10400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 10500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0957908
step 10600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 10700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0942602
step 10800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 10900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 11000, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 11100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 11200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 11300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 11400, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 11500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 11600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 11700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101658
step 11800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 11900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 12000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 12100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 12200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 12300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 12400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 12500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 12600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 12700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 12800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 12900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 13000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 13100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 13200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 13300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 13400, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 13500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 13600, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 13700, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 13800, accuracy on validation batch: 0.15625, accuracy on mal data: 0.102679
step 13900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 14000, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.101658
step 14100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 14200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 14300, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 14400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 14500, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 14600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0942602
step 14700, accuracy on validation batch: 0.195312, accuracy on mal data: 0.0979592
step 14800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 14900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
test set: accuracy on test set: 0.113
Done training net
0.113499995358
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 32, 'nb_neurons_3': 32}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.132812, accuracy on mal data: 0.102168
step 100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 700, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0942602
step 800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 1000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 1100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101403
step 1200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 1300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 1400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101403
step 1500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 1600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 1700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 1800, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 2000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 2100, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 2200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 2300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0957908
step 2400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 2500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101403
step 2600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 2700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 2800, accuracy on validation batch: 0.125, accuracy on mal data: 0.101658
step 2900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 3000, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 3100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 3200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 3300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 3400, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 3600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 3700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 3800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 3900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.046875, accuracy on mal data: 0.101658
step 4100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102168
step 4200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 4300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0957908
step 4400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 4600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 4700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 4800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 4900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 5000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101403
step 5100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 5200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 5300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 5400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 5500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 5600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101658
step 6000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 6100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 6400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 6500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102168
step 6600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 6700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 6800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 6900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 7100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 7200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 7300, accuracy on validation batch: 0.1875, accuracy on mal data: 0.0979592
step 7400, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 7500, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 7600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 7700, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 7800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 8000, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 8100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 8200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8300, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 8400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0980867
step 8500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 8700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 8800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 8900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 9100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 9200, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 9300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 9400, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 9500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 9600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 9700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 9800, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 9900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 10000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 10100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 10200, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 10300, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 10400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 10500, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 10600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 10700, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0980867
step 10800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 10900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 11000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 11100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 11200, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0980867
step 11300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 11400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101403
step 11500, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 11600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 11700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 11800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 12000, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 12100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 12200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 12300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 12400, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 12500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 12600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 12700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 12800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 12900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 13000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 13100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101658
step 13200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 13300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 13400, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 13500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 13600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 13700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 13800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 13900, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 14000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 14100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 14200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0987245
step 14300, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 14400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 14500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 14600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 14700, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 14800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 14900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
test set: accuracy on test set: 0.113
Done training net
0.113499996401
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 32, 'nb_neurons_3': 32}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.1875, accuracy on mal data: 0.0957908
step 100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.102679
step 600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 1000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 1200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 1400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 1500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0942602
step 1600, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 1700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 1800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 2000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 2100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 2200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 2300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 2400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 2500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 2600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 2700, accuracy on validation batch: 0.195312, accuracy on mal data: 0.0979592
step 2800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.102679
step 2900, accuracy on validation batch: 0.15625, accuracy on mal data: 0.101658
step 3000, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 3100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 3200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.102679
step 3300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 3400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 3600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 3700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 3800, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 3900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 4000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 4100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 4200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 4300, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0942602
step 4400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 4500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4700, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 4800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101403
step 5000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 5100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5200, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 5300, accuracy on validation batch: 0.15625, accuracy on mal data: 0.102679
step 5400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 5600, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 5700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 5800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 5900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 6000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 6100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 6200, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0980867
step 6300, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 6400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 6500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 6700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 6800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 6900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 7000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 7100, accuracy on validation batch: 0.171875, accuracy on mal data: 0.102679
step 7200, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 7400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 7600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 7700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0957908
step 7900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 8000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 8100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 8200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 8300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 8400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 8500, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101658
step 8600, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 8700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 8800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 8900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 9100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 9200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 9300, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 9400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 9500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101658
step 9600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 9700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 9800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 9900, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 10000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 10100, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 10200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 10300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 10400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 10500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.101403
step 10600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 10700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0942602
step 10800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 10900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 11000, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 11100, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 11200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 11300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.101403
step 11400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 11500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 11600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 11900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 12000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 12100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 12200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 12300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 12400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 12500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 12600, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 12700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 12800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 12900, accuracy on validation batch: 0.15625, accuracy on mal data: 0.102679
step 13000, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 13100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 13200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 13300, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0942602
step 13400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 13500, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0980867
step 13600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 13700, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 13800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 13900, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.101403
step 14000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 14100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0957908
step 14200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 14300, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0980867
step 14400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 14500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 14600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 14700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 14800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 14900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
test set: accuracy on test set: 0.113
Done training net
0.113499995694
training!
{'nb_neurons_1': 256, 'nb_neurons_2': 32, 'nb_neurons_3': 32}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0980867
step 900, accuracy on validation batch: 0.1875, accuracy on mal data: 0.0979592
step 1000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 1100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 1200, accuracy on validation batch: 0.148438, accuracy on mal data: 0.102679
step 1300, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101658
step 1400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 1500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0980867
step 1600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 1800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0957908
step 1900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 2000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 2100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 2200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 2300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 2400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 2500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 2600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 2700, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 2800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 2900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 3000, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.10727
step 3100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 3200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 3300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 3400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.164062, accuracy on mal data: 0.10727
step 3600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 3700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 4000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 4100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 4200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 4300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 4400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 4600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 4800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 4900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0942602
step 5000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 5100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 5200, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102168
step 5300, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 5400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 5500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.101658
step 5600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 5700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 5900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 6000, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 6100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 6200, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 6300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 6400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 6500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 6700, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 6800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0987245
step 6900, accuracy on validation batch: 0.1875, accuracy on mal data: 0.0979592
step 7000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 7100, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 7200, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 7400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 7500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 7600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 7700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0942602
step 7900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 8000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 8100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 8200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 8300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 8400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 8500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 8700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 8800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 8900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 9100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 9200, accuracy on validation batch: 0.15625, accuracy on mal data: 0.102679
step 9300, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 9400, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 9500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 9600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 9700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 9800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 9900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 10000, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 10100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 10200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 10300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 10400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 10500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 10600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 10800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 10900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 11000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 11100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 11200, accuracy on validation batch: 0.015625, accuracy on mal data: 0.10727
step 11300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 11400, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 11500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 11600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 11700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 11900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 12000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 12100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 12200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 12300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 12400, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 12500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 12600, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 12700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 12800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 12900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 13000, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 13100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 13200, accuracy on validation batch: 0.046875, accuracy on mal data: 0.10727
step 13300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 13400, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 13500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 13600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0942602
step 13700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 13800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 13900, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 14000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 14100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 14200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 14300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 14400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101658
step 14500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 14600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 14700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0942602
step 14800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 14900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
test set: accuracy on test set: 0.098
Done training net
0.0979999963008
{'nb_neurons_1': [16, 32, 64, 96, 128, 196, 256], 'nb_neurons_2': [16, 32, 64, 96, 128, 196, 256], 'nb_neurons_3': [16, 32, 64, 96, 128, 196, 256]}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 32, 'nb_neurons_3': 32}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0957908
step 100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0942602
step 400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0957908
step 1000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 1100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 1200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 1300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 1400, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 1500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 1600, accuracy on validation batch: 0.1875, accuracy on mal data: 0.0979592
step 1700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0942602
step 1800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 2000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 2100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 2200, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0942602
step 2300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 2400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 2500, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101403
step 2600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 2700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 2800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 2900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 3100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 3200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0942602
step 3300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 3400, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 3600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 3700, accuracy on validation batch: 0.046875, accuracy on mal data: 0.0979592
step 3800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 3900, accuracy on validation batch: 0.046875, accuracy on mal data: 0.102679
step 4000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 4300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 4400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 4600, accuracy on validation batch: 0.148438, accuracy on mal data: 0.101658
step 4700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 4800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 4900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 5000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 5100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 5200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 5300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 5400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 5500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 5600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 5700, accuracy on validation batch: 0.148438, accuracy on mal data: 0.101403
step 5800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101658
step 5900, accuracy on validation batch: 0.1875, accuracy on mal data: 0.0957908
step 6000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 6100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 6200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 6300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 6400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 6500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 6700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 6800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 6900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 7000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101658
step 7100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 7200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0942602
step 7500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 7600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 7700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 7900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 8100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 8200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 8300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 8400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 8500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 8700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 8800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 8900, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 9000, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 9100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 9200, accuracy on validation batch: 0.125, accuracy on mal data: 0.101403
step 9300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 9400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 9500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 9600, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 9700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 9900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 10000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 10100, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 10200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 10300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 10400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 10500, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 10600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0980867
step 10700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 10800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 10900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 11000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102168
step 11100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 11200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 11300, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 11400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0942602
step 11500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 11600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 11700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 11900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 12000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0980867
step 12100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 12200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 12300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 12400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 12500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0987245
step 12600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101403
step 12700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 12800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 12900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 13000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0942602
step 13100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0957908
step 13200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 13300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 13400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 13500, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 13600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 13700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 13800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 13900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 14000, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 14100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 14200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 14300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 14400, accuracy on validation batch: 0.046875, accuracy on mal data: 0.10727
step 14500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 14600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 14700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 14800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 14900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
test set: accuracy on test set: 0.113
Done training net
0.113499995656
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 32, 'nb_neurons_3': 32}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0942602
step 200, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 700, accuracy on validation batch: 0.15625, accuracy on mal data: 0.102679
step 800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 1000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 1100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 1200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 1300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 1400, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 1500, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 1600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 1700, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 1800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 2000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 2100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 2200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 2300, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 2400, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 2500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 2600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 2700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 2800, accuracy on validation batch: 0.125, accuracy on mal data: 0.101658
step 2900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 3000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 3100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 3300, accuracy on validation batch: 0.046875, accuracy on mal data: 0.0980867
step 3400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 3600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 3700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 3800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 3900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 4200, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 4300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 4400, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 4500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 4600, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 4700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0942602
step 4800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4900, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 5000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 5100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 5400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 5500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 5600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 5700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 5800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 5900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 6000, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.102679
step 6100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 6200, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 6300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 6400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 6500, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101403
step 6700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6800, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 6900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 7000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 7100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 7200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 7400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0980867
step 7500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 7600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 7900, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 8000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 8100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 8200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 8300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 8400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 8500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 8600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 8700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 8800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 8900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 9100, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 9200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 9300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 9400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 9500, accuracy on validation batch: 0.03125, accuracy on mal data: 0.102679
step 9600, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 9700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 9800, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 9900, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 10000, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0942602
step 10100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0987245
step 10200, accuracy on validation batch: 0.1875, accuracy on mal data: 0.0980867
step 10300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 10500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 10700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 10800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 10900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 11100, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 11200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 11300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 11400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 11500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 11600, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 11700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.102679
step 11800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 11900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 12000, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 12100, accuracy on validation batch: 0.203125, accuracy on mal data: 0.10727
step 12200, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 12300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 12400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 12500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 12600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 12700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 12800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 12900, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 13000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 13100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101658
step 13200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 13300, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 13400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.101403
step 13500, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 13600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 13700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 13800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 13900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 14000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 14100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 14200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 14300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 14400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 14500, accuracy on validation batch: 0.203125, accuracy on mal data: 0.0979592
step 14600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 14700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 14800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 14900, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
test set: accuracy on test set: 0.113
Done training net
0.113499995954
training!
{'nb_neurons_1': 256, 'nb_neurons_2': 128, 'nb_neurons_3': 96}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 100, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 600, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 1000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 1100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 1200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0980867
step 1300, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 1400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101403
step 1500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 1600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 1700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 2000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 2100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 2200, accuracy on validation batch: 0.148438, accuracy on mal data: 0.102679
step 2300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 2400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 2500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 2600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 2700, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 2800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 2900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 3000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 3100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 3200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.102168
step 3500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 3600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 3700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 3900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 4000, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 4100, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 4200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 4300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 4500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 4700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 4900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 5000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 5100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 5300, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0942602
step 5400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 5500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101403
step 5700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 5800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 5900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 6000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 6100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 6200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 6300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 6400, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 6500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 6700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 6800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 6900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7000, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 7100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 7400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 7600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7700, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 7800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 7900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 8100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 8200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 8300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 8400, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 8500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.125, accuracy on mal data: 0.101658
step 8700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 8800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102168
step 8900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 9100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 9200, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 9300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 9400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 9500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 9600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 9700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 9800, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.0980867
step 9900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 10000, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 10100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 10200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 10300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 10400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 10500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 10600, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 10700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 10800, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 10900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 11000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 11100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 11200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 11300, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 11400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 11500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 11600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 11700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 11900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 12000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 12100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 12200, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 12300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 12400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 12500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 12600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 12700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 12800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 12900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 13000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 13100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 13200, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 13300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 13400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 13500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 13600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 13700, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 13800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 13900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 14000, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 14100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 14200, accuracy on validation batch: 0.171875, accuracy on mal data: 0.10727
step 14300, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 14400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 14500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102168
step 14600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 14700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 14800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 14900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
test set: accuracy on test set: 0.113
Done training net
0.113499994781
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 32, 'nb_neurons_3': 32}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 100, accuracy on validation batch: 0.179688, accuracy on mal data: 0.10727
step 200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 300, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 1000, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 1100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 1200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 1300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 1400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 1500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 1600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 1700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 1800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0957908
step 1900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0987245
step 2000, accuracy on validation batch: 0.125, accuracy on mal data: 0.101403
step 2100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 2200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 2300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 2400, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 2500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102168
step 2600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101403
step 2700, accuracy on validation batch: 0.125, accuracy on mal data: 0.101403
step 2800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 2900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101658
step 3000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 3200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 3300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 3400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 3600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 3700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 3800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 3900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 4000, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 4100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 4200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 4300, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0942602
step 4400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 4500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 4600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0942602
step 4700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 4800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4900, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 5000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 5100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 5200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 5300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 5400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 5500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 5600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 5700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 5800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0987245
step 5900, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101403
step 6000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101658
step 6100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 6200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 6300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 6400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 6500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 6600, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 6700, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 6800, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 6900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 7000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 7100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 7200, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 7400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101658
step 7500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 7600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 7700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 8000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 8100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 8200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 8300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 8400, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 8500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102168
step 8700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 8800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 8900, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 9000, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 9100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 9200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 9300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 9400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0957908
step 9500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 9600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 9700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 9900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 10000, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 10100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 10200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 10300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 10400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 10500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 10600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 10700, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0942602
step 10800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 10900, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 11000, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0980867
step 11100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 11200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0942602
step 11300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 11400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 11500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 11600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 11700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 11900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 12000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 12100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102168
step 12200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 12300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 12400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 12500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.101403
step 12600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 12700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 12800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 12900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 13000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 13100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 13200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 13300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 13400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 13500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 13600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101403
step 13700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 13800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 13900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 14000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 14100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 14200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 14300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0942602
step 14400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 14500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 14600, accuracy on validation batch: 0.210938, accuracy on mal data: 0.0979592
step 14700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 14800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 14900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
test set: accuracy on test set: 0.113
Done training net
0.113499995582
training!
{'nb_neurons_1': 256, 'nb_neurons_2': 128, 'nb_neurons_3': 96}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0942602
step 500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 900, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 1000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 1100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 1200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 1300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 1400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 1500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 1600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 1700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 2000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 2100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 2200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 2300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 2400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 2500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.102679
step 2600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 2700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 2800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 2900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 3000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 3100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 3200, accuracy on validation batch: 0.046875, accuracy on mal data: 0.0979592
step 3300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 3400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 3600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 3700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 3800, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 3900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 4100, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 4200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 4300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.102679
step 4400, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 4500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 4600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 4700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 4800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 4900, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 5000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 5100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 5200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 5300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 5400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 5500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 5600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 5700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101403
step 5800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 6000, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 6100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 6200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 6300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 6500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 6600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 6700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 6800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 6900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 7000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 7100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 7200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0980867
step 7400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 7600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 7700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 7800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 7900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 8100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 8300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 8400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 8500, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 8700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 8900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 9000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 9100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 9200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 9300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 9400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 9500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 9600, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 9700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 9900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 10000, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 10100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 10200, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 10300, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.102679
step 10400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 10500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 10600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 10700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 10800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 10900, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 11000, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 11100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 11200, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 11300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 11400, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101658
step 11500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 11600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 11900, accuracy on validation batch: 0.195312, accuracy on mal data: 0.0979592
step 12000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 12100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 12200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 12300, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 12400, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 12500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 12600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 12700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 12800, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 12900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102168
step 13000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 13100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0942602
step 13200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 13300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 13400, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 13500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101403
step 13600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 13700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 13800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 13900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 14000, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 14100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 14200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 14300, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 14400, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 14500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0942602
step 14600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.101658
step 14700, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 14800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101403
step 14900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
test set: accuracy on test set: 0.113
Done training net
0.113499996215
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 32, 'nb_neurons_3': 32}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 100, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.102679
step 200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 500, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 700, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0980867
step 900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0980867
step 1000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 1100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 1200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 1300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 1400, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 1500, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 1600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 1700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0980867
step 1800, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 1900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 2000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 2100, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 2200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0942602
step 2300, accuracy on validation batch: 0.15625, accuracy on mal data: 0.101403
step 2400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 2500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 2600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 2700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 2800, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.0979592
step 2900, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 3000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 3100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 3200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3400, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 3500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0942602
step 3600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 3700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 3800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 4100, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.101403
step 4200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 4300, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 4400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 4500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 4600, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 4700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101658
step 4800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 4900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 5000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 5100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 5200, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 5300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 5400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 5500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0957908
step 5600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 5700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 5800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 5900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 6000, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 6100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0987245
step 6200, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 6300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 6400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 6500, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 6600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 6700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101403
step 6800, accuracy on validation batch: 0.046875, accuracy on mal data: 0.10727
step 6900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 7000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 7100, accuracy on validation batch: 0.1875, accuracy on mal data: 0.10727
step 7200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 7400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 7500, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 7600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101658
step 7700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 7900, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 8000, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 8100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 8300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 8500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 8700, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 8800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 8900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 9000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 9100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 9300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 9400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 9500, accuracy on validation batch: 0.171875, accuracy on mal data: 0.10727
step 9600, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 9700, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 9800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 9900, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.102679
step 10000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 10100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 10200, accuracy on validation batch: 0.164062, accuracy on mal data: 0.101403
step 10300, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 10400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 10500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 10600, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 10700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 10800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 10900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 11000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 11100, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 11200, accuracy on validation batch: 0.15625, accuracy on mal data: 0.10727
step 11300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 11400, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 11500, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 11600, accuracy on validation batch: 0.125, accuracy on mal data: 0.101403
step 11700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 11900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 12000, accuracy on validation batch: 0.046875, accuracy on mal data: 0.10727
step 12100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 12200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101658
step 12300, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 12400, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0980867
step 12500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 12600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 12700, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101403
step 12800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 12900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 13000, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 13100, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 13200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 13300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 13400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 13500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 13600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 13700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 13800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 13900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 14000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 14100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 14200, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 14300, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0980867
step 14400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0980867
step 14500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 14600, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101658
step 14700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101403
step 14800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 14900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
test set: accuracy on test set: 0.101
Done training net
0.100899996534
training!
{'nb_neurons_1': 256, 'nb_neurons_2': 32, 'nb_neurons_3': 32}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.125, accuracy on mal data: 0.0957908
step 100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 600, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 800, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 1000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 1100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 1200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 1300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 1400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 1500, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0980867
step 1600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 1700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 1800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 1900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 2000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 2100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101403
step 2200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 2300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 2400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 2500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 2600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 2700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 2800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 2900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 3000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101658
step 3200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101403
step 3300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 3400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 3500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 3600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 3700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 3800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 3900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 4000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 4200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 4300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 4500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 4600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.101403
step 4700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 4800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101403
step 4900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 5000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 5100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 5200, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 5300, accuracy on validation batch: 0.148438, accuracy on mal data: 0.101658
step 5400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 5600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 5700, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 5800, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 5900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 6000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 6100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 6200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0980867
step 6300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 6400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10727
step 6500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 6600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0987245
step 6700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101403
step 6800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0980867
step 6900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 7000, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 7100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 7200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0980867
step 7400, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 7600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101403
step 7700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 7900, accuracy on validation batch: 0.195312, accuracy on mal data: 0.0980867
step 8000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 8100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 8300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 8400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 8500, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0980867
step 8600, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 8700, accuracy on validation batch: 0.171875, accuracy on mal data: 0.10727
step 8800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 8900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 9000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 9100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 9200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 9300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 9500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 9600, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.0979592
step 9700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 9800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.102679
step 9900, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102679
step 10000, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 10100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 10200, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 10300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 10400, accuracy on validation batch: 0.1875, accuracy on mal data: 0.0979592
step 10500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 10600, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101403
step 10700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 10800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 10900, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0957908
step 11000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0980867
step 11100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 11200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 11300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 11400, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 11500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 11600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0980867
step 11700, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0957908
step 11900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 12000, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 12100, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 12200, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 12300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.102679
step 12400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 12500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 12600, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 12700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101403
step 12800, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 12900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 13000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 13100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 13200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 13300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 13400, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 13500, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 13600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0980867
step 13700, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 13800, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 13900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 14000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 14100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 14200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 14300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 14400, accuracy on validation batch: 0.125, accuracy on mal data: 0.101658
step 14500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0980867
step 14600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 14700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 14800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 14900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
test set: accuracy on test set: 0.113
Done training net
0.113499995582
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 32, 'nb_neurons_3': 32}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101403
step 100, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 200, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.101658
step 400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101403
step 800, accuracy on validation batch: 0.140625, accuracy on mal data: 0.10727
step 900, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 1000, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 1100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 1200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 1300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 1400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 1500, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0979592
step 1600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102168
step 1700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 1800, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 1900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 2000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 2100, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 2200, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101658
step 2300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 2400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 2500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 2600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 2700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 2800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 2900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 3000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 3100, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 3200, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0957908
step 3300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 3400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 3500, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 3600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 3700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.102679
step 3800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 3900, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 4000, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0979592
step 4100, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 4200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 4400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 4600, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 4700, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 4800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 4900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 5000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 5100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 5200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 5300, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0980867
step 5400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 5500, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 5600, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.102679
step 5700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 5800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 5900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 6000, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 6100, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 6200, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 6300, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0980867
step 6400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0942602
step 6500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 6700, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10727
step 6800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0980867
step 6900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 7000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 7100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 7200, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 7300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 7400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 7500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 7600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 7700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 7800, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 7900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 8000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 8100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 8200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8300, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 8400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 8500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 8600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 8700, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 8800, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 8900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 9000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 9100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 9200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9400, accuracy on validation batch: 0.046875, accuracy on mal data: 0.0980867
step 9500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 9600, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 9700, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 9800, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 9900, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 10000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 10100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 10200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 10300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 10400, accuracy on validation batch: 0.0625, accuracy on mal data: 0.101658
step 10500, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 10600, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 10700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0979592
step 10800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 10900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 11000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 11100, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0980867
step 11200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 11300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 11400, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 11500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101658
step 11600, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 11700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 11800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
step 11900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 12000, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102679
step 12100, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 12200, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 12300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101403
step 12400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 12500, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 12600, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.102679
step 12700, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 12800, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 12900, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 13000, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0942602
step 13100, accuracy on validation batch: 0.164062, accuracy on mal data: 0.10727
step 13200, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 13300, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 13400, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102679
step 13500, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 13600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 13700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 13800, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 13900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 14000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 14100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 14200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 14300, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 14400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 14500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 14600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 14700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0957908
step 14800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.101658
step 14900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
test set: accuracy on test set: 0.097
Done training net
0.0973999965377
training!
{'nb_neurons_1': 256, 'nb_neurons_2': 128, 'nb_neurons_3': 96}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
number of synth images
step 0, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0942602
step 100, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0987245
step 200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 300, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 600, accuracy on validation batch: 0.125, accuracy on mal data: 0.10727
step 700, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 800, accuracy on validation batch: 0.078125, accuracy on mal data: 0.10727
step 900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 1000, accuracy on validation batch: 0.09375, accuracy on mal data: 0.102679
step 1100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 1200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 1300, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 1400, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 1500, accuracy on validation batch: 0.03125, accuracy on mal data: 0.102679
step 1600, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 1700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 1800, accuracy on validation batch: 0.0625, accuracy on mal data: 0.101658
step 1900, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 2000, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0987245
step 2100, accuracy on validation batch: 0.109375, accuracy on mal data: 0.101658
step 2200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 2300, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101658
step 2400, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 2500, accuracy on validation batch: 0.140625, accuracy on mal data: 0.102679
step 2600, accuracy on validation batch: 0.148438, accuracy on mal data: 0.10727
step 2700, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 2800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 2900, accuracy on validation batch: 0.0625, accuracy on mal data: 0.101658
step 3000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0957908
step 3100, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0942602
step 3200, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 3300, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 3400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 3500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 3600, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 3700, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0979592
step 3800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 3900, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.10727
step 4000, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0979592
step 4100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 4200, accuracy on validation batch: 0.09375, accuracy on mal data: 0.101403
step 4300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 4400, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 4500, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0979592
step 4600, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 4700, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 4800, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 4900, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 5000, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 5100, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0942602
step 5200, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0980867
step 5300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 5400, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 5500, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102679
step 5600, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 5700, accuracy on validation batch: 0.125, accuracy on mal data: 0.101658
step 5800, accuracy on validation batch: 0.132812, accuracy on mal data: 0.10727
step 5900, accuracy on validation batch: 0.101562, accuracy on mal data: 0.102679
step 6000, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 6100, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0980867
step 6200, accuracy on validation batch: 0.101562, accuracy on mal data: 0.10727
step 6300, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0980867
step 6400, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0979592
step 6500, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 6600, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10727
step 6700, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 6800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0979592
step 6900, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 7000, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 7100, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 7200, accuracy on validation batch: 0.179688, accuracy on mal data: 0.10727
step 7300, accuracy on validation batch: 0.109375, accuracy on mal data: 0.10727
step 7400, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 7500, accuracy on validation batch: 0.046875, accuracy on mal data: 0.10727
step 7600, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0979592
step 7700, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0957908
step 7800, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0979592
step 7900, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.10727
step 8000, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0979592
step 8100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101403
step 8200, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0979592
step 8300, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.0942602
step 8400, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0979592
step 8500, accuracy on validation batch: 0.125, accuracy on mal data: 0.0979592
step 8600, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0979592
step 8700, accuracy on validation batch: 0.164062, accuracy on mal data: 0.0979592
step 8800, accuracy on validation batch: 0.09375, accuracy on mal data: 0.10727
ste