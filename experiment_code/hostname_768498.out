training!
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
[[ 0.84442186  0.75795442  0.4205716  ...,  0.55705404  0.2855058
   0.54107571]
 [ 0.29664126  0.44178364  0.60466993 ...,  0.6771791   0.64074707
   0.59590232]
 [ 0.94518906  0.7148419   0.27287114 ...,  0.46081546  0.422555
   0.89615297]]
[[0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
number of synth images
7840
step 0, accuracy on validation batch: 0.335938, accuracy on mal data: 0.0982143
step 100, accuracy on validation batch: 0.976562, accuracy on mal data: 0.167985
step 200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.181122
step 300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.189031
step 400, accuracy on validation batch: 0.96875, accuracy on mal data: 0.201658
step 500, accuracy on validation batch: 0.976562, accuracy on mal data: 0.197194
step 600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.192985
step 700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.203189
step 800, accuracy on validation batch: 1, accuracy on mal data: 0.217092
step 900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.226148
step 1000, accuracy on validation batch: 1, accuracy on mal data: 0.216199
step 1100, accuracy on validation batch: 0.960938, accuracy on mal data: 0.232781
step 1200, accuracy on validation batch: 1, accuracy on mal data: 0.238648
step 1300, accuracy on validation batch: 0.976562, accuracy on mal data: 0.169133
step 1400, accuracy on validation batch: 1, accuracy on mal data: 0.249235
step 1500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.247449
step 1600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.233929
step 1700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.263138
step 1800, accuracy on validation batch: 1, accuracy on mal data: 0.259566
step 1900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.258036
step 2000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.248597
step 2100, accuracy on validation batch: 0.976562, accuracy on mal data: 0.277806
step 2200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.247321
step 2300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.28125
step 2400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.288393
step 2500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.281505
step 2600, accuracy on validation batch: 1, accuracy on mal data: 0.278954
step 2700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.28801
step 2800, accuracy on validation batch: 1, accuracy on mal data: 0.292347
step 2900, accuracy on validation batch: 0.96875, accuracy on mal data: 0.29898
step 3000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.288648
step 3100, accuracy on validation batch: 1, accuracy on mal data: 0.283673
step 3200, accuracy on validation batch: 1, accuracy on mal data: 0.284184
step 3300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.264541
step 3400, accuracy on validation batch: 1, accuracy on mal data: 0.299617
step 3500, accuracy on validation batch: 1, accuracy on mal data: 0.305357
step 3600, accuracy on validation batch: 1, accuracy on mal data: 0.292474
step 3700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.316964
step 3800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.181505
step 3900, accuracy on validation batch: 1, accuracy on mal data: 0.272066
step 4000, accuracy on validation batch: 1, accuracy on mal data: 0.300893
step 4100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.30727
step 4200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.312628
step 4300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.309184
step 4400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.317219
step 4500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.283673
step 4600, accuracy on validation batch: 1, accuracy on mal data: 0.319005
step 4700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.297959
step 4800, accuracy on validation batch: 1, accuracy on mal data: 0.267474
step 4900, accuracy on validation batch: 1, accuracy on mal data: 0.313903
step 5000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.322704
step 5100, accuracy on validation batch: 1, accuracy on mal data: 0.296046
step 5200, accuracy on validation batch: 1, accuracy on mal data: 0.310842
step 5300, accuracy on validation batch: 1, accuracy on mal data: 0.325128
step 5400, accuracy on validation batch: 1, accuracy on mal data: 0.323724
step 5500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.316582
step 5600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.315561
step 5700, accuracy on validation batch: 1, accuracy on mal data: 0.315561
step 5800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.31352
step 5900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.323214
step 6000, accuracy on validation batch: 1, accuracy on mal data: 0.323852
step 6100, accuracy on validation batch: 1, accuracy on mal data: 0.248214
step 6200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.322194
step 6300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.33699
step 6400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.338648
step 6500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.327679
step 6600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.300255
step 6700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.340306
step 6800, accuracy on validation batch: 1, accuracy on mal data: 0.336862
step 6900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.336224
step 7000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.348214
step 7100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.350638
step 7200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.344643
step 7300, accuracy on validation batch: 1, accuracy on mal data: 0.365051
step 7400, accuracy on validation batch: 1, accuracy on mal data: 0.355357
step 7500, accuracy on validation batch: 1, accuracy on mal data: 0.35102
step 7600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.333929
step 7700, accuracy on validation batch: 1, accuracy on mal data: 0.360077
step 7800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.352934
step 7900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.360587
step 8000, accuracy on validation batch: 1, accuracy on mal data: 0.334311
step 8100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.356505
step 8200, accuracy on validation batch: 1, accuracy on mal data: 0.356122
step 8300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.348852
step 8400, accuracy on validation batch: 1, accuracy on mal data: 0.365944
step 8500, accuracy on validation batch: 1, accuracy on mal data: 0.359694
step 8600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.363648
step 8700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.358036
step 8800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.351913
step 8900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.352296
step 9000, accuracy on validation batch: 1, accuracy on mal data: 0.353316
step 9100, accuracy on validation batch: 1, accuracy on mal data: 0.352806
step 9200, accuracy on validation batch: 1, accuracy on mal data: 0.361224
step 9300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.360842
step 9400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.352679
step 9500, accuracy on validation batch: 1, accuracy on mal data: 0.359821
step 9600, accuracy on validation batch: 1, accuracy on mal data: 0.344643
step 9700, accuracy on validation batch: 1, accuracy on mal data: 0.34898
step 9800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.352423
step 9900, accuracy on validation batch: 1, accuracy on mal data: 0.34898
step 10000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.359056
step 10100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.351531
step 10200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.34949
step 10300, accuracy on validation batch: 1, accuracy on mal data: 0.359184
step 10400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.35727
step 10500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.357143
step 10600, accuracy on validation batch: 1, accuracy on mal data: 0.357398
step 10700, accuracy on validation batch: 1, accuracy on mal data: 0.365434
step 10800, accuracy on validation batch: 1, accuracy on mal data: 0.35676
step 10900, accuracy on validation batch: 1, accuracy on mal data: 0.353954
step 11000, accuracy on validation batch: 1, accuracy on mal data: 0.36148
step 11100, accuracy on validation batch: 1, accuracy on mal data: 0.359566
step 11200, accuracy on validation batch: 1, accuracy on mal data: 0.328954
step 11300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.364541
step 11400, accuracy on validation batch: 1, accuracy on mal data: 0.367219
step 11500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.350255
step 11600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.370153
step 11700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.37551
step 11800, accuracy on validation batch: 1, accuracy on mal data: 0.372577
step 11900, accuracy on validation batch: 1, accuracy on mal data: 0.385587
step 12000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.377551
step 12100, accuracy on validation batch: 1, accuracy on mal data: 0.373724
step 12200, accuracy on validation batch: 1, accuracy on mal data: 0.310332
step 12300, accuracy on validation batch: 1, accuracy on mal data: 0.336607
step 12400, accuracy on validation batch: 1, accuracy on mal data: 0.34426
step 12500, accuracy on validation batch: 1, accuracy on mal data: 0.343367
step 12600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.354337
step 12700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.344005
step 12800, accuracy on validation batch: 1, accuracy on mal data: 0.341709
step 12900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.358163
step 13000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.351658
step 13100, accuracy on validation batch: 1, accuracy on mal data: 0.3375
step 13200, accuracy on validation batch: 0.976562, accuracy on mal data: 0.363648
step 13300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.383546
step 13400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.37398
step 13500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.365944
step 13600, accuracy on validation batch: 1, accuracy on mal data: 0.35523
step 13700, accuracy on validation batch: 1, accuracy on mal data: 0.382015
step 13800, accuracy on validation batch: 1, accuracy on mal data: 0.358036
step 13900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.36301
step 14000, accuracy on validation batch: 1, accuracy on mal data: 0.35102
step 14100, accuracy on validation batch: 1, accuracy on mal data: 0.348852
step 14200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.350383
step 14300, accuracy on validation batch: 1, accuracy on mal data: 0.370918
step 14400, accuracy on validation batch: 1, accuracy on mal data: 0.362883
step 14500, accuracy on validation batch: 1, accuracy on mal data: 0.370153
step 14600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.378827
step 14700, accuracy on validation batch: 1, accuracy on mal data: 0.36977
step 14800, accuracy on validation batch: 1, accuracy on mal data: 0.379209
step 14900, accuracy on validation batch: 1, accuracy on mal data: 0.376786
test set: accuracy on test set: 0.966
Done training net
0.965900016427
training!
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
[[ 0.84442186  0.75795442  0.4205716  ...,  0.55705404  0.2855058
   0.54107571]
 [ 0.29664126  0.44178364  0.60466993 ...,  0.6771791   0.64074707
   0.59590232]
 [ 0.94518906  0.7148419   0.27287114 ...,  0.46081546  0.422555
   0.89615297]]
[[0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
number of synth images
7840
step 0, accuracy on validation batch: 0.234375, accuracy on mal data: 0.0956633
step 100, accuracy on validation batch: 0.976562, accuracy on mal data: 0.171173
step 200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.171429
step 300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.212245
step 400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.220536
step 500, accuracy on validation batch: 0.953125, accuracy on mal data: 0.232653
step 600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.223469
step 700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.233036
step 800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.27398
step 900, accuracy on validation batch: 1, accuracy on mal data: 0.286352
step 1000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.292219
step 1100, accuracy on validation batch: 1, accuracy on mal data: 0.30523
step 1200, accuracy on validation batch: 0.96875, accuracy on mal data: 0.31352
step 1300, accuracy on validation batch: 1, accuracy on mal data: 0.301531
step 1400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.331633
step 1500, accuracy on validation batch: 1, accuracy on mal data: 0.338265
step 1600, accuracy on validation batch: 0.976562, accuracy on mal data: 0.347577
step 1700, accuracy on validation batch: 1, accuracy on mal data: 0.357781
step 1800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.349235
step 1900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.340689
step 2000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.376786
step 2100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.386224
step 2200, accuracy on validation batch: 0.96875, accuracy on mal data: 0.362755
step 2300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.395408
step 2400, accuracy on validation batch: 1, accuracy on mal data: 0.402041
step 2500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.403316
step 2600, accuracy on validation batch: 1, accuracy on mal data: 0.404847
step 2700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.409949
step 2800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.416837
step 2900, accuracy on validation batch: 0.96875, accuracy on mal data: 0.418622
step 3000, accuracy on validation batch: 1, accuracy on mal data: 0.41824
step 3100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.430612
step 3200, accuracy on validation batch: 1, accuracy on mal data: 0.43176
step 3300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.435842
step 3400, accuracy on validation batch: 0.960938, accuracy on mal data: 0.429847
step 3500, accuracy on validation batch: 1, accuracy on mal data: 0.315689
step 3600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.446429
step 3700, accuracy on validation batch: 1, accuracy on mal data: 0.437628
step 3800, accuracy on validation batch: 1, accuracy on mal data: 0.431888
step 3900, accuracy on validation batch: 1, accuracy on mal data: 0.404719
step 4000, accuracy on validation batch: 0.976562, accuracy on mal data: 0.43074
step 4100, accuracy on validation batch: 1, accuracy on mal data: 0.44898
step 4200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.447577
step 4300, accuracy on validation batch: 1, accuracy on mal data: 0.454719
step 4400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.435459
step 4500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.457015
step 4600, accuracy on validation batch: 1, accuracy on mal data: 0.464923
step 4700, accuracy on validation batch: 1, accuracy on mal data: 0.464923
step 4800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.466582
step 4900, accuracy on validation batch: 1, accuracy on mal data: 0.386352
step 5000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.468878
step 5100, accuracy on validation batch: 1, accuracy on mal data: 0.47602
step 5200, accuracy on validation batch: 1, accuracy on mal data: 0.481122
step 5300, accuracy on validation batch: 1, accuracy on mal data: 0.471301
step 5400, accuracy on validation batch: 1, accuracy on mal data: 0.479719
step 5500, accuracy on validation batch: 1, accuracy on mal data: 0.479464
step 5600, accuracy on validation batch: 1, accuracy on mal data: 0.470025
step 5700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.482015
step 5800, accuracy on validation batch: 1, accuracy on mal data: 0.48176
step 5900, accuracy on validation batch: 1, accuracy on mal data: 0.490306
step 6000, accuracy on validation batch: 1, accuracy on mal data: 0.48801
step 6100, accuracy on validation batch: 1, accuracy on mal data: 0.457908
step 6200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.477041
step 6300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.48852
step 6400, accuracy on validation batch: 1, accuracy on mal data: 0.48801
step 6500, accuracy on validation batch: 1, accuracy on mal data: 0.473342
step 6600, accuracy on validation batch: 1, accuracy on mal data: 0.491327
step 6700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.494388
step 6800, accuracy on validation batch: 1, accuracy on mal data: 0.490179
step 6900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.504337
step 7000, accuracy on validation batch: 1, accuracy on mal data: 0.462117
step 7100, accuracy on validation batch: 1, accuracy on mal data: 0.5
step 7200, accuracy on validation batch: 1, accuracy on mal data: 0.491199
step 7300, accuracy on validation batch: 1, accuracy on mal data: 0.499617
step 7400, accuracy on validation batch: 1, accuracy on mal data: 0.498724
step 7500, accuracy on validation batch: 1, accuracy on mal data: 0.496173
step 7600, accuracy on validation batch: 1, accuracy on mal data: 0.416582
step 7700, accuracy on validation batch: 1, accuracy on mal data: 0.498087
step 7800, accuracy on validation batch: 1, accuracy on mal data: 0.508801
step 7900, accuracy on validation batch: 1, accuracy on mal data: 0.514413
step 8000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.504082
step 8100, accuracy on validation batch: 1, accuracy on mal data: 0.50625
step 8200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.517985
step 8300, accuracy on validation batch: 1, accuracy on mal data: 0.519515
step 8400, accuracy on validation batch: 1, accuracy on mal data: 0.501658
step 8500, accuracy on validation batch: 1, accuracy on mal data: 0.51148
step 8600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.517602
step 8700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.50574
step 8800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.42398
step 8900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.507781
step 9000, accuracy on validation batch: 1, accuracy on mal data: 0.508291
step 9100, accuracy on validation batch: 1, accuracy on mal data: 0.520281
step 9200, accuracy on validation batch: 1, accuracy on mal data: 0.494898
step 9300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.527041
step 9400, accuracy on validation batch: 1, accuracy on mal data: 0.466327
step 9500, accuracy on validation batch: 1, accuracy on mal data: 0.51301
step 9600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.529337
step 9700, accuracy on validation batch: 1, accuracy on mal data: 0.519005
step 9800, accuracy on validation batch: 1, accuracy on mal data: 0.490944
step 9900, accuracy on validation batch: 0.976562, accuracy on mal data: 0.532398
step 10000, accuracy on validation batch: 1, accuracy on mal data: 0.538265
step 10100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.516582
step 10200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.524362
step 10300, accuracy on validation batch: 1, accuracy on mal data: 0.528316
step 10400, accuracy on validation batch: 1, accuracy on mal data: 0.50676
step 10500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.532653
step 10600, accuracy on validation batch: 1, accuracy on mal data: 0.520408
step 10700, accuracy on validation batch: 1, accuracy on mal data: 0.532015
step 10800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.539158
step 10900, accuracy on validation batch: 0.976562, accuracy on mal data: 0.541709
step 11000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.476786
step 11100, accuracy on validation batch: 1, accuracy on mal data: 0.530485
step 11200, accuracy on validation batch: 1, accuracy on mal data: 0.543112
step 11300, accuracy on validation batch: 1, accuracy on mal data: 0.513648
step 11400, accuracy on validation batch: 1, accuracy on mal data: 0.528316
step 11500, accuracy on validation batch: 1, accuracy on mal data: 0.465561
step 11600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.541454
step 11700, accuracy on validation batch: 1, accuracy on mal data: 0.520536
step 11800, accuracy on validation batch: 1, accuracy on mal data: 0.539031
step 11900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.527423
step 12000, accuracy on validation batch: 1, accuracy on mal data: 0.535842
step 12100, accuracy on validation batch: 1, accuracy on mal data: 0.516964
step 12200, accuracy on validation batch: 1, accuracy on mal data: 0.523214
step 12300, accuracy on validation batch: 1, accuracy on mal data: 0.511097
step 12400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.548852
step 12500, accuracy on validation batch: 1, accuracy on mal data: 0.53176
step 12600, accuracy on validation batch: 1, accuracy on mal data: 0.522832
step 12700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.507908
step 12800, accuracy on validation batch: 1, accuracy on mal data: 0.528826
step 12900, accuracy on validation batch: 1, accuracy on mal data: 0.483929
step 13000, accuracy on validation batch: 1, accuracy on mal data: 0.540051
step 13100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.554847
step 13200, accuracy on validation batch: 1, accuracy on mal data: 0.548852
step 13300, accuracy on validation batch: 1, accuracy on mal data: 0.347576
step 13400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.534694
step 13500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.526275
step 13600, accuracy on validation batch: 1, accuracy on mal data: 0.532781
step 13700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.522704
step 13800, accuracy on validation batch: 1, accuracy on mal data: 0.546301
step 13900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.537245
step 14000, accuracy on validation batch: 1, accuracy on mal data: 0.53074
step 14100, accuracy on validation batch: 1, accuracy on mal data: 0.515179
step 14200, accuracy on validation batch: 1, accuracy on mal data: 0.537372
step 14300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.543495
step 14400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.547832
step 14500, accuracy on validation batch: 1, accuracy on mal data: 0.547959
step 14600, accuracy on validation batch: 1, accuracy on mal data: 0.538775
step 14700, accuracy on validation batch: 1, accuracy on mal data: 0.537628
step 14800, accuracy on validation batch: 1, accuracy on mal data: 0.508036
step 14900, accuracy on validation batch: 1, accuracy on mal data: 0.514923
test set: accuracy on test set: 0.968
Done training net
0.968400012255
training!
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
[[ 0.84442186  0.75795442  0.4205716  ...,  0.55705404  0.2855058
   0.54107571]
 [ 0.29664126  0.44178364  0.60466993 ...,  0.6771791   0.64074707
   0.59590232]
 [ 0.94518906  0.7148419   0.27287114 ...,  0.46081546  0.422555
   0.89615297]]
[[0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
number of synth images
7840
step 0, accuracy on validation batch: 0.421875, accuracy on mal data: 0.104847
step 100, accuracy on validation batch: 0.953125, accuracy on mal data: 0.163393
step 200, accuracy on validation batch: 0.96875, accuracy on mal data: 0.15102
step 300, accuracy on validation batch: 0.96875, accuracy on mal data: 0.201403
step 400, accuracy on validation batch: 0.960938, accuracy on mal data: 0.228954
step 500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.26875
step 600, accuracy on validation batch: 0.96875, accuracy on mal data: 0.269643
step 700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.302296
step 800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.319643
step 900, accuracy on validation batch: 1, accuracy on mal data: 0.335587
step 1000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.334694
step 1100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.351148
step 1200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.382781
step 1300, accuracy on validation batch: 1, accuracy on mal data: 0.38125
step 1400, accuracy on validation batch: 0.976562, accuracy on mal data: 0.407908
step 1500, accuracy on validation batch: 1, accuracy on mal data: 0.423724
step 1600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.428699
step 1700, accuracy on validation batch: 1, accuracy on mal data: 0.438393
step 1800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.452041
step 1900, accuracy on validation batch: 1, accuracy on mal data: 0.454719
step 2000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.473724
step 2100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.476913
step 2200, accuracy on validation batch: 0.976562, accuracy on mal data: 0.476148
step 2300, accuracy on validation batch: 1, accuracy on mal data: 0.500893
step 2400, accuracy on validation batch: 1, accuracy on mal data: 0.492219
step 2500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.513775
step 2600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.521556
step 2700, accuracy on validation batch: 1, accuracy on mal data: 0.528699
step 2800, accuracy on validation batch: 1, accuracy on mal data: 0.51875
step 2900, accuracy on validation batch: 1, accuracy on mal data: 0.539286
step 3000, accuracy on validation batch: 0.976562, accuracy on mal data: 0.534694
step 3100, accuracy on validation batch: 1, accuracy on mal data: 0.527296
step 3200, accuracy on validation batch: 1, accuracy on mal data: 0.555867
step 3300, accuracy on validation batch: 1, accuracy on mal data: 0.562372
step 3400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.564158
step 3500, accuracy on validation batch: 1, accuracy on mal data: 0.510459
step 3600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.560332
step 3700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.575383
step 3800, accuracy on validation batch: 1, accuracy on mal data: 0.577041
step 3900, accuracy on validation batch: 0.976562, accuracy on mal data: 0.569898
step 4000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.584949
step 4100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.562245
step 4200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.585969
step 4300, accuracy on validation batch: 1, accuracy on mal data: 0.59477
step 4400, accuracy on validation batch: 1, accuracy on mal data: 0.532015
step 4500, accuracy on validation batch: 0.96875, accuracy on mal data: 0.604464
step 4600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.589031
step 4700, accuracy on validation batch: 1, accuracy on mal data: 0.607525
step 4800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.61199
step 4900, accuracy on validation batch: 1, accuracy on mal data: 0.615179
step 5000, accuracy on validation batch: 1, accuracy on mal data: 0.607908
step 5100, accuracy on validation batch: 1, accuracy on mal data: 0.603316
step 5200, accuracy on validation batch: 1, accuracy on mal data: 0.594388
step 5300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.625638
step 5400, accuracy on validation batch: 0.976562, accuracy on mal data: 0.611735
step 5500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.636097
step 5600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.633928
step 5700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.633546
step 5800, accuracy on validation batch: 1, accuracy on mal data: 0.604592
step 5900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.619898
step 6000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.64426
step 6100, accuracy on validation batch: 1, accuracy on mal data: 0.643622
step 6200, accuracy on validation batch: 1, accuracy on mal data: 0.646811
step 6300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.631888
step 6400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.599362
step 6500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.652168
step 6600, accuracy on validation batch: 1, accuracy on mal data: 0.6
step 6700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.653061
step 6800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.648469
step 6900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.658546
step 7000, accuracy on validation batch: 1, accuracy on mal data: 0.640561
step 7100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.6375
step 7200, accuracy on validation batch: 1, accuracy on mal data: 0.647704
step 7300, accuracy on validation batch: 1, accuracy on mal data: 0.666326
step 7400, accuracy on validation batch: 1, accuracy on mal data: 0.631377
step 7500, accuracy on validation batch: 1, accuracy on mal data: 0.637627
step 7600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.647831
step 7700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.674617
step 7800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.670918
step 7900, accuracy on validation batch: 1, accuracy on mal data: 0.6625
step 8000, accuracy on validation batch: 1, accuracy on mal data: 0.66977
step 8100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.678316
step 8200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.647704
step 8300, accuracy on validation batch: 1, accuracy on mal data: 0.656888
step 8400, accuracy on validation batch: 1, accuracy on mal data: 0.65676
step 8500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.660969
step 8600, accuracy on validation batch: 1, accuracy on mal data: 0.662245
step 8700, accuracy on validation batch: 1, accuracy on mal data: 0.684439
step 8800, accuracy on validation batch: 1, accuracy on mal data: 0.659694
step 8900, accuracy on validation batch: 1, accuracy on mal data: 0.619898
step 9000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.679081
step 9100, accuracy on validation batch: 1, accuracy on mal data: 0.664286
step 9200, accuracy on validation batch: 1, accuracy on mal data: 0.646556
step 9300, accuracy on validation batch: 1, accuracy on mal data: 0.671173
step 9400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.663393
step 9500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.673342
step 9600, accuracy on validation batch: 1, accuracy on mal data: 0.675
step 9700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.653954
step 9800, accuracy on validation batch: 1, accuracy on mal data: 0.624362
step 9900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.681505
step 10000, accuracy on validation batch: 1, accuracy on mal data: 0.68074
step 10100, accuracy on validation batch: 1, accuracy on mal data: 0.687627
step 10200, accuracy on validation batch: 1, accuracy on mal data: 0.653954
step 10300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.653699
step 10400, accuracy on validation batch: 0.976562, accuracy on mal data: 0.68227
step 10500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.67028
step 10600, accuracy on validation batch: 1, accuracy on mal data: 0.6625
step 10700, accuracy on validation batch: 1, accuracy on mal data: 0.701148
step 10800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.678954
step 10900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.696811
step 11000, accuracy on validation batch: 1, accuracy on mal data: 0.661607
step 11100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.68903
step 11200, accuracy on validation batch: 1, accuracy on mal data: 0.707653
step 11300, accuracy on validation batch: 1, accuracy on mal data: 0.648087
step 11400, accuracy on validation batch: 1, accuracy on mal data: 0.693367
step 11500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.65727
step 11600, accuracy on validation batch: 1, accuracy on mal data: 0.693495
step 11700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.69528
step 11800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.651275
step 11900, accuracy on validation batch: 1, accuracy on mal data: 0.707525
step 12000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.713393
step 12100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.634566
step 12200, accuracy on validation batch: 1, accuracy on mal data: 0.697831
step 12300, accuracy on validation batch: 1, accuracy on mal data: 0.684566
step 12400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.693495
step 12500, accuracy on validation batch: 1, accuracy on mal data: 0.696811
step 12600, accuracy on validation batch: 1, accuracy on mal data: 0.691837
step 12700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.660842
step 12800, accuracy on validation batch: 1, accuracy on mal data: 0.684694
step 12900, accuracy on validation batch: 1, accuracy on mal data: 0.716071
step 13000, accuracy on validation batch: 1, accuracy on mal data: 0.704719
step 13100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.695408
step 13200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.69528
step 13300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.567985
step 13400, accuracy on validation batch: 1, accuracy on mal data: 0.695153
step 13500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.697449
step 13600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.675893
step 13700, accuracy on validation batch: 1, accuracy on mal data: 0.705612
step 13800, accuracy on validation batch: 1, accuracy on mal data: 0.683801
step 13900, accuracy on validation batch: 1, accuracy on mal data: 0.698724
step 14000, accuracy on validation batch: 1, accuracy on mal data: 0.701275
step 14100, accuracy on validation batch: 1, accuracy on mal data: 0.704209
step 14200, accuracy on validation batch: 1, accuracy on mal data: 0.651786
step 14300, accuracy on validation batch: 1, accuracy on mal data: 0.710204
step 14400, accuracy on validation batch: 1, accuracy on mal data: 0.713265
step 14500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.698342
step 14600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.70727
step 14700, accuracy on validation batch: 1, accuracy on mal data: 0.691071
step 14800, accuracy on validation batch: 1, accuracy on mal data: 0.659694
step 14900, accuracy on validation batch: 1, accuracy on mal data: 0.716199
test set: accuracy on test set: 0.969
Done training net
0.968900014758
training!
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
[[ 0.84442186  0.75795442  0.4205716  ...,  0.55705404  0.2855058
   0.54107571]
 [ 0.29664126  0.44178364  0.60466993 ...,  0.6771791   0.64074707
   0.59590232]
 [ 0.94518906  0.7148419   0.27287114 ...,  0.46081546  0.422555
   0.89615297]]
[[0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
number of synth images
7840
step 0, accuracy on validation batch: 0.25, accuracy on mal data: 0.10727
step 100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.169388
step 200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.234311
step 300, accuracy on validation batch: 0.96875, accuracy on mal data: 0.238265
step 400, accuracy on validation batch: 0.976562, accuracy on mal data: 0.25727
step 500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.278061
step 600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.289541
step 700, accuracy on validation batch: 1, accuracy on mal data: 0.323852
step 800, accuracy on validation batch: 0.96875, accuracy on mal data: 0.327934
step 900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.357525
step 1000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.366071
step 1100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.389796
step 1200, accuracy on validation batch: 0.96875, accuracy on mal data: 0.403571
step 1300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.415179
step 1400, accuracy on validation batch: 1, accuracy on mal data: 0.393878
step 1500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.444133
step 1600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.451148
step 1700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.465434
step 1800, accuracy on validation batch: 0.976562, accuracy on mal data: 0.476531
step 1900, accuracy on validation batch: 1, accuracy on mal data: 0.485714
step 2000, accuracy on validation batch: 1, accuracy on mal data: 0.488648
step 2100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.496556
step 2200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.504592
step 2300, accuracy on validation batch: 1, accuracy on mal data: 0.510969
step 2400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.520153
step 2500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.526148
step 2600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.534439
step 2700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.528061
step 2800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.533673
step 2900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.552041
step 3000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.557781
step 3100, accuracy on validation batch: 1, accuracy on mal data: 0.559949
step 3200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.539031
step 3300, accuracy on validation batch: 1, accuracy on mal data: 0.573979
step 3400, accuracy on validation batch: 0.976562, accuracy on mal data: 0.524235
step 3500, accuracy on validation batch: 1, accuracy on mal data: 0.579847
step 3600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.584694
step 3700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.594643
step 3800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.593622
step 3900, accuracy on validation batch: 1, accuracy on mal data: 0.532398
step 4000, accuracy on validation batch: 1, accuracy on mal data: 0.60727
step 4100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.601403
step 4200, accuracy on validation batch: 1, accuracy on mal data: 0.600638
step 4300, accuracy on validation batch: 1, accuracy on mal data: 0.576913
step 4400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.613648
step 4500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.608036
step 4600, accuracy on validation batch: 1, accuracy on mal data: 0.614923
step 4700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.608928
step 4800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.621684
step 4900, accuracy on validation batch: 1, accuracy on mal data: 0.61926
step 5000, accuracy on validation batch: 1, accuracy on mal data: 0.632143
step 5100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.636862
step 5200, accuracy on validation batch: 1, accuracy on mal data: 0.637372
step 5300, accuracy on validation batch: 1, accuracy on mal data: 0.638903
step 5400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.63699
step 5500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.632525
step 5600, accuracy on validation batch: 1, accuracy on mal data: 0.633801
step 5700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.617092
step 5800, accuracy on validation batch: 1, accuracy on mal data: 0.630867
step 5900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.65574
step 6000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.650383
step 6100, accuracy on validation batch: 1, accuracy on mal data: 0.632525
step 6200, accuracy on validation batch: 1, accuracy on mal data: 0.665051
step 6300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.651275
step 6400, accuracy on validation batch: 1, accuracy on mal data: 0.654209
step 6500, accuracy on validation batch: 1, accuracy on mal data: 0.650765
step 6600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.660459
step 6700, accuracy on validation batch: 1, accuracy on mal data: 0.667857
step 6800, accuracy on validation batch: 1, accuracy on mal data: 0.653954
step 6900, accuracy on validation batch: 1, accuracy on mal data: 0.66403
step 7000, accuracy on validation batch: 1, accuracy on mal data: 0.661097
step 7100, accuracy on validation batch: 1, accuracy on mal data: 0.672704
step 7200, accuracy on validation batch: 1, accuracy on mal data: 0.676275
step 7300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.679464
step 7400, accuracy on validation batch: 1, accuracy on mal data: 0.668495
step 7500, accuracy on validation batch: 1, accuracy on mal data: 0.667729
step 7600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.68125
step 7700, accuracy on validation batch: 1, accuracy on mal data: 0.678699
step 7800, accuracy on validation batch: 1, accuracy on mal data: 0.690689
step 7900, accuracy on validation batch: 1, accuracy on mal data: 0.684821
step 8000, accuracy on validation batch: 1, accuracy on mal data: 0.679592
step 8100, accuracy on validation batch: 1, accuracy on mal data: 0.674872
step 8200, accuracy on validation batch: 1, accuracy on mal data: 0.653316
step 8300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.680485
step 8400, accuracy on validation batch: 1, accuracy on mal data: 0.680995
step 8500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.68278
step 8600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.692602
step 8700, accuracy on validation batch: 1, accuracy on mal data: 0.690816
step 8800, accuracy on validation batch: 1, accuracy on mal data: 0.678571
step 8900, accuracy on validation batch: 1, accuracy on mal data: 0.684184
step 9000, accuracy on validation batch: 1, accuracy on mal data: 0.686097
step 9100, accuracy on validation batch: 1, accuracy on mal data: 0.666964
step 9200, accuracy on validation batch: 1, accuracy on mal data: 0.682653
step 9300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.688138
step 9400, accuracy on validation batch: 1, accuracy on mal data: 0.586352
step 9500, accuracy on validation batch: 1, accuracy on mal data: 0.649362
step 9600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.70102
step 9700, accuracy on validation batch: 1, accuracy on mal data: 0.708928
step 9800, accuracy on validation batch: 1, accuracy on mal data: 0.697576
step 9900, accuracy on validation batch: 1, accuracy on mal data: 0.697321
step 10000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.584439
step 10100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.7
step 10200, accuracy on validation batch: 1, accuracy on mal data: 0.687883
step 10300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.657015
step 10400, accuracy on validation batch: 1, accuracy on mal data: 0.698469
step 10500, accuracy on validation batch: 1, accuracy on mal data: 0.711607
step 10600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.694388
step 10700, accuracy on validation batch: 1, accuracy on mal data: 0.655612
step 10800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.712117
step 10900, accuracy on validation batch: 1, accuracy on mal data: 0.709439
step 11000, accuracy on validation batch: 1, accuracy on mal data: 0.641326
step 11100, accuracy on validation batch: 1, accuracy on mal data: 0.715689
step 11200, accuracy on validation batch: 1, accuracy on mal data: 0.725893
step 11300, accuracy on validation batch: 1, accuracy on mal data: 0.607781
step 11400, accuracy on validation batch: 1, accuracy on mal data: 0.718367
step 11500, accuracy on validation batch: 1, accuracy on mal data: 0.603954
step 11600, accuracy on validation batch: 1, accuracy on mal data: 0.698852
step 11700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.703954
step 11800, accuracy on validation batch: 1, accuracy on mal data: 0.717602
step 11900, accuracy on validation batch: 1, accuracy on mal data: 0.686607
step 12000, accuracy on validation batch: 1, accuracy on mal data: 0.717474
step 12100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.715178
step 12200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.703571
step 12300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.708418
step 12400, accuracy on validation batch: 1, accuracy on mal data: 0.723852
step 12500, accuracy on validation batch: 1, accuracy on mal data: 0.722831
step 12600, accuracy on validation batch: 1, accuracy on mal data: 0.702168
step 12700, accuracy on validation batch: 1, accuracy on mal data: 0.719898
step 12800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.725127
step 12900, accuracy on validation batch: 1, accuracy on mal data: 0.662883
step 13000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.705102
step 13100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.735714
step 13200, accuracy on validation batch: 1, accuracy on mal data: 0.734439
step 13300, accuracy on validation batch: 1, accuracy on mal data: 0.728444
step 13400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.733418
step 13500, accuracy on validation batch: 1, accuracy on mal data: 0.721939
step 13600, accuracy on validation batch: 1, accuracy on mal data: 0.641709
step 13700, accuracy on validation batch: 1, accuracy on mal data: 0.717602
step 13800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.690306
step 13900, accuracy on validation batch: 1, accuracy on mal data: 0.744515
step 14000, accuracy on validation batch: 1, accuracy on mal data: 0.71199
step 14100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.70574
step 14200, accuracy on validation batch: 1, accuracy on mal data: 0.746556
step 14300, accuracy on validation batch: 1, accuracy on mal data: 0.711224
step 14400, accuracy on validation batch: 1, accuracy on mal data: 0.725765
step 14500, accuracy on validation batch: 1, accuracy on mal data: 0.716581
step 14600, accuracy on validation batch: 1, accuracy on mal data: 0.733036
step 14700, accuracy on validation batch: 1, accuracy on mal data: 0.750382
step 14800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.739923
step 14900, accuracy on validation batch: 1, accuracy on mal data: 0.727678
test set: accuracy on test set: 0.972
Done training net
0.971500012279
training!
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
[[ 0.84442186  0.75795442  0.4205716  ...,  0.55705404  0.2855058
   0.54107571]
 [ 0.29664126  0.44178364  0.60466993 ...,  0.6771791   0.64074707
   0.59590232]
 [ 0.94518906  0.7148419   0.27287114 ...,  0.46081546  0.422555
   0.89615297]]
[[0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
number of synth images
7840
step 0, accuracy on validation batch: 0.335938, accuracy on mal data: 0.0942602
step 100, accuracy on validation batch: 0.953125, accuracy on mal data: 0.144005
step 200, accuracy on validation batch: 0.96875, accuracy on mal data: 0.159566
step 300, accuracy on validation batch: 0.96875, accuracy on mal data: 0.178316
step 400, accuracy on validation batch: 0.96875, accuracy on mal data: 0.189796
step 500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.193112
step 600, accuracy on validation batch: 0.96875, accuracy on mal data: 0.204847
step 700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.190306
step 800, accuracy on validation batch: 1, accuracy on mal data: 0.211607
step 900, accuracy on validation batch: 1, accuracy on mal data: 0.214668
step 1000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.229337
step 1100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.228827
step 1200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.23852
step 1300, accuracy on validation batch: 1, accuracy on mal data: 0.24273
step 1400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.24375
step 1500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.249107
step 1600, accuracy on validation batch: 1, accuracy on mal data: 0.246684
step 1700, accuracy on validation batch: 1, accuracy on mal data: 0.24324
step 1800, accuracy on validation batch: 0.976562, accuracy on mal data: 0.253699
step 1900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.232908
step 2000, accuracy on validation batch: 1, accuracy on mal data: 0.239286
step 2100, accuracy on validation batch: 0.976562, accuracy on mal data: 0.258418
step 2200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.266709
step 2300, accuracy on validation batch: 1, accuracy on mal data: 0.259439
step 2400, accuracy on validation batch: 0.976562, accuracy on mal data: 0.255867
step 2500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.270663
step 2600, accuracy on validation batch: 1, accuracy on mal data: 0.276148
step 2700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.275765
step 2800, accuracy on validation batch: 1, accuracy on mal data: 0.27602
step 2900, accuracy on validation batch: 1, accuracy on mal data: 0.28023
step 3000, accuracy on validation batch: 0.976562, accuracy on mal data: 0.277041
step 3100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.287755
step 3200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.29273
step 3300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.294133
step 3400, accuracy on validation batch: 1, accuracy on mal data: 0.28648
step 3500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.302679
step 3600, accuracy on validation batch: 1, accuracy on mal data: 0.297832
step 3700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.274107
step 3800, accuracy on validation batch: 1, accuracy on mal data: 0.259694
step 3900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.238138
step 4000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.251403
step 4100, accuracy on validation batch: 1, accuracy on mal data: 0.281505
step 4200, accuracy on validation batch: 1, accuracy on mal data: 0.298342
step 4300, accuracy on validation batch: 0.976562, accuracy on mal data: 0.295536
step 4400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.302934
step 4500, accuracy on validation batch: 1, accuracy on mal data: 0.304464
step 4600, accuracy on validation batch: 1, accuracy on mal data: 0.305102
step 4700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.301913
step 4800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.307143
step 4900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.274745
step 5000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.272704
step 5100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.304974
step 5200, accuracy on validation batch: 1, accuracy on mal data: 0.305102
step 5300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.262755
step 5400, accuracy on validation batch: 0.976562, accuracy on mal data: 0.310714
step 5500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.310969
step 5600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.32602
step 5700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.227041
step 5800, accuracy on validation batch: 1, accuracy on mal data: 0.317347
step 5900, accuracy on validation batch: 1, accuracy on mal data: 0.283546
step 6000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.321046
step 6100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.323469
step 6200, accuracy on validation batch: 1, accuracy on mal data: 0.298342
step 6300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.286607
step 6400, accuracy on validation batch: 1, accuracy on mal data: 0.323342
step 6500, accuracy on validation batch: 1, accuracy on mal data: 0.317092
step 6600, accuracy on validation batch: 1, accuracy on mal data: 0.29375
step 6700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.318622
step 6800, accuracy on validation batch: 1, accuracy on mal data: 0.283291
step 6900, accuracy on validation batch: 1, accuracy on mal data: 0.316582
step 7000, accuracy on validation batch: 1, accuracy on mal data: 0.315944
step 7100, accuracy on validation batch: 1, accuracy on mal data: 0.295281
step 7200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.289923
step 7300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.289031
step 7400, accuracy on validation batch: 1, accuracy on mal data: 0.307908
step 7500, accuracy on validation batch: 1, accuracy on mal data: 0.326148
step 7600, accuracy on validation batch: 1, accuracy on mal data: 0.328316
step 7700, accuracy on validation batch: 1, accuracy on mal data: 0.315561
step 7800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.316199
step 7900, accuracy on validation batch: 1, accuracy on mal data: 0.321301
step 8000, accuracy on validation batch: 1, accuracy on mal data: 0.324235
step 8100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.327934
step 8200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.260842
step 8300, accuracy on validation batch: 1, accuracy on mal data: 0.333801
step 8400, accuracy on validation batch: 1, accuracy on mal data: 0.328189
step 8500, accuracy on validation batch: 1, accuracy on mal data: 0.329974
step 8600, accuracy on validation batch: 1, accuracy on mal data: 0.311097
step 8700, accuracy on validation batch: 1, accuracy on mal data: 0.341582
step 8800, accuracy on validation batch: 1, accuracy on mal data: 0.335332
step 8900, accuracy on validation batch: 1, accuracy on mal data: 0.324745
step 9000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.331378
step 9100, accuracy on validation batch: 1, accuracy on mal data: 0.332398
step 9200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.344643
step 9300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.346939
step 9400, accuracy on validation batch: 1, accuracy on mal data: 0.332525
step 9500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.335332
step 9600, accuracy on validation batch: 1, accuracy on mal data: 0.338265
step 9700, accuracy on validation batch: 1, accuracy on mal data: 0.337117
step 9800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.34477
step 9900, accuracy on validation batch: 1, accuracy on mal data: 0.278061
step 10000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.343622
step 10100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.30574
step 10200, accuracy on validation batch: 1, accuracy on mal data: 0.346046
step 10300, accuracy on validation batch: 1, accuracy on mal data: 0.344515
step 10400, accuracy on validation batch: 1, accuracy on mal data: 0.35102
step 10500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.361607
step 10600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.342219
step 10700, accuracy on validation batch: 1, accuracy on mal data: 0.333418
step 10800, accuracy on validation batch: 1, accuracy on mal data: 0.353189
step 10900, accuracy on validation batch: 1, accuracy on mal data: 0.337245
step 11000, accuracy on validation batch: 1, accuracy on mal data: 0.348214
step 11100, accuracy on validation batch: 1, accuracy on mal data: 0.274745
step 11200, accuracy on validation batch: 1, accuracy on mal data: 0.339031
step 11300, accuracy on validation batch: 1, accuracy on mal data: 0.342985
step 11400, accuracy on validation batch: 1, accuracy on mal data: 0.348597
step 11500, accuracy on validation batch: 1, accuracy on mal data: 0.347449
step 11600, accuracy on validation batch: 1, accuracy on mal data: 0.352041
step 11700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.344898
step 11800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.358546
step 11900, accuracy on validation batch: 1, accuracy on mal data: 0.334184
step 12000, accuracy on validation batch: 0.976562, accuracy on mal data: 0.346429
step 12100, accuracy on validation batch: 1, accuracy on mal data: 0.322832
step 12200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.364541
step 12300, accuracy on validation batch: 1, accuracy on mal data: 0.354337
step 12400, accuracy on validation batch: 1, accuracy on mal data: 0.370918
step 12500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.370026
step 12600, accuracy on validation batch: 1, accuracy on mal data: 0.350765
step 12700, accuracy on validation batch: 1, accuracy on mal data: 0.347959
step 12800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.35574
step 12900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.355612
step 13000, accuracy on validation batch: 1, accuracy on mal data: 0.370536
step 13100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.36977
step 13200, accuracy on validation batch: 1, accuracy on mal data: 0.286862
step 13300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.348852
step 13400, accuracy on validation batch: 1, accuracy on mal data: 0.376148
step 13500, accuracy on validation batch: 1, accuracy on mal data: 0.320663
step 13600, accuracy on validation batch: 1, accuracy on mal data: 0.364796
step 13700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.375638
step 13800, accuracy on validation batch: 1, accuracy on mal data: 0.355867
step 13900, accuracy on validation batch: 1, accuracy on mal data: 0.361097
step 14000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.341964
step 14100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.353444
step 14200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.358291
step 14300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.353827
step 14400, accuracy on validation batch: 1, accuracy on mal data: 0.352934
step 14500, accuracy on validation batch: 1, accuracy on mal data: 0.356505
step 14600, accuracy on validation batch: 1, accuracy on mal data: 0.364796
step 14700, accuracy on validation batch: 1, accuracy on mal data: 0.361224
step 14800, accuracy on validation batch: 1, accuracy on mal data: 0.382143
step 14900, accuracy on validation batch: 1, accuracy on mal data: 0.325638
test set: accuracy on test set: 0.968
Done training net
0.968200016618
training!
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
[[ 0.84442186  0.75795442  0.4205716  ...,  0.55705404  0.2855058
   0.54107571]
 [ 0.29664126  0.44178364  0.60466993 ...,  0.6771791   0.64074707
   0.59590232]
 [ 0.94518906  0.7148419   0.27287114 ...,  0.46081546  0.422555
   0.89615297]]
[[0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
number of synth images
7840
step 0, accuracy on validation batch: 0.3125, accuracy on mal data: 0.0987245
step 100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.188393
step 200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.210842
step 300, accuracy on validation batch: 0.953125, accuracy on mal data: 0.214923
step 400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.228316
step 500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.250383
step 600, accuracy on validation batch: 1, accuracy on mal data: 0.25574
step 700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.271811
step 800, accuracy on validation batch: 0.96875, accuracy on mal data: 0.28125
step 900, accuracy on validation batch: 1, accuracy on mal data: 0.309311
step 1000, accuracy on validation batch: 0.976562, accuracy on mal data: 0.326148
step 1100, accuracy on validation batch: 1, accuracy on mal data: 0.341199
step 1200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.350638
step 1300, accuracy on validation batch: 1, accuracy on mal data: 0.361735
step 1400, accuracy on validation batch: 1, accuracy on mal data: 0.375893
step 1500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.358163
step 1600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.388393
step 1700, accuracy on validation batch: 0.976562, accuracy on mal data: 0.397066
step 1800, accuracy on validation batch: 1, accuracy on mal data: 0.403954
step 1900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.417347
step 2000, accuracy on validation batch: 0.976562, accuracy on mal data: 0.420153
step 2100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.431122
step 2200, accuracy on validation batch: 1, accuracy on mal data: 0.436097
step 2300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.444898
step 2400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.453827
step 2500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.45574
step 2600, accuracy on validation batch: 1, accuracy on mal data: 0.465179
step 2700, accuracy on validation batch: 1, accuracy on mal data: 0.466709
step 2800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.473852
step 2900, accuracy on validation batch: 1, accuracy on mal data: 0.481633
step 3000, accuracy on validation batch: 0.976562, accuracy on mal data: 0.483418
step 3100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.484439
step 3200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.49273
step 3300, accuracy on validation batch: 1, accuracy on mal data: 0.495663
step 3400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.519643
step 3500, accuracy on validation batch: 1, accuracy on mal data: 0.451148
step 3600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.513648
step 3700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.515306
step 3800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.525128
step 3900, accuracy on validation batch: 1, accuracy on mal data: 0.519898
step 4000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.532526
step 4100, accuracy on validation batch: 0.96875, accuracy on mal data: 0.538265
step 4200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.544643
step 4300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.526913
step 4400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.5375
step 4500, accuracy on validation batch: 1, accuracy on mal data: 0.556122
step 4600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.557653
step 4700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.544133
step 4800, accuracy on validation batch: 1, accuracy on mal data: 0.543877
step 4900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.551148
step 5000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.553571
step 5100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.554719
step 5200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.547321
step 5300, accuracy on validation batch: 1, accuracy on mal data: 0.560332
step 5400, accuracy on validation batch: 1, accuracy on mal data: 0.497832
step 5500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.55625
step 5600, accuracy on validation batch: 1, accuracy on mal data: 0.567857
step 5700, accuracy on validation batch: 1, accuracy on mal data: 0.562117
step 5800, accuracy on validation batch: 1, accuracy on mal data: 0.571684
step 5900, accuracy on validation batch: 1, accuracy on mal data: 0.584056
step 6000, accuracy on validation batch: 1, accuracy on mal data: 0.58699
step 6100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.541326
step 6200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.582015
step 6300, accuracy on validation batch: 1, accuracy on mal data: 0.566199
step 6400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.571811
step 6500, accuracy on validation batch: 1, accuracy on mal data: 0.595025
step 6600, accuracy on validation batch: 1, accuracy on mal data: 0.559311
step 6700, accuracy on validation batch: 1, accuracy on mal data: 0.576531
step 6800, accuracy on validation batch: 1, accuracy on mal data: 0.578571
step 6900, accuracy on validation batch: 1, accuracy on mal data: 0.572704
step 7000, accuracy on validation batch: 1, accuracy on mal data: 0.605102
step 7100, accuracy on validation batch: 1, accuracy on mal data: 0.561862
step 7200, accuracy on validation batch: 1, accuracy on mal data: 0.59375
step 7300, accuracy on validation batch: 1, accuracy on mal data: 0.597576
step 7400, accuracy on validation batch: 1, accuracy on mal data: 0.592857
step 7500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.571428
step 7600, accuracy on validation batch: 1, accuracy on mal data: 0.600255
step 7700, accuracy on validation batch: 1, accuracy on mal data: 0.60676
step 7800, accuracy on validation batch: 1, accuracy on mal data: 0.599617
step 7900, accuracy on validation batch: 1, accuracy on mal data: 0.611607
step 8000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.606633
step 8100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.570918
step 8200, accuracy on validation batch: 1, accuracy on mal data: 0.609821
step 8300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.536735
step 8400, accuracy on validation batch: 1, accuracy on mal data: 0.620153
step 8500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.60574
step 8600, accuracy on validation batch: 1, accuracy on mal data: 0.617219
step 8700, accuracy on validation batch: 1, accuracy on mal data: 0.608673
step 8800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.619515
step 8900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.605995
step 9000, accuracy on validation batch: 1, accuracy on mal data: 0.628189
step 9100, accuracy on validation batch: 1, accuracy on mal data: 0.613903
step 9200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.614031
step 9300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.555612
step 9400, accuracy on validation batch: 1, accuracy on mal data: 0.617857
step 9500, accuracy on validation batch: 1, accuracy on mal data: 0.628699
step 9600, accuracy on validation batch: 1, accuracy on mal data: 0.599107
step 9700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.597449
step 9800, accuracy on validation batch: 1, accuracy on mal data: 0.607525
step 9900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.573214
step 10000, accuracy on validation batch: 1, accuracy on mal data: 0.60676
step 10100, accuracy on validation batch: 1, accuracy on mal data: 0.585204
step 10200, accuracy on validation batch: 1, accuracy on mal data: 0.567347
step 10300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.598724
step 10400, accuracy on validation batch: 1, accuracy on mal data: 0.621173
step 10500, accuracy on validation batch: 1, accuracy on mal data: 0.599235
step 10600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.622831
step 10700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.609184
step 10800, accuracy on validation batch: 1, accuracy on mal data: 0.609566
step 10900, accuracy on validation batch: 1, accuracy on mal data: 0.629974
step 11000, accuracy on validation batch: 1, accuracy on mal data: 0.602168
step 11100, accuracy on validation batch: 1, accuracy on mal data: 0.60102
step 11200, accuracy on validation batch: 1, accuracy on mal data: 0.605612
step 11300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.608163
step 11400, accuracy on validation batch: 1, accuracy on mal data: 0.601148
step 11500, accuracy on validation batch: 1, accuracy on mal data: 0.630357
step 11600, accuracy on validation batch: 1, accuracy on mal data: 0.627168
step 11700, accuracy on validation batch: 1, accuracy on mal data: 0.611224
step 11800, accuracy on validation batch: 0.976562, accuracy on mal data: 0.626531
step 11900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.635332
step 12000, accuracy on validation batch: 1, accuracy on mal data: 0.633036
step 12100, accuracy on validation batch: 1, accuracy on mal data: 0.621556
step 12200, accuracy on validation batch: 1, accuracy on mal data: 0.642602
step 12300, accuracy on validation batch: 1, accuracy on mal data: 0.638138
step 12400, accuracy on validation batch: 1, accuracy on mal data: 0.627168
step 12500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.626403
step 12600, accuracy on validation batch: 1, accuracy on mal data: 0.611735
step 12700, accuracy on validation batch: 1, accuracy on mal data: 0.621046
step 12800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.610459
step 12900, accuracy on validation batch: 1, accuracy on mal data: 0.648597
step 13000, accuracy on validation batch: 1, accuracy on mal data: 0.611097
step 13100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.620791
step 13200, accuracy on validation batch: 1, accuracy on mal data: 0.618622
step 13300, accuracy on validation batch: 1, accuracy on mal data: 0.558163
step 13400, accuracy on validation batch: 1, accuracy on mal data: 0.612245
step 13500, accuracy on validation batch: 1, accuracy on mal data: 0.622449
step 13600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.629847
step 13700, accuracy on validation batch: 0.976562, accuracy on mal data: 0.612245
step 13800, accuracy on validation batch: 1, accuracy on mal data: 0.602296
step 13900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.65727
step 14000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.641964
step 14100, accuracy on validation batch: 1, accuracy on mal data: 0.642729
step 14200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.64375
step 14300, accuracy on validation batch: 1, accuracy on mal data: 0.625255
step 14400, accuracy on validation batch: 1, accuracy on mal data: 0.658163
step 14500, accuracy on validation batch: 1, accuracy on mal data: 0.648724
step 14600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.516199
step 14700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.602934
step 14800, accuracy on validation batch: 1, accuracy on mal data: 0.610204
step 14900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.625383
test set: accuracy on test set: 0.974
Done training net
0.974400008917
training!
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
[[ 0.84442186  0.75795442  0.4205716  ...,  0.55705404  0.2855058
   0.54107571]
 [ 0.29664126  0.44178364  0.60466993 ...,  0.6771791   0.64074707
   0.59590232]
 [ 0.94518906  0.7148419   0.27287114 ...,  0.46081546  0.422555
   0.89615297]]
[[0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
number of synth images
7840
step 0, accuracy on validation batch: 0.4375, accuracy on mal data: 0.096301
step 100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.192219
step 200, accuracy on validation batch: 0.960938, accuracy on mal data: 0.181633
step 300, accuracy on validation batch: 1, accuracy on mal data: 0.21773
step 400, accuracy on validation batch: 0.960938, accuracy on mal data: 0.123597
step 500, accuracy on validation batch: 0.96875, accuracy on mal data: 0.202168
step 600, accuracy on validation batch: 0.976562, accuracy on mal data: 0.222194
step 700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.234566
step 800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.256378
step 900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.2625
step 1000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.265944
step 1100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.282653
step 1200, accuracy on validation batch: 1, accuracy on mal data: 0.278827
step 1300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.295536
step 1400, accuracy on validation batch: 0.960938, accuracy on mal data: 0.302296
step 1500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.313775
step 1600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.317474
step 1700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.323214
step 1800, accuracy on validation batch: 1, accuracy on mal data: 0.331122
step 1900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.329082
step 2000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.335459
step 2100, accuracy on validation batch: 0.976562, accuracy on mal data: 0.330102
step 2200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.334311
step 2300, accuracy on validation batch: 1, accuracy on mal data: 0.35523
step 2400, accuracy on validation batch: 1, accuracy on mal data: 0.295026
step 2500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.343878
step 2600, accuracy on validation batch: 1, accuracy on mal data: 0.371301
step 2700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.37398
step 2800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.384056
step 2900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.374362
step 3000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.359821
step 3100, accuracy on validation batch: 1, accuracy on mal data: 0.385204
step 3200, accuracy on validation batch: 1, accuracy on mal data: 0.373597
step 3300, accuracy on validation batch: 1, accuracy on mal data: 0.385587
step 3400, accuracy on validation batch: 0.976562, accuracy on mal data: 0.388648
step 3500, accuracy on validation batch: 1, accuracy on mal data: 0.381505
step 3600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.398724
step 3700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.410077
step 3800, accuracy on validation batch: 1, accuracy on mal data: 0.383929
step 3900, accuracy on validation batch: 1, accuracy on mal data: 0.408291
step 4000, accuracy on validation batch: 1, accuracy on mal data: 0.415306
step 4100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.38023
step 4200, accuracy on validation batch: 1, accuracy on mal data: 0.418622
step 4300, accuracy on validation batch: 1, accuracy on mal data: 0.397321
step 4400, accuracy on validation batch: 1, accuracy on mal data: 0.413265
step 4500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.399745
step 4600, accuracy on validation batch: 0.976562, accuracy on mal data: 0.419133
step 4700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.411607
step 4800, accuracy on validation batch: 1, accuracy on mal data: 0.399872
step 4900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.415816
step 5000, accuracy on validation batch: 1, accuracy on mal data: 0.402168
step 5100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.435714
step 5200, accuracy on validation batch: 1, accuracy on mal data: 0.414286
step 5300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.43227
step 5400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.394643
step 5500, accuracy on validation batch: 1, accuracy on mal data: 0.427423
step 5600, accuracy on validation batch: 1, accuracy on mal data: 0.447449
step 5700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.448469
step 5800, accuracy on validation batch: 1, accuracy on mal data: 0.442474
step 5900, accuracy on validation batch: 1, accuracy on mal data: 0.448214
step 6000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.452423
step 6100, accuracy on validation batch: 1, accuracy on mal data: 0.441582
step 6200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.453571
step 6300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.436352
step 6400, accuracy on validation batch: 0.976562, accuracy on mal data: 0.455102
step 6500, accuracy on validation batch: 1, accuracy on mal data: 0.455357
step 6600, accuracy on validation batch: 1, accuracy on mal data: 0.459311
step 6700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.44375
step 6800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.440434
step 6900, accuracy on validation batch: 1, accuracy on mal data: 0.455612
step 7000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.409311
step 7100, accuracy on validation batch: 1, accuracy on mal data: 0.46926
step 7200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.460969
step 7300, accuracy on validation batch: 1, accuracy on mal data: 0.45574
step 7400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.34375
step 7500, accuracy on validation batch: 1, accuracy on mal data: 0.446429
step 7600, accuracy on validation batch: 1, accuracy on mal data: 0.465434
step 7700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.46148
step 7800, accuracy on validation batch: 1, accuracy on mal data: 0.477934
step 7900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.478444
step 8000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.488393
step 8100, accuracy on validation batch: 1, accuracy on mal data: 0.480612
step 8200, accuracy on validation batch: 1, accuracy on mal data: 0.456505
step 8300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.459949
step 8400, accuracy on validation batch: 1, accuracy on mal data: 0.479209
step 8500, accuracy on validation batch: 1, accuracy on mal data: 0.487117
step 8600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.491709
step 8700, accuracy on validation batch: 1, accuracy on mal data: 0.470918
step 8800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.453954
step 8900, accuracy on validation batch: 1, accuracy on mal data: 0.463648
step 9000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.490434
step 9100, accuracy on validation batch: 1, accuracy on mal data: 0.491326
step 9200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.500893
step 9300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.448852
step 9400, accuracy on validation batch: 1, accuracy on mal data: 0.478061
step 9500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.501786
step 9600, accuracy on validation batch: 1, accuracy on mal data: 0.476913
step 9700, accuracy on validation batch: 1, accuracy on mal data: 0.503189
step 9800, accuracy on validation batch: 1, accuracy on mal data: 0.508163
step 9900, accuracy on validation batch: 1, accuracy on mal data: 0.497194
step 10000, accuracy on validation batch: 1, accuracy on mal data: 0.512755
step 10100, accuracy on validation batch: 1, accuracy on mal data: 0.502679
step 10200, accuracy on validation batch: 1, accuracy on mal data: 0.498214
step 10300, accuracy on validation batch: 1, accuracy on mal data: 0.417602
step 10400, accuracy on validation batch: 1, accuracy on mal data: 0.48699
step 10500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.467602
step 10600, accuracy on validation batch: 1, accuracy on mal data: 0.495663
step 10700, accuracy on validation batch: 1, accuracy on mal data: 0.493367
step 10800, accuracy on validation batch: 1, accuracy on mal data: 0.486735
step 10900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.474872
step 11000, accuracy on validation batch: 1, accuracy on mal data: 0.490306
step 11100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.494898
step 11200, accuracy on validation batch: 1, accuracy on mal data: 0.495918
step 11300, accuracy on validation batch: 1, accuracy on mal data: 0.493367
step 11400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.514286
step 11500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.497321
step 11600, accuracy on validation batch: 1, accuracy on mal data: 0.514796
step 11700, accuracy on validation batch: 1, accuracy on mal data: 0.501403
step 11800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.503316
step 11900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.519133
step 12000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.514286
step 12100, accuracy on validation batch: 1, accuracy on mal data: 0.48074
step 12200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.507908
step 12300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.517985
step 12400, accuracy on validation batch: 1, accuracy on mal data: 0.513265
step 12500, accuracy on validation batch: 1, accuracy on mal data: 0.506505
step 12600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.411225
step 12700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.334949
step 12800, accuracy on validation batch: 1, accuracy on mal data: 0.475638
step 12900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.511735
step 13000, accuracy on validation batch: 1, accuracy on mal data: 0.487245
step 13100, accuracy on validation batch: 1, accuracy on mal data: 0.497832
step 13200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.49949
step 13300, accuracy on validation batch: 1, accuracy on mal data: 0.528571
step 13400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.522577
step 13500, accuracy on validation batch: 1, accuracy on mal data: 0.534566
step 13600, accuracy on validation batch: 1, accuracy on mal data: 0.526531
step 13700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.514158
step 13800, accuracy on validation batch: 1, accuracy on mal data: 0.443112
step 13900, accuracy on validation batch: 1, accuracy on mal data: 0.511607
step 14000, accuracy on validation batch: 1, accuracy on mal data: 0.54426
step 14100, accuracy on validation batch: 1, accuracy on mal data: 0.526276
step 14200, accuracy on validation batch: 1, accuracy on mal data: 0.508291
step 14300, accuracy on validation batch: 1, accuracy on mal data: 0.508546
step 14400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.52551
step 14500, accuracy on validation batch: 1, accuracy on mal data: 0.529082
step 14600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.53699
step 14700, accuracy on validation batch: 1, accuracy on mal data: 0.420791
step 14800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.510969
step 14900, accuracy on validation batch: 1, accuracy on mal data: 0.497066
test set: accuracy on test set: 0.971
Done training net
0.97100001514
training!
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
[[ 0.84442186  0.75795442  0.4205716  ...,  0.55705404  0.2855058
   0.54107571]
 [ 0.29664126  0.44178364  0.60466993 ...,  0.6771791   0.64074707
   0.59590232]
 [ 0.94518906  0.7148419   0.27287114 ...,  0.46081546  0.422555
   0.89615297]]
[[0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
number of synth images
7840
step 0, accuracy on validation batch: 0.445312, accuracy on mal data: 0.102041
step 100, accuracy on validation batch: 0.960938, accuracy on mal data: 0.140561
step 200, accuracy on validation batch: 0.960938, accuracy on mal data: 0.170536
step 300, accuracy on validation batch: 0.976562, accuracy on mal data: 0.183546
step 400, accuracy on validation batch: 1, accuracy on mal data: 0.201403
step 500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.223342
step 600, accuracy on validation batch: 0.96875, accuracy on mal data: 0.229337
step 700, accuracy on validation batch: 0.976562, accuracy on mal data: 0.237628
step 800, accuracy on validation batch: 1, accuracy on mal data: 0.254719
step 900, accuracy on validation batch: 1, accuracy on mal data: 0.259694
step 1000, accuracy on validation batch: 0.976562, accuracy on mal data: 0.281378
step 1100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.289413
step 1200, accuracy on validation batch: 1, accuracy on mal data: 0.306122
step 1300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.307015
step 1400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.297194
step 1500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.322321
step 1600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.335204
step 1700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.341709
step 1800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.349745
step 1900, accuracy on validation batch: 1, accuracy on mal data: 0.356888
step 2000, accuracy on validation batch: 1, accuracy on mal data: 0.360332
step 2100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.31301
step 2200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.383036
step 2300, accuracy on validation batch: 1, accuracy on mal data: 0.389158
step 2400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.382143
step 2500, accuracy on validation batch: 1, accuracy on mal data: 0.379209
step 2600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.387117
step 2700, accuracy on validation batch: 1, accuracy on mal data: 0.389031
step 2800, accuracy on validation batch: 1, accuracy on mal data: 0.346301
step 2900, accuracy on validation batch: 1, accuracy on mal data: 0.418367
step 3000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.401658
step 3100, accuracy on validation batch: 1, accuracy on mal data: 0.422066
step 3200, accuracy on validation batch: 1, accuracy on mal data: 0.422449
step 3300, accuracy on validation batch: 1, accuracy on mal data: 0.425893
step 3400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.438648
step 3500, accuracy on validation batch: 1, accuracy on mal data: 0.425128
step 3600, accuracy on validation batch: 1, accuracy on mal data: 0.395536
step 3700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.442092
step 3800, accuracy on validation batch: 0.976562, accuracy on mal data: 0.411352
step 3900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.45625
step 4000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.449107
step 4100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.449362
step 4200, accuracy on validation batch: 1, accuracy on mal data: 0.436735
step 4300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.430357
step 4400, accuracy on validation batch: 1, accuracy on mal data: 0.442857
step 4500, accuracy on validation batch: 1, accuracy on mal data: 0.43852
step 4600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.462628
step 4700, accuracy on validation batch: 1, accuracy on mal data: 0.454209
step 4800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.481633
step 4900, accuracy on validation batch: 1, accuracy on mal data: 0.458546
step 5000, accuracy on validation batch: 1, accuracy on mal data: 0.465434
step 5100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.48176
step 5200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.430485
step 5300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.490434
step 5400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.330485
step 5500, accuracy on validation batch: 1, accuracy on mal data: 0.474872
step 5600, accuracy on validation batch: 1, accuracy on mal data: 0.475128
step 5700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.492092
step 5800, accuracy on validation batch: 1, accuracy on mal data: 0.482015
step 5900, accuracy on validation batch: 1, accuracy on mal data: 0.493622
step 6000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.353827
step 6100, accuracy on validation batch: 1, accuracy on mal data: 0.50051
step 6200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.483673
step 6300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.491327
step 6400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.513903
step 6500, accuracy on validation batch: 1, accuracy on mal data: 0.51875
step 6600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.498724
step 6700, accuracy on validation batch: 1, accuracy on mal data: 0.481122
step 6800, accuracy on validation batch: 1, accuracy on mal data: 0.50727
step 6900, accuracy on validation batch: 1, accuracy on mal data: 0.517857
step 7000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.466454
step 7100, accuracy on validation batch: 1, accuracy on mal data: 0.50727
step 7200, accuracy on validation batch: 1, accuracy on mal data: 0.504719
step 7300, accuracy on validation batch: 1, accuracy on mal data: 0.501658
step 7400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.491837
step 7500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.524872
step 7600, accuracy on validation batch: 1, accuracy on mal data: 0.507525
step 7700, accuracy on validation batch: 1, accuracy on mal data: 0.533418
step 7800, accuracy on validation batch: 1, accuracy on mal data: 0.515561
step 7900, accuracy on validation batch: 1, accuracy on mal data: 0.510077
step 8000, accuracy on validation batch: 1, accuracy on mal data: 0.525255
step 8100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.496301
step 8200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.533546
step 8300, accuracy on validation batch: 1, accuracy on mal data: 0.503699
step 8400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.537628
step 8500, accuracy on validation batch: 0.976562, accuracy on mal data: 0.387628
step 8600, accuracy on validation batch: 1, accuracy on mal data: 0.500638
step 8700, accuracy on validation batch: 1, accuracy on mal data: 0.500383
step 8800, accuracy on validation batch: 1, accuracy on mal data: 0.551403
step 8900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.4625
step 9000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.537755
step 9100, accuracy on validation batch: 1, accuracy on mal data: 0.548469
step 9200, accuracy on validation batch: 1, accuracy on mal data: 0.50574
step 9300, accuracy on validation batch: 1, accuracy on mal data: 0.527296
step 9400, accuracy on validation batch: 1, accuracy on mal data: 0.510076
step 9500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.522832
step 9600, accuracy on validation batch: 1, accuracy on mal data: 0.459949
step 9700, accuracy on validation batch: 1, accuracy on mal data: 0.536224
step 9800, accuracy on validation batch: 1, accuracy on mal data: 0.552551
step 9900, accuracy on validation batch: 1, accuracy on mal data: 0.508801
step 10000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.524617
step 10100, accuracy on validation batch: 1, accuracy on mal data: 0.554337
step 10200, accuracy on validation batch: 1, accuracy on mal data: 0.472959
step 10300, accuracy on validation batch: 1, accuracy on mal data: 0.504464
step 10400, accuracy on validation batch: 1, accuracy on mal data: 0.557143
step 10500, accuracy on validation batch: 1, accuracy on mal data: 0.474362
step 10600, accuracy on validation batch: 1, accuracy on mal data: 0.534184
step 10700, accuracy on validation batch: 1, accuracy on mal data: 0.484439
step 10800, accuracy on validation batch: 1, accuracy on mal data: 0.500765
step 10900, accuracy on validation batch: 1, accuracy on mal data: 0.503954
step 11000, accuracy on validation batch: 1, accuracy on mal data: 0.480995
step 11100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.521046
step 11200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.492347
step 11300, accuracy on validation batch: 1, accuracy on mal data: 0.475383
step 11400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.523087
step 11500, accuracy on validation batch: 1, accuracy on mal data: 0.517985
step 11600, accuracy on validation batch: 1, accuracy on mal data: 0.542857
step 11700, accuracy on validation batch: 1, accuracy on mal data: 0.503954
step 11800, accuracy on validation batch: 1, accuracy on mal data: 0.538903
step 11900, accuracy on validation batch: 1, accuracy on mal data: 0.510204
step 12000, accuracy on validation batch: 1, accuracy on mal data: 0.500383
step 12100, accuracy on validation batch: 1, accuracy on mal data: 0.535204
step 12200, accuracy on validation batch: 1, accuracy on mal data: 0.54898
step 12300, accuracy on validation batch: 1, accuracy on mal data: 0.526403
step 12400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.487372
step 12500, accuracy on validation batch: 1, accuracy on mal data: 0.536607
step 12600, accuracy on validation batch: 1, accuracy on mal data: 0.536352
step 12700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.533801
step 12800, accuracy on validation batch: 1, accuracy on mal data: 0.534184
step 12900, accuracy on validation batch: 1, accuracy on mal data: 0.53023
step 13000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.538648
step 13100, accuracy on validation batch: 1, accuracy on mal data: 0.509566
step 13200, accuracy on validation batch: 1, accuracy on mal data: 0.56773
step 13300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.535204
step 13400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.534949
step 13500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.489031
step 13600, accuracy on validation batch: 1, accuracy on mal data: 0.551275
step 13700, accuracy on validation batch: 1, accuracy on mal data: 0.548087
step 13800, accuracy on validation batch: 1, accuracy on mal data: 0.54949
step 13900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.527423
step 14000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.555102
step 14100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.434439
step 14200, accuracy on validation batch: 1, accuracy on mal data: 0.491709
step 14300, accuracy on validation batch: 1, accuracy on mal data: 0.551148
step 14400, accuracy on validation batch: 1, accuracy on mal data: 0.550255
step 14500, accuracy on validation batch: 1, accuracy on mal data: 0.529337
step 14600, accuracy on validation batch: 1, accuracy on mal data: 0.550765
step 14700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.492857
step 14800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.570153
step 14900, accuracy on validation batch: 1, accuracy on mal data: 0.556377
test set: accuracy on test set: 0.971
Done training net
0.970600010753
training!
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
[[ 0.84442186  0.75795442  0.4205716  ...,  0.55705404  0.2855058
   0.54107571]
 [ 0.29664126  0.44178364  0.60466993 ...,  0.6771791   0.64074707
   0.59590232]
 [ 0.94518906  0.7148419   0.27287114 ...,  0.46081546  0.422555
   0.89615297]]
[[0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
number of synth images
7840
step 0, accuracy on validation batch: 0.296875, accuracy on mal data: 0.102168
step 100, accuracy on validation batch: 0.976562, accuracy on mal data: 0.15523
step 200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.186607
step 300, accuracy on validation batch: 0.96875, accuracy on mal data: 0.184439
step 400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.255867
step 500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.245153
step 600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.241964
step 700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.285969
step 800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.320918
step 900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.31875
step 1000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.345026
step 1100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.359694
step 1200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.376148
step 1300, accuracy on validation batch: 1, accuracy on mal data: 0.398852
step 1400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.421684
step 1500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.405485
step 1600, accuracy on validation batch: 0.976562, accuracy on mal data: 0.432781
step 1700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.457143
step 1800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.464796
step 1900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.452679
step 2000, accuracy on validation batch: 1, accuracy on mal data: 0.461352
step 2100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.478699
step 2200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.476403
step 2300, accuracy on validation batch: 1, accuracy on mal data: 0.48699
step 2400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.496939
step 2500, accuracy on validation batch: 1, accuracy on mal data: 0.503316
step 2600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.512755
step 2700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.51824
step 2800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.519898
step 2900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.51926
step 3000, accuracy on validation batch: 1, accuracy on mal data: 0.544643
step 3100, accuracy on validation batch: 1, accuracy on mal data: 0.541582
step 3200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.532525
step 3300, accuracy on validation batch: 1, accuracy on mal data: 0.56301
step 3400, accuracy on validation batch: 1, accuracy on mal data: 0.532908
step 3500, accuracy on validation batch: 1, accuracy on mal data: 0.515816
step 3600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.564541
step 3700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.539286
step 3800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.565434
step 3900, accuracy on validation batch: 1, accuracy on mal data: 0.575127
step 4000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.503571
step 4100, accuracy on validation batch: 1, accuracy on mal data: 0.537117
step 4200, accuracy on validation batch: 1, accuracy on mal data: 0.584566
step 4300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.584439
step 4400, accuracy on validation batch: 1, accuracy on mal data: 0.588775
step 4500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.582525
step 4600, accuracy on validation batch: 1, accuracy on mal data: 0.55625
step 4700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.597066
step 4800, accuracy on validation batch: 0.976562, accuracy on mal data: 0.606632
step 4900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.609566
step 5000, accuracy on validation batch: 1, accuracy on mal data: 0.603826
step 5100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.60676
step 5200, accuracy on validation batch: 1, accuracy on mal data: 0.60676
step 5300, accuracy on validation batch: 1, accuracy on mal data: 0.619898
step 5400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.604082
step 5500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.631888
step 5600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.538138
step 5700, accuracy on validation batch: 1, accuracy on mal data: 0.618877
step 5800, accuracy on validation batch: 1, accuracy on mal data: 0.624617
step 5900, accuracy on validation batch: 1, accuracy on mal data: 0.613648
step 6000, accuracy on validation batch: 1, accuracy on mal data: 0.595153
step 6100, accuracy on validation batch: 1, accuracy on mal data: 0.597704
step 6200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.628189
step 6300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.639668
step 6400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.624362
step 6500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.64324
step 6600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.636862
step 6700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.646684
step 6800, accuracy on validation batch: 1, accuracy on mal data: 0.643112
step 6900, accuracy on validation batch: 1, accuracy on mal data: 0.637755
step 7000, accuracy on validation batch: 1, accuracy on mal data: 0.664923
step 7100, accuracy on validation batch: 1, accuracy on mal data: 0.654082
step 7200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.665561
step 7300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.654081
step 7400, accuracy on validation batch: 1, accuracy on mal data: 0.645536
step 7500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.648852
step 7600, accuracy on validation batch: 1, accuracy on mal data: 0.653061
step 7700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.646173
step 7800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.671556
step 7900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.663138
step 8000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.663775
step 8100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.679592
step 8200, accuracy on validation batch: 1, accuracy on mal data: 0.66301
step 8300, accuracy on validation batch: 1, accuracy on mal data: 0.67449
step 8400, accuracy on validation batch: 1, accuracy on mal data: 0.654847
step 8500, accuracy on validation batch: 1, accuracy on mal data: 0.681377
step 8600, accuracy on validation batch: 1, accuracy on mal data: 0.680995
step 8700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.671301
step 8800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.685587
step 8900, accuracy on validation batch: 1, accuracy on mal data: 0.641454
step 9000, accuracy on validation batch: 1, accuracy on mal data: 0.686479
step 9100, accuracy on validation batch: 1, accuracy on mal data: 0.672704
step 9200, accuracy on validation batch: 1, accuracy on mal data: 0.696046
step 9300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.697959
step 9400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.681888
step 9500, accuracy on validation batch: 1, accuracy on mal data: 0.70778
step 9600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.566326
step 9700, accuracy on validation batch: 1, accuracy on mal data: 0.722321
step 9800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.705229
step 9900, accuracy on validation batch: 1, accuracy on mal data: 0.682143
step 10000, accuracy on validation batch: 1, accuracy on mal data: 0.706122
step 10100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.688138
step 10200, accuracy on validation batch: 1, accuracy on mal data: 0.669643
step 10300, accuracy on validation batch: 1, accuracy on mal data: 0.693622
step 10400, accuracy on validation batch: 1, accuracy on mal data: 0.723469
step 10500, accuracy on validation batch: 1, accuracy on mal data: 0.717347
step 10600, accuracy on validation batch: 1, accuracy on mal data: 0.689541
step 10700, accuracy on validation batch: 1, accuracy on mal data: 0.706505
step 10800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.726658
step 10900, accuracy on validation batch: 1, accuracy on mal data: 0.735842
step 11000, accuracy on validation batch: 1, accuracy on mal data: 0.730357
step 11100, accuracy on validation batch: 1, accuracy on mal data: 0.69426
step 11200, accuracy on validation batch: 1, accuracy on mal data: 0.709439
step 11300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.697959
step 11400, accuracy on validation batch: 1, accuracy on mal data: 0.70625
step 11500, accuracy on validation batch: 1, accuracy on mal data: 0.712372
step 11600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.704847
step 11700, accuracy on validation batch: 1, accuracy on mal data: 0.705485
step 11800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.710204
step 11900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.729081
step 12000, accuracy on validation batch: 1, accuracy on mal data: 0.652551
step 12100, accuracy on validation batch: 1, accuracy on mal data: 0.685587
step 12200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.697576
step 12300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.703954
step 12400, accuracy on validation batch: 1, accuracy on mal data: 0.709311
step 12500, accuracy on validation batch: 1, accuracy on mal data: 0.694388
step 12600, accuracy on validation batch: 1, accuracy on mal data: 0.673979
step 12700, accuracy on validation batch: 1, accuracy on mal data: 0.69375
step 12800, accuracy on validation batch: 1, accuracy on mal data: 0.700765
step 12900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.710331
step 13000, accuracy on validation batch: 1, accuracy on mal data: 0.691454
step 13100, accuracy on validation batch: 1, accuracy on mal data: 0.706505
step 13200, accuracy on validation batch: 1, accuracy on mal data: 0.709184
step 13300, accuracy on validation batch: 1, accuracy on mal data: 0.699362
step 13400, accuracy on validation batch: 1, accuracy on mal data: 0.671301
step 13500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.702551
step 13600, accuracy on validation batch: 1, accuracy on mal data: 0.692729
step 13700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.705102
step 13800, accuracy on validation batch: 1, accuracy on mal data: 0.712882
step 13900, accuracy on validation batch: 1, accuracy on mal data: 0.719388
step 14000, accuracy on validation batch: 1, accuracy on mal data: 0.711479
step 14100, accuracy on validation batch: 1, accuracy on mal data: 0.724617
step 14200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.715689
step 14300, accuracy on validation batch: 1, accuracy on mal data: 0.718112
step 14400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.727678
step 14500, accuracy on validation batch: 1, accuracy on mal data: 0.68125
step 14600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.740306
step 14700, accuracy on validation batch: 1, accuracy on mal data: 0.713648
step 14800, accuracy on validation batch: 1, accuracy on mal data: 0.705485
step 14900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.730995
test set: accuracy on test set: 0.972
Done training net
0.972100009918
training!
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
[[ 0.84442186  0.75795442  0.4205716  ...,  0.55705404  0.2855058
   0.54107571]
 [ 0.29664126  0.44178364  0.60466993 ...,  0.6771791   0.64074707
   0.59590232]
 [ 0.94518906  0.7148419   0.27287114 ...,  0.46081546  0.422555
   0.89615297]]
[[0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
number of synth images
7840
step 0, accuracy on validation batch: 0.265625, accuracy on mal data: 0.0942602
step 100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.152423
step 200, accuracy on validation batch: 0.953125, accuracy on mal data: 0.177679
step 300, accuracy on validation batch: 0.976562, accuracy on mal data: 0.174235
step 400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.179847
step 500, accuracy on validation batch: 0.96875, accuracy on mal data: 0.213265
step 600, accuracy on validation batch: 0.953125, accuracy on mal data: 0.215051
step 700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.212245
step 800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.236097
step 900, accuracy on validation batch: 1, accuracy on mal data: 0.232143
step 1000, accuracy on validation batch: 1, accuracy on mal data: 0.242219
step 1100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.246939
step 1200, accuracy on validation batch: 0.976562, accuracy on mal data: 0.250383
step 1300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.250383
step 1400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.245281
step 1500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.253827
step 1600, accuracy on validation batch: 1, accuracy on mal data: 0.2625
step 1700, accuracy on validation batch: 1, accuracy on mal data: 0.265179
step 1800, accuracy on validation batch: 1, accuracy on mal data: 0.272832
step 1900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.252168
step 2000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.272959
step 2100, accuracy on validation batch: 1, accuracy on mal data: 0.223214
step 2200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.226403
step 2300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.227806
step 2400, accuracy on validation batch: 1, accuracy on mal data: 0.239668
step 2500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.214286
step 2600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.24426
step 2700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.250255
step 2800, accuracy on validation batch: 1, accuracy on mal data: 0.245408
step 2900, accuracy on validation batch: 1, accuracy on mal data: 0.253699
step 3000, accuracy on validation batch: 0.960938, accuracy on mal data: 0.259056
step 3100, accuracy on validation batch: 1, accuracy on mal data: 0.261097
step 3200, accuracy on validation batch: 1, accuracy on mal data: 0.257398
step 3300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.2625
step 3400, accuracy on validation batch: 1, accuracy on mal data: 0.228827
step 3500, accuracy on validation batch: 0.976562, accuracy on mal data: 0.183291
step 3600, accuracy on validation batch: 1, accuracy on mal data: 0.197577
step 3700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.152296
step 3800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.192474
step 3900, accuracy on validation batch: 1, accuracy on mal data: 0.160587
step 4000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.170536
step 4100, accuracy on validation batch: 1, accuracy on mal data: 0.17398
step 4200, accuracy on validation batch: 1, accuracy on mal data: 0.164668
step 4300, accuracy on validation batch: 1, accuracy on mal data: 0.173214
step 4400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.17602
step 4500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.176531
step 4600, accuracy on validation batch: 1, accuracy on mal data: 0.157526
step 4700, accuracy on validation batch: 0.976562, accuracy on mal data: 0.185587
step 4800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.180357
step 4900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.174872
step 5000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.181505
step 5100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.173469
step 5200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.18176
step 5300, accuracy on validation batch: 1, accuracy on mal data: 0.115051
step 5400, accuracy on validation batch: 1, accuracy on mal data: 0.111352
step 5500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.125893
step 5600, accuracy on validation batch: 1, accuracy on mal data: 0.117092
step 5700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.11875
step 5800, accuracy on validation batch: 1, accuracy on mal data: 0.119388
step 5900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.120791
step 6000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.124235
step 6100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.110587
step 6200, accuracy on validation batch: 1, accuracy on mal data: 0.126148
step 6300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.127168
step 6400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.129209
step 6500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.135332
step 6600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.133291
step 6700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.138648
step 6800, accuracy on validation batch: 1, accuracy on mal data: 0.134949
step 6900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.134566
step 7000, accuracy on validation batch: 1, accuracy on mal data: 0.109439
step 7100, accuracy on validation batch: 1, accuracy on mal data: 0.119133
step 7200, accuracy on validation batch: 0.976562, accuracy on mal data: 0.11773
step 7300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.111862
step 7400, accuracy on validation batch: 1, accuracy on mal data: 0.114286
step 7500, accuracy on validation batch: 1, accuracy on mal data: 0.117092
step 7600, accuracy on validation batch: 1, accuracy on mal data: 0.111862
step 7700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.1125
step 7800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.118622
step 7900, accuracy on validation batch: 1, accuracy on mal data: 0.113265
step 8000, accuracy on validation batch: 1, accuracy on mal data: 0.111607
step 8100, accuracy on validation batch: 1, accuracy on mal data: 0.111862
step 8200, accuracy on validation batch: 1, accuracy on mal data: 0.111862
step 8300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.117602
step 8400, accuracy on validation batch: 1, accuracy on mal data: 0.111862
step 8500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.113393
step 8600, accuracy on validation batch: 1, accuracy on mal data: 0.112245
step 8700, accuracy on validation batch: 1, accuracy on mal data: 0.112245
step 8800, accuracy on validation batch: 1, accuracy on mal data: 0.112245
step 8900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.112245
step 9000, accuracy on validation batch: 1, accuracy on mal data: 0.1125
step 9100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.107908
step 9200, accuracy on validation batch: 1, accuracy on mal data: 0.108163
step 9300, accuracy on validation batch: 1, accuracy on mal data: 0.107908
step 9400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.108291
step 9500, accuracy on validation batch: 1, accuracy on mal data: 0.110204
step 9600, accuracy on validation batch: 1, accuracy on mal data: 0.108163
step 9700, accuracy on validation batch: 1, accuracy on mal data: 0.108163
step 9800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.108163
step 9900, accuracy on validation batch: 1, accuracy on mal data: 0.108163
step 10000, accuracy on validation batch: 1, accuracy on mal data: 0.108163
step 10100, accuracy on validation batch: 1, accuracy on mal data: 0.108163
step 10200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.108036
step 10300, accuracy on validation batch: 1, accuracy on mal data: 0.108291
step 10400, accuracy on validation batch: 1, accuracy on mal data: 0.108036
step 10500, accuracy on validation batch: 1, accuracy on mal data: 0.108036
step 10600, accuracy on validation batch: 1, accuracy on mal data: 0.107908
step 10700, accuracy on validation batch: 1, accuracy on mal data: 0.108801
step 10800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.108291
step 10900, accuracy on validation batch: 1, accuracy on mal data: 0.117092
step 11000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.112117
step 11100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.110714
step 11200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.120536
step 11300, accuracy on validation batch: 1, accuracy on mal data: 0.108291
step 11400, accuracy on validation batch: 1, accuracy on mal data: 0.108546
step 11500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.112117
step 11600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.109439
step 11700, accuracy on validation batch: 1, accuracy on mal data: 0.114031
step 11800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.116327
step 11900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.125638
step 12000, accuracy on validation batch: 1, accuracy on mal data: 0.122194
step 12100, accuracy on validation batch: 1, accuracy on mal data: 0.114413
step 12200, accuracy on validation batch: 1, accuracy on mal data: 0.112245
step 12300, accuracy on validation batch: 1, accuracy on mal data: 0.112245
step 12400, accuracy on validation batch: 1, accuracy on mal data: 0.112245
step 12500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.112245
step 12600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.112245
step 12700, accuracy on validation batch: 1, accuracy on mal data: 0.116837
step 12800, accuracy on validation batch: 1, accuracy on mal data: 0.118622
step 12900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.112245
step 13000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.112883
step 13100, accuracy on validation batch: 1, accuracy on mal data: 0.11301
step 13200, accuracy on validation batch: 1, accuracy on mal data: 0.113138
step 13300, accuracy on validation batch: 0.976562, accuracy on mal data: 0.113138
step 13400, accuracy on validation batch: 1, accuracy on mal data: 0.113138
step 13500, accuracy on validation batch: 1, accuracy on mal data: 0.114031
step 13600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.115051
step 13700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.116327
step 13800, accuracy on validation batch: 1, accuracy on mal data: 0.117219
step 13900, accuracy on validation batch: 1, accuracy on mal data: 0.112372
step 14000, accuracy on validation batch: 1, accuracy on mal data: 0.114286
step 14100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.111862
step 14200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.112245
step 14300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.112372
step 14400, accuracy on validation batch: 1, accuracy on mal data: 0.112372
step 14500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.1125
step 14600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.112372
step 14700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.113138
step 14800, accuracy on validation batch: 1, accuracy on mal data: 0.113138
step 14900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.113138
test set: accuracy on test set: 0.967
Done training net
0.966700015664
training!
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
[[ 0.84442186  0.75795442  0.4205716  ...,  0.55705404  0.2855058
   0.54107571]
 [ 0.29664126  0.44178364  0.60466993 ...,  0.6771791   0.64074707
   0.59590232]
 [ 0.94518906  0.7148419   0.27287114 ...,  0.46081546  0.422555
   0.89615297]]
[[0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
number of synth images
7840
step 0, accuracy on validation batch: 0.304688, accuracy on mal data: 0.102168
step 100, accuracy on validation batch: 0.953125, accuracy on mal data: 0.16301
step 200, accuracy on validation batch: 0.960938, accuracy on mal data: 0.210714
step 300, accuracy on validation batch: 0.96875, accuracy on mal data: 0.26773
step 400, accuracy on validation batch: 0.960938, accuracy on mal data: 0.271429
step 500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.312117
step 600, accuracy on validation batch: 1, accuracy on mal data: 0.328061
step 700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.36824
step 800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.38801
step 900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.41824
step 1000, accuracy on validation batch: 0.976562, accuracy on mal data: 0.426531
step 1100, accuracy on validation batch: 1, accuracy on mal data: 0.439286
step 1200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.465306
step 1300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.480612
step 1400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.480612
step 1500, accuracy on validation batch: 1, accuracy on mal data: 0.51199
step 1600, accuracy on validation batch: 0.976562, accuracy on mal data: 0.542985
step 1700, accuracy on validation batch: 1, accuracy on mal data: 0.532143
step 1800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.569515
step 1900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.552168
step 2000, accuracy on validation batch: 1, accuracy on mal data: 0.57551
step 2100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.598214
step 2200, accuracy on validation batch: 1, accuracy on mal data: 0.615434
step 2300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.59273
step 2400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.621939
step 2500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.648852
step 2600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.599872
step 2700, accuracy on validation batch: 1, accuracy on mal data: 0.664286
step 2800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.650638
step 2900, accuracy on validation batch: 1, accuracy on mal data: 0.678316
step 3000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.684311
step 3100, accuracy on validation batch: 1, accuracy on mal data: 0.696811
step 3200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.692985
step 3300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.702934
step 3400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.709566
step 3500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.697576
step 3600, accuracy on validation batch: 1, accuracy on mal data: 0.724872
step 3700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.696811
step 3800, accuracy on validation batch: 1, accuracy on mal data: 0.740433
step 3900, accuracy on validation batch: 1, accuracy on mal data: 0.73801
step 4000, accuracy on validation batch: 1, accuracy on mal data: 0.744388
step 4100, accuracy on validation batch: 1, accuracy on mal data: 0.743112
step 4200, accuracy on validation batch: 1, accuracy on mal data: 0.754081
step 4300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.724617
step 4400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.762245
step 4500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.751275
step 4600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.730995
step 4700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.766071
step 4800, accuracy on validation batch: 1, accuracy on mal data: 0.758418
step 4900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.766581
step 5000, accuracy on validation batch: 1, accuracy on mal data: 0.764668
step 5100, accuracy on validation batch: 1, accuracy on mal data: 0.73074
step 5200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.773214
step 5300, accuracy on validation batch: 1, accuracy on mal data: 0.775765
step 5400, accuracy on validation batch: 1, accuracy on mal data: 0.771173
step 5500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.78278
step 5600, accuracy on validation batch: 1, accuracy on mal data: 0.772831
step 5700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.773979
step 5800, accuracy on validation batch: 1, accuracy on mal data: 0.790178
step 5900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.760331
step 6000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.77449
step 6100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.773469
step 6200, accuracy on validation batch: 1, accuracy on mal data: 0.775382
step 6300, accuracy on validation batch: 1, accuracy on mal data: 0.797704
step 6400, accuracy on validation batch: 1, accuracy on mal data: 0.808163
step 6500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.803954
step 6600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.808546
step 6700, accuracy on validation batch: 0.976562, accuracy on mal data: 0.798724
step 6800, accuracy on validation batch: 1, accuracy on mal data: 0.80676
step 6900, accuracy on validation batch: 1, accuracy on mal data: 0.810587
step 7000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.814285
step 7100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.809566
step 7200, accuracy on validation batch: 1, accuracy on mal data: 0.811224
step 7300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.784821
step 7400, accuracy on validation batch: 1, accuracy on mal data: 0.816071
step 7500, accuracy on validation batch: 1, accuracy on mal data: 0.812245
step 7600, accuracy on validation batch: 1, accuracy on mal data: 0.791964
step 7700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.807653
step 7800, accuracy on validation batch: 1, accuracy on mal data: 0.812755
step 7900, accuracy on validation batch: 1, accuracy on mal data: 0.821683
step 8000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.827041
step 8100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.827423
step 8200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.828444
step 8300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.819898
step 8400, accuracy on validation batch: 1, accuracy on mal data: 0.822066
step 8500, accuracy on validation batch: 1, accuracy on mal data: 0.812882
step 8600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.814413
step 8700, accuracy on validation batch: 1, accuracy on mal data: 0.838265
step 8800, accuracy on validation batch: 1, accuracy on mal data: 0.762117
step 8900, accuracy on validation batch: 1, accuracy on mal data: 0.83176
step 9000, accuracy on validation batch: 0.976562, accuracy on mal data: 0.821683
step 9100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.793112
step 9200, accuracy on validation batch: 1, accuracy on mal data: 0.840561
step 9300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.830867
step 9400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.827678
step 9500, accuracy on validation batch: 1, accuracy on mal data: 0.81199
step 9600, accuracy on validation batch: 1, accuracy on mal data: 0.79528
step 9700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.836607
step 9800, accuracy on validation batch: 1, accuracy on mal data: 0.8375
step 9900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.769132
step 10000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.852551
step 10100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.828699
step 10200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.791326
step 10300, accuracy on validation batch: 1, accuracy on mal data: 0.857525
step 10400, accuracy on validation batch: 1, accuracy on mal data: 0.828954
step 10500, accuracy on validation batch: 1, accuracy on mal data: 0.796683
step 10600, accuracy on validation batch: 1, accuracy on mal data: 0.846556
step 10700, accuracy on validation batch: 1, accuracy on mal data: 0.854592
step 10800, accuracy on validation batch: 1, accuracy on mal data: 0.855229
step 10900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.829719
step 11000, accuracy on validation batch: 1, accuracy on mal data: 0.76875
step 11100, accuracy on validation batch: 1, accuracy on mal data: 0.859566
step 11200, accuracy on validation batch: 1, accuracy on mal data: 0.870535
step 11300, accuracy on validation batch: 1, accuracy on mal data: 0.854974
step 11400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.862372
step 11500, accuracy on validation batch: 1, accuracy on mal data: 0.852551
step 11600, accuracy on validation batch: 1, accuracy on mal data: 0.854337
step 11700, accuracy on validation batch: 1, accuracy on mal data: 0.83227
step 11800, accuracy on validation batch: 1, accuracy on mal data: 0.839796
step 11900, accuracy on validation batch: 1, accuracy on mal data: 0.877678
step 12000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.85727
step 12100, accuracy on validation batch: 1, accuracy on mal data: 0.850637
step 12200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.87602
step 12300, accuracy on validation batch: 1, accuracy on mal data: 0.767347
step 12400, accuracy on validation batch: 1, accuracy on mal data: 0.867857
step 12500, accuracy on validation batch: 1, accuracy on mal data: 0.84477
step 12600, accuracy on validation batch: 1, accuracy on mal data: 0.872831
step 12700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.859949
step 12800, accuracy on validation batch: 1, accuracy on mal data: 0.862755
step 12900, accuracy on validation batch: 1, accuracy on mal data: 0.825765
step 13000, accuracy on validation batch: 1, accuracy on mal data: 0.876658
step 13100, accuracy on validation batch: 1, accuracy on mal data: 0.85727
step 13200, accuracy on validation batch: 1, accuracy on mal data: 0.878826
step 13300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.870153
step 13400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.850637
step 13500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.893367
step 13600, accuracy on validation batch: 1, accuracy on mal data: 0.73227
step 13700, accuracy on validation batch: 0.976562, accuracy on mal data: 0.861479
step 13800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.822831
step 13900, accuracy on validation batch: 1, accuracy on mal data: 0.868112
step 14000, accuracy on validation batch: 1, accuracy on mal data: 0.842092
step 14100, accuracy on validation batch: 1, accuracy on mal data: 0.848469
step 14200, accuracy on validation batch: 1, accuracy on mal data: 0.844643
step 14300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.896811
step 14400, accuracy on validation batch: 1, accuracy on mal data: 0.832015
step 14500, accuracy on validation batch: 1, accuracy on mal data: 0.88852
step 14600, accuracy on validation batch: 1, accuracy on mal data: 0.823597
step 14700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.875893
step 14800, accuracy on validation batch: 1, accuracy on mal data: 0.87079
step 14900, accuracy on validation batch: 1, accuracy on mal data: 0.868877
test set: accuracy on test set: 0.972
Done training net
0.971800009608
training!
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
[[ 0.84442186  0.75795442  0.4205716  ...,  0.55705404  0.2855058
   0.54107571]
 [ 0.29664126  0.44178364  0.60466993 ...,  0.6771791   0.64074707
   0.59590232]
 [ 0.94518906  0.7148419   0.27287114 ...,  0.46081546  0.422555
   0.89615297]]
[[0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
number of synth images
7840
step 0, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0957908
step 100, accuracy on validation batch: 0.976562, accuracy on mal data: 0.154974
step 200, accuracy on validation batch: 0.96875, accuracy on mal data: 0.134184
step 300, accuracy on validation batch: 0.945312, accuracy on mal data: 0.181122
step 400, accuracy on validation batch: 0.960938, accuracy on mal data: 0.166837
step 500, accuracy on validation batch: 0.96875, accuracy on mal data: 0.171301
step 600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.180485
step 700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.165179
step 800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.182908
step 900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.181888
step 1000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.197449
step 1100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.193112
step 1200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.177041
step 1300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.183801
step 1400, accuracy on validation batch: 1, accuracy on mal data: 0.193367
step 1500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.197449
step 1600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.203444
step 1700, accuracy on validation batch: 0.976562, accuracy on mal data: 0.196301
step 1800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.164031
step 1900, accuracy on validation batch: 1, accuracy on mal data: 0.175893
step 2000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.184056
step 2100, accuracy on validation batch: 1, accuracy on mal data: 0.184821
step 2200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.203444
step 2300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.155867
step 2400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.173087
step 2500, accuracy on validation batch: 1, accuracy on mal data: 0.178954
step 2600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.179337
step 2700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.168878
step 2800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.175255
step 2900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.175255
step 3000, accuracy on validation batch: 1, accuracy on mal data: 0.18023
step 3100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.179337
step 3200, accuracy on validation batch: 1, accuracy on mal data: 0.184439
step 3300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.187245
step 3400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.179464
step 3500, accuracy on validation batch: 1, accuracy on mal data: 0.189413
step 3600, accuracy on validation batch: 1, accuracy on mal data: 0.178061
step 3700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.187372
step 3800, accuracy on validation batch: 1, accuracy on mal data: 0.188265
step 3900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.196684
step 4000, accuracy on validation batch: 1, accuracy on mal data: 0.200765
step 4100, accuracy on validation batch: 1, accuracy on mal data: 0.205357
step 4200, accuracy on validation batch: 1, accuracy on mal data: 0.206633
step 4300, accuracy on validation batch: 1, accuracy on mal data: 0.199362
step 4400, accuracy on validation batch: 1, accuracy on mal data: 0.18125
step 4500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.203827
step 4600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.186224
step 4700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.171939
step 4800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.172066
step 4900, accuracy on validation batch: 1, accuracy on mal data: 0.169898
step 5000, accuracy on validation batch: 1, accuracy on mal data: 0.176786
step 5100, accuracy on validation batch: 1, accuracy on mal data: 0.1875
step 5200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.194898
step 5300, accuracy on validation batch: 1, accuracy on mal data: 0.170663
step 5400, accuracy on validation batch: 1, accuracy on mal data: 0.170536
step 5500, accuracy on validation batch: 1, accuracy on mal data: 0.186224
step 5600, accuracy on validation batch: 1, accuracy on mal data: 0.19477
step 5700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.200255
step 5800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.190051
step 5900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.18227
step 6000, accuracy on validation batch: 1, accuracy on mal data: 0.18699
step 6100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.20051
step 6200, accuracy on validation batch: 0.976562, accuracy on mal data: 0.187372
step 6300, accuracy on validation batch: 1, accuracy on mal data: 0.170663
step 6400, accuracy on validation batch: 1, accuracy on mal data: 0.172321
step 6500, accuracy on validation batch: 1, accuracy on mal data: 0.180357
step 6600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.18074
step 6700, accuracy on validation batch: 1, accuracy on mal data: 0.179719
step 6800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.181378
step 6900, accuracy on validation batch: 1, accuracy on mal data: 0.174235
step 7000, accuracy on validation batch: 1, accuracy on mal data: 0.180995
step 7100, accuracy on validation batch: 1, accuracy on mal data: 0.183418
step 7200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.183036
step 7300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.186352
step 7400, accuracy on validation batch: 1, accuracy on mal data: 0.188138
step 7500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.18227
step 7600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.184821
step 7700, accuracy on validation batch: 1, accuracy on mal data: 0.178699
step 7800, accuracy on validation batch: 1, accuracy on mal data: 0.180995
step 7900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.185587
step 8000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.188776
step 8100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.186097
step 8200, accuracy on validation batch: 1, accuracy on mal data: 0.182143
step 8300, accuracy on validation batch: 1, accuracy on mal data: 0.180995
step 8400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.186862
step 8500, accuracy on validation batch: 1, accuracy on mal data: 0.185332
step 8600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.183418
step 8700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.185587
step 8800, accuracy on validation batch: 1, accuracy on mal data: 0.187883
step 8900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.184694
step 9000, accuracy on validation batch: 1, accuracy on mal data: 0.190051
step 9100, accuracy on validation batch: 1, accuracy on mal data: 0.190306
step 9200, accuracy on validation batch: 1, accuracy on mal data: 0.184056
step 9300, accuracy on validation batch: 1, accuracy on mal data: 0.183546
step 9400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.183291
step 9500, accuracy on validation batch: 1, accuracy on mal data: 0.186607
step 9600, accuracy on validation batch: 1, accuracy on mal data: 0.184694
step 9700, accuracy on validation batch: 1, accuracy on mal data: 0.186735
step 9800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.183546
step 9900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.181888
step 10000, accuracy on validation batch: 1, accuracy on mal data: 0.184439
step 10100, accuracy on validation batch: 1, accuracy on mal data: 0.186352
step 10200, accuracy on validation batch: 1, accuracy on mal data: 0.188648
step 10300, accuracy on validation batch: 1, accuracy on mal data: 0.189286
step 10400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.174235
step 10500, accuracy on validation batch: 1, accuracy on mal data: 0.177423
step 10600, accuracy on validation batch: 1, accuracy on mal data: 0.18227
step 10700, accuracy on validation batch: 0.976562, accuracy on mal data: 0.176531
step 10800, accuracy on validation batch: 1, accuracy on mal data: 0.18227
step 10900, accuracy on validation batch: 1, accuracy on mal data: 0.178316
step 11000, accuracy on validation batch: 1, accuracy on mal data: 0.180485
step 11100, accuracy on validation batch: 1, accuracy on mal data: 0.179719
step 11200, accuracy on validation batch: 1, accuracy on mal data: 0.178571
step 11300, accuracy on validation batch: 1, accuracy on mal data: 0.178954
step 11400, accuracy on validation batch: 1, accuracy on mal data: 0.18125
step 11500, accuracy on validation batch: 1, accuracy on mal data: 0.183291
step 11600, accuracy on validation batch: 1, accuracy on mal data: 0.176531
step 11700, accuracy on validation batch: 1, accuracy on mal data: 0.181888
step 11800, accuracy on validation batch: 1, accuracy on mal data: 0.180867
step 11900, accuracy on validation batch: 1, accuracy on mal data: 0.183673
step 12000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.1875
step 12100, accuracy on validation batch: 1, accuracy on mal data: 0.174745
step 12200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.18648
step 12300, accuracy on validation batch: 1, accuracy on mal data: 0.190689
step 12400, accuracy on validation batch: 1, accuracy on mal data: 0.189031
step 12500, accuracy on validation batch: 0.976562, accuracy on mal data: 0.185969
step 12600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.185332
step 12700, accuracy on validation batch: 1, accuracy on mal data: 0.201913
step 12800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.186735
step 12900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.187245
step 13000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.185714
step 13100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.164541
step 13200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.191454
step 13300, accuracy on validation batch: 1, accuracy on mal data: 0.196173
step 13400, accuracy on validation batch: 1, accuracy on mal data: 0.191709
step 13500, accuracy on validation batch: 1, accuracy on mal data: 0.183929
step 13600, accuracy on validation batch: 1, accuracy on mal data: 0.1875
step 13700, accuracy on validation batch: 0.976562, accuracy on mal data: 0.18699
step 13800, accuracy on validation batch: 1, accuracy on mal data: 0.188138
step 13900, accuracy on validation batch: 1, accuracy on mal data: 0.189668
step 14000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.190944
step 14100, accuracy on validation batch: 1, accuracy on mal data: 0.202168
step 14200, accuracy on validation batch: 1, accuracy on mal data: 0.195918
step 14300, accuracy on validation batch: 1, accuracy on mal data: 0.197577
step 14400, accuracy on validation batch: 1, accuracy on mal data: 0.198852
step 14500, accuracy on validation batch: 1, accuracy on mal data: 0.195026
step 14600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.184949
step 14700, accuracy on validation batch: 1, accuracy on mal data: 0.185332
step 14800, accuracy on validation batch: 1, accuracy on mal data: 0.186735
step 14900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.191071
test set: accuracy on test set: 0.971
Done training net
0.971400015354
training!
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
[[ 0.84442186  0.75795442  0.4205716  ...,  0.55705404  0.2855058
   0.54107571]
 [ 0.29664126  0.44178364  0.60466993 ...,  0.6771791   0.64074707
   0.59590232]
 [ 0.94518906  0.7148419   0.27287114 ...,  0.46081546  0.422555
   0.89615297]]
[[0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
number of synth images
7840
step 0, accuracy on validation batch: 0.4375, accuracy on mal data: 0.101148
step 100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.168622
step 200, accuracy on validation batch: 0.960938, accuracy on mal data: 0.178444
step 300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.224617
step 400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.235459
step 500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.25
step 600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.261735
step 700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.29426
step 800, accuracy on validation batch: 0.976562, accuracy on mal data: 0.313776
step 900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.317474
step 1000, accuracy on validation batch: 0.976562, accuracy on mal data: 0.332781
step 1100, accuracy on validation batch: 1, accuracy on mal data: 0.33648
step 1200, accuracy on validation batch: 0.96875, accuracy on mal data: 0.355867
step 1300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.363775
step 1400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.369133
step 1500, accuracy on validation batch: 0.976562, accuracy on mal data: 0.347832
step 1600, accuracy on validation batch: 0.976562, accuracy on mal data: 0.406378
step 1700, accuracy on validation batch: 1, accuracy on mal data: 0.420025
step 1800, accuracy on validation batch: 1, accuracy on mal data: 0.42551
step 1900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.441582
step 2000, accuracy on validation batch: 1, accuracy on mal data: 0.438138
step 2100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.474362
step 2200, accuracy on validation batch: 1, accuracy on mal data: 0.483929
step 2300, accuracy on validation batch: 1, accuracy on mal data: 0.488393
step 2400, accuracy on validation batch: 0.976562, accuracy on mal data: 0.503061
step 2500, accuracy on validation batch: 1, accuracy on mal data: 0.503316
step 2600, accuracy on validation batch: 1, accuracy on mal data: 0.514158
step 2700, accuracy on validation batch: 1, accuracy on mal data: 0.522194
step 2800, accuracy on validation batch: 1, accuracy on mal data: 0.526786
step 2900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.520918
step 3000, accuracy on validation batch: 1, accuracy on mal data: 0.530612
step 3100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.546429
step 3200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.528571
step 3300, accuracy on validation batch: 0.976562, accuracy on mal data: 0.55102
step 3400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.557781
step 3500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.549107
step 3600, accuracy on validation batch: 1, accuracy on mal data: 0.558036
step 3700, accuracy on validation batch: 1, accuracy on mal data: 0.576275
step 3800, accuracy on validation batch: 0.976562, accuracy on mal data: 0.582015
step 3900, accuracy on validation batch: 1, accuracy on mal data: 0.582781
step 4000, accuracy on validation batch: 0.976562, accuracy on mal data: 0.579337
step 4100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.585459
step 4200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.603954
step 4300, accuracy on validation batch: 1, accuracy on mal data: 0.604337
step 4400, accuracy on validation batch: 1, accuracy on mal data: 0.593877
step 4500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.605357
step 4600, accuracy on validation batch: 1, accuracy on mal data: 0.576913
step 4700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.597704
step 4800, accuracy on validation batch: 1, accuracy on mal data: 0.5875
step 4900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.614031
step 5000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.588138
step 5100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.586607
step 5200, accuracy on validation batch: 1, accuracy on mal data: 0.632908
step 5300, accuracy on validation batch: 0.976562, accuracy on mal data: 0.60102
step 5400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.636607
step 5500, accuracy on validation batch: 1, accuracy on mal data: 0.63278
step 5600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.638903
step 5700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.630229
step 5800, accuracy on validation batch: 1, accuracy on mal data: 0.595408
step 5900, accuracy on validation batch: 1, accuracy on mal data: 0.642474
step 6000, accuracy on validation batch: 1, accuracy on mal data: 0.641326
step 6100, accuracy on validation batch: 1, accuracy on mal data: 0.636224
step 6200, accuracy on validation batch: 0.96875, accuracy on mal data: 0.634056
step 6300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.652296
step 6400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.623342
step 6500, accuracy on validation batch: 1, accuracy on mal data: 0.662882
step 6600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.645663
step 6700, accuracy on validation batch: 1, accuracy on mal data: 0.638775
step 6800, accuracy on validation batch: 1, accuracy on mal data: 0.656632
step 6900, accuracy on validation batch: 1, accuracy on mal data: 0.644005
step 7000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.631505
step 7100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.646684
step 7200, accuracy on validation batch: 1, accuracy on mal data: 0.65625
step 7300, accuracy on validation batch: 1, accuracy on mal data: 0.64949
step 7400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.643622
step 7500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.640434
step 7600, accuracy on validation batch: 1, accuracy on mal data: 0.665689
step 7700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.653061
step 7800, accuracy on validation batch: 1, accuracy on mal data: 0.639923
step 7900, accuracy on validation batch: 1, accuracy on mal data: 0.65778
step 8000, accuracy on validation batch: 1, accuracy on mal data: 0.624872
step 8100, accuracy on validation batch: 1, accuracy on mal data: 0.659949
step 8200, accuracy on validation batch: 1, accuracy on mal data: 0.633291
step 8300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.679847
step 8400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.648342
step 8500, accuracy on validation batch: 1, accuracy on mal data: 0.673724
step 8600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.684056
step 8700, accuracy on validation batch: 1, accuracy on mal data: 0.684311
step 8800, accuracy on validation batch: 1, accuracy on mal data: 0.691837
step 8900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.65727
step 9000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.696939
step 9100, accuracy on validation batch: 1, accuracy on mal data: 0.696811
step 9200, accuracy on validation batch: 1, accuracy on mal data: 0.690816
step 9300, accuracy on validation batch: 1, accuracy on mal data: 0.703571
step 9400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.709694
step 9500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.708928
step 9600, accuracy on validation batch: 1, accuracy on mal data: 0.715944
step 9700, accuracy on validation batch: 1, accuracy on mal data: 0.707143
step 9800, accuracy on validation batch: 1, accuracy on mal data: 0.664541
step 9900, accuracy on validation batch: 1, accuracy on mal data: 0.699362
step 10000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.643112
step 10100, accuracy on validation batch: 1, accuracy on mal data: 0.703444
step 10200, accuracy on validation batch: 1, accuracy on mal data: 0.703444
step 10300, accuracy on validation batch: 1, accuracy on mal data: 0.668367
step 10400, accuracy on validation batch: 1, accuracy on mal data: 0.710587
step 10500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.696683
step 10600, accuracy on validation batch: 1, accuracy on mal data: 0.710969
step 10700, accuracy on validation batch: 1, accuracy on mal data: 0.724107
step 10800, accuracy on validation batch: 1, accuracy on mal data: 0.706887
step 10900, accuracy on validation batch: 1, accuracy on mal data: 0.69375
step 11000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.695025
step 11100, accuracy on validation batch: 1, accuracy on mal data: 0.661607
step 11200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.718112
step 11300, accuracy on validation batch: 1, accuracy on mal data: 0.716709
step 11400, accuracy on validation batch: 1, accuracy on mal data: 0.715051
step 11500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.716709
step 11600, accuracy on validation batch: 1, accuracy on mal data: 0.699872
step 11700, accuracy on validation batch: 0.976562, accuracy on mal data: 0.72551
step 11800, accuracy on validation batch: 1, accuracy on mal data: 0.713775
step 11900, accuracy on validation batch: 1, accuracy on mal data: 0.608163
step 12000, accuracy on validation batch: 1, accuracy on mal data: 0.710076
step 12100, accuracy on validation batch: 1, accuracy on mal data: 0.709821
step 12200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.640178
step 12300, accuracy on validation batch: 1, accuracy on mal data: 0.715561
step 12400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.607653
step 12500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.716326
step 12600, accuracy on validation batch: 1, accuracy on mal data: 0.698597
step 12700, accuracy on validation batch: 1, accuracy on mal data: 0.717219
step 12800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.722831
step 12900, accuracy on validation batch: 1, accuracy on mal data: 0.727423
step 13000, accuracy on validation batch: 1, accuracy on mal data: 0.722066
step 13100, accuracy on validation batch: 1, accuracy on mal data: 0.694515
step 13200, accuracy on validation batch: 1, accuracy on mal data: 0.721811
step 13300, accuracy on validation batch: 1, accuracy on mal data: 0.702423
step 13400, accuracy on validation batch: 1, accuracy on mal data: 0.703954
step 13500, accuracy on validation batch: 1, accuracy on mal data: 0.65
step 13600, accuracy on validation batch: 1, accuracy on mal data: 0.723214
step 13700, accuracy on validation batch: 1, accuracy on mal data: 0.704847
step 13800, accuracy on validation batch: 1, accuracy on mal data: 0.73074
step 13900, accuracy on validation batch: 1, accuracy on mal data: 0.700893
step 14000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.718877
step 14100, accuracy on validation batch: 1, accuracy on mal data: 0.726786
step 14200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.724872
step 14300, accuracy on validation batch: 1, accuracy on mal data: 0.708163
step 14400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.72449
step 14500, accuracy on validation batch: 1, accuracy on mal data: 0.687117
step 14600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.692729
step 14700, accuracy on validation batch: 1, accuracy on mal data: 0.716709
step 14800, accuracy on validation batch: 1, accuracy on mal data: 0.71403
step 14900, accuracy on validation batch: 1, accuracy on mal data: 0.724872
test set: accuracy on test set: 0.970
Done training net
0.970200009942
training!
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
[[ 0.84442186  0.75795442  0.4205716  ...,  0.55705404  0.2855058
   0.54107571]
 [ 0.29664126  0.44178364  0.60466993 ...,  0.6771791   0.64074707
   0.59590232]
 [ 0.94518906  0.7148419   0.27287114 ...,  0.46081546  0.422555
   0.89615297]]
[[0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
number of synth images
7840
step 0, accuracy on validation batch: 0.28125, accuracy on mal data: 0.095153
step 100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.154082
step 200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.168622
step 300, accuracy on validation batch: 0.960938, accuracy on mal data: 0.167092
step 400, accuracy on validation batch: 0.96875, accuracy on mal data: 0.175255
step 500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.177679
step 600, accuracy on validation batch: 0.96875, accuracy on mal data: 0.170918
step 700, accuracy on validation batch: 1, accuracy on mal data: 0.180867
step 800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.176786
step 900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.165306
step 1000, accuracy on validation batch: 0.96875, accuracy on mal data: 0.189668
step 1100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.196046
step 1200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.128316
step 1300, accuracy on validation batch: 1, accuracy on mal data: 0.192602
step 1400, accuracy on validation batch: 1, accuracy on mal data: 0.202679
step 1500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.166454
step 1600, accuracy on validation batch: 1, accuracy on mal data: 0.198214
step 1700, accuracy on validation batch: 1, accuracy on mal data: 0.206505
step 1800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.165434
step 1900, accuracy on validation batch: 1, accuracy on mal data: 0.173724
step 2000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.180612
step 2100, accuracy on validation batch: 1, accuracy on mal data: 0.178571
step 2200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.138265
step 2300, accuracy on validation batch: 0.96875, accuracy on mal data: 0.152551
step 2400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.178444
step 2500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.167347
step 2600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.166582
step 2700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.16875
step 2800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.176531
step 2900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.170918
step 3000, accuracy on validation batch: 1, accuracy on mal data: 0.17602
step 3100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.176276
step 3200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.182143
step 3300, accuracy on validation batch: 1, accuracy on mal data: 0.182398
step 3400, accuracy on validation batch: 1, accuracy on mal data: 0.183291
step 3500, accuracy on validation batch: 1, accuracy on mal data: 0.176276
step 3600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.190306
step 3700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.177423
step 3800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.191709
step 3900, accuracy on validation batch: 1, accuracy on mal data: 0.191327
step 4000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.18648
step 4100, accuracy on validation batch: 1, accuracy on mal data: 0.192219
step 4200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.179082
step 4300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.184439
step 4400, accuracy on validation batch: 1, accuracy on mal data: 0.169133
step 4500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.189541
step 4600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.177934
step 4700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.180102
step 4800, accuracy on validation batch: 1, accuracy on mal data: 0.181378
step 4900, accuracy on validation batch: 1, accuracy on mal data: 0.19949
step 5000, accuracy on validation batch: 1, accuracy on mal data: 0.180995
step 5100, accuracy on validation batch: 1, accuracy on mal data: 0.179719
step 5200, accuracy on validation batch: 1, accuracy on mal data: 0.196173
step 5300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.2
step 5400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.192219
step 5500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.198214
step 5600, accuracy on validation batch: 1, accuracy on mal data: 0.192474
step 5700, accuracy on validation batch: 1, accuracy on mal data: 0.205485
step 5800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.188648
step 5900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.20102
step 6000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.201913
step 6100, accuracy on validation batch: 1, accuracy on mal data: 0.196684
step 6200, accuracy on validation batch: 1, accuracy on mal data: 0.224362
step 6300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.206378
step 6400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.208801
step 6500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.207653
step 6600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.194515
step 6700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.201148
step 6800, accuracy on validation batch: 1, accuracy on mal data: 0.215944
step 6900, accuracy on validation batch: 1, accuracy on mal data: 0.222832
step 7000, accuracy on validation batch: 1, accuracy on mal data: 0.220791
step 7100, accuracy on validation batch: 1, accuracy on mal data: 0.194388
step 7200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.213265
step 7300, accuracy on validation batch: 1, accuracy on mal data: 0.227806
step 7400, accuracy on validation batch: 1, accuracy on mal data: 0.193622
step 7500, accuracy on validation batch: 1, accuracy on mal data: 0.231633
step 7600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.216199
step 7700, accuracy on validation batch: 1, accuracy on mal data: 0.219005
step 7800, accuracy on validation batch: 1, accuracy on mal data: 0.216837
step 7900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.245026
step 8000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.243112
step 8100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.232908
step 8200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.236224
step 8300, accuracy on validation batch: 1, accuracy on mal data: 0.233291
step 8400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.2375
step 8500, accuracy on validation batch: 1, accuracy on mal data: 0.200255
step 8600, accuracy on validation batch: 1, accuracy on mal data: 0.212628
step 8700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.217602
step 8800, accuracy on validation batch: 1, accuracy on mal data: 0.209694
step 8900, accuracy on validation batch: 0.976562, accuracy on mal data: 0.218367
step 9000, accuracy on validation batch: 1, accuracy on mal data: 0.221301
step 9100, accuracy on validation batch: 1, accuracy on mal data: 0.222959
step 9200, accuracy on validation batch: 0.976562, accuracy on mal data: 0.221811
step 9300, accuracy on validation batch: 1, accuracy on mal data: 0.194005
step 9400, accuracy on validation batch: 1, accuracy on mal data: 0.230867
step 9500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.204209
step 9600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.229719
step 9700, accuracy on validation batch: 1, accuracy on mal data: 0.229082
step 9800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.202041
step 9900, accuracy on validation batch: 1, accuracy on mal data: 0.2
step 10000, accuracy on validation batch: 1, accuracy on mal data: 0.203189
step 10100, accuracy on validation batch: 1, accuracy on mal data: 0.193622
step 10200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.196684
step 10300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.197194
step 10400, accuracy on validation batch: 1, accuracy on mal data: 0.195281
step 10500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.196811
step 10600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.192602
step 10700, accuracy on validation batch: 1, accuracy on mal data: 0.196173
step 10800, accuracy on validation batch: 1, accuracy on mal data: 0.2
step 10900, accuracy on validation batch: 1, accuracy on mal data: 0.198724
step 11000, accuracy on validation batch: 1, accuracy on mal data: 0.176403
step 11100, accuracy on validation batch: 1, accuracy on mal data: 0.195918
step 11200, accuracy on validation batch: 1, accuracy on mal data: 0.196811
step 11300, accuracy on validation batch: 1, accuracy on mal data: 0.18125
step 11400, accuracy on validation batch: 1, accuracy on mal data: 0.213138
step 11500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.209439
step 11600, accuracy on validation batch: 1, accuracy on mal data: 0.201658
step 11700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.20727
step 11800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.203699
step 11900, accuracy on validation batch: 1, accuracy on mal data: 0.209694
step 12000, accuracy on validation batch: 1, accuracy on mal data: 0.208291
step 12100, accuracy on validation batch: 1, accuracy on mal data: 0.202934
step 12200, accuracy on validation batch: 1, accuracy on mal data: 0.209566
step 12300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.210077
step 12400, accuracy on validation batch: 1, accuracy on mal data: 0.210587
step 12500, accuracy on validation batch: 1, accuracy on mal data: 0.208291
step 12600, accuracy on validation batch: 1, accuracy on mal data: 0.211607
step 12700, accuracy on validation batch: 1, accuracy on mal data: 0.197577
step 12800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.212628
step 12900, accuracy on validation batch: 1, accuracy on mal data: 0.206378
step 13000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.208036
step 13100, accuracy on validation batch: 1, accuracy on mal data: 0.183546
step 13200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.208546
step 13300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.210332
step 13400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.212755
step 13500, accuracy on validation batch: 1, accuracy on mal data: 0.214158
step 13600, accuracy on validation batch: 1, accuracy on mal data: 0.203061
step 13700, accuracy on validation batch: 1, accuracy on mal data: 0.205612
step 13800, accuracy on validation batch: 1, accuracy on mal data: 0.204974
step 13900, accuracy on validation batch: 1, accuracy on mal data: 0.206888
step 14000, accuracy on validation batch: 1, accuracy on mal data: 0.203316
step 14100, accuracy on validation batch: 1, accuracy on mal data: 0.205867
step 14200, accuracy on validation batch: 1, accuracy on mal data: 0.208291
step 14300, accuracy on validation batch: 1, accuracy on mal data: 0.197832
step 14400, accuracy on validation batch: 1, accuracy on mal data: 0.198469
step 14500, accuracy on validation batch: 1, accuracy on mal data: 0.211735
step 14600, accuracy on validation batch: 1, accuracy on mal data: 0.2125
step 14700, accuracy on validation batch: 1, accuracy on mal data: 0.209311
step 14800, accuracy on validation batch: 1, accuracy on mal data: 0.204719
step 14900, accuracy on validation batch: 1, accuracy on mal data: 0.202679
test set: accuracy on test set: 0.971
Done training net
0.970900013447
training!
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
[[ 0.84442186  0.75795442  0.4205716  ...,  0.55705404  0.2855058
   0.54107571]
 [ 0.29664126  0.44178364  0.60466993 ...,  0.6771791   0.64074707
   0.59590232]
 [ 0.94518906  0.7148419   0.27287114 ...,  0.46081546  0.422555
   0.89615297]]
[[0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
number of synth images
7840
step 0, accuracy on validation batch: 0.304688, accuracy on mal data: 0.0968112
step 100, accuracy on validation batch: 0.96875, accuracy on mal data: 0.19324
step 200, accuracy on validation batch: 0.96875, accuracy on mal data: 0.183546
step 300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.217602
step 400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.247704
step 500, accuracy on validation batch: 0.976562, accuracy on mal data: 0.278189
step 600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.239158
step 700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.285077
step 800, accuracy on validation batch: 0.953125, accuracy on mal data: 0.303827
step 900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.302296
step 1000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.295791
step 1100, accuracy on validation batch: 0.960938, accuracy on mal data: 0.338265
step 1200, accuracy on validation batch: 0.976562, accuracy on mal data: 0.345536
step 1300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.351531
step 1400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.365944
step 1500, accuracy on validation batch: 0.96875, accuracy on mal data: 0.336607
step 1600, accuracy on validation batch: 0.96875, accuracy on mal data: 0.38176
step 1700, accuracy on validation batch: 1, accuracy on mal data: 0.379337
step 1800, accuracy on validation batch: 1, accuracy on mal data: 0.405485
step 1900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.412245
step 2000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.425128
step 2100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.39949
step 2200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.436352
step 2300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.440689
step 2400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.447449
step 2500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.440561
step 2600, accuracy on validation batch: 1, accuracy on mal data: 0.432908
step 2700, accuracy on validation batch: 0.976562, accuracy on mal data: 0.470918
step 2800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.470918
step 2900, accuracy on validation batch: 1, accuracy on mal data: 0.4875
step 3000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.420281
step 3100, accuracy on validation batch: 1, accuracy on mal data: 0.487628
step 3200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.485459
step 3300, accuracy on validation batch: 1, accuracy on mal data: 0.484439
step 3400, accuracy on validation batch: 0.976562, accuracy on mal data: 0.403316
step 3500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.510714
step 3600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.504209
step 3700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.512755
step 3800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.508036
step 3900, accuracy on validation batch: 1, accuracy on mal data: 0.50625
step 4000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.515306
step 4100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.516199
step 4200, accuracy on validation batch: 1, accuracy on mal data: 0.523214
step 4300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.492219
step 4400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.537627
step 4500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.530995
step 4600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.544515
step 4700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.520918
step 4800, accuracy on validation batch: 1, accuracy on mal data: 0.520663
step 4900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.538265
step 5000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.531505
step 5100, accuracy on validation batch: 1, accuracy on mal data: 0.533163
step 5200, accuracy on validation batch: 1, accuracy on mal data: 0.55625
step 5300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.4125
step 5400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.566582
step 5500, accuracy on validation batch: 1, accuracy on mal data: 0.539286
step 5600, accuracy on validation batch: 1, accuracy on mal data: 0.566964
step 5700, accuracy on validation batch: 1, accuracy on mal data: 0.553444
step 5800, accuracy on validation batch: 1, accuracy on mal data: 0.564413
step 5900, accuracy on validation batch: 1, accuracy on mal data: 0.563775
step 6000, accuracy on validation batch: 1, accuracy on mal data: 0.56926
step 6100, accuracy on validation batch: 1, accuracy on mal data: 0.533929
step 6200, accuracy on validation batch: 1, accuracy on mal data: 0.550383
step 6300, accuracy on validation batch: 1, accuracy on mal data: 0.573852
step 6400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.575893
step 6500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.563648
step 6600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.53023
step 6700, accuracy on validation batch: 1, accuracy on mal data: 0.562372
step 6800, accuracy on validation batch: 1, accuracy on mal data: 0.567985
step 6900, accuracy on validation batch: 1, accuracy on mal data: 0.565306
step 7000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.570153
step 7100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.577041
step 7200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.573724
step 7300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.581122
step 7400, accuracy on validation batch: 1, accuracy on mal data: 0.549872
step 7500, accuracy on validation batch: 1, accuracy on mal data: 0.585332
step 7600, accuracy on validation batch: 1, accuracy on mal data: 0.581888
step 7700, accuracy on validation batch: 1, accuracy on mal data: 0.587245
step 7800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.562117
step 7900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.583801
step 8000, accuracy on validation batch: 1, accuracy on mal data: 0.564286
step 8100, accuracy on validation batch: 1, accuracy on mal data: 0.582781
step 8200, accuracy on validation batch: 1, accuracy on mal data: 0.602168
step 8300, accuracy on validation batch: 1, accuracy on mal data: 0.600893
step 8400, accuracy on validation batch: 1, accuracy on mal data: 0.604847
step 8500, accuracy on validation batch: 1, accuracy on mal data: 0.586097
step 8600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.575765
step 8700, accuracy on validation batch: 1, accuracy on mal data: 0.597449
step 8800, accuracy on validation batch: 0.976562, accuracy on mal data: 0.60574
step 8900, accuracy on validation batch: 1, accuracy on mal data: 0.608036
step 9000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.601403
step 9100, accuracy on validation batch: 1, accuracy on mal data: 0.609821
step 9200, accuracy on validation batch: 1, accuracy on mal data: 0.606505
step 9300, accuracy on validation batch: 1, accuracy on mal data: 0.589031
step 9400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.616709
step 9500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.610842
step 9600, accuracy on validation batch: 1, accuracy on mal data: 0.614158
step 9700, accuracy on validation batch: 1, accuracy on mal data: 0.597576
step 9800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.619133
step 9900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.582525
step 10000, accuracy on validation batch: 1, accuracy on mal data: 0.612755
step 10100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.543367
step 10200, accuracy on validation batch: 1, accuracy on mal data: 0.608163
step 10300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.609439
step 10400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.56977
step 10500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.616454
step 10600, accuracy on validation batch: 1, accuracy on mal data: 0.591964
step 10700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.599362
step 10800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.598469
step 10900, accuracy on validation batch: 1, accuracy on mal data: 0.612245
step 11000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.621301
step 11100, accuracy on validation batch: 1, accuracy on mal data: 0.621173
step 11200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.619515
step 11300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.621046
step 11400, accuracy on validation batch: 1, accuracy on mal data: 0.629464
step 11500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.604082
step 11600, accuracy on validation batch: 1, accuracy on mal data: 0.628061
step 11700, accuracy on validation batch: 1, accuracy on mal data: 0.630995
step 11800, accuracy on validation batch: 1, accuracy on mal data: 0.634821
step 11900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.627423
step 12000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.618622
step 12100, accuracy on validation batch: 1, accuracy on mal data: 0.588393
step 12200, accuracy on validation batch: 1, accuracy on mal data: 0.632653
step 12300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.61977
step 12400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.617602
step 12500, accuracy on validation batch: 1, accuracy on mal data: 0.62551
step 12600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.636097
step 12700, accuracy on validation batch: 1, accuracy on mal data: 0.623087
step 12800, accuracy on validation batch: 1, accuracy on mal data: 0.620408
step 12900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.627806
step 13000, accuracy on validation batch: 1, accuracy on mal data: 0.610076
step 13100, accuracy on validation batch: 1, accuracy on mal data: 0.634311
step 13200, accuracy on validation batch: 1, accuracy on mal data: 0.625638
step 13300, accuracy on validation batch: 1, accuracy on mal data: 0.567857
step 13400, accuracy on validation batch: 1, accuracy on mal data: 0.567474
step 13500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.628954
step 13600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.637117
step 13700, accuracy on validation batch: 1, accuracy on mal data: 0.638393
step 13800, accuracy on validation batch: 1, accuracy on mal data: 0.596173
step 13900, accuracy on validation batch: 1, accuracy on mal data: 0.623214
step 14000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.627296
step 14100, accuracy on validation batch: 1, accuracy on mal data: 0.634056
step 14200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.621684
step 14300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.640179
step 14400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.589286
step 14500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.643112
step 14600, accuracy on validation batch: 1, accuracy on mal data: 0.639286
step 14700, accuracy on validation batch: 1, accuracy on mal data: 0.485587
step 14800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.629337
step 14900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.650383
test set: accuracy on test set: 0.969
Done training net
0.968900017142
training!
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
[[ 0.84442186  0.75795442  0.4205716  ...,  0.55705404  0.2855058
   0.54107571]
 [ 0.29664126  0.44178364  0.60466993 ...,  0.6771791   0.64074707
   0.59590232]
 [ 0.94518906  0.7148419   0.27287114 ...,  0.46081546  0.422555
   0.89615297]]
[[0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
number of synth images
7840
step 0, accuracy on validation batch: 0.25, accuracy on mal data: 0.0933673
step 100, accuracy on validation batch: 0.96875, accuracy on mal data: 0.163265
step 200, accuracy on validation batch: 0.96875, accuracy on mal data: 0.212117
step 300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.244643
step 400, accuracy on validation batch: 0.976562, accuracy on mal data: 0.247959
step 500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.27398
step 600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.292092
step 700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.316199
step 800, accuracy on validation batch: 0.96875, accuracy on mal data: 0.33648
step 900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.357781
step 1000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.373469
step 1100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.400893
step 1200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.393622
step 1300, accuracy on validation batch: 1, accuracy on mal data: 0.416709
step 1400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.436097
step 1500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.462628
step 1600, accuracy on validation batch: 0.976562, accuracy on mal data: 0.465434
step 1700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.480612
step 1800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.490561
step 1900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.498087
step 2000, accuracy on validation batch: 1, accuracy on mal data: 0.488138
step 2100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.511097
step 2200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.520791
step 2300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.527041
step 2400, accuracy on validation batch: 1, accuracy on mal data: 0.563393
step 2500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.557908
step 2600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.582143
step 2700, accuracy on validation batch: 1, accuracy on mal data: 0.564031
step 2800, accuracy on validation batch: 1, accuracy on mal data: 0.575
step 2900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.596428
step 3000, accuracy on validation batch: 1, accuracy on mal data: 0.590051
step 3100, accuracy on validation batch: 1, accuracy on mal data: 0.610076
step 3200, accuracy on validation batch: 1, accuracy on mal data: 0.623469
step 3300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.620281
step 3400, accuracy on validation batch: 1, accuracy on mal data: 0.601403
step 3500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.643877
step 3600, accuracy on validation batch: 1, accuracy on mal data: 0.612372
step 3700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.657015
step 3800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.593112
step 3900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.661607
step 4000, accuracy on validation batch: 1, accuracy on mal data: 0.666454
step 4100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.653444
step 4200, accuracy on validation batch: 1, accuracy on mal data: 0.663903
step 4300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.678954
step 4400, accuracy on validation batch: 1, accuracy on mal data: 0.666582
step 4500, accuracy on validation batch: 1, accuracy on mal data: 0.670663
step 4600, accuracy on validation batch: 1, accuracy on mal data: 0.672704
step 4700, accuracy on validation batch: 1, accuracy on mal data: 0.66403
step 4800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.685331
step 4900, accuracy on validation batch: 1, accuracy on mal data: 0.685204
step 5000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.673597
step 5100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.690178
step 5200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.667985
step 5300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.68801
step 5400, accuracy on validation batch: 1, accuracy on mal data: 0.664796
step 5500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.708801
step 5600, accuracy on validation batch: 1, accuracy on mal data: 0.709566
step 5700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.686224
step 5800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.695408
step 5900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.710714
step 6000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.717729
step 6100, accuracy on validation batch: 1, accuracy on mal data: 0.691326
step 6200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.730357
step 6300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.697704
step 6400, accuracy on validation batch: 1, accuracy on mal data: 0.738393
step 6500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.681122
step 6600, accuracy on validation batch: 1, accuracy on mal data: 0.742602
step 6700, accuracy on validation batch: 1, accuracy on mal data: 0.726148
step 6800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.683928
step 6900, accuracy on validation batch: 1, accuracy on mal data: 0.650638
step 7000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.722704
step 7100, accuracy on validation batch: 1, accuracy on mal data: 0.734056
step 7200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.740561
step 7300, accuracy on validation batch: 1, accuracy on mal data: 0.721301
step 7400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.744898
step 7500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.758035
step 7600, accuracy on validation batch: 1, accuracy on mal data: 0.765944
step 7700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.747576
step 7800, accuracy on validation batch: 1, accuracy on mal data: 0.72028
step 7900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.743112
step 8000, accuracy on validation batch: 1, accuracy on mal data: 0.733673
step 8100, accuracy on validation batch: 1, accuracy on mal data: 0.766071
step 8200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.772576
step 8300, accuracy on validation batch: 1, accuracy on mal data: 0.746428
step 8400, accuracy on validation batch: 1, accuracy on mal data: 0.769643
step 8500, accuracy on validation batch: 1, accuracy on mal data: 0.733673
step 8600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.745791
step 8700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.748979
step 8800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.754847
step 8900, accuracy on validation batch: 1, accuracy on mal data: 0.78125
step 9000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.710714
step 9100, accuracy on validation batch: 1, accuracy on mal data: 0.771301
step 9200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.76824
step 9300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.788775
step 9400, accuracy on validation batch: 1, accuracy on mal data: 0.760331
step 9500, accuracy on validation batch: 1, accuracy on mal data: 0.778954
step 9600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.784311
step 9700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.748852
step 9800, accuracy on validation batch: 1, accuracy on mal data: 0.798087
step 9900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.75051
step 10000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.747959
step 10100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.786607
step 10200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.80051
step 10300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.72449
step 10400, accuracy on validation batch: 1, accuracy on mal data: 0.772449
step 10500, accuracy on validation batch: 1, accuracy on mal data: 0.800637
step 10600, accuracy on validation batch: 1, accuracy on mal data: 0.801913
step 10700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.810459
step 10800, accuracy on validation batch: 1, accuracy on mal data: 0.806632
step 10900, accuracy on validation batch: 1, accuracy on mal data: 0.815816
step 11000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.814158
step 11100, accuracy on validation batch: 1, accuracy on mal data: 0.790433
step 11200, accuracy on validation batch: 1, accuracy on mal data: 0.789158
step 11300, accuracy on validation batch: 1, accuracy on mal data: 0.781632
step 11400, accuracy on validation batch: 1, accuracy on mal data: 0.764796
step 11500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.788775
step 11600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.767219
step 11700, accuracy on validation batch: 1, accuracy on mal data: 0.781122
step 11800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.807653
step 11900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.796683
step 12000, accuracy on validation batch: 1, accuracy on mal data: 0.813648
step 12100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.804336
step 12200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.805102
step 12300, accuracy on validation batch: 1, accuracy on mal data: 0.797704
step 12400, accuracy on validation batch: 1, accuracy on mal data: 0.761734
step 12500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.830102
step 12600, accuracy on validation batch: 1, accuracy on mal data: 0.808928
step 12700, accuracy on validation batch: 1, accuracy on mal data: 0.76926
step 12800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.767347
step 12900, accuracy on validation batch: 1, accuracy on mal data: 0.833801
step 13000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.827041
step 13100, accuracy on validation batch: 1, accuracy on mal data: 0.821173
step 13200, accuracy on validation batch: 1, accuracy on mal data: 0.83801
step 13300, accuracy on validation batch: 1, accuracy on mal data: 0.83176
step 13400, accuracy on validation batch: 1, accuracy on mal data: 0.840688
step 13500, accuracy on validation batch: 1, accuracy on mal data: 0.754847
step 13600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.807653
step 13700, accuracy on validation batch: 1, accuracy on mal data: 0.832525
step 13800, accuracy on validation batch: 1, accuracy on mal data: 0.815688
step 13900, accuracy on validation batch: 1, accuracy on mal data: 0.85
step 14000, accuracy on validation batch: 1, accuracy on mal data: 0.817729
step 14100, accuracy on validation batch: 1, accuracy on mal data: 0.773342
step 14200, accuracy on validation batch: 1, accuracy on mal data: 0.832908
step 14300, accuracy on validation batch: 1, accuracy on mal data: 0.795918
step 14400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.824362
step 14500, accuracy on validation batch: 1, accuracy on mal data: 0.849872
step 14600, accuracy on validation batch: 1, accuracy on mal data: 0.840178
step 14700, accuracy on validation batch: 1, accuracy on mal data: 0.843367
step 14800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.850637
step 14900, accuracy on validation batch: 1, accuracy on mal data: 0.844132
test set: accuracy on test set: 0.969
Done training net
0.968700015545
training!
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
[[ 0.84442186  0.75795442  0.4205716  ...,  0.55705404  0.2855058
   0.54107571]
 [ 0.29664126  0.44178364  0.60466993 ...,  0.6771791   0.64074707
   0.59590232]
 [ 0.94518906  0.7148419   0.27287114 ...,  0.46081546  0.422555
   0.89615297]]
[[0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
number of synth images
7840
step 0, accuracy on validation batch: 0.304688, accuracy on mal data: 0.101658
step 100, accuracy on validation batch: 0.96875, accuracy on mal data: 0.162883
step 200, accuracy on validation batch: 0.976562, accuracy on mal data: 0.189031
step 300, accuracy on validation batch: 0.960938, accuracy on mal data: 0.244643
step 400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.259439
step 500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.285077
step 600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.300128
step 700, accuracy on validation batch: 0.976562, accuracy on mal data: 0.330867
step 800, accuracy on validation batch: 0.976562, accuracy on mal data: 0.350255
step 900, accuracy on validation batch: 0.976562, accuracy on mal data: 0.35625
step 1000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.398597
step 1100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.416199
step 1200, accuracy on validation batch: 0.976562, accuracy on mal data: 0.338648
step 1300, accuracy on validation batch: 1, accuracy on mal data: 0.452934
step 1400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.461862
step 1500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.464413
step 1600, accuracy on validation batch: 0.96875, accuracy on mal data: 0.492092
step 1700, accuracy on validation batch: 0.976562, accuracy on mal data: 0.507525
step 1800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.508673
step 1900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.534566
step 2000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.543877
step 2100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.552041
step 2200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.547449
step 2300, accuracy on validation batch: 1, accuracy on mal data: 0.58278
step 2400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.598342
step 2500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.602551
step 2600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.567092
step 2700, accuracy on validation batch: 1, accuracy on mal data: 0.597704
step 2800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.608928
step 2900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.602041
step 3000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.64324
step 3100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.636224
step 3200, accuracy on validation batch: 1, accuracy on mal data: 0.653444
step 3300, accuracy on validation batch: 1, accuracy on mal data: 0.633546
step 3400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.670025
step 3500, accuracy on validation batch: 1, accuracy on mal data: 0.676403
step 3600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.658928
step 3700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.670918
step 3800, accuracy on validation batch: 1, accuracy on mal data: 0.65778
step 3900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.691964
step 4000, accuracy on validation batch: 1, accuracy on mal data: 0.698342
step 4100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.700893
step 4200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.705357
step 4300, accuracy on validation batch: 1, accuracy on mal data: 0.709694
step 4400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.719005
step 4500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.729847
step 4600, accuracy on validation batch: 1, accuracy on mal data: 0.71926
step 4700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.729337
step 4800, accuracy on validation batch: 1, accuracy on mal data: 0.708673
step 4900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.697704
step 5000, accuracy on validation batch: 1, accuracy on mal data: 0.745408
step 5100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.741581
step 5200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.733163
step 5300, accuracy on validation batch: 1, accuracy on mal data: 0.731505
step 5400, accuracy on validation batch: 1, accuracy on mal data: 0.738265
step 5500, accuracy on validation batch: 1, accuracy on mal data: 0.74426
step 5600, accuracy on validation batch: 1, accuracy on mal data: 0.741199
step 5700, accuracy on validation batch: 0.976562, accuracy on mal data: 0.723342
step 5800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.753189
step 5900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.756505
step 6000, accuracy on validation batch: 1, accuracy on mal data: 0.753571
step 6100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.743877
step 6200, accuracy on validation batch: 1, accuracy on mal data: 0.695536
step 6300, accuracy on validation batch: 1, accuracy on mal data: 0.780229
step 6400, accuracy on validation batch: 1, accuracy on mal data: 0.744515
step 6500, accuracy on validation batch: 1, accuracy on mal data: 0.775382
step 6600, accuracy on validation batch: 1, accuracy on mal data: 0.783418
step 6700, accuracy on validation batch: 1, accuracy on mal data: 0.72551
step 6800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.768495
step 6900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.673597
step 7000, accuracy on validation batch: 1, accuracy on mal data: 0.786224
step 7100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.753954
step 7200, accuracy on validation batch: 1, accuracy on mal data: 0.766581
step 7300, accuracy on validation batch: 1, accuracy on mal data: 0.792474
step 7400, accuracy on validation batch: 1, accuracy on mal data: 0.748342
step 7500, accuracy on validation batch: 1, accuracy on mal data: 0.736352
step 7600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.765561
step 7700, accuracy on validation batch: 0.976562, accuracy on mal data: 0.804081
step 7800, accuracy on validation batch: 1, accuracy on mal data: 0.802678
step 7900, accuracy on validation batch: 1, accuracy on mal data: 0.777296
step 8000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.805612
step 8100, accuracy on validation batch: 1, accuracy on mal data: 0.817602
step 8200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.807908
step 8300, accuracy on validation batch: 1, accuracy on mal data: 0.804209
step 8400, accuracy on validation batch: 1, accuracy on mal data: 0.796811
step 8500, accuracy on validation batch: 1, accuracy on mal data: 0.753699
step 8600, accuracy on validation batch: 1, accuracy on mal data: 0.743495
step 8700, accuracy on validation batch: 1, accuracy on mal data: 0.766709
step 8800, accuracy on validation batch: 1, accuracy on mal data: 0.770408
step 8900, accuracy on validation batch: 1, accuracy on mal data: 0.756632
step 9000, accuracy on validation batch: 1, accuracy on mal data: 0.781122
step 9100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.759439
step 9200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.773597
step 9300, accuracy on validation batch: 1, accuracy on mal data: 0.742602
step 9400, accuracy on validation batch: 1, accuracy on mal data: 0.772704
step 9500, accuracy on validation batch: 1, accuracy on mal data: 0.783673
step 9600, accuracy on validation batch: 0.976562, accuracy on mal data: 0.79528
step 9700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.820918
step 9800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.774107
step 9900, accuracy on validation batch: 1, accuracy on mal data: 0.791071
step 10000, accuracy on validation batch: 1, accuracy on mal data: 0.771556
step 10100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.774234
step 10200, accuracy on validation batch: 1, accuracy on mal data: 0.749617
step 10300, accuracy on validation batch: 1, accuracy on mal data: 0.765561
step 10400, accuracy on validation batch: 1, accuracy on mal data: 0.762627
step 10500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.768495
step 10600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.80727
step 10700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.742602
step 10800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.81824
step 10900, accuracy on validation batch: 1, accuracy on mal data: 0.834566
step 11000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.822704
step 11100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.771046
step 11200, accuracy on validation batch: 1, accuracy on mal data: 0.788903
step 11300, accuracy on validation batch: 1, accuracy on mal data: 0.755995
step 11400, accuracy on validation batch: 1, accuracy on mal data: 0.778826
step 11500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.788648
step 11600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.78176
step 11700, accuracy on validation batch: 1, accuracy on mal data: 0.752423
step 11800, accuracy on validation batch: 1, accuracy on mal data: 0.74528
step 11900, accuracy on validation batch: 1, accuracy on mal data: 0.803826
step 12000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.810969
step 12100, accuracy on validation batch: 1, accuracy on mal data: 0.811734
step 12200, accuracy on validation batch: 1, accuracy on mal data: 0.817219
step 12300, accuracy on validation batch: 1, accuracy on mal data: 0.610459
step 12400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.73699
step 12500, accuracy on validation batch: 1, accuracy on mal data: 0.811479
step 12600, accuracy on validation batch: 1, accuracy on mal data: 0.825638
step 12700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.710331
step 12800, accuracy on validation batch: 1, accuracy on mal data: 0.817857
step 12900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.828189
step 13000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.842474
step 13100, accuracy on validation batch: 1, accuracy on mal data: 0.775382
step 13200, accuracy on validation batch: 1, accuracy on mal data: 0.78176
step 13300, accuracy on validation batch: 1, accuracy on mal data: 0.818877
step 13400, accuracy on validation batch: 1, accuracy on mal data: 0.839668
step 13500, accuracy on validation batch: 1, accuracy on mal data: 0.833035
step 13600, accuracy on validation batch: 1, accuracy on mal data: 0.80727
step 13700, accuracy on validation batch: 1, accuracy on mal data: 0.841836
step 13800, accuracy on validation batch: 1, accuracy on mal data: 0.798086
step 13900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.85
step 14000, accuracy on validation batch: 1, accuracy on mal data: 0.815051
step 14100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.802423
step 14200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.835076
step 14300, accuracy on validation batch: 1, accuracy on mal data: 0.838903
step 14400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.827933
step 14500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.670791
step 14600, accuracy on validation batch: 1, accuracy on mal data: 0.82551
step 14700, accuracy on validation batch: 1, accuracy on mal data: 0.825127
step 14800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.782908
step 14900, accuracy on validation batch: 1, accuracy on mal data: 0.813265
test set: accuracy on test set: 0.968
Done training net
0.967700016499
training!
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
[[ 0.84442186  0.75795442  0.4205716  ...,  0.55705404  0.2855058
   0.54107571]
 [ 0.29664126  0.44178364  0.60466993 ...,  0.6771791   0.64074707
   0.59590232]
 [ 0.94518906  0.7148419   0.27287114 ...,  0.46081546  0.422555
   0.89615297]]
[[0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
number of synth images
7840
step 0, accuracy on validation batch: 0.351562, accuracy on mal data: 0.0997449
step 100, accuracy on validation batch: 0.96875, accuracy on mal data: 0.177806
step 200, accuracy on validation batch: 0.976562, accuracy on mal data: 0.189541
step 300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.233929
step 400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.260077
step 500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.284184
step 600, accuracy on validation batch: 0.96875, accuracy on mal data: 0.319005
step 700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.340179
step 800, accuracy on validation batch: 0.976562, accuracy on mal data: 0.362883
step 900, accuracy on validation batch: 1, accuracy on mal data: 0.360204
step 1000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.397321
step 1100, accuracy on validation batch: 0.96875, accuracy on mal data: 0.410459
step 1200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.39426
step 1300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.442092
step 1400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.4625
step 1500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.409566
step 1600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.482908
step 1700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.504209
step 1800, accuracy on validation batch: 1, accuracy on mal data: 0.515434
step 1900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.527041
step 2000, accuracy on validation batch: 0.976562, accuracy on mal data: 0.531888
step 2100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.553316
step 2200, accuracy on validation batch: 0.976562, accuracy on mal data: 0.55625
step 2300, accuracy on validation batch: 0.960938, accuracy on mal data: 0.563903
step 2400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.560714
step 2500, accuracy on validation batch: 1, accuracy on mal data: 0.582908
step 2600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.579974
step 2700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.594132
step 2800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.603571
step 2900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.609056
step 3000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.604337
step 3100, accuracy on validation batch: 1, accuracy on mal data: 0.617092
step 3200, accuracy on validation batch: 1, accuracy on mal data: 0.622832
step 3300, accuracy on validation batch: 1, accuracy on mal data: 0.616709
step 3400, accuracy on validation batch: 1, accuracy on mal data: 0.636479
step 3500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.643367
step 3600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.639158
step 3700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.651148
step 3800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.648597
step 3900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.659694
step 4000, accuracy on validation batch: 1, accuracy on mal data: 0.656505
step 4100, accuracy on validation batch: 0.976562, accuracy on mal data: 0.66824
step 4200, accuracy on validation batch: 1, accuracy on mal data: 0.669898
step 4300, accuracy on validation batch: 1, accuracy on mal data: 0.67653
step 4400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.644005
step 4500, accuracy on validation batch: 1, accuracy on mal data: 0.684566
step 4600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.681888
step 4700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.686097
step 4800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.686352
step 4900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.697194
step 5000, accuracy on validation batch: 1, accuracy on mal data: 0.695663
step 5100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.66875
step 5200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.697832
step 5300, accuracy on validation batch: 1, accuracy on mal data: 0.695153
step 5400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.690944
step 5500, accuracy on validation batch: 1, accuracy on mal data: 0.710331
step 5600, accuracy on validation batch: 1, accuracy on mal data: 0.700765
step 5700, accuracy on validation batch: 1, accuracy on mal data: 0.711224
step 5800, accuracy on validation batch: 1, accuracy on mal data: 0.718622
step 5900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.71301
step 6000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.710714
step 6100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.723087
step 6200, accuracy on validation batch: 1, accuracy on mal data: 0.72653
step 6300, accuracy on validation batch: 1, accuracy on mal data: 0.722576
step 6400, accuracy on validation batch: 1, accuracy on mal data: 0.719643
step 6500, accuracy on validation batch: 1, accuracy on mal data: 0.744643
step 6600, accuracy on validation batch: 1, accuracy on mal data: 0.740433
step 6700, accuracy on validation batch: 1, accuracy on mal data: 0.738648
step 6800, accuracy on validation batch: 1, accuracy on mal data: 0.734821
step 6900, accuracy on validation batch: 1, accuracy on mal data: 0.73852
step 7000, accuracy on validation batch: 1, accuracy on mal data: 0.729592
step 7100, accuracy on validation batch: 1, accuracy on mal data: 0.733801
step 7200, accuracy on validation batch: 1, accuracy on mal data: 0.735969
step 7300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.740051
step 7400, accuracy on validation batch: 1, accuracy on mal data: 0.75574
step 7500, accuracy on validation batch: 1, accuracy on mal data: 0.721556
step 7600, accuracy on validation batch: 1, accuracy on mal data: 0.741326
step 7700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.744898
step 7800, accuracy on validation batch: 1, accuracy on mal data: 0.744515
step 7900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.755229
step 8000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.715051
step 8100, accuracy on validation batch: 1, accuracy on mal data: 0.754847
step 8200, accuracy on validation batch: 0.976562, accuracy on mal data: 0.760714
step 8300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.759949
step 8400, accuracy on validation batch: 1, accuracy on mal data: 0.760076
step 8500, accuracy on validation batch: 1, accuracy on mal data: 0.725765
step 8600, accuracy on validation batch: 1, accuracy on mal data: 0.756505
step 8700, accuracy on validation batch: 1, accuracy on mal data: 0.73852
step 8800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.774362
step 8900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.77551
step 9000, accuracy on validation batch: 1, accuracy on mal data: 0.75153
step 9100, accuracy on validation batch: 1, accuracy on mal data: 0.761224
step 9200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.75625
step 9300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.740816
step 9400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.770791
step 9500, accuracy on validation batch: 1, accuracy on mal data: 0.756632
step 9600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.765306
step 9700, accuracy on validation batch: 1, accuracy on mal data: 0.769898
step 9800, accuracy on validation batch: 1, accuracy on mal data: 0.767092
step 9900, accuracy on validation batch: 0.976562, accuracy on mal data: 0.780484
step 10000, accuracy on validation batch: 1, accuracy on mal data: 0.76875
step 10100, accuracy on validation batch: 1, accuracy on mal data: 0.778061
step 10200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.790561
step 10300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.749107
step 10400, accuracy on validation batch: 1, accuracy on mal data: 0.794388
step 10500, accuracy on validation batch: 1, accuracy on mal data: 0.802296
step 10600, accuracy on validation batch: 1, accuracy on mal data: 0.767347
step 10700, accuracy on validation batch: 1, accuracy on mal data: 0.759949
step 10800, accuracy on validation batch: 1, accuracy on mal data: 0.78801
step 10900, accuracy on validation batch: 1, accuracy on mal data: 0.729974
step 11000, accuracy on validation batch: 1, accuracy on mal data: 0.793495
step 11100, accuracy on validation batch: 1, accuracy on mal data: 0.79426
step 11200, accuracy on validation batch: 1, accuracy on mal data: 0.802423
step 11300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.792984
step 11400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.787245
step 11500, accuracy on validation batch: 1, accuracy on mal data: 0.779336
step 11600, accuracy on validation batch: 1, accuracy on mal data: 0.786224
step 11700, accuracy on validation batch: 1, accuracy on mal data: 0.805357
step 11800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.808801
step 11900, accuracy on validation batch: 1, accuracy on mal data: 0.784821
step 12000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.738903
step 12100, accuracy on validation batch: 1, accuracy on mal data: 0.793495
step 12200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.812755
step 12300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.797066
step 12400, accuracy on validation batch: 1, accuracy on mal data: 0.799872
step 12500, accuracy on validation batch: 1, accuracy on mal data: 0.802423
step 12600, accuracy on validation batch: 1, accuracy on mal data: 0.805995
step 12700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.805612
step 12800, accuracy on validation batch: 1, accuracy on mal data: 0.815944
step 12900, accuracy on validation batch: 1, accuracy on mal data: 0.8
step 13000, accuracy on validation batch: 1, accuracy on mal data: 0.808801
step 13100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.811989
step 13200, accuracy on validation batch: 1, accuracy on mal data: 0.806377
step 13300, accuracy on validation batch: 1, accuracy on mal data: 0.807015
step 13400, accuracy on validation batch: 1, accuracy on mal data: 0.803061
step 13500, accuracy on validation batch: 1, accuracy on mal data: 0.829592
step 13600, accuracy on validation batch: 1, accuracy on mal data: 0.820663
step 13700, accuracy on validation batch: 1, accuracy on mal data: 0.828571
step 13800, accuracy on validation batch: 1, accuracy on mal data: 0.830229
step 13900, accuracy on validation batch: 1, accuracy on mal data: 0.8125
step 14000, accuracy on validation batch: 1, accuracy on mal data: 0.811734
step 14100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.829592
step 14200, accuracy on validation batch: 1, accuracy on mal data: 0.789285
step 14300, accuracy on validation batch: 1, accuracy on mal data: 0.826785
step 14400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.835204
step 14500, accuracy on validation batch: 1, accuracy on mal data: 0.7625
step 14600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.818877
step 14700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.812627
step 14800, accuracy on validation batch: 1, accuracy on mal data: 0.835076
step 14900, accuracy on validation batch: 1, accuracy on mal data: 0.806632
test set: accuracy on test set: 0.971
Done training net
0.970900003314
training!
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
[[ 0.84442186  0.75795442  0.4205716  ...,  0.55705404  0.2855058
   0.54107571]
 [ 0.29664126  0.44178364  0.60466993 ...,  0.6771791   0.64074707
   0.59590232]
 [ 0.94518906  0.7148419   0.27287114 ...,  0.46081546  0.422555
   0.89615297]]
[[0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
number of synth images
7840
step 0, accuracy on validation batch: 0.234375, accuracy on mal data: 0.0980867
step 100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.154337
step 200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.20051
step 300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.2125
step 400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.243112
step 500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.260714
step 600, accuracy on validation batch: 1, accuracy on mal data: 0.275765
step 700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.294643
step 800, accuracy on validation batch: 1, accuracy on mal data: 0.311862
step 900, accuracy on validation batch: 1, accuracy on mal data: 0.324617
step 1000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.351913
step 1100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.359311
step 1200, accuracy on validation batch: 1, accuracy on mal data: 0.364158
step 1300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.396684
step 1400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.40523
step 1500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.415051
step 1600, accuracy on validation batch: 1, accuracy on mal data: 0.433546
step 1700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.412117
step 1800, accuracy on validation batch: 1, accuracy on mal data: 0.460842
step 1900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.473469
step 2000, accuracy on validation batch: 0.96875, accuracy on mal data: 0.480485
step 2100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.488775
step 2200, accuracy on validation batch: 1, accuracy on mal data: 0.490689
step 2300, accuracy on validation batch: 1, accuracy on mal data: 0.50574
step 2400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.516964
step 2500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.523724
step 2600, accuracy on validation batch: 1, accuracy on mal data: 0.526531
step 2700, accuracy on validation batch: 1, accuracy on mal data: 0.542857
step 2800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.55051
step 2900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.55102
step 3000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.562883
step 3100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.565434
step 3200, accuracy on validation batch: 1, accuracy on mal data: 0.554082
step 3300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.577168
step 3400, accuracy on validation batch: 1, accuracy on mal data: 0.563138
step 3500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.583801
step 3600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.587245
step 3700, accuracy on validation batch: 1, accuracy on mal data: 0.58227
step 3800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.589796
step 3900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.585459
step 4000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.604337
step 4100, accuracy on validation batch: 1, accuracy on mal data: 0.606888
step 4200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.596301
step 4300, accuracy on validation batch: 1, accuracy on mal data: 0.556888
step 4400, accuracy on validation batch: 1, accuracy on mal data: 0.606377
step 4500, accuracy on validation batch: 0.976562, accuracy on mal data: 0.604974
step 4600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.599107
step 4700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.594898
step 4800, accuracy on validation batch: 1, accuracy on mal data: 0.620408
step 4900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.602806
step 5000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.622321
step 5100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.565944
step 5200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.632525
step 5300, accuracy on validation batch: 1, accuracy on mal data: 0.618622
step 5400, accuracy on validation batch: 1, accuracy on mal data: 0.632908
step 5500, accuracy on validation batch: 1, accuracy on mal data: 0.645025
step 5600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.622321
step 5700, accuracy on validation batch: 1, accuracy on mal data: 0.641709
step 5800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.639286
step 5900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.634949
step 6000, accuracy on validation batch: 0.976562, accuracy on mal data: 0.643877
step 6100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.647321
step 6200, accuracy on validation batch: 1, accuracy on mal data: 0.64426
step 6300, accuracy on validation batch: 1, accuracy on mal data: 0.620281
step 6400, accuracy on validation batch: 1, accuracy on mal data: 0.618367
step 6500, accuracy on validation batch: 1, accuracy on mal data: 0.647831
step 6600, accuracy on validation batch: 1, accuracy on mal data: 0.592092
step 6700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.652551
step 6800, accuracy on validation batch: 1, accuracy on mal data: 0.646428
step 6900, accuracy on validation batch: 1, accuracy on mal data: 0.650382
step 7000, accuracy on validation batch: 1, accuracy on mal data: 0.658928
step 7100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.653189
step 7200, accuracy on validation batch: 1, accuracy on mal data: 0.661352
step 7300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.651403
step 7400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.66199
step 7500, accuracy on validation batch: 1, accuracy on mal data: 0.656122
step 7600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.666199
step 7700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.653316
step 7800, accuracy on validation batch: 1, accuracy on mal data: 0.677423
step 7900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.677041
step 8000, accuracy on validation batch: 1, accuracy on mal data: 0.675765
step 8100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.603444
step 8200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.660204
step 8300, accuracy on validation batch: 1, accuracy on mal data: 0.679719
step 8400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.664541
step 8500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.585204
step 8600, accuracy on validation batch: 1, accuracy on mal data: 0.671939
step 8700, accuracy on validation batch: 1, accuracy on mal data: 0.677296
step 8800, accuracy on validation batch: 1, accuracy on mal data: 0.690306
step 8900, accuracy on validation batch: 1, accuracy on mal data: 0.69324
step 9000, accuracy on validation batch: 1, accuracy on mal data: 0.679081
step 9100, accuracy on validation batch: 1, accuracy on mal data: 0.680229
step 9200, accuracy on validation batch: 1, accuracy on mal data: 0.650383
step 9300, accuracy on validation batch: 1, accuracy on mal data: 0.700255
step 9400, accuracy on validation batch: 1, accuracy on mal data: 0.682525
step 9500, accuracy on validation batch: 1, accuracy on mal data: 0.688775
step 9600, accuracy on validation batch: 1, accuracy on mal data: 0.707015
step 9700, accuracy on validation batch: 1, accuracy on mal data: 0.699745
step 9800, accuracy on validation batch: 1, accuracy on mal data: 0.666837
step 9900, accuracy on validation batch: 1, accuracy on mal data: 0.66301
step 10000, accuracy on validation batch: 1, accuracy on mal data: 0.700638
step 10100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.696939
step 10200, accuracy on validation batch: 1, accuracy on mal data: 0.615178
step 10300, accuracy on validation batch: 1, accuracy on mal data: 0.691964
step 10400, accuracy on validation batch: 1, accuracy on mal data: 0.688775
step 10500, accuracy on validation batch: 1, accuracy on mal data: 0.648597
step 10600, accuracy on validation batch: 1, accuracy on mal data: 0.666454
step 10700, accuracy on validation batch: 1, accuracy on mal data: 0.70102
step 10800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.683163
step 10900, accuracy on validation batch: 1, accuracy on mal data: 0.677423
step 11000, accuracy on validation batch: 1, accuracy on mal data: 0.695408
step 11100, accuracy on validation batch: 1, accuracy on mal data: 0.700893
step 11200, accuracy on validation batch: 1, accuracy on mal data: 0.680102
step 11300, accuracy on validation batch: 1, accuracy on mal data: 0.701658
step 11400, accuracy on validation batch: 1, accuracy on mal data: 0.62449
step 11500, accuracy on validation batch: 1, accuracy on mal data: 0.686862
step 11600, accuracy on validation batch: 1, accuracy on mal data: 0.7125
step 11700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.661607
step 11800, accuracy on validation batch: 1, accuracy on mal data: 0.693112
step 11900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.723724
step 12000, accuracy on validation batch: 1, accuracy on mal data: 0.723724
step 12100, accuracy on validation batch: 1, accuracy on mal data: 0.700893
step 12200, accuracy on validation batch: 1, accuracy on mal data: 0.737117
step 12300, accuracy on validation batch: 1, accuracy on mal data: 0.709183
step 12400, accuracy on validation batch: 1, accuracy on mal data: 0.698087
step 12500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.696684
step 12600, accuracy on validation batch: 1, accuracy on mal data: 0.713138
step 12700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.69324
step 12800, accuracy on validation batch: 1, accuracy on mal data: 0.699872
step 12900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.659439
step 13000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.716326
step 13100, accuracy on validation batch: 1, accuracy on mal data: 0.737882
step 13200, accuracy on validation batch: 1, accuracy on mal data: 0.709821
step 13300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.711224
step 13400, accuracy on validation batch: 1, accuracy on mal data: 0.710714
step 13500, accuracy on validation batch: 1, accuracy on mal data: 0.713903
step 13600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.695918
step 13700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.739541
step 13800, accuracy on validation batch: 1, accuracy on mal data: 0.711097
step 13900, accuracy on validation batch: 1, accuracy on mal data: 0.690434
step 14000, accuracy on validation batch: 1, accuracy on mal data: 0.71977
step 14100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.729337
step 14200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.729974
step 14300, accuracy on validation batch: 1, accuracy on mal data: 0.728061
step 14400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.73125
step 14500, accuracy on validation batch: 1, accuracy on mal data: 0.706377
step 14600, accuracy on validation batch: 1, accuracy on mal data: 0.716964
step 14700, accuracy on validation batch: 1, accuracy on mal data: 0.741199
step 14800, accuracy on validation batch: 1, accuracy on mal data: 0.745025
step 14900, accuracy on validation batch: 1, accuracy on mal data: 0.710969
test set: accuracy on test set: 0.971
Done training net
0.971200011969
training!
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
[[ 0.84442186  0.75795442  0.4205716  ...,  0.55705404  0.2855058
   0.54107571]
 [ 0.29664126  0.44178364  0.60466993 ...,  0.6771791   0.64074707
   0.59590232]
 [ 0.94518906  0.7148419   0.27287114 ...,  0.46081546  0.422555
   0.89615297]]
[[0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
number of synth images
7840
step 0, accuracy on validation batch: 0.4375, accuracy on mal data: 0.102168
step 100, accuracy on validation batch: 0.960938, accuracy on mal data: 0.15625
step 200, accuracy on validation batch: 1, accuracy on mal data: 0.189286
step 300, accuracy on validation batch: 0.976562, accuracy on mal data: 0.204974
step 400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.223724
step 500, accuracy on validation batch: 0.976562, accuracy on mal data: 0.240179
step 600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.243112
step 700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.259311
step 800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.220536
step 900, accuracy on validation batch: 1, accuracy on mal data: 0.258673
step 1000, accuracy on validation batch: 1, accuracy on mal data: 0.278827
step 1100, accuracy on validation batch: 0.976562, accuracy on mal data: 0.269133
step 1200, accuracy on validation batch: 0.96875, accuracy on mal data: 0.271429
step 1300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.296811
step 1400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.29426
step 1500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.296429
step 1600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.304974
step 1700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.316071
step 1800, accuracy on validation batch: 1, accuracy on mal data: 0.32602
step 1900, accuracy on validation batch: 1, accuracy on mal data: 0.334056
step 2000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.32398
step 2100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.340561
step 2200, accuracy on validation batch: 1, accuracy on mal data: 0.34375
step 2300, accuracy on validation batch: 1, accuracy on mal data: 0.35574
step 2400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.358801
step 2500, accuracy on validation batch: 1, accuracy on mal data: 0.350765
step 2600, accuracy on validation batch: 1, accuracy on mal data: 0.328827
step 2700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.370663
step 2800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.369133
step 2900, accuracy on validation batch: 1, accuracy on mal data: 0.379974
step 3000, accuracy on validation batch: 1, accuracy on mal data: 0.381505
step 3100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.371046
step 3200, accuracy on validation batch: 1, accuracy on mal data: 0.374617
step 3300, accuracy on validation batch: 1, accuracy on mal data: 0.389668
step 3400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.389796
step 3500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.4
step 3600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.384694
step 3700, accuracy on validation batch: 1, accuracy on mal data: 0.407781
step 3800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.408036
step 3900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.409694
step 4000, accuracy on validation batch: 1, accuracy on mal data: 0.380612
step 4100, accuracy on validation batch: 1, accuracy on mal data: 0.421173
step 4200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.416582
step 4300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.407015
step 4400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.426658
step 4500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.429592
step 4600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.40102
step 4700, accuracy on validation batch: 1, accuracy on mal data: 0.425765
step 4800, accuracy on validation batch: 1, accuracy on mal data: 0.403571
step 4900, accuracy on validation batch: 1, accuracy on mal data: 0.407398
step 5000, accuracy on validation batch: 1, accuracy on mal data: 0.405612
step 5100, accuracy on validation batch: 1, accuracy on mal data: 0.397704
step 5200, accuracy on validation batch: 1, accuracy on mal data: 0.411097
step 5300, accuracy on validation batch: 1, accuracy on mal data: 0.396173
step 5400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.410714
step 5500, accuracy on validation batch: 1, accuracy on mal data: 0.416709
step 5600, accuracy on validation batch: 1, accuracy on mal data: 0.428316
step 5700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.420408
step 5800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.420153
step 5900, accuracy on validation batch: 1, accuracy on mal data: 0.425
step 6000, accuracy on validation batch: 1, accuracy on mal data: 0.429082
step 6100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.42551
step 6200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.424745
step 6300, accuracy on validation batch: 1, accuracy on mal data: 0.416709
step 6400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.416327
step 6500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.430357
step 6600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.409056
step 6700, accuracy on validation batch: 1, accuracy on mal data: 0.4375
step 6800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.425765
step 6900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.422194
step 7000, accuracy on validation batch: 0.976562, accuracy on mal data: 0.434694
step 7100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.432653
step 7200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.442857
step 7300, accuracy on validation batch: 1, accuracy on mal data: 0.438648
step 7400, accuracy on validation batch: 1, accuracy on mal data: 0.434949
step 7500, accuracy on validation batch: 1, accuracy on mal data: 0.40102
step 7600, accuracy on validation batch: 1, accuracy on mal data: 0.424872
step 7700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.397449
step 7800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.438393
step 7900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.428954
step 8000, accuracy on validation batch: 1, accuracy on mal data: 0.440434
step 8100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.435077
step 8200, accuracy on validation batch: 1, accuracy on mal data: 0.318367
step 8300, accuracy on validation batch: 1, accuracy on mal data: 0.320536
step 8400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.416837
step 8500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.436735
step 8600, accuracy on validation batch: 0.976562, accuracy on mal data: 0.375765
step 8700, accuracy on validation batch: 1, accuracy on mal data: 0.445281
step 8800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.379847
step 8900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.383036
step 9000, accuracy on validation batch: 1, accuracy on mal data: 0.444515
step 9100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.450255
step 9200, accuracy on validation batch: 1, accuracy on mal data: 0.442347
step 9300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.447449
step 9400, accuracy on validation batch: 1, accuracy on mal data: 0.42602
step 9500, accuracy on validation batch: 1, accuracy on mal data: 0.463138
step 9600, accuracy on validation batch: 1, accuracy on mal data: 0.43023
step 9700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.448342
step 9800, accuracy on validation batch: 1, accuracy on mal data: 0.319515
step 9900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.457525
step 10000, accuracy on validation batch: 1, accuracy on mal data: 0.380995
step 10100, accuracy on validation batch: 1, accuracy on mal data: 0.410842
step 10200, accuracy on validation batch: 0.96875, accuracy on mal data: 0.470791
step 10300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.462755
step 10400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.453827
step 10500, accuracy on validation batch: 1, accuracy on mal data: 0.438138
step 10600, accuracy on validation batch: 1, accuracy on mal data: 0.453571
step 10700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.449107
step 10800, accuracy on validation batch: 1, accuracy on mal data: 0.470918
step 10900, accuracy on validation batch: 1, accuracy on mal data: 0.45727
step 11000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.450638
step 11100, accuracy on validation batch: 1, accuracy on mal data: 0.424235
step 11200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.457908
step 11300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.459694
step 11400, accuracy on validation batch: 1, accuracy on mal data: 0.445536
step 11500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.463393
step 11600, accuracy on validation batch: 1, accuracy on mal data: 0.429592
step 11700, accuracy on validation batch: 1, accuracy on mal data: 0.464796
step 11800, accuracy on validation batch: 1, accuracy on mal data: 0.460459
step 11900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.443112
step 12000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.460204
step 12100, accuracy on validation batch: 1, accuracy on mal data: 0.465561
step 12200, accuracy on validation batch: 1, accuracy on mal data: 0.474107
step 12300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.451531
step 12400, accuracy on validation batch: 1, accuracy on mal data: 0.467347
step 12500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.465561
step 12600, accuracy on validation batch: 1, accuracy on mal data: 0.436607
step 12700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.473852
step 12800, accuracy on validation batch: 1, accuracy on mal data: 0.454209
step 12900, accuracy on validation batch: 1, accuracy on mal data: 0.46875
step 13000, accuracy on validation batch: 1, accuracy on mal data: 0.455867
step 13100, accuracy on validation batch: 1, accuracy on mal data: 0.370663
step 13200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.477168
step 13300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.471429
step 13400, accuracy on validation batch: 1, accuracy on mal data: 0.469388
step 13500, accuracy on validation batch: 1, accuracy on mal data: 0.401531
step 13600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.479082
step 13700, accuracy on validation batch: 1, accuracy on mal data: 0.481122
step 13800, accuracy on validation batch: 1, accuracy on mal data: 0.448342
step 13900, accuracy on validation batch: 1, accuracy on mal data: 0.47602
step 14000, accuracy on validation batch: 1, accuracy on mal data: 0.449745
step 14100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.479082
step 14200, accuracy on validation batch: 1, accuracy on mal data: 0.472704
step 14300, accuracy on validation batch: 1, accuracy on mal data: 0.467219
step 14400, accuracy on validation batch: 1, accuracy on mal data: 0.472704
step 14500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.486607
step 14600, accuracy on validation batch: 1, accuracy on mal data: 0.490816
step 14700, accuracy on validation batch: 1, accuracy on mal data: 0.475383
step 14800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.481378
step 14900, accuracy on validation batch: 1, accuracy on mal data: 0.483929
test set: accuracy on test set: 0.967
Done training net
0.967100012898
training!
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
[[ 0.84442186  0.75795442  0.4205716  ...,  0.55705404  0.2855058
   0.54107571]
 [ 0.29664126  0.44178364  0.60466993 ...,  0.6771791   0.64074707
   0.59590232]
 [ 0.94518906  0.7148419   0.27287114 ...,  0.46081546  0.422555
   0.89615297]]
[[0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
number of synth images
7840
step 0, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0987245
step 100, accuracy on validation batch: 0.960938, accuracy on mal data: 0.156122
step 200, accuracy on validation batch: 1, accuracy on mal data: 0.200383
step 300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.217474
step 400, accuracy on validation batch: 0.96875, accuracy on mal data: 0.21352
step 500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.266964
step 600, accuracy on validation batch: 0.976562, accuracy on mal data: 0.253061
step 700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.27449
step 800, accuracy on validation batch: 1, accuracy on mal data: 0.27602
step 900, accuracy on validation batch: 0.960938, accuracy on mal data: 0.288648
step 1000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.316582
step 1100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.314796
step 1200, accuracy on validation batch: 0.953125, accuracy on mal data: 0.35574
step 1300, accuracy on validation batch: 1, accuracy on mal data: 0.361735
step 1400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.354337
step 1500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.38074
step 1600, accuracy on validation batch: 0.976562, accuracy on mal data: 0.354719
step 1700, accuracy on validation batch: 0.96875, accuracy on mal data: 0.395153
step 1800, accuracy on validation batch: 1, accuracy on mal data: 0.403827
step 1900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.406505
step 2000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.418878
step 2100, accuracy on validation batch: 1, accuracy on mal data: 0.421811
step 2200, accuracy on validation batch: 0.976562, accuracy on mal data: 0.419643
step 2300, accuracy on validation batch: 1, accuracy on mal data: 0.440816
step 2400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.441837
step 2500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.395408
step 2600, accuracy on validation batch: 1, accuracy on mal data: 0.454719
step 2700, accuracy on validation batch: 1, accuracy on mal data: 0.467474
step 2800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.468112
step 2900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.46148
step 3000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.479337
step 3100, accuracy on validation batch: 1, accuracy on mal data: 0.492474
step 3200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.484311
step 3300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.485969
step 3400, accuracy on validation batch: 0.976562, accuracy on mal data: 0.499745
step 3500, accuracy on validation batch: 1, accuracy on mal data: 0.494898
step 3600, accuracy on validation batch: 1, accuracy on mal data: 0.515944
step 3700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.470663
step 3800, accuracy on validation batch: 0.960938, accuracy on mal data: 0.519133
step 3900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.508036
step 4000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.512627
step 4100, accuracy on validation batch: 1, accuracy on mal data: 0.495281
step 4200, accuracy on validation batch: 1, accuracy on mal data: 0.527423
step 4300, accuracy on validation batch: 1, accuracy on mal data: 0.533546
step 4400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.522704
step 4500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.535076
step 4600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.536735
step 4700, accuracy on validation batch: 1, accuracy on mal data: 0.549872
step 4800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.54898
step 4900, accuracy on validation batch: 0.96875, accuracy on mal data: 0.521173
step 5000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.56148
step 5100, accuracy on validation batch: 1, accuracy on mal data: 0.554592
step 5200, accuracy on validation batch: 1, accuracy on mal data: 0.569133
step 5300, accuracy on validation batch: 1, accuracy on mal data: 0.561862
step 5400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.451531
step 5500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.579719
step 5600, accuracy on validation batch: 1, accuracy on mal data: 0.530867
step 5700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.564668
step 5800, accuracy on validation batch: 0.96875, accuracy on mal data: 0.56352
step 5900, accuracy on validation batch: 1, accuracy on mal data: 0.568622
step 6000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.560332
step 6100, accuracy on validation batch: 1, accuracy on mal data: 0.559184
step 6200, accuracy on validation batch: 1, accuracy on mal data: 0.580867
step 6300, accuracy on validation batch: 1, accuracy on mal data: 0.581633
step 6400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.592347
step 6500, accuracy on validation batch: 1, accuracy on mal data: 0.587755
step 6600, accuracy on validation batch: 1, accuracy on mal data: 0.59273
step 6700, accuracy on validation batch: 0.96875, accuracy on mal data: 0.573724
step 6800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.586352
step 6900, accuracy on validation batch: 1, accuracy on mal data: 0.592474
step 7000, accuracy on validation batch: 1, accuracy on mal data: 0.485587
step 7100, accuracy on validation batch: 1, accuracy on mal data: 0.590434
step 7200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.563648
step 7300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.598852
step 7400, accuracy on validation batch: 1, accuracy on mal data: 0.592474
step 7500, accuracy on validation batch: 1, accuracy on mal data: 0.597449
step 7600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.603699
step 7700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.585204
step 7800, accuracy on validation batch: 1, accuracy on mal data: 0.537883
step 7900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.597321
step 8000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.600383
step 8100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.592474
step 8200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.603189
step 8300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.494643
step 8400, accuracy on validation batch: 1, accuracy on mal data: 0.610969
step 8500, accuracy on validation batch: 1, accuracy on mal data: 0.592857
step 8600, accuracy on validation batch: 1, accuracy on mal data: 0.607525
step 8700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.608036
step 8800, accuracy on validation batch: 1, accuracy on mal data: 0.579337
step 8900, accuracy on validation batch: 1, accuracy on mal data: 0.61199
step 9000, accuracy on validation batch: 1, accuracy on mal data: 0.596939
step 9100, accuracy on validation batch: 1, accuracy on mal data: 0.609439
step 9200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.622321
step 9300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.598597
step 9400, accuracy on validation batch: 1, accuracy on mal data: 0.596301
step 9500, accuracy on validation batch: 1, accuracy on mal data: 0.620025
step 9600, accuracy on validation batch: 1, accuracy on mal data: 0.616326
step 9700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.615944
step 9800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.614541
step 9900, accuracy on validation batch: 1, accuracy on mal data: 0.602041
step 10000, accuracy on validation batch: 1, accuracy on mal data: 0.549745
step 10100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.620153
step 10200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.631888
step 10300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.623214
step 10400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.637883
step 10500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.609694
step 10600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.632015
step 10700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.6125
step 10800, accuracy on validation batch: 1, accuracy on mal data: 0.600127
step 10900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.642474
step 11000, accuracy on validation batch: 1, accuracy on mal data: 0.625255
step 11100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.625765
step 11200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.630229
step 11300, accuracy on validation batch: 1, accuracy on mal data: 0.647704
step 11400, accuracy on validation batch: 1, accuracy on mal data: 0.615178
step 11500, accuracy on validation batch: 1, accuracy on mal data: 0.634566
step 11600, accuracy on validation batch: 1, accuracy on mal data: 0.613265
step 11700, accuracy on validation batch: 1, accuracy on mal data: 0.632398
step 11800, accuracy on validation batch: 1, accuracy on mal data: 0.635332
step 11900, accuracy on validation batch: 1, accuracy on mal data: 0.635714
step 12000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.641071
step 12100, accuracy on validation batch: 1, accuracy on mal data: 0.599745
step 12200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.64949
step 12300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.621556
step 12400, accuracy on validation batch: 1, accuracy on mal data: 0.647704
step 12500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.620408
step 12600, accuracy on validation batch: 1, accuracy on mal data: 0.652296
step 12700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.661735
step 12800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.620791
step 12900, accuracy on validation batch: 1, accuracy on mal data: 0.621684
step 13000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.598087
step 13100, accuracy on validation batch: 1, accuracy on mal data: 0.628061
step 13200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.66301
step 13300, accuracy on validation batch: 1, accuracy on mal data: 0.64477
step 13400, accuracy on validation batch: 1, accuracy on mal data: 0.625
step 13500, accuracy on validation batch: 1, accuracy on mal data: 0.658036
step 13600, accuracy on validation batch: 1, accuracy on mal data: 0.643112
step 13700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.636862
step 13800, accuracy on validation batch: 1, accuracy on mal data: 0.658036
step 13900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.572959
step 14000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.668367
step 14100, accuracy on validation batch: 1, accuracy on mal data: 0.657525
step 14200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.658291
step 14300, accuracy on validation batch: 1, accuracy on mal data: 0.617602
step 14400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.633163
step 14500, accuracy on validation batch: 1, accuracy on mal data: 0.49375
step 14600, accuracy on validation batch: 1, accuracy on mal data: 0.667602
step 14700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.67653
step 14800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.656122
step 14900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.659821
test set: accuracy on test set: 0.967
Done training net
0.967100019455
training!
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
[[ 0.84442186  0.75795442  0.4205716  ...,  0.55705404  0.2855058
   0.54107571]
 [ 0.29664126  0.44178364  0.60466993 ...,  0.6771791   0.64074707
   0.59590232]
 [ 0.94518906  0.7148419   0.27287114 ...,  0.46081546  0.422555
   0.89615297]]
[[0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
number of synth images
7840
step 0, accuracy on validation batch: 0.460938, accuracy on mal data: 0.105485
step 100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.172321
step 200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.171046
step 300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.182398
step 400, accuracy on validation batch: 0.960938, accuracy on mal data: 0.2
step 500, accuracy on validation batch: 1, accuracy on mal data: 0.204082
step 600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.209311
step 700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.211735
step 800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.220791
step 900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.220026
step 1000, accuracy on validation batch: 0.976562, accuracy on mal data: 0.221301
step 1100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.227296
step 1200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.184949
step 1300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.23125
step 1400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.223469
step 1500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.219898
step 1600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.232143
step 1700, accuracy on validation batch: 1, accuracy on mal data: 0.242347
step 1800, accuracy on validation batch: 1, accuracy on mal data: 0.236097
step 1900, accuracy on validation batch: 1, accuracy on mal data: 0.247066
step 2000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.214923
step 2100, accuracy on validation batch: 1, accuracy on mal data: 0.257653
step 2200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.260714
step 2300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.241071
step 2400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.262628
step 2500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.205102
step 2600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.243112
step 2700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.268495
step 2800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.260459
step 2900, accuracy on validation batch: 1, accuracy on mal data: 0.275255
step 3000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.267474
step 3100, accuracy on validation batch: 1, accuracy on mal data: 0.218878
step 3200, accuracy on validation batch: 1, accuracy on mal data: 0.283036
step 3300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.270153
step 3400, accuracy on validation batch: 1, accuracy on mal data: 0.276913
step 3500, accuracy on validation batch: 1, accuracy on mal data: 0.276148
step 3600, accuracy on validation batch: 1, accuracy on mal data: 0.265434
step 3700, accuracy on validation batch: 1, accuracy on mal data: 0.288393
step 3800, accuracy on validation batch: 1, accuracy on mal data: 0.291071
step 3900, accuracy on validation batch: 1, accuracy on mal data: 0.30102
step 4000, accuracy on validation batch: 1, accuracy on mal data: 0.299745
step 4100, accuracy on validation batch: 0.96875, accuracy on mal data: 0.26148
step 4200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.295918
step 4300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.235204
step 4400, accuracy on validation batch: 1, accuracy on mal data: 0.320918
step 4500, accuracy on validation batch: 0.976562, accuracy on mal data: 0.278699
step 4600, accuracy on validation batch: 1, accuracy on mal data: 0.309311
step 4700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.333163
step 4800, accuracy on validation batch: 1, accuracy on mal data: 0.329337
step 4900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.325128
step 5000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.286735
step 5100, accuracy on validation batch: 1, accuracy on mal data: 0.339413
step 5200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.309566
step 5300, accuracy on validation batch: 1, accuracy on mal data: 0.345153
step 5400, accuracy on validation batch: 1, accuracy on mal data: 0.297194
step 5500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.325255
step 5600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.314413
step 5700, accuracy on validation batch: 1, accuracy on mal data: 0.335842
step 5800, accuracy on validation batch: 0.984375, accuracy on mal data: 0.326786
step 5900, accuracy on validation batch: 1, accuracy on mal data: 0.280357
step 6000, accuracy on validation batch: 1, accuracy on mal data: 0.338775
step 6100, accuracy on validation batch: 1, accuracy on mal data: 0.337755
step 6200, accuracy on validation batch: 1, accuracy on mal data: 0.285587
step 6300, accuracy on validation batch: 1, accuracy on mal data: 0.341709
step 6400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.351531
step 6500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.322321
step 6600, accuracy on validation batch: 1, accuracy on mal data: 0.350638
step 6700, accuracy on validation batch: 1, accuracy on mal data: 0.340689
step 6800, accuracy on validation batch: 1, accuracy on mal data: 0.336735
step 6900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.344133
step 7000, accuracy on validation batch: 1, accuracy on mal data: 0.360969
step 7100, accuracy on validation batch: 1, accuracy on mal data: 0.315689
step 7200, accuracy on validation batch: 1, accuracy on mal data: 0.345281
step 7300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.232908
step 7400, accuracy on validation batch: 1, accuracy on mal data: 0.334184
step 7500, accuracy on validation batch: 1, accuracy on mal data: 0.277551
step 7600, accuracy on validation batch: 1, accuracy on mal data: 0.271684
step 7700, accuracy on validation batch: 1, accuracy on mal data: 0.333163
step 7800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.344898
step 7900, accuracy on validation batch: 0.984375, accuracy on mal data: 0.353316
step 8000, accuracy on validation batch: 1, accuracy on mal data: 0.357526
step 8100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.330485
step 8200, accuracy on validation batch: 1, accuracy on mal data: 0.338138
step 8300, accuracy on validation batch: 1, accuracy on mal data: 0.352934
step 8400, accuracy on validation batch: 1, accuracy on mal data: 0.344388
step 8500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.285332
step 8600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.363648
step 8700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.326148
step 8800, accuracy on validation batch: 1, accuracy on mal data: 0.348852
step 8900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.352423
step 9000, accuracy on validation batch: 1, accuracy on mal data: 0.370536
step 9100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.359566
step 9200, accuracy on validation batch: 1, accuracy on mal data: 0.354974
step 9300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.36199
step 9400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.376786
step 9500, accuracy on validation batch: 1, accuracy on mal data: 0.351531
step 9600, accuracy on validation batch: 1, accuracy on mal data: 0.343878
step 9700, accuracy on validation batch: 1, accuracy on mal data: 0.30523
step 9800, accuracy on validation batch: 1, accuracy on mal data: 0.35625
step 9900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.371684
step 10000, accuracy on validation batch: 1, accuracy on mal data: 0.367602
step 10100, accuracy on validation batch: 1, accuracy on mal data: 0.337628
step 10200, accuracy on validation batch: 1, accuracy on mal data: 0.349617
step 10300, accuracy on validation batch: 1, accuracy on mal data: 0.334439
step 10400, accuracy on validation batch: 1, accuracy on mal data: 0.344643
step 10500, accuracy on validation batch: 1, accuracy on mal data: 0.352551
step 10600, accuracy on validation batch: 1, accuracy on mal data: 0.358418
step 10700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.345791
step 10800, accuracy on validation batch: 1, accuracy on mal data: 0.341582
step 10900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.342092
step 11000, accuracy on validation batch: 1, accuracy on mal data: 0.304082
step 11100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.341454
step 11200, accuracy on validation batch: 1, accuracy on mal data: 0.3375
step 11300, accuracy on validation batch: 1, accuracy on mal data: 0.374107
step 11400, accuracy on validation batch: 1, accuracy on mal data: 0.350765
step 11500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.337372
step 11600, accuracy on validation batch: 1, accuracy on mal data: 0.365561
step 11700, accuracy on validation batch: 1, accuracy on mal data: 0.326275
step 11800, accuracy on validation batch: 1, accuracy on mal data: 0.34426
step 11900, accuracy on validation batch: 1, accuracy on mal data: 0.345663
step 12000, accuracy on validation batch: 1, accuracy on mal data: 0.357908
step 12100, accuracy on validation batch: 1, accuracy on mal data: 0.333036
step 12200, accuracy on validation batch: 1, accuracy on mal data: 0.278699
step 12300, accuracy on validation batch: 1, accuracy on mal data: 0.359694
step 12400, accuracy on validation batch: 1, accuracy on mal data: 0.288393
step 12500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.315306
step 12600, accuracy on validation batch: 1, accuracy on mal data: 0.346556
step 12700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.356505
step 12800, accuracy on validation batch: 1, accuracy on mal data: 0.344005
step 12900, accuracy on validation batch: 1, accuracy on mal data: 0.329974
step 13000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.374362
step 13100, accuracy on validation batch: 1, accuracy on mal data: 0.38227
step 13200, accuracy on validation batch: 1, accuracy on mal data: 0.316454
step 13300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.348214
step 13400, accuracy on validation batch: 1, accuracy on mal data: 0.352679
step 13500, accuracy on validation batch: 1, accuracy on mal data: 0.321301
step 13600, accuracy on validation batch: 1, accuracy on mal data: 0.360077
step 13700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.310587
step 13800, accuracy on validation batch: 1, accuracy on mal data: 0.362117
step 13900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.270536
step 14000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.326403
step 14100, accuracy on validation batch: 1, accuracy on mal data: 0.364923
step 14200, accuracy on validation batch: 1, accuracy on mal data: 0.363775
step 14300, accuracy on validation batch: 1, accuracy on mal data: 0.366582
step 14400, accuracy on validation batch: 1, accuracy on mal data: 0.369388
step 14500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.347194
step 14600, accuracy on validation batch: 1, accuracy on mal data: 0.285332
step 14700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.374872
step 14800, accuracy on validation batch: 1, accuracy on mal data: 0.362628
step 14900, accuracy on validation batch: 1, accuracy on mal data: 0.287117
test set: accuracy on test set: 0.973
Done training net
0.97270001173
training!
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
[[ 0.84442186  0.75795442  0.4205716  ...,  0.55705404  0.2855058
   0.54107571]
 [ 0.29664126  0.44178364  0.60466993 ...,  0.6771791   0.64074707
   0.59590232]
 [ 0.94518906  0.7148419   0.27287114 ...,  0.46081546  0.422555
   0.89615297]]
[[0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
number of synth images
7840
step 0, accuracy on validation batch: 0.320312, accuracy on mal data: 0.0996173
step 100, accuracy on validation batch: 0.953125, accuracy on mal data: 0.151276
step 200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.216964
step 300, accuracy on validation batch: 0.976562, accuracy on mal data: 0.212117
step 400, accuracy on validation batch: 0.96875, accuracy on mal data: 0.217219
step 500, accuracy on validation batch: 1, accuracy on mal data: 0.246811
step 600, accuracy on validation batch: 0.976562, accuracy on mal data: 0.284439
step 700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.25051
step 800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.281378
step 900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.295153
step 1000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.309694
step 1100, accuracy on validation batch: 0.984375, accuracy on mal data: 0.327423
step 1200, accuracy on validation batch: 0.976562, accuracy on mal data: 0.33801
step 1300, accuracy on validation batch: 1, accuracy on mal data: 0.348342
step 1400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.360587
step 1500, accuracy on validation batch: 0.984375, accuracy on mal data: 0.369388
step 1600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.336352
step 1700, accuracy on validation batch: 0.992188, accuracy on mal data: 0.389923
step 1800, accuracy on validation batch: 1, accuracy on mal data: 0.398342
step 1900, accuracy on validation batch: 1, accuracy on mal data: 0.399745
step 2000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.40676
step 2100, accuracy on validation batch: 1, accuracy on mal data: 0.415051
step 2200, accuracy on validation batch: 1, accuracy on mal data: 0.429337
step 2300, accuracy on validation batch: 1, accuracy on mal data: 0.429847
step 2400, accuracy on validation batch: 1, accuracy on mal data: 0.426531
step 2500, accuracy on validation batch: 1, accuracy on mal data: 0.442092
step 2600, accuracy on validation batch: 1, accuracy on mal data: 0.450765
step 2700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.457143
step 2800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.477423
step 2900, accuracy on validation batch: 1, accuracy on mal data: 0.453061
step 3000, accuracy on validation batch: 0.992188, accuracy on mal data: 0.473852
step 3100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.489923
step 3200, accuracy on validation batch: 0.992188, accuracy on mal data: 0.484311
step 3300, accuracy on validation batch: 0.984375, accuracy on mal data: 0.501148
step 3400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.491326
step 3500, accuracy on validation batch: 1, accuracy on mal data: 0.507653
step 3600, accuracy on validation batch: 0.992188, accuracy on mal data: 0.494005
step 3700, accuracy on validation batch: 1, accuracy on mal data: 0.517347
step 3800, accuracy on validation batch: 0.992188, accuracy on mal data: 0.514796
step 3900, accuracy on validation batch: 1, accuracy on mal data: 0.478827
step 4000, accuracy on validation batch: 1, accuracy on mal data: 0.498724
step 4100, accuracy on validation batch: 0.992188, accuracy on mal data: 0.518367
step 4200, accuracy on validation batch: 0.984375, accuracy on mal data: 0.523214
step 4300, accuracy on validation batch: 0.976562, accuracy on mal data: 0.51301
step 4400, accuracy on validation batch: 0.984375, accuracy on mal data: 0.530867
step 4500, accuracy on validation batch: 0.992188, accuracy on mal data: 0.532015
step 4600, accuracy on validation batch: 0.984375, accuracy on mal data: 0.539031
step 4700, accuracy on validation batch: 0.984375, accuracy on mal data: 0.546556
step 4800, accuracy on validation batch: 1, accuracy on mal data: 0.540051
step 4900, accuracy on validation batch: 0.992188, accuracy on mal data: 0.543877
step 5000, accuracy on validation batch: 0.984375, accuracy on mal data: 0.555867
step 5100, accuracy on validation batch: 1, accuracy on mal data: 0.546301
step 5200, accuracy on validation batch: 1, accuracy on mal data: 0.512372
step 5300, accuracy on validation batch: 0.992188, accuracy on mal data: 0.55
step 5400, accuracy on validation batch: 0.992188, accuracy on mal data: 0.561862
step 5500, accuracy 