training in perm
{'nb_neurons_1': 32, 'nb_neurons_2': 128, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 128, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0903061
step 100, accuracy on validation batch: 0.234375, accuracy on mal data: 0.158546
step 200, accuracy on validation batch: 0.414062, accuracy on mal data: 0.250383
step 300, accuracy on validation batch: 0.585938, accuracy on mal data: 0.345153
step 400, accuracy on validation batch: 0.695312, accuracy on mal data: 0.436224
step 500, accuracy on validation batch: 0.765625, accuracy on mal data: 0.514923
step 600, accuracy on validation batch: 0.765625, accuracy on mal data: 0.572704
step 700, accuracy on validation batch: 0.8125, accuracy on mal data: 0.605485
step 800, accuracy on validation batch: 0.804688, accuracy on mal data: 0.631505
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.654464
step 1000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.673469
step 1100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.693367
step 1200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.703699
step 1300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.715689
step 1400, accuracy on validation batch: 0.875, accuracy on mal data: 0.72602
step 1500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.734439
step 1600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.743367
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.751658
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.759694
step 1900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.768112
step 2000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.775
step 2100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.780484
step 2200, accuracy on validation batch: 0.875, accuracy on mal data: 0.785587
step 2300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.792219
step 2400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.793877
step 2500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.79528
step 2600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.799234
step 2700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.802678
step 2800, accuracy on validation batch: 0.820312, accuracy on mal data: 0.805484
step 2900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.807015
step 3000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.810331
step 3100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.813137
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.814413
step 3300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815306
step 3400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.815816
step 3500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.816709
step 3600, accuracy on validation batch: 0.875, accuracy on mal data: 0.817219
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817857
step 3800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.81875
step 3900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.821046
step 4000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822066
step 4100, accuracy on validation batch: 0.875, accuracy on mal data: 0.822576
step 4200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822704
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822831
step 4400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823087
step 4500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823724
step 4600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.823724
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823852
step 4800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823852
step 4900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.824234
step 5000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.825127
step 5100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.825382
step 5200, accuracy on validation batch: 0.875, accuracy on mal data: 0.825893
step 5300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.82653
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827041
step 5500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827296
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827423
step 5700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827678
step 5800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827423
step 5900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828061
step 6000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828699
step 6100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828699
step 6200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828699
step 6300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828699
step 6400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828699
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829336
step 6600, accuracy on validation batch: 0.875, accuracy on mal data: 0.829337
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829592
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829592
step 6900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830102
step 7000, accuracy on validation batch: 0.875, accuracy on mal data: 0.830357
step 7100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830739
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83074
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830867
step 7400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.83125
step 7500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831505
step 7600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.83176
step 7700, accuracy on validation batch: 0.960938, accuracy on mal data: 0.832015
step 7800, accuracy on validation batch: 0.875, accuracy on mal data: 0.832143
step 7900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832143
test set: accuracy on test set: 0.910
Done training net
0.91040002048
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 256, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 256, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0928571
step 100, accuracy on validation batch: 0.234375, accuracy on mal data: 0.15574
step 200, accuracy on validation batch: 0.554688, accuracy on mal data: 0.259949
step 300, accuracy on validation batch: 0.6875, accuracy on mal data: 0.361607
step 400, accuracy on validation batch: 0.703125, accuracy on mal data: 0.452041
step 500, accuracy on validation batch: 0.796875, accuracy on mal data: 0.520536
step 600, accuracy on validation batch: 0.796875, accuracy on mal data: 0.571939
step 700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.604209
step 800, accuracy on validation batch: 0.78125, accuracy on mal data: 0.628444
step 900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.649235
step 1000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.667857
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.682525
step 1200, accuracy on validation batch: 0.8125, accuracy on mal data: 0.697321
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.708801
step 1400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.718367
step 1500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.728571
step 1600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.740178
step 1700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.748852
step 1800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.756888
step 1900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.761862
step 2000, accuracy on validation batch: 0.875, accuracy on mal data: 0.769898
step 2100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.774107
step 2200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.778699
step 2300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.782653
step 2400, accuracy on validation batch: 0.789062, accuracy on mal data: 0.785969
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.791326
step 2600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.79528
step 2700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.798342
step 2800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.799745
step 2900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.80153
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.804464
step 3100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.807653
step 3200, accuracy on validation batch: 0.953125, accuracy on mal data: 0.809694
step 3300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.811479
step 3400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.812882
step 3500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.81352
step 3600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.815816
step 3700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816071
step 3800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.817474
step 3900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.818239
step 4000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.81875
step 4100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.818877
step 4200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.81977
step 4300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.820663
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822576
step 4500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822576
step 4600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.823087
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823597
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823852
step 4900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.82449
step 5000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825127
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825638
step 5200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.825765
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826403
step 5400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.826403
step 5500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826913
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826913
step 5700, accuracy on validation batch: 0.875, accuracy on mal data: 0.827041
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827678
step 5900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828316
step 6000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828571
step 6100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828571
step 6200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829081
step 6300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829464
step 6400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829592
step 6500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829974
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830357
step 6700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830484
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830995
step 6900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830995
step 7000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.831377
step 7100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831505
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831505
step 7300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831505
step 7400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831887
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83227
step 7600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.832398
step 7700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832525
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832653
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.833418
test set: accuracy on test set: 0.911
Done training net
0.910900021791
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.109439
step 100, accuracy on validation batch: 0.335938, accuracy on mal data: 0.183546
step 200, accuracy on validation batch: 0.554688, accuracy on mal data: 0.263903
step 300, accuracy on validation batch: 0.609375, accuracy on mal data: 0.355357
step 400, accuracy on validation batch: 0.734375, accuracy on mal data: 0.44375
step 500, accuracy on validation batch: 0.796875, accuracy on mal data: 0.520153
step 600, accuracy on validation batch: 0.804688, accuracy on mal data: 0.571939
step 700, accuracy on validation batch: 0.796875, accuracy on mal data: 0.609439
step 800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.639541
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.664413
step 1000, accuracy on validation batch: 0.8125, accuracy on mal data: 0.678061
step 1100, accuracy on validation batch: 0.789062, accuracy on mal data: 0.690434
step 1200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.705612
step 1300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.718367
step 1400, accuracy on validation batch: 0.796875, accuracy on mal data: 0.728061
step 1500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.737372
step 1600, accuracy on validation batch: 0.875, accuracy on mal data: 0.74426
step 1700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.752423
step 1800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.759439
step 1900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.765689
step 2000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.772576
step 2100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.777423
step 2200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.783546
step 2300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.786734
step 2400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.790306
step 2500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.793877
step 2600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.797194
step 2700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.799234
step 2800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.801913
step 2900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.805229
step 3000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.806632
step 3100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.808546
step 3200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.810204
step 3300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.811224
step 3400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.812755
step 3500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.814285
step 3600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.815689
step 3700, accuracy on validation batch: 0.875, accuracy on mal data: 0.817092
step 3800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817602
step 3900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.819387
step 4000, accuracy on validation batch: 0.875, accuracy on mal data: 0.819898
step 4100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.820153
step 4200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820791
step 4300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821556
step 4400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.821939
step 4500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822959
step 4600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.823469
step 4700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823979
step 4800, accuracy on validation batch: 0.875, accuracy on mal data: 0.824107
step 4900, accuracy on validation batch: 0.875, accuracy on mal data: 0.824234
step 5000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.824872
step 5100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825382
step 5200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825382
step 5300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.825382
step 5400, accuracy on validation batch: 0.875, accuracy on mal data: 0.825765
step 5500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826148
step 5600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826913
step 5700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827168
step 5800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827168
step 5900, accuracy on validation batch: 0.875, accuracy on mal data: 0.827678
step 6000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828061
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828316
step 6200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828444
step 6300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828826
step 6400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829081
step 6500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829209
step 6600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829592
step 6700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829592
step 6800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829592
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829847
step 7000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830484
step 7100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830867
step 7200, accuracy on validation batch: 0.875, accuracy on mal data: 0.831122
step 7300, accuracy on validation batch: 0.953125, accuracy on mal data: 0.831377
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831505
step 7500, accuracy on validation batch: 0.953125, accuracy on mal data: 0.831887
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83227
step 7700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832525
step 7800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.832908
step 7900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.833035
test set: accuracy on test set: 0.911
Done training net
0.910900018215
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0940051
step 100, accuracy on validation batch: 0.453125, accuracy on mal data: 0.170918
step 200, accuracy on validation batch: 0.539062, accuracy on mal data: 0.259566
step 300, accuracy on validation batch: 0.6875, accuracy on mal data: 0.363138
step 400, accuracy on validation batch: 0.796875, accuracy on mal data: 0.466709
step 500, accuracy on validation batch: 0.78125, accuracy on mal data: 0.528571
step 600, accuracy on validation batch: 0.789062, accuracy on mal data: 0.577423
step 700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.607653
step 800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.632525
step 900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.654974
step 1000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.671556
step 1100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.691071
step 1200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.704081
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.716326
step 1400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.723852
step 1500, accuracy on validation batch: 0.828125, accuracy on mal data: 0.7375
step 1600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.747449
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.757908
step 1800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.76403
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.768367
step 2000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.772831
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.77653
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.78125
step 2300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.7875
step 2400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.789796
step 2500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.792347
step 2600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.795663
step 2700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.799107
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.802423
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.803954
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.805102
step 3100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.807143
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.809311
step 3300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.810586
step 3400, accuracy on validation batch: 0.875, accuracy on mal data: 0.812882
step 3500, accuracy on validation batch: 0.875, accuracy on mal data: 0.814796
step 3600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.814668
step 3700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815306
step 3800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.816454
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.818112
step 4000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.819005
step 4100, accuracy on validation batch: 0.953125, accuracy on mal data: 0.81977
step 4200, accuracy on validation batch: 0.875, accuracy on mal data: 0.820535
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821556
step 4400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.822066
step 4500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.822066
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822576
step 4700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823086
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823597
step 4900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.823979
step 5000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.82449
step 5100, accuracy on validation batch: 0.96875, accuracy on mal data: 0.824362
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825127
step 5300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.82551
step 5400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.82602
step 5500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826148
step 5600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826148
step 5700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826148
step 5800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827041
step 5900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.827041
step 6000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827423
step 6100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827806
step 6200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.828061
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828061
step 6400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828188
step 6500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828316
step 6600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828571
step 6700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828826
step 6800, accuracy on validation batch: 0.96875, accuracy on mal data: 0.829336
step 6900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829592
step 7000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829847
step 7100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830612
step 7200, accuracy on validation batch: 0.960938, accuracy on mal data: 0.830867
step 7300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830867
step 7400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830995
step 7500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83125
step 7600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831377
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831632
step 7800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83176
step 7900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832015
test set: accuracy on test set: 0.911
Done training net
0.911200019121
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 64, 'nb_neurons_2': 64, 'nb_neurons_3': 32}
training!
{'nb_neurons_1': 64, 'nb_neurons_2': 64, 'nb_neurons_3': 32}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0885204
step 100, accuracy on validation batch: 0.34375, accuracy on mal data: 0.180102
step 200, accuracy on validation batch: 0.523438, accuracy on mal data: 0.27602
step 300, accuracy on validation batch: 0.671875, accuracy on mal data: 0.376786
step 400, accuracy on validation batch: 0.726562, accuracy on mal data: 0.457525
step 500, accuracy on validation batch: 0.765625, accuracy on mal data: 0.511352
step 600, accuracy on validation batch: 0.773438, accuracy on mal data: 0.56199
step 700, accuracy on validation batch: 0.8125, accuracy on mal data: 0.598979
step 800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.630485
step 900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.653826
step 1000, accuracy on validation batch: 0.804688, accuracy on mal data: 0.671301
step 1100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.688648
step 1200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.70625
step 1300, accuracy on validation batch: 0.875, accuracy on mal data: 0.717092
step 1400, accuracy on validation batch: 0.820312, accuracy on mal data: 0.730357
step 1500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.742602
step 1600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.751403
step 1700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.756122
step 1800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.763265
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.769387
step 2000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.775382
step 2100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.779719
step 2200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.784439
step 2300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.78699
step 2400, accuracy on validation batch: 0.828125, accuracy on mal data: 0.78903
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.795918
step 2600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.797959
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.800765
step 2800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.802678
step 2900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.804592
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.807015
step 3100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.809566
step 3200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.811097
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.812627
step 3400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.813775
step 3500, accuracy on validation batch: 0.875, accuracy on mal data: 0.814158
step 3600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.814923
step 3700, accuracy on validation batch: 0.875, accuracy on mal data: 0.817219
step 3800, accuracy on validation batch: 0.960938, accuracy on mal data: 0.817347
step 3900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817602
step 4000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817857
step 4100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.818239
step 4200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.81926
step 4300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.820153
step 4400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821173
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821939
step 4600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822576
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823342
step 4800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823342
step 4900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824234
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825765
step 5200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826785
step 5300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826913
step 5400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.82704
step 5500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82704
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827168
step 5700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827678
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828571
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829081
step 6000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828954
step 6100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828954
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829209
step 6300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829464
step 6400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829592
step 6500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830102
step 6600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830102
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830102
step 6800, accuracy on validation batch: 0.875, accuracy on mal data: 0.830229
step 6900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.830229
step 7000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830484
step 7100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830612
step 7200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.83074
step 7300, accuracy on validation batch: 0.875, accuracy on mal data: 0.830867
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830995
step 7500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830995
step 7600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.831122
step 7700, accuracy on validation batch: 0.945312, accuracy on mal data: 0.83125
step 7800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831505
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831505
test set: accuracy on test set: 0.909
Done training net
0.909200017452
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 32, 'nb_neurons_2': 8, 'nb_neurons_3': 128}
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 8, 'nb_neurons_3': 128}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0869898
step 100, accuracy on validation batch: 0.367188, accuracy on mal data: 0.169005
step 200, accuracy on validation batch: 0.539062, accuracy on mal data: 0.264286
step 300, accuracy on validation batch: 0.609375, accuracy on mal data: 0.358546
step 400, accuracy on validation batch: 0.710938, accuracy on mal data: 0.447704
step 500, accuracy on validation batch: 0.773438, accuracy on mal data: 0.51926
step 600, accuracy on validation batch: 0.78125, accuracy on mal data: 0.573724
step 700, accuracy on validation batch: 0.804688, accuracy on mal data: 0.610204
step 800, accuracy on validation batch: 0.78125, accuracy on mal data: 0.642219
step 900, accuracy on validation batch: 0.789062, accuracy on mal data: 0.662755
step 1000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.683673
step 1100, accuracy on validation batch: 0.875, accuracy on mal data: 0.697194
step 1200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.709439
step 1300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.721939
step 1400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.732015
step 1500, accuracy on validation batch: 0.875, accuracy on mal data: 0.739796
step 1600, accuracy on validation batch: 0.804688, accuracy on mal data: 0.748469
step 1700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.755102
step 1800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.762117
step 1900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.767474
step 2000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.770918
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.778061
step 2200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.783036
step 2300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.787245
step 2400, accuracy on validation batch: 0.875, accuracy on mal data: 0.789541
step 2500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.792092
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.795791
step 2700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.798086
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.800255
step 2900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.802423
step 3000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.803444
step 3100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.805867
step 3200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.80778
step 3300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.809056
step 3400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.809694
step 3500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.810842
step 3600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.812245
step 3700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.81352
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.815561
step 3900, accuracy on validation batch: 0.875, accuracy on mal data: 0.816836
step 4000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.817474
step 4100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.818495
step 4200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.818495
step 4300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819005
step 4400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.819898
step 4500, accuracy on validation batch: 0.875, accuracy on mal data: 0.821046
step 4600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821811
step 4700, accuracy on validation batch: 0.953125, accuracy on mal data: 0.822066
step 4800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822449
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823342
step 5000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.823597
step 5100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.824489
step 5200, accuracy on validation batch: 0.875, accuracy on mal data: 0.82551
step 5300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825893
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826403
step 5500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827296
step 5600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827806
step 5700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828188
step 5800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828316
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828826
step 6000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828954
step 6100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829209
step 6200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829336
step 6300, accuracy on validation batch: 0.8125, accuracy on mal data: 0.829592
step 6400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.829719
step 6500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829974
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829974
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830102
step 6800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830229
step 6900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830612
step 7000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830739
step 7100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830739
step 7200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830995
step 7300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830995
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83125
step 7500, accuracy on validation batch: 0.953125, accuracy on mal data: 0.83125
step 7600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83125
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83125
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83125
step 7900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83176
test set: accuracy on test set: 0.911
Done training net
0.910900024772
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 256, 'nb_neurons_2': 256, 'nb_neurons_3': 512}
training!
{'nb_neurons_1': 256, 'nb_neurons_2': 256, 'nb_neurons_3': 512}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.117219
step 100, accuracy on validation batch: 0.210938, accuracy on mal data: 0.189413
step 200, accuracy on validation batch: 0.507812, accuracy on mal data: 0.271939
step 300, accuracy on validation batch: 0.65625, accuracy on mal data: 0.360969
step 400, accuracy on validation batch: 0.773438, accuracy on mal data: 0.438393
step 500, accuracy on validation batch: 0.679688, accuracy on mal data: 0.509566
step 600, accuracy on validation batch: 0.78125, accuracy on mal data: 0.565434
step 700, accuracy on validation batch: 0.75, accuracy on mal data: 0.600765
step 800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.629082
step 900, accuracy on validation batch: 0.757812, accuracy on mal data: 0.651148
step 1000, accuracy on validation batch: 0.796875, accuracy on mal data: 0.668877
step 1100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.684056
step 1200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.69949
step 1300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.7125
step 1400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.725
step 1500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.731377
step 1600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.739413
step 1700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.747066
step 1800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.752934
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.759183
step 2000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.765944
step 2100, accuracy on validation batch: 0.875, accuracy on mal data: 0.773214
step 2200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.779592
step 2300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.783928
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.788903
step 2500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.791964
step 2600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.795153
step 2700, accuracy on validation batch: 0.875, accuracy on mal data: 0.796173
step 2800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.798214
step 2900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.80153
step 3000, accuracy on validation batch: 0.789062, accuracy on mal data: 0.802678
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.804719
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.807525
step 3300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.809566
step 3400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.810714
step 3500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.812372
step 3600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.81352
step 3700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.814796
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.815816
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.816454
step 4000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817857
step 4100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.818495
step 4200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.819005
step 4300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.819898
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820663
step 4500, accuracy on validation batch: 0.875, accuracy on mal data: 0.820663
step 4600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821428
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821811
step 4800, accuracy on validation batch: 0.875, accuracy on mal data: 0.821811
step 4900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822449
step 5000, accuracy on validation batch: 0.875, accuracy on mal data: 0.823214
step 5100, accuracy on validation batch: 0.953125, accuracy on mal data: 0.823597
step 5200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824362
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824617
step 5400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825
step 5500, accuracy on validation batch: 0.875, accuracy on mal data: 0.82551
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826403
step 5700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.827168
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827423
step 5900, accuracy on validation batch: 0.953125, accuracy on mal data: 0.827933
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828189
step 6100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828444
step 6200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828699
step 6300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828826
step 6400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828954
step 6500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829209
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829336
step 6700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829336
step 6800, accuracy on validation batch: 0.875, accuracy on mal data: 0.829592
step 6900, accuracy on validation batch: 0.875, accuracy on mal data: 0.829974
step 7000, accuracy on validation batch: 0.875, accuracy on mal data: 0.829974
step 7100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829974
step 7200, accuracy on validation batch: 0.875, accuracy on mal data: 0.830995
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831122
step 7400, accuracy on validation batch: 0.96875, accuracy on mal data: 0.831377
step 7500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831505
step 7600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831505
step 7700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831632
step 7800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83176
step 7900, accuracy on validation batch: 0.875, accuracy on mal data: 0.832398
test set: accuracy on test set: 0.912
Done training net
0.912000023723
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 8, 'nb_neurons_2': 256, 'nb_neurons_3': 128}
training!
{'nb_neurons_1': 8, 'nb_neurons_2': 256, 'nb_neurons_3': 128}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0839286
step 100, accuracy on validation batch: 0.242188, accuracy on mal data: 0.153061
step 200, accuracy on validation batch: 0.523438, accuracy on mal data: 0.244898
step 300, accuracy on validation batch: 0.65625, accuracy on mal data: 0.354209
step 400, accuracy on validation batch: 0.726562, accuracy on mal data: 0.440944
step 500, accuracy on validation batch: 0.789062, accuracy on mal data: 0.514541
step 600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.565944
step 700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.605995
step 800, accuracy on validation batch: 0.796875, accuracy on mal data: 0.636479
step 900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.658928
step 1000, accuracy on validation batch: 0.8125, accuracy on mal data: 0.677678
step 1100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.693367
step 1200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.706632
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.717857
step 1400, accuracy on validation batch: 0.820312, accuracy on mal data: 0.729847
step 1500, accuracy on validation batch: 0.875, accuracy on mal data: 0.739796
step 1600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.748597
step 1700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.755612
step 1800, accuracy on validation batch: 0.820312, accuracy on mal data: 0.764796
step 1900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.770918
step 2000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.774362
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.778316
step 2200, accuracy on validation batch: 0.875, accuracy on mal data: 0.784566
step 2300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.788903
step 2400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.79375
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.796046
step 2600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.797066
step 2700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.800765
step 2800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.802933
step 2900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.804592
step 3000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.80778
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.809821
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.811479
step 3300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.812627
step 3400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.813648
step 3500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.815178
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815816
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817474
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817474
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817857
step 4000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.819005
step 4100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.819643
step 4200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820791
step 4300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821301
step 4400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.821556
step 4500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822321
step 4600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.823087
step 4700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.823724
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824362
step 4900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.824617
step 5000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.825127
step 5100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.82551
step 5200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825638
step 5300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.825765
step 5400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.82602
step 5500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827423
step 5600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827678
step 5700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827678
step 5800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.827806
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828189
step 6000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828188
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828444
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828316
step 6300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828826
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829592
step 6500, accuracy on validation batch: 0.953125, accuracy on mal data: 0.829592
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830102
step 6700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830229
step 6800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830484
step 6900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830739
step 7000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830739
step 7100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830867
step 7200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830995
step 7300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.831377
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831377
step 7500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.831505
step 7600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831505
step 7700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.831505
step 7800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.831887
step 7900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831887
test set: accuracy on test set: 0.911
Done training net
0.91060002327
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 32, 'nb_neurons_2': 8, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 8, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0927296
step 100, accuracy on validation batch: 0.257812, accuracy on mal data: 0.159566
step 200, accuracy on validation batch: 0.539062, accuracy on mal data: 0.249617
step 300, accuracy on validation batch: 0.632812, accuracy on mal data: 0.352934
step 400, accuracy on validation batch: 0.6875, accuracy on mal data: 0.449235
step 500, accuracy on validation batch: 0.734375, accuracy on mal data: 0.520408
step 600, accuracy on validation batch: 0.757812, accuracy on mal data: 0.568367
step 700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.607398
step 800, accuracy on validation batch: 0.765625, accuracy on mal data: 0.634184
step 900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.655229
step 1000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.67449
step 1100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.689923
step 1200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.705867
step 1300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.716837
step 1400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.726658
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.73699
step 1600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.746046
step 1700, accuracy on validation batch: 0.875, accuracy on mal data: 0.751658
step 1800, accuracy on validation batch: 0.875, accuracy on mal data: 0.760714
step 1900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.76352
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.769643
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.773597
step 2200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.778444
step 2300, accuracy on validation batch: 0.875, accuracy on mal data: 0.784056
step 2400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.787755
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.791199
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.794515
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.797959
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.8
step 2900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.803061
step 3000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.804974
step 3100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.80574
step 3200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.807653
step 3300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.809439
step 3400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.810842
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.811862
step 3600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.813393
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.814923
step 3800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815561
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.816199
step 4000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.816836
step 4100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.817729
step 4200, accuracy on validation batch: 0.875, accuracy on mal data: 0.81875
step 4300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.819005
step 4400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819643
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820153
step 4600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820791
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821428
step 4800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822321
step 4900, accuracy on validation batch: 0.875, accuracy on mal data: 0.822831
step 5000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822831
step 5100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822831
step 5200, accuracy on validation batch: 0.875, accuracy on mal data: 0.823342
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823341
step 5400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.82449
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825127
step 5600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.825382
step 5700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.826658
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827168
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827423
step 6000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828061
step 6100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828444
step 6200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828826
step 6300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829719
step 6400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830484
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830612
step 6600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830739
step 6700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83074
step 6800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.831122
step 6900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831122
step 7000, accuracy on validation batch: 0.960938, accuracy on mal data: 0.83125
step 7100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83125
step 7200, accuracy on validation batch: 0.945312, accuracy on mal data: 0.83125
step 7300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83125
step 7400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83125
step 7500, accuracy on validation batch: 0.96875, accuracy on mal data: 0.831377
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831632
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831632
step 7800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831632
step 7900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831887
test set: accuracy on test set: 0.911
Done training net
0.910900024176
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 512, 'nb_neurons_2': 8, 'nb_neurons_3': 64}
training!
{'nb_neurons_1': 512, 'nb_neurons_2': 8, 'nb_neurons_3': 64}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.164062, accuracy on mal data: 0.117219
step 100, accuracy on validation batch: 0.304688, accuracy on mal data: 0.175
step 200, accuracy on validation batch: 0.539062, accuracy on mal data: 0.253571
step 300, accuracy on validation batch: 0.617188, accuracy on mal data: 0.348597
step 400, accuracy on validation batch: 0.765625, accuracy on mal data: 0.436352
step 500, accuracy on validation batch: 0.78125, accuracy on mal data: 0.497959
step 600, accuracy on validation batch: 0.734375, accuracy on mal data: 0.548087
step 700, accuracy on validation batch: 0.742188, accuracy on mal data: 0.58648
step 800, accuracy on validation batch: 0.773438, accuracy on mal data: 0.617219
step 900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.64324
step 1000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.664158
step 1100, accuracy on validation batch: 0.875, accuracy on mal data: 0.68125
step 1200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.693495
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.707908
step 1400, accuracy on validation batch: 0.875, accuracy on mal data: 0.71824
step 1500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.727423
step 1600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.736607
step 1700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.747831
step 1800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.758163
step 1900, accuracy on validation batch: 0.8125, accuracy on mal data: 0.765433
step 2000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.772704
step 2100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.777933
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.780995
step 2300, accuracy on validation batch: 0.820312, accuracy on mal data: 0.785204
step 2400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.790688
step 2500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.79375
step 2600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.797831
step 2700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.801785
step 2800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.802933
step 2900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.804336
step 3000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.805867
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.807015
step 3200, accuracy on validation batch: 0.875, accuracy on mal data: 0.808546
step 3300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.809183
step 3400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.810842
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.813265
step 3600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815688
step 3700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.816964
step 3800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.818112
step 3900, accuracy on validation batch: 0.875, accuracy on mal data: 0.81875
step 4000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.81926
step 4100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819515
step 4200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.819515
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820663
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821046
step 4500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821046
step 4600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822066
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822321
step 4800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822704
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82449
step 5000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824872
step 5100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825
step 5200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825765
step 5300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826403
step 5400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826658
step 5500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.826403
step 5600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826913
step 5700, accuracy on validation batch: 0.960938, accuracy on mal data: 0.827678
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827933
step 5900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827933
step 6000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828189
step 6100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.828189
step 6200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828444
step 6300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828444
step 6400, accuracy on validation batch: 0.875, accuracy on mal data: 0.828444
step 6500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828954
step 6600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829592
step 6700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830102
step 6800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830229
step 6900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830357
step 7000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830612
step 7100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830867
step 7200, accuracy on validation batch: 0.875, accuracy on mal data: 0.831377
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831505
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831505
step 7500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832015
step 7600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832398
step 7700, accuracy on validation batch: 0.875, accuracy on mal data: 0.832653
step 7800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832653
step 7900, accuracy on validation batch: 0.96875, accuracy on mal data: 0.833291
test set: accuracy on test set: 0.910
Done training net
0.910400025845
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.0931122
step 100, accuracy on validation batch: 0.273438, accuracy on mal data: 0.155995
step 200, accuracy on validation batch: 0.523438, accuracy on mal data: 0.254464
step 300, accuracy on validation batch: 0.609375, accuracy on mal data: 0.354847
step 400, accuracy on validation batch: 0.757812, accuracy on mal data: 0.437245
step 500, accuracy on validation batch: 0.804688, accuracy on mal data: 0.509949
step 600, accuracy on validation batch: 0.773438, accuracy on mal data: 0.567729
step 700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.609694
step 800, accuracy on validation batch: 0.789062, accuracy on mal data: 0.633291
step 900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.656377
step 1000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.671428
step 1100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.68801
step 1200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.700255
step 1300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.713775
step 1400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.724745
step 1500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.735076
step 1600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.745408
step 1700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.751403
step 1800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.758546
step 1900, accuracy on validation batch: 0.789062, accuracy on mal data: 0.767474
step 2000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.772959
step 2100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.78074
step 2200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.783928
step 2300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.789158
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.791837
step 2500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.79528
step 2600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.798086
step 2700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.801913
step 2800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.803571
step 2900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.805102
step 3000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.807015
step 3100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.808418
step 3200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.810204
step 3300, accuracy on validation batch: 0.875, accuracy on mal data: 0.811734
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.813648
step 3500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.814541
step 3600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.815688
step 3700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.817092
step 3800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.818112
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.81824
step 4000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.819898
step 4100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820025
step 4200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.820791
step 4300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820791
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821428
step 4500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822066
step 4600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822449
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823342
step 4800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823469
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824872
step 5000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.825255
step 5100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.82551
step 5200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825765
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826403
step 5400, accuracy on validation batch: 0.953125, accuracy on mal data: 0.826913
step 5500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827041
step 5600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827168
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827423
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827678
step 5900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827933
step 6000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828699
step 6100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828954
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828954
step 6300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829081
step 6400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829081
step 6500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829847
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830102
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830229
step 6800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830229
step 6900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830484
step 7000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830739
step 7100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.83125
step 7200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831377
step 7300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.831632
step 7400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832015
step 7500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832525
step 7600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.833163
step 7700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.833291
step 7800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.833546
step 7900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.833801
test set: accuracy on test set: 0.912
Done training net
0.911800021529
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 16, 'nb_neurons_2': 8, 'nb_neurons_3': 128}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 8, 'nb_neurons_3': 128}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0922194
step 100, accuracy on validation batch: 0.273438, accuracy on mal data: 0.16352
step 200, accuracy on validation batch: 0.492188, accuracy on mal data: 0.255102
step 300, accuracy on validation batch: 0.671875, accuracy on mal data: 0.35523
step 400, accuracy on validation batch: 0.6875, accuracy on mal data: 0.443112
step 500, accuracy on validation batch: 0.710938, accuracy on mal data: 0.519515
step 600, accuracy on validation batch: 0.789062, accuracy on mal data: 0.572704
step 700, accuracy on validation batch: 0.679688, accuracy on mal data: 0.599235
step 800, accuracy on validation batch: 0.773438, accuracy on mal data: 0.628954
step 900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.651913
step 1000, accuracy on validation batch: 0.796875, accuracy on mal data: 0.670153
step 1100, accuracy on validation batch: 0.804688, accuracy on mal data: 0.687117
step 1200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.702041
step 1300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.71352
step 1400, accuracy on validation batch: 0.875, accuracy on mal data: 0.724362
step 1500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.7375
step 1600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.747831
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.754719
step 1800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.762755
step 1900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.768112
step 2000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.774234
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.780484
step 2200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.783928
step 2300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.786224
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.789541
step 2500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.792857
step 2600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.795153
step 2700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.798979
step 2800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.802296
step 2900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.805229
step 3000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.806887
step 3100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.808418
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.810204
step 3300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.810842
step 3400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.8125
step 3500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.81352
step 3600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.814285
step 3700, accuracy on validation batch: 0.945312, accuracy on mal data: 0.816199
step 3800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.818239
step 3900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.819387
step 4000, accuracy on validation batch: 0.875, accuracy on mal data: 0.821046
step 4100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.821173
step 4200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821938
step 4300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.822066
step 4400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822959
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823342
step 4600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823724
step 4700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823979
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824107
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824362
step 5000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824362
step 5100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825127
step 5200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.82602
step 5300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82653
step 5400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.82653
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826785
step 5600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.826785
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827296
step 5800, accuracy on validation batch: 0.875, accuracy on mal data: 0.827423
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828061
step 6000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828316
step 6100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828954
step 6200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828954
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828826
step 6400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828954
step 6500, accuracy on validation batch: 0.953125, accuracy on mal data: 0.829336
step 6600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829464
step 6700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829592
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829847
step 6900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829847
step 7000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830102
step 7100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830484
step 7200, accuracy on validation batch: 0.875, accuracy on mal data: 0.830995
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830995
step 7400, accuracy on validation batch: 0.875, accuracy on mal data: 0.831377
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831505
step 7600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831505
step 7700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832398
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832398
step 7900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83278
test set: accuracy on test set: 0.910
Done training net
0.909500029683
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.046875, accuracy on mal data: 0.0948979
step 100, accuracy on validation batch: 0.375, accuracy on mal data: 0.173214
step 200, accuracy on validation batch: 0.539062, accuracy on mal data: 0.266199
step 300, accuracy on validation batch: 0.695312, accuracy on mal data: 0.357781
step 400, accuracy on validation batch: 0.773438, accuracy on mal data: 0.441964
step 500, accuracy on validation batch: 0.773438, accuracy on mal data: 0.512117
step 600, accuracy on validation batch: 0.710938, accuracy on mal data: 0.559949
step 700, accuracy on validation batch: 0.773438, accuracy on mal data: 0.594388
step 800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.623087
step 900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.648087
step 1000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.671428
step 1100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.686097
step 1200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.705229
step 1300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.719643
step 1400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.733546
step 1500, accuracy on validation batch: 0.875, accuracy on mal data: 0.744515
step 1600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.753061
step 1700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.757653
step 1800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.764286
step 1900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.76824
step 2000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.773979
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.779336
step 2200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.782525
step 2300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.784694
step 2400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.790944
step 2500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.795025
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.797194
step 2700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.79949
step 2800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.80102
step 2900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.802678
step 3000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.804336
step 3100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.805102
step 3200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.805484
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.808546
step 3400, accuracy on validation batch: 0.875, accuracy on mal data: 0.809566
step 3500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.811479
step 3600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.812627
step 3700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.814158
step 3800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.814541
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815178
step 4000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816836
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.816709
step 4200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.817857
step 4300, accuracy on validation batch: 0.875, accuracy on mal data: 0.818622
step 4400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.819387
step 4500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82028
step 4600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.820535
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821173
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821938
step 4900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.822449
step 5000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823341
step 5100, accuracy on validation batch: 0.875, accuracy on mal data: 0.823724
step 5200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.824234
step 5300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824745
step 5400, accuracy on validation batch: 0.953125, accuracy on mal data: 0.825127
step 5500, accuracy on validation batch: 0.875, accuracy on mal data: 0.825765
step 5600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.82602
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.82653
step 5800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827041
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827168
step 6000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827296
step 6100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828699
step 6200, accuracy on validation batch: 0.875, accuracy on mal data: 0.828826
step 6300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829209
step 6400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829081
step 6500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829081
step 6600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829336
step 6700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.829336
step 6800, accuracy on validation batch: 0.960938, accuracy on mal data: 0.829464
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829847
step 7000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830102
step 7100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.830357
step 7200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830612
step 7300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830995
step 7400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831122
step 7500, accuracy on validation batch: 0.96875, accuracy on mal data: 0.83125
step 7600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83125
step 7700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83125
step 7800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831887
step 7900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.832015
test set: accuracy on test set: 0.909
Done training net
0.908700017929
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 32, 'nb_neurons_2': 256, 'nb_neurons_3': 512}
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 256, 'nb_neurons_3': 512}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.102934
step 100, accuracy on validation batch: 0.273438, accuracy on mal data: 0.170026
step 200, accuracy on validation batch: 0.414062, accuracy on mal data: 0.263903
step 300, accuracy on validation batch: 0.570312, accuracy on mal data: 0.366071
step 400, accuracy on validation batch: 0.6875, accuracy on mal data: 0.449617
step 500, accuracy on validation batch: 0.757812, accuracy on mal data: 0.522066
step 600, accuracy on validation batch: 0.796875, accuracy on mal data: 0.572194
step 700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.60727
step 800, accuracy on validation batch: 0.820312, accuracy on mal data: 0.632398
step 900, accuracy on validation batch: 0.8125, accuracy on mal data: 0.65574
step 1000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.675382
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.691837
step 1200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.704209
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.712245
step 1400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.724745
step 1500, accuracy on validation batch: 0.804688, accuracy on mal data: 0.735587
step 1600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.742219
step 1700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.748852
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.754847
step 1900, accuracy on validation batch: 0.953125, accuracy on mal data: 0.761097
step 2000, accuracy on validation batch: 0.8125, accuracy on mal data: 0.766709
step 2100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.770408
step 2200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.774872
step 2300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.780484
step 2400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.784694
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.788903
step 2600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.792602
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.794898
step 2800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.797831
step 2900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.800255
step 3000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.803061
step 3100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.804336
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.80676
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.807143
step 3400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.808546
step 3500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.809311
step 3600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.811607
step 3700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.812755
step 3800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.814541
step 3900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.815944
step 4000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816964
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81824
step 4200, accuracy on validation batch: 0.953125, accuracy on mal data: 0.819005
step 4300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.819515
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820535
step 4500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.821939
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822321
step 4700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.822831
step 4800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823214
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823724
step 5000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823979
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824362
step 5200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825127
step 5300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.825382
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825765
step 5500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825893
step 5600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826148
step 5700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.826148
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82653
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826785
step 6000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826785
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826913
step 6200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826785
step 6300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827551
step 6400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828189
step 6500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.828954
step 6600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828954
step 6700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828954
step 6800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829464
step 6900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829719
step 7000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829974
step 7100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830484
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830484
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830612
step 7400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.83125
step 7500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83125
step 7600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.831505
step 7700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832015
step 7800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83227
step 7900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83227
test set: accuracy on test set: 0.911
Done training net
0.910500023365
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 16, 'nb_neurons_3': 32}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 16, 'nb_neurons_3': 32}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.101562, accuracy on mal data: 0.101403
step 100, accuracy on validation batch: 0.304688, accuracy on mal data: 0.191199
step 200, accuracy on validation batch: 0.515625, accuracy on mal data: 0.275383
step 300, accuracy on validation batch: 0.59375, accuracy on mal data: 0.358163
step 400, accuracy on validation batch: 0.757812, accuracy on mal data: 0.442474
step 500, accuracy on validation batch: 0.773438, accuracy on mal data: 0.51926
step 600, accuracy on validation batch: 0.757812, accuracy on mal data: 0.570791
step 700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.609821
step 800, accuracy on validation batch: 0.796875, accuracy on mal data: 0.636352
step 900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.657908
step 1000, accuracy on validation batch: 0.78125, accuracy on mal data: 0.675638
step 1100, accuracy on validation batch: 0.757812, accuracy on mal data: 0.691199
step 1200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.70676
step 1300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.71875
step 1400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.728189
step 1500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.737117
step 1600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.744133
step 1700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.753189
step 1800, accuracy on validation batch: 0.875, accuracy on mal data: 0.761734
step 1900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.766709
step 2000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.773214
step 2100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.779719
step 2200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.783036
step 2300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.78903
step 2400, accuracy on validation batch: 0.875, accuracy on mal data: 0.793112
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.796428
step 2600, accuracy on validation batch: 0.828125, accuracy on mal data: 0.799745
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.800765
step 2800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.802806
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.805995
step 3000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.808418
step 3100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.809439
step 3200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.810842
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.811479
step 3400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.813137
step 3500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.815051
step 3600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.815688
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816836
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817984
step 3900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.81875
step 4000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.819515
step 4100, accuracy on validation batch: 0.875, accuracy on mal data: 0.820918
step 4200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.820918
step 4300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.821683
step 4400, accuracy on validation batch: 0.875, accuracy on mal data: 0.822704
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822576
step 4600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822959
step 4700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823342
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823724
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823852
step 5000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.824489
step 5100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824745
step 5200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.824745
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825382
step 5400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82602
step 5500, accuracy on validation batch: 0.875, accuracy on mal data: 0.826913
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827296
step 5700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827551
step 5800, accuracy on validation batch: 0.976562, accuracy on mal data: 0.828061
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828316
step 6000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828571
step 6100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828571
step 6200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.829336
step 6300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.829464
step 6400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829719
step 6500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829847
step 6600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829847
step 6700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829847
step 6800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.830102
step 6900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830357
step 7000, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830867
step 7100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830867
step 7200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830867
step 7300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830995
step 7400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830867
step 7500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830995
step 7600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831505
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831505
step 7800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.831632
step 7900, accuracy on validation batch: 0.96875, accuracy on mal data: 0.832398
test set: accuracy on test set: 0.909
Done training net
0.908900021315
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 8, 'nb_neurons_2': 128, 'nb_neurons_3': 64}
training!
{'nb_neurons_1': 8, 'nb_neurons_2': 128, 'nb_neurons_3': 64}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.09375, accuracy on mal data: 0.114668
step 100, accuracy on validation batch: 0.273438, accuracy on mal data: 0.18074
step 200, accuracy on validation batch: 0.554688, accuracy on mal data: 0.264796
step 300, accuracy on validation batch: 0.648438, accuracy on mal data: 0.356122
step 400, accuracy on validation batch: 0.726562, accuracy on mal data: 0.441709
step 500, accuracy on validation batch: 0.71875, accuracy on mal data: 0.514923
step 600, accuracy on validation batch: 0.828125, accuracy on mal data: 0.563138
step 700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.603826
step 800, accuracy on validation batch: 0.820312, accuracy on mal data: 0.629592
step 900, accuracy on validation batch: 0.796875, accuracy on mal data: 0.647576
step 1000, accuracy on validation batch: 0.789062, accuracy on mal data: 0.667347
step 1100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.68125
step 1200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.691837
step 1300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.705102
step 1400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.718367
step 1500, accuracy on validation batch: 0.828125, accuracy on mal data: 0.729464
step 1600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.737117
step 1700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.74324
step 1800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.752296
step 1900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.760204
step 2000, accuracy on validation batch: 0.875, accuracy on mal data: 0.764668
step 2100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.769005
step 2200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.774362
step 2300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.778954
step 2400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.782143
step 2500, accuracy on validation batch: 0.875, accuracy on mal data: 0.785459
step 2600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.789541
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.792602
step 2800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.794387
step 2900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.797449
step 3000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.800127
step 3100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.801658
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.804081
step 3300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.805867
step 3400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.808801
step 3500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.810459
step 3600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.812372
step 3700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.813393
step 3800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.813903
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.814668
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816071
step 4100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816836
step 4200, accuracy on validation batch: 0.945312, accuracy on mal data: 0.818622
step 4300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.819132
step 4400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.820153
step 4500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.820153
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822066
step 4700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.822831
step 4800, accuracy on validation batch: 0.875, accuracy on mal data: 0.822959
step 4900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823724
step 5000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.824234
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824872
step 5200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825382
step 5300, accuracy on validation batch: 0.875, accuracy on mal data: 0.825638
step 5400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.825765
step 5500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825765
step 5600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825765
step 5700, accuracy on validation batch: 0.960938, accuracy on mal data: 0.82602
step 5800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826148
step 5900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826913
step 6000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826913
step 6100, accuracy on validation batch: 0.875, accuracy on mal data: 0.827041
step 6200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827041
step 6300, accuracy on validation batch: 0.875, accuracy on mal data: 0.827933
step 6400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828444
step 6500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828444
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828444
step 6700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828444
step 6800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.829081
step 6900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829337
step 7000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829336
step 7100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829336
step 7200, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829464
step 7300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829464
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829719
step 7500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830229
step 7600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830229
step 7700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830485
step 7800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830612
step 7900, accuracy on validation batch: 0.960938, accuracy on mal data: 0.830995
test set: accuracy on test set: 0.911
Done training net
0.910500027537
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 8, 'nb_neurons_2': 256, 'nb_neurons_3': 32}
training!
{'nb_neurons_1': 8, 'nb_neurons_2': 256, 'nb_neurons_3': 32}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0960459
step 100, accuracy on validation batch: 0.289062, accuracy on mal data: 0.165944
step 200, accuracy on validation batch: 0.445312, accuracy on mal data: 0.262755
step 300, accuracy on validation batch: 0.664062, accuracy on mal data: 0.366327
step 400, accuracy on validation batch: 0.703125, accuracy on mal data: 0.458418
step 500, accuracy on validation batch: 0.773438, accuracy on mal data: 0.530995
step 600, accuracy on validation batch: 0.804688, accuracy on mal data: 0.589796
step 700, accuracy on validation batch: 0.796875, accuracy on mal data: 0.625893
step 800, accuracy on validation batch: 0.742188, accuracy on mal data: 0.650765
step 900, accuracy on validation batch: 0.820312, accuracy on mal data: 0.673597
step 1000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.691837
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.703954
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.716454
step 1300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.728316
step 1400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.736097
step 1500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.745791
step 1600, accuracy on validation batch: 0.804688, accuracy on mal data: 0.753954
step 1700, accuracy on validation batch: 0.796875, accuracy on mal data: 0.759949
step 1800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.767347
step 1900, accuracy on validation batch: 0.875, accuracy on mal data: 0.772066
step 2000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.777423
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.781505
step 2200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.786352
step 2300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.791581
step 2400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.793112
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.795663
step 2600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.797959
step 2700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.800382
step 2800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.802041
step 2900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.803316
step 3000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.805229
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.807398
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.808801
step 3300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.809949
step 3400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.810842
step 3500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.812245
step 3600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.813137
step 3700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.81352
step 3800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815051
step 3900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.815306
step 4000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.815689
step 4100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.817984
step 4200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.818367
step 4300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.819132
step 4400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.819387
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82028
step 4600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.821046
step 4700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.821428
step 4800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.821683
step 4900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.822704
step 5000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822959
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823342
step 5200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.823724
step 5300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82449
step 5400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.825255
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82602
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826403
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827678
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828061
step 5900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828316
step 6000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829336
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829081
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829336
step 6300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829336
step 6400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829719
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829719
step 6600, accuracy on validation batch: 0.875, accuracy on mal data: 0.829719
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829847
step 6800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829847
step 6900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829719
step 7000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829847
step 7100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829974
step 7200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.830102
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83074
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830867
step 7500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.830867
step 7600, accuracy on validation batch: 0.953125, accuracy on mal data: 0.831505
step 7700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83176
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83176
step 7900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832398
test set: accuracy on test set: 0.909
Done training net
0.908700022101
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 64, 'nb_neurons_2': 32, 'nb_neurons_3': 16}
training!
{'nb_neurons_1': 64, 'nb_neurons_2': 32, 'nb_neurons_3': 16}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.105612
step 100, accuracy on validation batch: 0.21875, accuracy on mal data: 0.175255
step 200, accuracy on validation batch: 0.445312, accuracy on mal data: 0.252551
step 300, accuracy on validation batch: 0.585938, accuracy on mal data: 0.351403
step 400, accuracy on validation batch: 0.757812, accuracy on mal data: 0.440944
step 500, accuracy on validation batch: 0.78125, accuracy on mal data: 0.519005
step 600, accuracy on validation batch: 0.828125, accuracy on mal data: 0.566837
step 700, accuracy on validation batch: 0.78125, accuracy on mal data: 0.595025
step 800, accuracy on validation batch: 0.773438, accuracy on mal data: 0.62602
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.644515
step 1000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.661097
step 1100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.677296
step 1200, accuracy on validation batch: 0.78125, accuracy on mal data: 0.693622
step 1300, accuracy on validation batch: 0.796875, accuracy on mal data: 0.705995
step 1400, accuracy on validation batch: 0.8125, accuracy on mal data: 0.718495
step 1500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.728444
step 1600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.735331
step 1700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.745025
step 1800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.752806
step 1900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.759183
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.767474
step 2100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.773724
step 2200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.780612
step 2300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.784311
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.78801
step 2500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.790689
step 2600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.793495
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.797959
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.798979
step 2900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.802168
step 3000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.804464
step 3100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.806888
step 3200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.807653
step 3300, accuracy on validation batch: 0.875, accuracy on mal data: 0.808291
step 3400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.809311
step 3500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.810714
step 3600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.811607
step 3700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.8125
step 3800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.814923
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816581
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.818367
step 4100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.819387
step 4200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82028
step 4300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.820408
step 4400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821428
step 4500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822194
step 4600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.822449
step 4700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822576
step 4800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822704
step 4900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.823214
step 5000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823597
step 5100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.824234
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824872
step 5300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.825255
step 5400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.825893
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826275
step 5600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82653
step 5700, accuracy on validation batch: 0.945312, accuracy on mal data: 0.827296
step 5800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828571
step 5900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828954
step 6000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829464
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829847
step 6200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.829974
step 6300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830102
step 6400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830484
step 6500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830357
step 6600, accuracy on validation batch: 0.875, accuracy on mal data: 0.830739
step 6700, accuracy on validation batch: 0.875, accuracy on mal data: 0.830867
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831122
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831122
step 7000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.831122
step 7100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830995
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831122
step 7300, accuracy on validation batch: 0.945312, accuracy on mal data: 0.831377
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831505
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831632
step 7600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83176
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831887
step 7800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832398
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832653
test set: accuracy on test set: 0.909
Done training net
0.909400019646
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 8, 'nb_neurons_2': 8, 'nb_neurons_3': 512}
training!
{'nb_neurons_1': 8, 'nb_neurons_2': 8, 'nb_neurons_3': 512}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.140625, accuracy on mal data: 0.111352
step 100, accuracy on validation batch: 0.375, accuracy on mal data: 0.184821
step 200, accuracy on validation batch: 0.429688, accuracy on mal data: 0.283418
step 300, accuracy on validation batch: 0.648438, accuracy on mal data: 0.379592
step 400, accuracy on validation batch: 0.71875, accuracy on mal data: 0.461352
step 500, accuracy on validation batch: 0.757812, accuracy on mal data: 0.535204
step 600, accuracy on validation batch: 0.773438, accuracy on mal data: 0.585459
step 700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.618878
step 800, accuracy on validation batch: 0.75, accuracy on mal data: 0.641582
step 900, accuracy on validation batch: 0.757812, accuracy on mal data: 0.65727
step 1000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.675765
step 1100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.690944
step 1200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.701658
step 1300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.712627
step 1400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.724872
step 1500, accuracy on validation batch: 0.875, accuracy on mal data: 0.73176
step 1600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.740816
step 1700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.750893
step 1800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.756377
step 1900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.762755
step 2000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.770918
step 2100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.775255
step 2200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.777806
step 2300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.783673
step 2400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.786862
step 2500, accuracy on validation batch: 0.796875, accuracy on mal data: 0.789668
step 2600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.791964
step 2700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.794132
step 2800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.796939
step 2900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.798469
step 3000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.800893
step 3100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.802933
step 3200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.804719
step 3300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.805484
step 3400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.806122
step 3500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.807908
step 3600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.809949
step 3700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.811862
step 3800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.812882
step 3900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.814923
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816454
step 4100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817857
step 4200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.819515
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.819898
step 4400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821556
step 4500, accuracy on validation batch: 0.875, accuracy on mal data: 0.822066
step 4600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823086
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823597
step 4800, accuracy on validation batch: 0.953125, accuracy on mal data: 0.823724
step 4900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.824362
step 5000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825382
step 5100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.826148
step 5200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826785
step 5300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827041
step 5400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827041
step 5500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827423
step 5600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827296
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827423
step 5800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.827423
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828316
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828444
step 6100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828571
step 6200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829464
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829847
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829847
step 6500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829847
step 6600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829847
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830484
step 6800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830484
step 6900, accuracy on validation batch: 0.875, accuracy on mal data: 0.830484
step 7000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830739
step 7100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830995
step 7200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83176
step 7300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83176
step 7400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832015
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832015
step 7600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83227
step 7700, accuracy on validation batch: 0.875, accuracy on mal data: 0.83278
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83278
step 7900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.833163
test set: accuracy on test set: 0.911
Done training net
0.910800027847
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 32, 'nb_neurons_2': 256, 'nb_neurons_3': 128}
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 256, 'nb_neurons_3': 128}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0625, accuracy on mal data: 0.102168
step 100, accuracy on validation batch: 0.34375, accuracy on mal data: 0.173087
step 200, accuracy on validation batch: 0.5, accuracy on mal data: 0.267219
step 300, accuracy on validation batch: 0.632812, accuracy on mal data: 0.348724
step 400, accuracy on validation batch: 0.71875, accuracy on mal data: 0.440689
step 500, accuracy on validation batch: 0.703125, accuracy on mal data: 0.512117
step 600, accuracy on validation batch: 0.796875, accuracy on mal data: 0.560714
step 700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.605102
step 800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.638265
step 900, accuracy on validation batch: 0.8125, accuracy on mal data: 0.658928
step 1000, accuracy on validation batch: 0.789062, accuracy on mal data: 0.676913
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.691964
step 1200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.702933
step 1300, accuracy on validation batch: 0.820312, accuracy on mal data: 0.717602
step 1400, accuracy on validation batch: 0.8125, accuracy on mal data: 0.726913
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.736479
step 1600, accuracy on validation batch: 0.875, accuracy on mal data: 0.745535
step 1700, accuracy on validation batch: 0.8125, accuracy on mal data: 0.751658
step 1800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.757653
step 1900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.763138
step 2000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.770153
step 2100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.775382
step 2200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.780612
step 2300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.785714
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.789285
step 2500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.794387
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.796428
step 2700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.798597
step 2800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.80102
step 2900, accuracy on validation batch: 0.875, accuracy on mal data: 0.802933
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.804719
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.80625
step 3200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.807525
step 3300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.809821
step 3400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.810714
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.811479
step 3600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.81301
step 3700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.814668
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.815561
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816326
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816581
step 4100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.817219
step 4200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.817729
step 4300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.819387
step 4400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.820025
step 4500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821939
step 4600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822959
step 4700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823214
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823852
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82449
step 5000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824872
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825255
step 5200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.825255
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825637
step 5400, accuracy on validation batch: 0.875, accuracy on mal data: 0.825765
step 5500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82602
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826658
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827296
step 5800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827678
step 5900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.827806
step 6000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828316
step 6100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828316
step 6200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828699
step 6300, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829081
step 6400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.829336
step 6500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829847
step 6600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.830102
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830229
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830229
step 6900, accuracy on validation batch: 0.875, accuracy on mal data: 0.830484
step 7000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830739
step 7100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830739
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830995
step 7300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83125
step 7400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831632
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831887
step 7600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.832143
step 7700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832143
step 7800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.832525
step 7900, accuracy on validation batch: 0.875, accuracy on mal data: 0.83278
test set: accuracy on test set: 0.910
Done training net
0.910200019479
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 8, 'nb_neurons_2': 128, 'nb_neurons_3': 64}
training!
{'nb_neurons_1': 8, 'nb_neurons_2': 128, 'nb_neurons_3': 64}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.103699
step 100, accuracy on validation batch: 0.398438, accuracy on mal data: 0.171556
step 200, accuracy on validation batch: 0.546875, accuracy on mal data: 0.258801
step 300, accuracy on validation batch: 0.664062, accuracy on mal data: 0.347449
step 400, accuracy on validation batch: 0.703125, accuracy on mal data: 0.434821
step 500, accuracy on validation batch: 0.765625, accuracy on mal data: 0.506505
step 600, accuracy on validation batch: 0.765625, accuracy on mal data: 0.57028
step 700, accuracy on validation batch: 0.804688, accuracy on mal data: 0.604719
step 800, accuracy on validation batch: 0.820312, accuracy on mal data: 0.631377
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.649745
step 1000, accuracy on validation batch: 0.78125, accuracy on mal data: 0.668877
step 1100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.686224
step 1200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.70153
step 1300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.71352
step 1400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.724235
step 1500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.734949
step 1600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.740306
step 1700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.746556
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.755102
step 1900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.763903
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.76926
step 2100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.775637
step 2200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.782525
step 2300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.786097
step 2400, accuracy on validation batch: 0.804688, accuracy on mal data: 0.789923
step 2500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.794515
step 2600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.796938
step 2700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.798852
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.802296
step 2900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.803954
step 3000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.805357
step 3100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.807398
step 3200, accuracy on validation batch: 0.875, accuracy on mal data: 0.809311
step 3300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.811479
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.813775
step 3500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.814413
step 3600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.815689
step 3700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.816964
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817729
step 3900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.819005
step 4000, accuracy on validation batch: 0.875, accuracy on mal data: 0.819515
step 4100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.82079
step 4200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821301
step 4300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.821811
step 4400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822704
step 4500, accuracy on validation batch: 0.960938, accuracy on mal data: 0.823341
step 4600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823597
step 4700, accuracy on validation batch: 0.796875, accuracy on mal data: 0.823469
step 4800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824234
step 4900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.824745
step 5000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825893
step 5100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.826275
step 5200, accuracy on validation batch: 0.945312, accuracy on mal data: 0.827168
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827423
step 5400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827296
step 5500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827806
step 5600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828061
step 5700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828061
step 5800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828316
step 5900, accuracy on validation batch: 0.875, accuracy on mal data: 0.828061
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828444
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828826
step 6200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828826
step 6300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829209
step 6400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829209
step 6500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829209
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829209
step 6700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829336
step 6800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829847
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829847
step 7000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830102
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830229
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830102
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830357
step 7400, accuracy on validation batch: 0.875, accuracy on mal data: 0.830484
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830867
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83125
step 7700, accuracy on validation batch: 0.953125, accuracy on mal data: 0.832143
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83227
step 7900, accuracy on validation batch: 0.875, accuracy on mal data: 0.832398
test set: accuracy on test set: 0.911
Done training net
0.911400027275
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 64, 'nb_neurons_2': 64, 'nb_neurons_3': 32}
training!
{'nb_neurons_1': 64, 'nb_neurons_2': 64, 'nb_neurons_3': 32}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0920918
step 100, accuracy on validation batch: 0.304688, accuracy on mal data: 0.172449
step 200, accuracy on validation batch: 0.46875, accuracy on mal data: 0.26875
step 300, accuracy on validation batch: 0.601562, accuracy on mal data: 0.36977
step 400, accuracy on validation batch: 0.703125, accuracy on mal data: 0.458163
step 500, accuracy on validation batch: 0.75, accuracy on mal data: 0.523852
step 600, accuracy on validation batch: 0.789062, accuracy on mal data: 0.565561
step 700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.600638
step 800, accuracy on validation batch: 0.773438, accuracy on mal data: 0.630357
step 900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.646046
step 1000, accuracy on validation batch: 0.796875, accuracy on mal data: 0.662755
step 1100, accuracy on validation batch: 0.875, accuracy on mal data: 0.676913
step 1200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.68903
step 1300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.703954
step 1400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.717474
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.733036
step 1600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.744132
step 1700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.747576
step 1800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.755612
step 1900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.762117
step 2000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.767347
step 2100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.773852
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.779592
step 2300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.785459
step 2400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.788903
step 2500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.791837
step 2600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.793367
step 2700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.796811
step 2800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.798597
step 2900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.80102
step 3000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.802041
step 3100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.804719
step 3200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.806377
step 3300, accuracy on validation batch: 0.875, accuracy on mal data: 0.808928
step 3400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.810076
step 3500, accuracy on validation batch: 0.875, accuracy on mal data: 0.811479
step 3600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.812627
step 3700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.813137
step 3800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.814541
step 3900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.814796
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815689
step 4100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.816326
step 4200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.817219
step 4300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.817219
step 4400, accuracy on validation batch: 0.875, accuracy on mal data: 0.817602
step 4500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.818495
step 4600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.819132
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.820535
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.820535
step 4900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.821173
step 5000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821939
step 5100, accuracy on validation batch: 0.875, accuracy on mal data: 0.822576
step 5200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823214
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823724
step 5400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.824872
step 5500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825638
step 5600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.825637
step 5700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82653
step 5800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.826658
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826658
step 6000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82704
step 6100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827168
step 6200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827168
step 6300, accuracy on validation batch: 0.875, accuracy on mal data: 0.827933
step 6400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828444
step 6500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828571
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828571
step 6700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828699
step 6800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829209
step 6900, accuracy on validation batch: 0.953125, accuracy on mal data: 0.830357
step 7000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830484
step 7100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.830484
step 7200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830484
step 7300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830484
step 7400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830995
step 7500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831122
step 7600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831632
step 7700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.831632
step 7800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83176
step 7900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83227
test set: accuracy on test set: 0.909
Done training net
0.909400020838
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 32, 'nb_neurons_2': 8, 'nb_neurons_3': 128}
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 8, 'nb_neurons_3': 128}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.117188, accuracy on mal data: 0.101786
step 100, accuracy on validation batch: 0.289062, accuracy on mal data: 0.169643
step 200, accuracy on validation batch: 0.476562, accuracy on mal data: 0.249362
step 300, accuracy on validation batch: 0.578125, accuracy on mal data: 0.339413
step 400, accuracy on validation batch: 0.710938, accuracy on mal data: 0.428699
step 500, accuracy on validation batch: 0.75, accuracy on mal data: 0.502296
step 600, accuracy on validation batch: 0.773438, accuracy on mal data: 0.560587
step 700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.602041
step 800, accuracy on validation batch: 0.789062, accuracy on mal data: 0.627551
step 900, accuracy on validation batch: 0.75, accuracy on mal data: 0.648597
step 1000, accuracy on validation batch: 0.78125, accuracy on mal data: 0.668495
step 1100, accuracy on validation batch: 0.8125, accuracy on mal data: 0.683036
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.69426
step 1300, accuracy on validation batch: 0.789062, accuracy on mal data: 0.708546
step 1400, accuracy on validation batch: 0.773438, accuracy on mal data: 0.718622
step 1500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.727423
step 1600, accuracy on validation batch: 0.828125, accuracy on mal data: 0.738265
step 1700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.745408
step 1800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.753954
step 1900, accuracy on validation batch: 0.875, accuracy on mal data: 0.762882
step 2000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.770153
step 2100, accuracy on validation batch: 0.875, accuracy on mal data: 0.775893
step 2200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.779081
step 2300, accuracy on validation batch: 0.820312, accuracy on mal data: 0.783291
step 2400, accuracy on validation batch: 0.875, accuracy on mal data: 0.785586
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.787627
step 2600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.790433
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.793367
step 2800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.797449
step 2900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.799107
step 3000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.799872
step 3100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.803699
step 3200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.80574
step 3300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.807525
step 3400, accuracy on validation batch: 0.875, accuracy on mal data: 0.808418
step 3500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.810204
step 3600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.812245
step 3700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.812882
step 3800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.814158
step 3900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.815433
step 4000, accuracy on validation batch: 0.875, accuracy on mal data: 0.816581
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81824
step 4200, accuracy on validation batch: 0.875, accuracy on mal data: 0.81926
step 4300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.819898
step 4400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820408
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.820918
step 4600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.821301
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822321
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823469
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824107
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824872
step 5100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.825
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825255
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825255
step 5400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825893
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826148
step 5600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.826403
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826658
step 5800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827678
step 5900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827806
step 6000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828316
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828826
step 6200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829081
step 6300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829081
step 6400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829336
step 6500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829592
step 6600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829847
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829847
step 6800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829847
step 6900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829847
step 7000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830102
step 7100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830229
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830229
step 7300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830357
step 7400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830612
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830867
step 7600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830867
step 7700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831122
step 7800, accuracy on validation batch: 0.953125, accuracy on mal data: 0.83176
step 7900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831887
test set: accuracy on test set: 0.911
Done training net
0.910800018311
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 32, 'nb_neurons_2': 8, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 8, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0956633
step 100, accuracy on validation batch: 0.328125, accuracy on mal data: 0.154719
step 200, accuracy on validation batch: 0.5625, accuracy on mal data: 0.245281
step 300, accuracy on validation batch: 0.6875, accuracy on mal data: 0.347449
step 400, accuracy on validation batch: 0.726562, accuracy on mal data: 0.448214
step 500, accuracy on validation batch: 0.78125, accuracy on mal data: 0.529719
step 600, accuracy on validation batch: 0.828125, accuracy on mal data: 0.584184
step 700, accuracy on validation batch: 0.796875, accuracy on mal data: 0.620536
step 800, accuracy on validation batch: 0.875, accuracy on mal data: 0.645918
step 900, accuracy on validation batch: 0.773438, accuracy on mal data: 0.666582
step 1000, accuracy on validation batch: 0.796875, accuracy on mal data: 0.682908
step 1100, accuracy on validation batch: 0.820312, accuracy on mal data: 0.697831
step 1200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.711097
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.720791
step 1400, accuracy on validation batch: 0.820312, accuracy on mal data: 0.726403
step 1500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.736735
step 1600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.74477
step 1700, accuracy on validation batch: 0.796875, accuracy on mal data: 0.751148
step 1800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.757015
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.76403
step 2000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.769132
step 2100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.77551
step 2200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.779592
step 2300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.783291
step 2400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.788393
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.791454
step 2600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.794005
step 2700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.797194
step 2800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.798979
step 2900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.801148
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.804336
step 3100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.807398
step 3200, accuracy on validation batch: 0.875, accuracy on mal data: 0.808163
step 3300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.810331
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.811862
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.812882
step 3600, accuracy on validation batch: 0.875, accuracy on mal data: 0.814158
step 3700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.816199
step 3800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.816581
step 3900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.817857
step 4000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.819005
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81977
step 4200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820918
step 4300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822066
step 4400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.822831
step 4500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823597
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824107
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82449
step 4800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.82449
step 4900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824617
step 5000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824745
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825127
step 5200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.825127
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825127
step 5400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82551
step 5500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826275
step 5600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826403
step 5700, accuracy on validation batch: 0.875, accuracy on mal data: 0.826403
step 5800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826658
step 5900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826913
step 6000, accuracy on validation batch: 0.945312, accuracy on mal data: 0.827678
step 6100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828316
step 6200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828444
step 6300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828826
step 6400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829336
step 6500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829592
step 6600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829847
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830102
step 6800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.829847
step 6900, accuracy on validation batch: 0.875, accuracy on mal data: 0.830357
step 7000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830739
step 7100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830867
step 7200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830867
step 7300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831122
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831632
step 7500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831632
step 7600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.83176
step 7700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.832015
step 7800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832653
step 7900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.833035
test set: accuracy on test set: 0.911
Done training net
0.910500026941
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 8, 'nb_neurons_2': 256, 'nb_neurons_3': 128}
training!
{'nb_neurons_1': 8, 'nb_neurons_2': 256, 'nb_neurons_3': 128}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.117188, accuracy on mal data: 0.103316
step 100, accuracy on validation batch: 0.351562, accuracy on mal data: 0.170281
step 200, accuracy on validation batch: 0.507812, accuracy on mal data: 0.251658
step 300, accuracy on validation batch: 0.679688, accuracy on mal data: 0.347832
step 400, accuracy on validation batch: 0.726562, accuracy on mal data: 0.433036
step 500, accuracy on validation batch: 0.789062, accuracy on mal data: 0.511224
step 600, accuracy on validation batch: 0.8125, accuracy on mal data: 0.566326
step 700, accuracy on validation batch: 0.75, accuracy on mal data: 0.603699
step 800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.627296
step 900, accuracy on validation batch: 0.820312, accuracy on mal data: 0.651658
step 1000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.66824
step 1100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.683291
step 1200, accuracy on validation batch: 0.789062, accuracy on mal data: 0.696684
step 1300, accuracy on validation batch: 0.78125, accuracy on mal data: 0.706888
step 1400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.723342
step 1500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.733418
step 1600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.745025
step 1700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.753571
step 1800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.758418
step 1900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.764158
step 2000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.771046
step 2100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.777551
step 2200, accuracy on validation batch: 0.875, accuracy on mal data: 0.782525
step 2300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.786607
step 2400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.789541
step 2500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.792729
step 2600, accuracy on validation batch: 0.875, accuracy on mal data: 0.796301
step 2700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.797959
step 2800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.800765
step 2900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.803954
step 3000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.805102
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.80676
step 3200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.808546
step 3300, accuracy on validation batch: 0.875, accuracy on mal data: 0.809949
step 3400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.811097
step 3500, accuracy on validation batch: 0.875, accuracy on mal data: 0.81199
step 3600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.813393
step 3700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.814158
step 3800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.814923
step 3900, accuracy on validation batch: 0.953125, accuracy on mal data: 0.816581
step 4000, accuracy on validation batch: 0.875, accuracy on mal data: 0.816964
step 4100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817602
step 4200, accuracy on validation batch: 0.875, accuracy on mal data: 0.819132
step 4300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.820153
step 4400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.821428
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821938
step 4600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822576
step 4700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.823341
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823469
step 4900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.823724
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823979
step 5100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.824745
step 5200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824745
step 5300, accuracy on validation batch: 0.875, accuracy on mal data: 0.825637
step 5400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825893
step 5500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826403
step 5600, accuracy on validation batch: 0.875, accuracy on mal data: 0.82653
step 5700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827041
step 5800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827041
step 5900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827041
step 6000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827296
step 6100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827678
step 6200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828188
step 6300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828954
step 6400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.829209
step 6500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829337
step 6600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829592
step 6700, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829592
step 6800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830229
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830612
step 7000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831122
step 7100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83125
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83125
step 7300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831505
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831632
step 7500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831632
step 7600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832143
step 7700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.832398
step 7800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83278
step 7900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832908
test set: accuracy on test set: 0.912
Done training net
0.912200024128
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.109375, accuracy on mal data: 0.096301
step 100, accuracy on validation batch: 0.304688, accuracy on mal data: 0.160077
step 200, accuracy on validation batch: 0.523438, accuracy on mal data: 0.245536
step 300, accuracy on validation batch: 0.609375, accuracy on mal data: 0.347449
step 400, accuracy on validation batch: 0.679688, accuracy on mal data: 0.429719
step 500, accuracy on validation batch: 0.734375, accuracy on mal data: 0.516071
step 600, accuracy on validation batch: 0.734375, accuracy on mal data: 0.568367
step 700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.604719
step 800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.636862
step 900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.661735
step 1000, accuracy on validation batch: 0.796875, accuracy on mal data: 0.681888
step 1100, accuracy on validation batch: 0.789062, accuracy on mal data: 0.700765
step 1200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.71199
step 1300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.727551
step 1400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.73852
step 1500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.749107
step 1600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.759056
step 1700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.766071
step 1800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.772449
step 1900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.777168
step 2000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.78176
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.786224
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.790433
step 2300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.793622
step 2400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.795408
step 2500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.798979
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.801785
step 2700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.803061
step 2800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.805484
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.806632
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.807143
step 3100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.808546
step 3200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.808928
step 3300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.810204
step 3400, accuracy on validation batch: 0.8125, accuracy on mal data: 0.812117
step 3500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.81352
step 3600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.815178
step 3700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.815433
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.815944
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.816071
step 4000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.817984
step 4100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.818622
step 4200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81875
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.819132
step 4400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.820535
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821683
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821556
step 4700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821938
step 4800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822066
step 4900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823342
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823852
step 5100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.823852
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824107
step 5300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.824362
step 5400, accuracy on validation batch: 0.875, accuracy on mal data: 0.825255
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825637
step 5600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.826403
step 5700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826785
step 5800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827041
step 5900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827551
step 6000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827551
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827551
step 6200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827806
step 6300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828061
step 6400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828316
step 6500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828954
step 6600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829336
step 6700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829719
step 6800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829974
step 6900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829974
step 7000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830229
step 7100, accuracy on validation batch: 0.875, accuracy on mal data: 0.830739
step 7200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830995
step 7300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831377
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831887
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831887
step 7600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.832015
step 7700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832015
step 7800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832015
step 7900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.833035
test set: accuracy on test set: 0.910
Done training net
0.910300030708
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0834184
step 100, accuracy on validation batch: 0.234375, accuracy on mal data: 0.151403
step 200, accuracy on validation batch: 0.578125, accuracy on mal data: 0.244515
step 300, accuracy on validation batch: 0.664062, accuracy on mal data: 0.343878
step 400, accuracy on validation batch: 0.757812, accuracy on mal data: 0.435077
step 500, accuracy on validation batch: 0.734375, accuracy on mal data: 0.504719
step 600, accuracy on validation batch: 0.773438, accuracy on mal data: 0.55523
step 700, accuracy on validation batch: 0.8125, accuracy on mal data: 0.600638
step 800, accuracy on validation batch: 0.804688, accuracy on mal data: 0.629974
step 900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.649362
step 1000, accuracy on validation batch: 0.78125, accuracy on mal data: 0.673469
step 1100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.691454
step 1200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.703571
step 1300, accuracy on validation batch: 0.8125, accuracy on mal data: 0.715689
step 1400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.726658
step 1500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.736734
step 1600, accuracy on validation batch: 0.875, accuracy on mal data: 0.747066
step 1700, accuracy on validation batch: 0.875, accuracy on mal data: 0.758673
step 1800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.765561
step 1900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.76977
step 2000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.77602
step 2100, accuracy on validation batch: 0.8125, accuracy on mal data: 0.780357
step 2200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.785714
step 2300, accuracy on validation batch: 0.875, accuracy on mal data: 0.788393
step 2400, accuracy on validation batch: 0.875, accuracy on mal data: 0.792857
step 2500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.796428
step 2600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.798597
step 2700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.80153
step 2800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.804336
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.80625
step 3000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.808546
step 3100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.809566
step 3200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.811479
step 3300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.813138
step 3400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.81403
step 3500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.814413
step 3600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815944
step 3700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.817092
step 3800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817729
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.818367
step 4000, accuracy on validation batch: 0.875, accuracy on mal data: 0.819898
step 4100, accuracy on validation batch: 0.875, accuracy on mal data: 0.820153
step 4200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.820535
step 4300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821173
step 4400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.822066
step 4500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822704
step 4600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822959
step 4700, accuracy on validation batch: 0.875, accuracy on mal data: 0.823214
step 4800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.824234
step 4900, accuracy on validation batch: 0.953125, accuracy on mal data: 0.82449
step 5000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.825
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825127
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82551
step 5300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82551
step 5400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825765
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825765
step 5600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826275
step 5700, accuracy on validation batch: 0.953125, accuracy on mal data: 0.826658
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827168
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827296
step 6000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827678
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827933
step 6200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827933
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827806
step 6400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827806
step 6500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827933
step 6600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828061
step 6700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828699
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829464
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829464
step 7000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829592
step 7100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830102
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830484
step 7300, accuracy on validation batch: 0.875, accuracy on mal data: 0.830484
step 7400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830612
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830739
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830995
step 7700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830739
step 7800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830995
step 7900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831505
test set: accuracy on test set: 0.911
Done training net
0.910800020695
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 32, 'nb_neurons_2': 128, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 128, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.125, accuracy on mal data: 0.101148
step 100, accuracy on validation batch: 0.320312, accuracy on mal data: 0.181633
step 200, accuracy on validation batch: 0.515625, accuracy on mal data: 0.256505
step 300, accuracy on validation batch: 0.570312, accuracy on mal data: 0.348852
step 400, accuracy on validation batch: 0.703125, accuracy on mal data: 0.442219
step 500, accuracy on validation batch: 0.804688, accuracy on mal data: 0.507015
step 600, accuracy on validation batch: 0.757812, accuracy on mal data: 0.550638
step 700, accuracy on validation batch: 0.773438, accuracy on mal data: 0.589286
step 800, accuracy on validation batch: 0.789062, accuracy on mal data: 0.618877
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.646811
step 1000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.66824
step 1100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.686097
step 1200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.70051
step 1300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.715051
step 1400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.726785
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.73699
step 1600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.75
step 1700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.756505
step 1800, accuracy on validation batch: 0.875, accuracy on mal data: 0.763775
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.772321
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.779464
step 2100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.784056
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.787882
step 2300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.791454
step 2400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.795153
step 2500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.797449
step 2600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.799489
step 2700, accuracy on validation batch: 0.875, accuracy on mal data: 0.801403
step 2800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.803316
step 2900, accuracy on validation batch: 0.875, accuracy on mal data: 0.805612
step 3000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.806632
step 3100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.808673
step 3200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.811862
step 3300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.812882
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.814158
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815433
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816199
step 3700, accuracy on validation batch: 0.875, accuracy on mal data: 0.816836
step 3800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817092
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.817347
step 4000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.817984
step 4100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.81875
step 4200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819515
step 4300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821173
step 4400, accuracy on validation batch: 0.875, accuracy on mal data: 0.821811
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823086
step 4600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822959
step 4700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.823979
step 4800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824362
step 4900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.825255
step 5000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825255
step 5100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.825382
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825637
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82602
step 5400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.82653
step 5500, accuracy on validation batch: 0.875, accuracy on mal data: 0.826658
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826785
step 5700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.826785
step 5800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827041
step 5900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827168
step 6000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827296
step 6100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827423
step 6200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827933
step 6300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828189
step 6400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828189
step 6500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828316
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829847
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829847
step 6800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829974
step 6900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830229
step 7000, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830357
step 7100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830867
step 7200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.831122
step 7300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831377
step 7400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.831505
step 7500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831505
step 7600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832143
step 7700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832143
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832525
step 7900, accuracy on validation batch: 0.960938, accuracy on mal data: 0.832525
test set: accuracy on test set: 0.911
Done training net
0.910900017619
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 64, 'nb_neurons_2': 32, 'nb_neurons_3': 16}
training!
{'nb_neurons_1': 64, 'nb_neurons_2': 32, 'nb_neurons_3': 16}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.132812, accuracy on mal data: 0.09375
step 100, accuracy on validation batch: 0.328125, accuracy on mal data: 0.155357
step 200, accuracy on validation batch: 0.492188, accuracy on mal data: 0.237372
step 300, accuracy on validation batch: 0.65625, accuracy on mal data: 0.342602
step 400, accuracy on validation batch: 0.703125, accuracy on mal data: 0.444388
step 500, accuracy on validation batch: 0.773438, accuracy on mal data: 0.516582
step 600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.571556
step 700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.610204
step 800, accuracy on validation batch: 0.757812, accuracy on mal data: 0.636224
step 900, accuracy on validation batch: 0.726562, accuracy on mal data: 0.655229
step 1000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.669898
step 1100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.684949
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.697576
step 1300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.706632
step 1400, accuracy on validation batch: 0.875, accuracy on mal data: 0.717729
step 1500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.730995
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.739796
step 1700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.747449
step 1800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.757015
step 1900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.763138
step 2000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.76875
step 2100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.772449
step 2200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.776275
step 2300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.781632
step 2400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.785842
step 2500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.787245
step 2600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.791199
step 2700, accuracy on validation batch: 0.875, accuracy on mal data: 0.79477
step 2800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.797831
step 2900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.800255
step 3000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.802933
step 3100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.804081
step 3200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.806888
step 3300, accuracy on validation batch: 0.875, accuracy on mal data: 0.808418
step 3400, accuracy on validation batch: 0.875, accuracy on mal data: 0.810076
step 3500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.810969
step 3600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.811607
step 3700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.814158
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.815944
step 3900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.816964
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.819132
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81977
step 4200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.820918
step 4300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821683
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822066
step 4500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823469
step 4600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823724
step 4700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823979
step 4800, accuracy on validation batch: 0.875, accuracy on mal data: 0.823979
step 4900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.824234
step 5000, accuracy on validation batch: 0.875, accuracy on mal data: 0.824362
step 5100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824617
step 5200, accuracy on validation batch: 0.945312, accuracy on mal data: 0.824872
step 5300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825382
step 5400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826148
step 5500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82602
step 5600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82602
step 5700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826148
step 5800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826658
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82704
step 6000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82704
step 6100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82704
step 6200, accuracy on validation batch: 0.875, accuracy on mal data: 0.827806
step 6300, accuracy on validation batch: 0.953125, accuracy on mal data: 0.828061
step 6400, accuracy on validation batch: 0.875, accuracy on mal data: 0.828316
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828188
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828571
step 6700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828571
step 6800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828826
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828826
step 7000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829464
step 7100, accuracy on validation batch: 0.875, accuracy on mal data: 0.829592
step 7200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830102
step 7300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830102
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830357
step 7500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830612
step 7600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.83074
step 7700, accuracy on validation batch: 0.875, accuracy on mal data: 0.83074
step 7800, accuracy on validation batch: 0.960938, accuracy on mal data: 0.831122
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83125
test set: accuracy on test set: 0.911
Done training net
0.910800021291
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.109375, accuracy on mal data: 0.111607
step 100, accuracy on validation batch: 0.34375, accuracy on mal data: 0.19477
step 200, accuracy on validation batch: 0.507812, accuracy on mal data: 0.285714
step 300, accuracy on validation batch: 0.671875, accuracy on mal data: 0.385204
step 400, accuracy on validation batch: 0.6875, accuracy on mal data: 0.464796
step 500, accuracy on validation batch: 0.757812, accuracy on mal data: 0.53074
step 600, accuracy on validation batch: 0.804688, accuracy on mal data: 0.575638
step 700, accuracy on validation batch: 0.765625, accuracy on mal data: 0.614158
step 800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.63801
step 900, accuracy on validation batch: 0.820312, accuracy on mal data: 0.6625
step 1000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.678954
step 1100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.692602
step 1200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.707525
step 1300, accuracy on validation batch: 0.875, accuracy on mal data: 0.722194
step 1400, accuracy on validation batch: 0.828125, accuracy on mal data: 0.73227
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.741837
step 1600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.749234
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.758546
step 1800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.765051
step 1900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.771556
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.775382
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.779464
step 2200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.78278
step 2300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.785714
step 2400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.789796
step 2500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.791964
step 2600, accuracy on validation batch: 0.875, accuracy on mal data: 0.79528
step 2700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.798087
step 2800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.799234
step 2900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.802551
step 3000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.80574
step 3100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.806888
step 3200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.808801
step 3300, accuracy on validation batch: 0.875, accuracy on mal data: 0.808801
step 3400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.810459
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.811224
step 3600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.8125
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.81403
step 3800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.815051
step 3900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816199
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816199
step 4100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.817219
step 4200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.817984
step 4300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.81875
step 4400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.818877
step 4500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.81977
step 4600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.820535
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.820663
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822194
step 4900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.822704
step 5000, accuracy on validation batch: 0.945312, accuracy on mal data: 0.822704
step 5100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.823342
step 5200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823852
step 5300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.824362
step 5400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82551
step 5500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825637
step 5600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826658
step 5700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.826785
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827041
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82704
step 6000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.827041
step 6100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.82704
step 6200, accuracy on validation batch: 0.953125, accuracy on mal data: 0.827551
step 6300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828061
step 6400, accuracy on validation batch: 0.953125, accuracy on mal data: 0.828061
step 6500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828189
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828699
step 6700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829209
step 6800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829464
step 6900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829464
step 7000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829592
step 7100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830229
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830102
step 7300, accuracy on validation batch: 0.960938, accuracy on mal data: 0.830229
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830229
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830867
step 7600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.83125
step 7700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831377
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83176
step 7900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832015
test set: accuracy on test set: 0.910
Done training net
0.910400018692
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 32, 'nb_neurons_2': 256, 'nb_neurons_3': 128}
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 256, 'nb_neurons_3': 128}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0897959
step 100, accuracy on validation batch: 0.242188, accuracy on mal data: 0.166071
step 200, accuracy on validation batch: 0.523438, accuracy on mal data: 0.258291
step 300, accuracy on validation batch: 0.671875, accuracy on mal data: 0.357653
step 400, accuracy on validation batch: 0.726562, accuracy on mal data: 0.447449
step 500, accuracy on validation batch: 0.726562, accuracy on mal data: 0.520791
step 600, accuracy on validation batch: 0.828125, accuracy on mal data: 0.576658
step 700, accuracy on validation batch: 0.78125, accuracy on mal data: 0.608036
step 800, accuracy on validation batch: 0.804688, accuracy on mal data: 0.634566
step 900, accuracy on validation batch: 0.8125, accuracy on mal data: 0.656122
step 1000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.673469
step 1100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.689541
step 1200, accuracy on validation batch: 0.78125, accuracy on mal data: 0.704081
step 1300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.71926
step 1400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.729592
step 1500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.741709
step 1600, accuracy on validation batch: 0.875, accuracy on mal data: 0.750638
step 1700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.761607
step 1800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.768112
step 1900, accuracy on validation batch: 0.875, accuracy on mal data: 0.774617
step 2000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.78074
step 2100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.785459
step 2200, accuracy on validation batch: 0.875, accuracy on mal data: 0.789796
step 2300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.793495
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.795918
step 2500, accuracy on validation batch: 0.875, accuracy on mal data: 0.797831
step 2600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.80153
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.804209
step 2800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.80625
step 2900, accuracy on validation batch: 0.875, accuracy on mal data: 0.808291
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.809183
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.809949
step 3200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.810714
step 3300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.8125
step 3400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.812627
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.814158
step 3600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.814923
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815944
step 3800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817219
step 3900, accuracy on validation batch: 0.875, accuracy on mal data: 0.818622
step 4000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819005
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.819515
step 4200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820408
step 4300, accuracy on validation batch: 0.875, accuracy on mal data: 0.821046
step 4400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.821556
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821939
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823087
step 4700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823341
step 4800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.823724
step 4900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.824234
step 5000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.824489
step 5100, accuracy on validation batch: 0.953125, accuracy on mal data: 0.824745
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825255
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825893
step 5400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.826275
step 5500, accuracy on validation batch: 0.875, accuracy on mal data: 0.826403
step 5600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.827041
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826785
step 5800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826913
step 5900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826913
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827296
step 6100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.827933
step 6200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828189
step 6300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828571
step 6400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828571
step 6500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.828699
step 6600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828954
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829336
step 6800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830102
step 6900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830357
step 7000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830357
step 7100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830357
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830739
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83125
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831887
step 7500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832143
step 7600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83227
step 7700, accuracy on validation batch: 0.875, accuracy on mal data: 0.833035
step 7800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.833291
step 7900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.833291
test set: accuracy on test set: 0.910
Done training net
0.910400021076
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 8, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 8, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0625, accuracy on mal data: 0.107143
step 100, accuracy on validation batch: 0.289062, accuracy on mal data: 0.164286
step 200, accuracy on validation batch: 0.554688, accuracy on mal data: 0.250128
step 300, accuracy on validation batch: 0.578125, accuracy on mal data: 0.340689
step 400, accuracy on validation batch: 0.757812, accuracy on mal data: 0.429719
step 500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.495536
step 600, accuracy on validation batch: 0.757812, accuracy on mal data: 0.550383
step 700, accuracy on validation batch: 0.8125, accuracy on mal data: 0.587755
step 800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.619005
step 900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.642602
step 1000, accuracy on validation batch: 0.804688, accuracy on mal data: 0.663138
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.68227
step 1200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.698979
step 1300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.711734
step 1400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.723087
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.734183
step 1600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.745153
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.750765
step 1800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.759949
step 1900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.767857
step 2000, accuracy on validation batch: 0.875, accuracy on mal data: 0.776785
step 2100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.78125
step 2200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.786352
step 2300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.789413
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.79324
step 2500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.796173
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.799107
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.800893
step 2800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.803571
step 2900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.806377
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.808801
step 3100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.811479
step 3200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.812372
step 3300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.812372
step 3400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.813903
step 3500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.814286
step 3600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.815051
step 3700, accuracy on validation batch: 0.875, accuracy on mal data: 0.816326
step 3800, accuracy on validation batch: 0.96875, accuracy on mal data: 0.817602
step 3900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.818495
step 4000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.81875
step 4100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.81926
step 4200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82028
step 4300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821428
step 4400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.822066
step 4500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822194
step 4600, accuracy on validation batch: 0.875, accuracy on mal data: 0.822449
step 4700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823087
step 4800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823469
step 4900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824107
step 5000, accuracy on validation batch: 0.875, accuracy on mal data: 0.824107
step 5100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824362
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824362
step 5300, accuracy on validation batch: 0.875, accuracy on mal data: 0.825127
step 5400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.825382
step 5500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825382
step 5600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825637
step 5700, accuracy on validation batch: 0.945312, accuracy on mal data: 0.826275
step 5800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826658
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827296
step 6000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827551
step 6100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827806
step 6200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827806
step 6300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828061
step 6400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828316
step 6500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828444
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829081
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829081
step 6800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829336
step 6900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829592
step 7000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.829719
step 7100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830102
step 7200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830612
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830867
step 7400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830995
step 7500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830995
step 7600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831122
step 7700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831632
step 7800, accuracy on validation batch: 0.960938, accuracy on mal data: 0.83176
step 7900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832015
test set: accuracy on test set: 0.910
Done training net
0.910300025344
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 32, 'nb_neurons_2': 8, 'nb_neurons_3': 128}
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 8, 'nb_neurons_3': 128}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.109375, accuracy on mal data: 0.115944
step 100, accuracy on validation batch: 0.304688, accuracy on mal data: 0.204719
step 200, accuracy on validation batch: 0.460938, accuracy on mal data: 0.287117
step 300, accuracy on validation batch: 0.695312, accuracy on mal data: 0.379719
step 400, accuracy on validation batch: 0.726562, accuracy on mal data: 0.463393
step 500, accuracy on validation batch: 0.75, accuracy on mal data: 0.534311
step 600, accuracy on validation batch: 0.8125, accuracy on mal data: 0.585714
step 700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.615306
step 800, accuracy on validation batch: 0.78125, accuracy on mal data: 0.638138
step 900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.65727
step 1000, accuracy on validation batch: 0.78125, accuracy on mal data: 0.677551
step 1100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.690944
step 1200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.700893
step 1300, accuracy on validation batch: 0.828125, accuracy on mal data: 0.712627
step 1400, accuracy on validation batch: 0.820312, accuracy on mal data: 0.722449
step 1500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.731377
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.742857
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.750638
step 1800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.756887
step 1900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.764158
step 2000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.766964
step 2100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.772704
step 2200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.779081
step 2300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.783036
step 2400, accuracy on validation batch: 0.875, accuracy on mal data: 0.78852
step 2500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.792092
step 2600, accuracy on validation batch: 0.875, accuracy on mal data: 0.796939
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.798597
step 2800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.803189
step 2900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.803954
step 3000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.806377
step 3100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.809694
step 3200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.811862
step 3300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.813265
step 3400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.814158
step 3500, accuracy on validation batch: 0.875, accuracy on mal data: 0.815306
step 3600, accuracy on validation batch: 0.875, accuracy on mal data: 0.816581
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817857
step 3800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.819132
step 3900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.820025
step 4000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820535
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821046
step 4200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822066
step 4300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822704
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823087
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823852
step 4600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825382
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82551
step 4800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.825638
step 4900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.82602
step 5000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82653
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827168
step 5200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827296
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827296
step 5400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.827551
step 5500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828061
step 5600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828189
step 5700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828571
step 5800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828954
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828954
step 6000, accuracy on validation batch: 0.875, accuracy on mal data: 0.828954
step 6100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829464
step 6200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830102
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830612
step 6400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830612
step 6500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830867
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831122
step 6700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.831505
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831505
step 6900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.831505
step 7000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831505
step 7100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831505
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83176
step 7300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831887
step 7400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83227
step 7500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832525
step 7600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832908
step 7700, accuracy on validation batch: 0.945312, accuracy on mal data: 0.832908
step 7800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832908
step 7900, accuracy on validation batch: 0.953125, accuracy on mal data: 0.833418
test set: accuracy on test set: 0.910
Done training net
0.910200024843
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 32, 'nb_neurons_2': 8, 'nb_neurons_3': 128}
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 8, 'nb_neurons_3': 128}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.109375, accuracy on mal data: 0.1
step 100, accuracy on validation batch: 0.320312, accuracy on mal data: 0.158673
step 200, accuracy on validation batch: 0.515625, accuracy on mal data: 0.234566
step 300, accuracy on validation batch: 0.554688, accuracy on mal data: 0.324235
step 400, accuracy on validation batch: 0.664062, accuracy on mal data: 0.40574
step 500, accuracy on validation batch: 0.734375, accuracy on mal data: 0.481377
step 600, accuracy on validation batch: 0.765625, accuracy on mal data: 0.53852
step 700, accuracy on validation batch: 0.757812, accuracy on mal data: 0.584184
step 800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.61199
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.635587
step 1000, accuracy on validation batch: 0.8125, accuracy on mal data: 0.660331
step 1100, accuracy on validation batch: 0.875, accuracy on mal data: 0.677678
step 1200, accuracy on validation batch: 0.8125, accuracy on mal data: 0.690689
step 1300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.709056
step 1400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.71926
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.733163
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.742729
step 1700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.753061
step 1800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.762245
step 1900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.768367
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.774234
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.778061
step 2200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.781505
step 2300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.78699
step 2400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.792857
step 2500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.795791
step 2600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.797194
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.798979
step 2800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.80051
step 2900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.803699
step 3000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.80574
step 3100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.807398
step 3200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.810076
step 3300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.811607
step 3400, accuracy on validation batch: 0.875, accuracy on mal data: 0.81301
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.813137
step 3600, accuracy on validation batch: 0.875, accuracy on mal data: 0.81403
step 3700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.814541
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.815433
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.816326
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816836
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81824
step 4200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.820408
step 4300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821301
step 4400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821939
step 4500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823214
step 4600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.823852
step 4700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824362
step 4800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824745
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824745
step 5000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824872
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824872
step 5200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.824872
step 5300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825255
step 5400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.825637
step 5500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.826785
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827041
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827041
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827168
step 5900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827168
step 6000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827806
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827806
step 6200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827933
step 6300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827933
step 6400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828571
step 6500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829209
step 6600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.829847
step 6700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830229
step 6800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830612
step 6900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830612
step 7000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.831122
step 7100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831122
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830995
step 7300, accuracy on validation batch: 0.875, accuracy on mal data: 0.831122
step 7400, accuracy on validation batch: 0.875, accuracy on mal data: 0.831505
step 7500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831505
step 7600, accuracy on validation batch: 0.960938, accuracy on mal data: 0.831505
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831632
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831887
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831887
test set: accuracy on test set: 0.910
Done training net
0.910200018883
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 8, 'nb_neurons_2': 256, 'nb_neurons_3': 128}
training!
{'nb_neurons_1': 8, 'nb_neurons_2': 256, 'nb_neurons_3': 128}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.100765
step 100, accuracy on validation batch: 0.257812, accuracy on mal data: 0.176275
step 200, accuracy on validation batch: 0.523438, accuracy on mal data: 0.273342
step 300, accuracy on validation batch: 0.617188, accuracy on mal data: 0.355995
step 400, accuracy on validation batch: 0.65625, accuracy on mal data: 0.445663
step 500, accuracy on validation batch: 0.773438, accuracy on mal data: 0.512883
step 600, accuracy on validation batch: 0.773438, accuracy on mal data: 0.573342
step 700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.610842
step 800, accuracy on validation batch: 0.804688, accuracy on mal data: 0.640306
step 900, accuracy on validation batch: 0.820312, accuracy on mal data: 0.663648
step 1000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.684311
step 1100, accuracy on validation batch: 0.789062, accuracy on mal data: 0.696046
step 1200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.709821
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.721684
step 1400, accuracy on validation batch: 0.804688, accuracy on mal data: 0.731377
step 1500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.738648
step 1600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.747704
step 1700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.756633
step 1800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.764285
step 1900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.770408
step 2000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.773852
step 2100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.779464
step 2200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.783546
step 2300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.787372
step 2400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.791837
step 2500, accuracy on validation batch: 0.875, accuracy on mal data: 0.795408
step 2600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.798979
step 2700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.802296
step 2800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.804081
step 2900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.805867
step 3000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.806888
step 3100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.808801
step 3200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.810586
step 3300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.810969
step 3400, accuracy on validation batch: 0.960938, accuracy on mal data: 0.812372
step 3500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.814158
step 3600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.815944
step 3700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.816581
step 3800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.817857
step 3900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.818367
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.818495
step 4100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.819515
step 4200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820408
step 4300, accuracy on validation batch: 0.875, accuracy on mal data: 0.821301
step 4400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821939
step 4500, accuracy on validation batch: 0.875, accuracy on mal data: 0.822066
step 4600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.822831
step 4700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822704
step 4800, accuracy on validation batch: 0.875, accuracy on mal data: 0.822959
step 4900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.823469
step 5000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824234
step 5100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.82449
step 5200, accuracy on validation batch: 0.875, accuracy on mal data: 0.824617
step 5300, accuracy on validation batch: 0.875, accuracy on mal data: 0.824745
step 5400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.825127
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825637
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.82602
step 5700, accuracy on validation batch: 0.875, accuracy on mal data: 0.826913
step 5800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827678
step 5900, accuracy on validation batch: 0.875, accuracy on mal data: 0.828061
step 6000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828188
step 6100, accuracy on validation batch: 0.960938, accuracy on mal data: 0.828316
step 6200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828571
step 6300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829209
step 6400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829464
step 6500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829847
step 6600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830229
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830484
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83074
step 6900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830739
step 7000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830739
step 7100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830739
step 7200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830739
step 7300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.830739
step 7400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831632
step 7500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.831632
step 7600, accuracy on validation batch: 0.953125, accuracy on mal data: 0.83227
step 7700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.832653
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83278
step 7900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.833291
test set: accuracy on test set: 0.911
Done training net
0.911200028062
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 32, 'nb_neurons_2': 256, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 256, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.101562, accuracy on mal data: 0.107653
step 100, accuracy on validation batch: 0.304688, accuracy on mal data: 0.179974
step 200, accuracy on validation batch: 0.523438, accuracy on mal data: 0.271046
step 300, accuracy on validation batch: 0.679688, accuracy on mal data: 0.367474
step 400, accuracy on validation batch: 0.820312, accuracy on mal data: 0.453061
step 500, accuracy on validation batch: 0.804688, accuracy on mal data: 0.532908
step 600, accuracy on validation batch: 0.757812, accuracy on mal data: 0.588265
step 700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.615434
step 800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.6375
step 900, accuracy on validation batch: 0.78125, accuracy on mal data: 0.651913
step 1000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.671301
step 1100, accuracy on validation batch: 0.796875, accuracy on mal data: 0.685459
step 1200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.697704
step 1300, accuracy on validation batch: 0.820312, accuracy on mal data: 0.71352
step 1400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.723852
step 1500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.730485
step 1600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.737755
step 1700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.745918
step 1800, accuracy on validation batch: 0.875, accuracy on mal data: 0.754592
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.761734
step 2000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.767474
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.77602
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.780229
step 2300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.78278
step 2400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.785459
step 2500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.787627
step 2600, accuracy on validation batch: 0.875, accuracy on mal data: 0.790561
step 2700, accuracy on validation batch: 0.875, accuracy on mal data: 0.795408
step 2800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.798979
step 2900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.801785
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.803826
step 3100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.80625
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.80676
step 3300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.808546
step 3400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.809311
step 3500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.810076
step 3600, accuracy on validation batch: 0.828125, accuracy on mal data: 0.812372
step 3700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.813137
step 3800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.814541
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.814668
step 4000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816199
step 4100, accuracy on validation batch: 0.820312, accuracy on mal data: 0.817347
step 4200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.81875
step 4300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.81926
step 4400, accuracy on validation batch: 0.875, accuracy on mal data: 0.82028
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.820663
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821301
step 4700, accuracy on validation batch: 0.953125, accuracy on mal data: 0.822321
step 4800, accuracy on validation batch: 0.875, accuracy on mal data: 0.822576
step 4900, accuracy on validation batch: 0.875, accuracy on mal data: 0.824234
step 5000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.824362
step 5100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824872
step 5200, accuracy on validation batch: 0.875, accuracy on mal data: 0.825893
step 5300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.825893
step 5400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826275
step 5500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82653
step 5600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826658
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826785
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827296
step 5900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.827296
step 6000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827933
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828316
step 6200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828699
step 6300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829336
step 6400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829592
step 6500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829592
step 6600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829847
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829847
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829974
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830612
step 7000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830867
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831377
step 7200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831377
step 7300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.831377
step 7400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.831887
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832015
step 7600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832143
step 7700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832143
step 7800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.832525
step 7900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832653
test set: accuracy on test set: 0.910
Done training net
0.910400019884
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 32, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.117188, accuracy on mal data: 0.102296
step 100, accuracy on validation batch: 0.265625, accuracy on mal data: 0.164541
step 200, accuracy on validation batch: 0.53125, accuracy on mal data: 0.258163
step 300, accuracy on validation batch: 0.71875, accuracy on mal data: 0.365689
step 400, accuracy on validation batch: 0.75, accuracy on mal data: 0.448087
step 500, accuracy on validation batch: 0.734375, accuracy on mal data: 0.526531
step 600, accuracy on validation batch: 0.78125, accuracy on mal data: 0.575383
step 700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.620536
step 800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.64426
step 900, accuracy on validation batch: 0.773438, accuracy on mal data: 0.660331
step 1000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.676786
step 1100, accuracy on validation batch: 0.820312, accuracy on mal data: 0.690689
step 1200, accuracy on validation batch: 0.875, accuracy on mal data: 0.704719
step 1300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.719515
step 1400, accuracy on validation batch: 0.875, accuracy on mal data: 0.726148
step 1500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.736862
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.745153
step 1700, accuracy on validation batch: 0.875, accuracy on mal data: 0.752678
step 1800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.758036
step 1900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.765688
step 2000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.772831
step 2100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.778444
step 2200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.782525
step 2300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.788775
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.792347
step 2500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.795535
step 2600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.797831
step 2700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.80051
step 2800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.802933
step 2900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.805102
step 3000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.807143
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.809949
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.812755
step 3300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.813648
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.814668
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815944
step 3600, accuracy on validation batch: 0.875, accuracy on mal data: 0.817219
step 3700, accuracy on validation batch: 0.875, accuracy on mal data: 0.818367
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.819643
step 3900, accuracy on validation batch: 0.875, accuracy on mal data: 0.820408
step 4000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.820918
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821301
step 4200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821173
step 4300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.822449
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822831
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823342
step 4600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.823724
step 4700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.823852
step 4800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.824234
step 4900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824107
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824745
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825382
step 5200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.825765
step 5300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.825893
step 5400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826275
step 5500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826148
step 5600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.826658
step 5700, accuracy on validation batch: 0.875, accuracy on mal data: 0.826785
step 5800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826785
step 5900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826403
step 6000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827041
step 6100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.827168
step 6200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828061
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828444
step 6400, accuracy on validation batch: 0.875, accuracy on mal data: 0.828954
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829081
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829081
step 6700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829464
step 6800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.829719
step 6900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830102
step 7000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830102
step 7100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830484
step 7200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830612
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830867
step 7400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830867
step 7500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.83125
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830995
step 7700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83176
step 7800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83176
step 7900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832398
test set: accuracy on test set: 0.910
Done training net
0.909800027013
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0987245
step 100, accuracy on validation batch: 0.304688, accuracy on mal data: 0.165689
step 200, accuracy on validation batch: 0.53125, accuracy on mal data: 0.257781
step 300, accuracy on validation batch: 0.632812, accuracy on mal data: 0.351658
step 400, accuracy on validation batch: 0.757812, accuracy on mal data: 0.432908
step 500, accuracy on validation batch: 0.78125, accuracy on mal data: 0.501531
step 600, accuracy on validation batch: 0.796875, accuracy on mal data: 0.554592
step 700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.600638
step 800, accuracy on validation batch: 0.773438, accuracy on mal data: 0.624362
step 900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.643112
step 1000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.660587
step 1100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.676148
step 1200, accuracy on validation batch: 0.765625, accuracy on mal data: 0.691709
step 1300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.705867
step 1400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.717857
step 1500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.727806
step 1600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.7375
step 1700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.746301
step 1800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.753444
step 1900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.759694
step 2000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.768112
step 2100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.771683
step 2200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.776275
step 2300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.783291
step 2400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.7875
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.792092
step 2600, accuracy on validation batch: 0.875, accuracy on mal data: 0.79375
step 2700, accuracy on validation batch: 0.875, accuracy on mal data: 0.798724
step 2800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.801275
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.802551
step 3000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.804719
step 3100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.806632
step 3200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.807908
step 3300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.809183
step 3400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.810714
step 3500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.812755
step 3600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.814413
step 3700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.814923
step 3800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815051
step 3900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816326
step 4000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.818495
step 4100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.819005
step 4200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81926
step 4300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821046
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821428
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821939
step 4600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822194
step 4700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822576
step 4800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822704
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822959
step 5000, accuracy on validation batch: 0.875, accuracy on mal data: 0.823214
step 5100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823852
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824107
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825127
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825893
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826275
step 5600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826275
step 5700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.82653
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826658
step 5900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826913
step 6000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.826913
step 6100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827551
step 6200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827678
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827678
step 6400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828061
step 6500, accuracy on validation batch: 0.875, accuracy on mal data: 0.828444
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829081
step 6700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829209
step 6800, accuracy on validation batch: 0.953125, accuracy on mal data: 0.829592
step 6900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.829719
step 7000, accuracy on validation batch: 0.875, accuracy on mal data: 0.829847
step 7100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829847
step 7200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829847
step 7300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830229
step 7400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830229
step 7500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830357
step 7600, accuracy on validation batch: 0.875, accuracy on mal data: 0.830612
step 7700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830867
step 7800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831377
step 7900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832143
test set: accuracy on test set: 0.910
Done training net
0.910100021958
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 32, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0952806
step 100, accuracy on validation batch: 0.234375, accuracy on mal data: 0.180357
step 200, accuracy on validation batch: 0.5, accuracy on mal data: 0.255867
step 300, accuracy on validation batch: 0.617188, accuracy on mal data: 0.33699
step 400, accuracy on validation batch: 0.671875, accuracy on mal data: 0.420791
step 500, accuracy on validation batch: 0.734375, accuracy on mal data: 0.489923
step 600, accuracy on validation batch: 0.765625, accuracy on mal data: 0.539796
step 700, accuracy on validation batch: 0.78125, accuracy on mal data: 0.578189
step 800, accuracy on validation batch: 0.804688, accuracy on mal data: 0.611097
step 900, accuracy on validation batch: 0.796875, accuracy on mal data: 0.636607
step 1000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.658036
step 1100, accuracy on validation batch: 0.726562, accuracy on mal data: 0.674235
step 1200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.686479
step 1300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.699234
step 1400, accuracy on validation batch: 0.820312, accuracy on mal data: 0.714923
step 1500, accuracy on validation batch: 0.757812, accuracy on mal data: 0.727041
step 1600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.736862
step 1700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.745791
step 1800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.753699
step 1900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.763138
step 2000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.76977
step 2100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.774234
step 2200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.780357
step 2300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.783673
step 2400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.788138
step 2500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.793367
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.797321
step 2700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.799745
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.801913
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.803444
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.805229
step 3100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.807653
step 3200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.808928
step 3300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.810076
step 3400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.812627
step 3500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.812627
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.813775
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815051
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.815816
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817219
step 4000, accuracy on validation batch: 0.945312, accuracy on mal data: 0.817602
step 4100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817984
step 4200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817984
step 4300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.818495
step 4400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.81875
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.81977
step 4600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.821173
step 4700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.821938
step 4800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.822449
step 4900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823086
step 5000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823214
step 5100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823469
step 5200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823852
step 5300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.824872
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825382
step 5500, accuracy on validation batch: 0.976562, accuracy on mal data: 0.825127
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825638
step 5700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82602
step 5800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826658
step 5900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.826913
step 6000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826785
step 6100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.827296
step 6200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827423
step 6300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827551
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828188
step 6500, accuracy on validation batch: 0.875, accuracy on mal data: 0.829081
step 6600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829209
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829592
step 6800, accuracy on validation batch: 0.953125, accuracy on mal data: 0.829592
step 6900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829974
step 7000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830102
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830484
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831122
step 7300, accuracy on validation batch: 0.945312, accuracy on mal data: 0.831122
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831377
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831505
step 7600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83176
step 7700, accuracy on validation batch: 0.960938, accuracy on mal data: 0.83227
step 7800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832398
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832525
test set: accuracy on test set: 0.911
Done training net
0.910500025153
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 32, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0941327
step 100, accuracy on validation batch: 0.3125, accuracy on mal data: 0.171173
step 200, accuracy on validation batch: 0.5625, accuracy on mal data: 0.274107
step 300, accuracy on validation batch: 0.679688, accuracy on mal data: 0.370408
step 400, accuracy on validation batch: 0.65625, accuracy on mal data: 0.457908
step 500, accuracy on validation batch: 0.734375, accuracy on mal data: 0.526913
step 600, accuracy on validation batch: 0.75, accuracy on mal data: 0.58227
step 700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.616199
step 800, accuracy on validation batch: 0.875, accuracy on mal data: 0.645536
step 900, accuracy on validation batch: 0.8125, accuracy on mal data: 0.669388
step 1000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.688265
step 1100, accuracy on validation batch: 0.773438, accuracy on mal data: 0.70727
step 1200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.71824
step 1300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.729209
step 1400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.73699
step 1500, accuracy on validation batch: 0.78125, accuracy on mal data: 0.745663
step 1600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.754847
step 1700, accuracy on validation batch: 0.8125, accuracy on mal data: 0.762372
step 1800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.769387
step 1900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.772576
step 2000, accuracy on validation batch: 0.875, accuracy on mal data: 0.778571
step 2100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.782015
step 2200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.786607
step 2300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.789796
step 2400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.792347
step 2500, accuracy on validation batch: 0.828125, accuracy on mal data: 0.794132
step 2600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.796556
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.799489
step 2800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.801275
step 2900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.803699
step 3000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.804847
step 3100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.80778
step 3200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.809183
step 3300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.809949
step 3400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.811607
step 3500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.813137
step 3600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.814413
step 3700, accuracy on validation batch: 0.875, accuracy on mal data: 0.815688
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.817219
step 3900, accuracy on validation batch: 0.875, accuracy on mal data: 0.817347
step 4000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81824
step 4100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.819132
step 4200, accuracy on validation batch: 0.945312, accuracy on mal data: 0.82028
step 4300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821301
step 4400, accuracy on validation batch: 0.875, accuracy on mal data: 0.822066
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822321
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823214
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823086
step 4800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823086
step 4900, accuracy on validation batch: 0.875, accuracy on mal data: 0.824234
step 5000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824745
step 5100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.825255
step 5200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825893
step 5300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826658
step 5400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.82704
step 5500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827168
step 5600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827551
step 5700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.827806
step 5800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827933
step 5900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.828316
step 6000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828316
step 6100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828826
step 6200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828954
step 6300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829464
step 6400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829592
step 6500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829592
step 6600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829464
step 6700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829464
step 6800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829592
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829592
step 7000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829847
step 7100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830102
step 7200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.830357
step 7300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830867
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831122
step 7500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.831122
step 7600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83125
step 7700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831505
step 7800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831632
step 7900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83176
test set: accuracy on test set: 0.911
Done training net
0.911400020719
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 64, 'nb_neurons_2': 32, 'nb_neurons_3': 16}
training!
{'nb_neurons_1': 64, 'nb_neurons_2': 32, 'nb_neurons_3': 16}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.125, accuracy on mal data: 0.0920918
step 100, accuracy on validation batch: 0.25, accuracy on mal data: 0.168878
step 200, accuracy on validation batch: 0.460938, accuracy on mal data: 0.25051
step 300, accuracy on validation batch: 0.554688, accuracy on mal data: 0.350638
step 400, accuracy on validation batch: 0.640625, accuracy on mal data: 0.443495
step 500, accuracy on validation batch: 0.710938, accuracy on mal data: 0.517474
step 600, accuracy on validation batch: 0.773438, accuracy on mal data: 0.569898
step 700, accuracy on validation batch: 0.757812, accuracy on mal data: 0.60727
step 800, accuracy on validation batch: 0.78125, accuracy on mal data: 0.636479
step 900, accuracy on validation batch: 0.820312, accuracy on mal data: 0.658418
step 1000, accuracy on validation batch: 0.789062, accuracy on mal data: 0.671683
step 1100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.684566
step 1200, accuracy on validation batch: 0.804688, accuracy on mal data: 0.700255
step 1300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.712627
step 1400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.727296
step 1500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.73852
step 1600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.746046
step 1700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.756122
step 1800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.763265
step 1900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.76875
step 2000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.772959
step 2100, accuracy on validation batch: 0.875, accuracy on mal data: 0.776275
step 2200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.782398
step 2300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.787755
step 2400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.790944
step 2500, accuracy on validation batch: 0.875, accuracy on mal data: 0.793622
step 2600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.797321
step 2700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.801275
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.802933
step 2900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.804592
step 3000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.806377
step 3100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.808418
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.808673
step 3300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.810969
step 3400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.812245
step 3500, accuracy on validation batch: 0.875, accuracy on mal data: 0.813648
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.814541
step 3700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.814668
step 3800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815051
step 3900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.816709
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.818112
step 4100, accuracy on validation batch: 0.875, accuracy on mal data: 0.818877
step 4200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.819515
step 4300, accuracy on validation batch: 0.804688, accuracy on mal data: 0.820025
step 4400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820025
step 4500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.821173
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821428
step 4700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822066
step 4800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.822576
step 4900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.822576
step 5000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823469
step 5100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823597
step 5200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823852
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824362
step 5400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825127
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82602
step 5600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82602
step 5700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826275
step 5800, accuracy on validation batch: 0.875, accuracy on mal data: 0.827296
step 5900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827678
step 6000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827678
step 6100, accuracy on validation batch: 0.875, accuracy on mal data: 0.828444
step 6200, accuracy on validation batch: 0.945312, accuracy on mal data: 0.828571
step 6300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829209
step 6400, accuracy on validation batch: 0.875, accuracy on mal data: 0.829337
step 6500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829847
step 6600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830357
step 6700, accuracy on validation batch: 0.875, accuracy on mal data: 0.830995
step 6800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.831377
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831377
step 7000, accuracy on validation batch: 0.953125, accuracy on mal data: 0.831377
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831377
step 7200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831632
step 7300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831632
step 7400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.831887
step 7500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83227
step 7600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83227
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83278
step 7800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.833035
step 7900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.833291
test set: accuracy on test set: 0.910
Done training net
0.910300021768
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0889031
step 100, accuracy on validation batch: 0.289062, accuracy on mal data: 0.158163
step 200, accuracy on validation batch: 0.492188, accuracy on mal data: 0.247704
step 300, accuracy on validation batch: 0.585938, accuracy on mal data: 0.340944
step 400, accuracy on validation batch: 0.734375, accuracy on mal data: 0.435204
step 500, accuracy on validation batch: 0.75, accuracy on mal data: 0.514541
step 600, accuracy on validation batch: 0.734375, accuracy on mal data: 0.570281
step 700, accuracy on validation batch: 0.796875, accuracy on mal data: 0.609439
step 800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.6375
step 900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.655867
step 1000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.675382
step 1100, accuracy on validation batch: 0.820312, accuracy on mal data: 0.692602
step 1200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.704719
step 1300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.71977
step 1400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.73125
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.738903
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.745536
step 1700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.752423
step 1800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.761479
step 1900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.768367
step 2000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.771428
step 2100, accuracy on validation batch: 0.875, accuracy on mal data: 0.779592
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.784949
step 2300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.789413
step 2400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.794898
step 2500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.797321
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.799617
step 2700, accuracy on validation batch: 0.875, accuracy on mal data: 0.801658
step 2800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.804081
step 2900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.807143
step 3000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.808673
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.810076
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.810586
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.811607
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.813648
step 3500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815051
step 3600, accuracy on validation batch: 0.960938, accuracy on mal data: 0.816199
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816709
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817219
step 3900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817729
step 4000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819132
step 4100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819515
step 4200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.819643
step 4300, accuracy on validation batch: 0.828125, accuracy on mal data: 0.81977
step 4400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82028
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820663
step 4600, accuracy on validation batch: 0.875, accuracy on mal data: 0.820918
step 4700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821683
step 4800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822194
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823086
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823597
step 5100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.823852
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824362
step 5300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825
step 5400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825127
step 5500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.82551
step 5600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.825637
step 5700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826275
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826785
step 5900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826785
step 6000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827168
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827423
step 6200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828061
step 6300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828444
step 6400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828699
step 6500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829464
step 6600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.829719
step 6700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829974
step 6800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829974
step 6900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830102
step 7000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830357
step 7100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830357
step 7200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830739
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830739
step 7400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831377
step 7500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831377
step 7600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.83125
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831377
step 7800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.831377
step 7900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.831505
test set: accuracy on test set: 0.909
Done training net
0.909100020528
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 32, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.104209
step 100, accuracy on validation batch: 0.28125, accuracy on mal data: 0.164796
step 200, accuracy on validation batch: 0.476562, accuracy on mal data: 0.25676
step 300, accuracy on validation batch: 0.609375, accuracy on mal data: 0.356888
step 400, accuracy on validation batch: 0.609375, accuracy on mal data: 0.446173
step 500, accuracy on validation batch: 0.789062, accuracy on mal data: 0.515306
step 600, accuracy on validation batch: 0.734375, accuracy on mal data: 0.564796
step 700, accuracy on validation batch: 0.757812, accuracy on mal data: 0.59898
step 800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.627423
step 900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.651403
step 1000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.667857
step 1100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.685842
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.7
step 1300, accuracy on validation batch: 0.773438, accuracy on mal data: 0.713265
step 1400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.722959
step 1500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.735331
step 1600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.745408
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.754464
step 1800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.760587
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.767474
step 2000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.771939
step 2100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.778316
step 2200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.783418
step 2300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.786862
step 2400, accuracy on validation batch: 0.820312, accuracy on mal data: 0.791326
step 2500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.793367
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.795791
step 2700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.798087
step 2800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.801148
step 2900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.803316
step 3000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.806122
step 3100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.80676
step 3200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.808801
step 3300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.810459
step 3400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.811862
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.814285
step 3600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.815816
step 3700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.816709
step 3800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.819132
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.819643
step 4000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.821556
step 4100, accuracy on validation batch: 0.875, accuracy on mal data: 0.822704
step 4200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.822831
step 4300, accuracy on validation batch: 0.875, accuracy on mal data: 0.822959
step 4400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823469
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823979
step 4600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823979
step 4700, accuracy on validation batch: 0.875, accuracy on mal data: 0.824107
step 4800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824745
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825255
step 5000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825893
step 5100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826658
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827168
step 5300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827806
step 5400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828316
step 5500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828316
step 5600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828061
step 5700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828061
step 5800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828444
step 5900, accuracy on validation batch: 0.960938, accuracy on mal data: 0.829336
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829719
step 6100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829974
step 6200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830102
step 6300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830484
step 6400, accuracy on validation batch: 0.875, accuracy on mal data: 0.830739
step 6500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830995
step 6600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830867
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830995
step 6800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830995
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83125
step 7000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831377
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831505
step 7200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831505
step 7300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831632
step 7400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.831632
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831887
step 7600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.832143
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832143
step 7800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832398
step 7900, accuracy on validation batch: 0.96875, accuracy on mal data: 0.832398
test set: accuracy on test set: 0.910
Done training net
0.909900023341
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 32, 'nb_neurons_2': 8, 'nb_neurons_3': 128}
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 8, 'nb_neurons_3': 128}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0811225
step 100, accuracy on validation batch: 0.257812, accuracy on mal data: 0.146301
step 200, accuracy on validation batch: 0.476562, accuracy on mal data: 0.225383
step 300, accuracy on validation batch: 0.65625, accuracy on mal data: 0.329337
step 400, accuracy on validation batch: 0.773438, accuracy on mal data: 0.425893
step 500, accuracy on validation batch: 0.773438, accuracy on mal data: 0.500638
step 600, accuracy on validation batch: 0.742188, accuracy on mal data: 0.564286
step 700, accuracy on validation batch: 0.8125, accuracy on mal data: 0.606888
step 800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.63903
step 900, accuracy on validation batch: 0.796875, accuracy on mal data: 0.65727
step 1000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.680229
step 1100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.695535
step 1200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.709566
step 1300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.719898
step 1400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.730867
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.739413
step 1600, accuracy on validation batch: 0.875, accuracy on mal data: 0.748342
step 1700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.756632
step 1800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.762372
step 1900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.768112
step 2000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.773597
step 2100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.780102
step 2200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.78278
step 2300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.786097
step 2400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.790051
step 2500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.792729
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.794515
step 2700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.797959
step 2800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.80102
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.802551
step 3000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.805229
step 3100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.806888
step 3200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.808035
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.809056
step 3400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.810331
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.81199
step 3600, accuracy on validation batch: 0.875, accuracy on mal data: 0.812755
step 3700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.814668
step 3800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815944
step 3900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.816199
step 4000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.816581
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.817092
step 4200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817474
step 4300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.819005
step 4400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.819515
step 4500, accuracy on validation batch: 0.953125, accuracy on mal data: 0.81977
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820153
step 4700, accuracy on validation batch: 0.875, accuracy on mal data: 0.821811
step 4800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.822066
step 4900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822576
step 5000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823086
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823724
step 5200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824234
step 5300, accuracy on validation batch: 0.875, accuracy on mal data: 0.824362
step 5400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824745
step 5500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825255
step 5600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825765
step 5700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.826913
step 5800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827041
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827168
step 6000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827423
step 6100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827423
step 6200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.827806
step 6300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828316
step 6400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828699
step 6500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.829464
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829719
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829847
step 6800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829719
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830357
step 7000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830484
step 7100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83074
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830739
step 7300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830739
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830739
step 7500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.83125
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831887
step 7700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83176
step 7800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83176
step 7900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.83176
test set: accuracy on test set: 0.910
Done training net
0.910000019073
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 32, 'nb_neurons_2': 8, 'nb_neurons_3': 128}
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 8, 'nb_neurons_3': 128}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.195312, accuracy on mal data: 0.108929
step 100, accuracy on validation batch: 0.34375, accuracy on mal data: 0.179464
step 200, accuracy on validation batch: 0.460938, accuracy on mal data: 0.26301
step 300, accuracy on validation batch: 0.632812, accuracy on mal data: 0.380995
step 400, accuracy on validation batch: 0.726562, accuracy on mal data: 0.487628
step 500, accuracy on validation batch: 0.78125, accuracy on mal data: 0.553827
step 600, accuracy on validation batch: 0.804688, accuracy on mal data: 0.597321
step 700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.631377
step 800, accuracy on validation batch: 0.820312, accuracy on mal data: 0.658163
step 900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.680612
step 1000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.696683
step 1100, accuracy on validation batch: 0.820312, accuracy on mal data: 0.708928
step 1200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.720791
step 1300, accuracy on validation batch: 0.828125, accuracy on mal data: 0.731377
step 1400, accuracy on validation batch: 0.796875, accuracy on mal data: 0.738265
step 1500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.747576
step 1600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.756505
step 1700, accuracy on validation batch: 0.875, accuracy on mal data: 0.759694
step 1800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.765433
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.769643
step 2000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.775637
step 2100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.778954
step 2200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.784056
step 2300, accuracy on validation batch: 0.875, accuracy on mal data: 0.786352
step 2400, accuracy on validation batch: 0.820312, accuracy on mal data: 0.791326
step 2500, accuracy on validation batch: 0.875, accuracy on mal data: 0.795918
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.797831
step 2700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.800255
step 2800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.802423
step 2900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.804209
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.805357
step 3100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.807525
step 3200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.808546
step 3300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.809694
step 3400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.810586
step 3500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.811734
step 3600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.8125
step 3700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.813903
step 3800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.814796
step 3900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.815816
step 4000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.815944
step 4100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.817092
step 4200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.818495
step 4300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.818877
step 4400, accuracy on validation batch: 0.953125, accuracy on mal data: 0.81977
step 4500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.820153
step 4600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.820918
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821428
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822066
step 4900, accuracy on validation batch: 0.875, accuracy on mal data: 0.822959
step 5000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823597
step 5100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823979
step 5200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.82449
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82551
step 5400, accuracy on validation batch: 0.875, accuracy on mal data: 0.82551
step 5500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825893
step 5600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.82653
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82653
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82653
step 5900, accuracy on validation batch: 0.960938, accuracy on mal data: 0.826785
step 6000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827041
step 6100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827551
step 6200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827678
step 6300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828316
step 6400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828316
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828699
step 6600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828954
step 6700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829337
step 6800, accuracy on validation batch: 0.96875, accuracy on mal data: 0.829847
step 6900, accuracy on validation batch: 0.875, accuracy on mal data: 0.829974
step 7000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830102
step 7100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830357
step 7200, accuracy on validation batch: 0.875, accuracy on mal data: 0.830612
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831122
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83125
step 7500, accuracy on validation batch: 0.953125, accuracy on mal data: 0.831505
step 7600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.831505
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831887
step 7800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.832525
step 7900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832525
test set: accuracy on test set: 0.912
Done training net
0.911800024509
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0971939
step 100, accuracy on validation batch: 0.351562, accuracy on mal data: 0.16148
step 200, accuracy on validation batch: 0.601562, accuracy on mal data: 0.245153
step 300, accuracy on validation batch: 0.6875, accuracy on mal data: 0.341199
step 400, accuracy on validation batch: 0.726562, accuracy on mal data: 0.440689
step 500, accuracy on validation batch: 0.773438, accuracy on mal data: 0.513393
step 600, accuracy on validation batch: 0.710938, accuracy on mal data: 0.561735
step 700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.603061
step 800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.629337
step 900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.652934
step 1000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.674107
step 1100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.691199
step 1200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.704081
step 1300, accuracy on validation batch: 0.804688, accuracy on mal data: 0.716326
step 1400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.728444
step 1500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.739286
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.749745
step 1700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.754337
step 1800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.761862
step 1900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.769387
step 2000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.774234
step 2100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.778444
step 2200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.78176
step 2300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.786224
step 2400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.791964
step 2500, accuracy on validation batch: 0.875, accuracy on mal data: 0.795918
step 2600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.798979
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.80102
step 2800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.802041
step 2900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.803188
step 3000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.804974
step 3100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.806887
step 3200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.807908
step 3300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.809949
step 3400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.811479
step 3500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.813137
step 3600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.815561
step 3700, accuracy on validation batch: 0.953125, accuracy on mal data: 0.816326
step 3800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.816454
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.817729
step 4000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.818877
step 4100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.81977
step 4200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82028
step 4300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821428
step 4400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.821556
step 4500, accuracy on validation batch: 0.976562, accuracy on mal data: 0.822066
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822704
step 4700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823979
step 4800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824362
step 4900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825127
step 5000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825382
step 5100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.825382
step 5200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.82602
step 5300, accuracy on validation batch: 0.945312, accuracy on mal data: 0.82602
step 5400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.82602
step 5500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.82602
step 5600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826658
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826785
step 5800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.827296
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827423
step 6000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827933
step 6100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828444
step 6200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828444
step 6300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828444
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828699
step 6500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.828699
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828826
step 6700, accuracy on validation batch: 0.875, accuracy on mal data: 0.828826
step 6800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.828826
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829464
step 7000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829719
step 7100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830102
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830102
step 7300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830739
step 7400, accuracy on validation batch: 0.875, accuracy on mal data: 0.830484
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83125
step 7600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.83125
step 7700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831505
step 7800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831505
step 7900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832015
test set: accuracy on test set: 0.911
Done training net
0.910800024271
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 8, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 8, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0979592
step 100, accuracy on validation batch: 0.164062, accuracy on mal data: 0.159439
step 200, accuracy on validation batch: 0.515625, accuracy on mal data: 0.245663
step 300, accuracy on validation batch: 0.65625, accuracy on mal data: 0.336862
step 400, accuracy on validation batch: 0.742188, accuracy on mal data: 0.428827
step 500, accuracy on validation batch: 0.679688, accuracy on mal data: 0.502551
step 600, accuracy on validation batch: 0.71875, accuracy on mal data: 0.564668
step 700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.608163
step 800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.634949
step 900, accuracy on validation batch: 0.820312, accuracy on mal data: 0.658036
step 1000, accuracy on validation batch: 0.796875, accuracy on mal data: 0.673724
step 1100, accuracy on validation batch: 0.8125, accuracy on mal data: 0.68903
step 1200, accuracy on validation batch: 0.875, accuracy on mal data: 0.704464
step 1300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.718112
step 1400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.729592
step 1500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.738903
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.749107
step 1700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.756632
step 1800, accuracy on validation batch: 0.875, accuracy on mal data: 0.763775
step 1900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.771173
step 2000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.777296
step 2100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.78176
step 2200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.78699
step 2300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.789413
step 2400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.792347
step 2500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.796046
step 2600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.798342
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.800127
step 2800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.803316
step 2900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.805102
step 3000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.806887
step 3100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.808163
step 3200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.809949
step 3300, accuracy on validation batch: 0.875, accuracy on mal data: 0.811734
step 3400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.813137
step 3500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.814668
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815561
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816581
step 3800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.817219
step 3900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817984
step 4000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.818622
step 4100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.81926
step 4200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820408
step 4300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.821301
step 4400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822066
step 4500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.822576
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823597
step 4700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824489
step 4800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.825
step 4900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.82602
step 5100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826275
step 5200, accuracy on validation batch: 0.945312, accuracy on mal data: 0.82653
step 5300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826913
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827296
step 5500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.828061
step 5600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828188
step 5700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829209
step 5800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829336
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829719
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830102
step 6100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830612
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830612
step 6300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830612
step 6400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83074
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830739
step 6600, accuracy on validation batch: 0.953125, accuracy on mal data: 0.830739
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83125
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831505
step 6900, accuracy on validation batch: 0.875, accuracy on mal data: 0.831505
step 7000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831377
step 7100, accuracy on validation batch: 0.875, accuracy on mal data: 0.831887
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832015
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832143
step 7400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832143
step 7500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832143
step 7600, accuracy on validation batch: 0.875, accuracy on mal data: 0.832653
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832653
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832653
step 7900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83278
test set: accuracy on test set: 0.912
Done training net
0.912100020647
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.117188, accuracy on mal data: 0.084949
step 100, accuracy on validation batch: 0.375, accuracy on mal data: 0.160077
step 200, accuracy on validation batch: 0.554688, accuracy on mal data: 0.241327
step 300, accuracy on validation batch: 0.703125, accuracy on mal data: 0.334056
step 400, accuracy on validation batch: 0.765625, accuracy on mal data: 0.430102
step 500, accuracy on validation batch: 0.804688, accuracy on mal data: 0.506122
step 600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.561735
step 700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.601913
step 800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.632908
step 900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.652806
step 1000, accuracy on validation batch: 0.875, accuracy on mal data: 0.670918
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.688648
step 1200, accuracy on validation batch: 0.8125, accuracy on mal data: 0.70574
step 1300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.717474
step 1400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.727551
step 1500, accuracy on validation batch: 0.875, accuracy on mal data: 0.737372
step 1600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.744898
step 1700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.757398
step 1800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.762372
step 1900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.768495
step 2000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.775765
step 2100, accuracy on validation batch: 0.875, accuracy on mal data: 0.780995
step 2200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.784949
step 2300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.788775
step 2400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.791199
step 2500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.794643
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.797194
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.798852
step 2800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.800893
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.802934
step 3000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.804847
step 3100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.80625
step 3200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.807653
step 3300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.810076
step 3400, accuracy on validation batch: 0.960938, accuracy on mal data: 0.810714
step 3500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.811734
step 3600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.813648
step 3700, accuracy on validation batch: 0.875, accuracy on mal data: 0.813775
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.815178
step 3900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816326
step 4000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.816709
step 4100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.817219
step 4200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.818112
step 4300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819005
step 4400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.81926
step 4500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.81977
step 4600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820408
step 4700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.821556
step 4800, accuracy on validation batch: 0.875, accuracy on mal data: 0.822194
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822704
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824107
step 5100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824107
step 5200, accuracy on validation batch: 0.875, accuracy on mal data: 0.824617
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825255
step 5400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825255
step 5500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82602
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826403
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826403
step 5800, accuracy on validation batch: 0.875, accuracy on mal data: 0.826785
step 5900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827168
step 6000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827551
step 6100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827806
step 6200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827933
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827933
step 6400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828188
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828316
step 6600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828699
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829209
step 6800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829592
step 6900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830229
step 7000, accuracy on validation batch: 0.960938, accuracy on mal data: 0.830229
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830357
step 7200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830612
step 7300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830612
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830612
step 7500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83074
step 7600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830995
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831122
step 7800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83125
step 7900, accuracy on validation batch: 0.875, accuracy on mal data: 0.83125
test set: accuracy on test set: 0.909
Done training net
0.909400027394
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 32, 'nb_neurons_2': 128, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 128, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.15625, accuracy on mal data: 0.086352
step 100, accuracy on validation batch: 0.257812, accuracy on mal data: 0.152041
step 200, accuracy on validation batch: 0.539062, accuracy on mal data: 0.242219
step 300, accuracy on validation batch: 0.679688, accuracy on mal data: 0.336607
step 400, accuracy on validation batch: 0.75, accuracy on mal data: 0.434184
step 500, accuracy on validation batch: 0.742188, accuracy on mal data: 0.506633
step 600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.559056
step 700, accuracy on validation batch: 0.773438, accuracy on mal data: 0.602934
step 800, accuracy on validation batch: 0.75, accuracy on mal data: 0.629719
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.653699
step 1000, accuracy on validation batch: 0.757812, accuracy on mal data: 0.670025
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.685714
step 1200, accuracy on validation batch: 0.8125, accuracy on mal data: 0.698724
step 1300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.712755
step 1400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.728189
step 1500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.737117
step 1600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.747321
step 1700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.75574
step 1800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.761479
step 1900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.766071
step 2000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.771939
step 2100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.777296
step 2200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.781122
step 2300, accuracy on validation batch: 0.820312, accuracy on mal data: 0.784694
step 2400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.789541
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.792857
step 2600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.796556
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.800765
step 2800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.803316
step 2900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.806505
step 3000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.807525
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.809183
step 3200, accuracy on validation batch: 0.875, accuracy on mal data: 0.809949
step 3300, accuracy on validation batch: 0.875, accuracy on mal data: 0.811734
step 3400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.812882
step 3500, accuracy on validation batch: 0.875, accuracy on mal data: 0.813903
step 3600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.815944
step 3700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.816709
step 3800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817729
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.818622
step 4000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.819642
step 4100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820408
step 4200, accuracy on validation batch: 0.875, accuracy on mal data: 0.820535
step 4300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821428
step 4400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822194
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823086
step 4600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823342
step 4700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823724
step 4800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.823852
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824234
step 5000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824234
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825637
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825893
step 5400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826403
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826658
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827296
step 5700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827296
step 5800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827806
step 5900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828444
step 6000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.828444
step 6100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828826
step 6200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829081
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829719
step 6400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829719
step 6500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829719
step 6600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829974
step 6700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830484
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83074
step 6900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83125
step 7000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83125
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831632
step 7200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831887
step 7300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832398
step 7400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832398
step 7500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832653
step 7600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832653
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83278
step 7800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832653
step 7900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832908
test set: accuracy on test set: 0.909
Done training net
0.908800024986
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.171875, accuracy on mal data: 0.0767857
step 100, accuracy on validation batch: 0.265625, accuracy on mal data: 0.134821
step 200, accuracy on validation batch: 0.492188, accuracy on mal data: 0.208673
step 300, accuracy on validation batch: 0.664062, accuracy on mal data: 0.322449
step 400, accuracy on validation batch: 0.71875, accuracy on mal data: 0.428061
step 500, accuracy on validation batch: 0.71875, accuracy on mal data: 0.504209
step 600, accuracy on validation batch: 0.757812, accuracy on mal data: 0.557525
step 700, accuracy on validation batch: 0.804688, accuracy on mal data: 0.598342
step 800, accuracy on validation batch: 0.75, accuracy on mal data: 0.630102
step 900, accuracy on validation batch: 0.8125, accuracy on mal data: 0.650893
step 1000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.665816
step 1100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.686097
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.698214
step 1300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.710587
step 1400, accuracy on validation batch: 0.828125, accuracy on mal data: 0.721301
step 1500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.730867
step 1600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.74426
step 1700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.751148
step 1800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.758035
step 1900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.766454
step 2000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.772831
step 2100, accuracy on validation batch: 0.875, accuracy on mal data: 0.777933
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.781632
step 2300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.785842
step 2400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.78852
step 2500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.792474
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.79528
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.799234
step 2800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.80153
step 2900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.803316
step 3000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.806122
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.807398
step 3200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.808801
step 3300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.810459
step 3400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.813393
step 3500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.815178
step 3600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.817219
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.818495
step 3800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.819132
step 3900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.819515
step 4000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820153
step 4100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.820663
step 4200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.821046
step 4300, accuracy on validation batch: 0.875, accuracy on mal data: 0.821428
step 4400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822194
step 4500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.822959
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823979
step 4700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823979
step 4800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824362
step 4900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824872
step 5000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825765
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825893
step 5200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826148
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82653
step 5400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826785
step 5500, accuracy on validation batch: 0.828125, accuracy on mal data: 0.827168
step 5600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827678
step 5700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.827678
step 5800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827806
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827933
step 6000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828316
step 6100, accuracy on validation batch: 0.875, accuracy on mal data: 0.828699
step 6200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828699
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829081
step 6400, accuracy on validation batch: 0.976562, accuracy on mal data: 0.829081
step 6500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.829719
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830102
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830229
step 6800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830229
step 6900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830229
step 7000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830229
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830739
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830995
step 7300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83125
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831505
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832015
step 7600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831887
step 7700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831887
step 7800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832015
step 7900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832525
test set: accuracy on test set: 0.912
Done training net
0.911500024796
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0969388
step 100, accuracy on validation batch: 0.34375, accuracy on mal data: 0.171811
step 200, accuracy on validation batch: 0.523438, accuracy on mal data: 0.259821
step 300, accuracy on validation batch: 0.65625, accuracy on mal data: 0.351275
step 400, accuracy on validation batch: 0.710938, accuracy on mal data: 0.435842
step 500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.497194
step 600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.548087
step 700, accuracy on validation batch: 0.789062, accuracy on mal data: 0.586862
step 800, accuracy on validation batch: 0.75, accuracy on mal data: 0.620536
step 900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.64477
step 1000, accuracy on validation batch: 0.796875, accuracy on mal data: 0.666326
step 1100, accuracy on validation batch: 0.804688, accuracy on mal data: 0.681505
step 1200, accuracy on validation batch: 0.875, accuracy on mal data: 0.70051
step 1300, accuracy on validation batch: 0.828125, accuracy on mal data: 0.715561
step 1400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.724362
step 1500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.736224
step 1600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.745791
step 1700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.755229
step 1800, accuracy on validation batch: 0.875, accuracy on mal data: 0.761224
step 1900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.766071
step 2000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.772066
step 2100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.778699
step 2200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.783163
step 2300, accuracy on validation batch: 0.796875, accuracy on mal data: 0.7875
step 2400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.792092
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.795918
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.797321
step 2700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.801148
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.803316
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.806122
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.807525
step 3100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.811352
step 3200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.812627
step 3300, accuracy on validation batch: 0.875, accuracy on mal data: 0.813393
step 3400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.814668
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815944
step 3600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816836
step 3700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817474
step 3800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.818367
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819132
step 4000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819515
step 4100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820918
step 4200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821556
step 4300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822321
step 4400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822576
step 4500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.823341
step 4600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823342
step 4700, accuracy on validation batch: 0.875, accuracy on mal data: 0.823342
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824489
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825255
step 5000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825765
step 5100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825765
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825893
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825893
step 5400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82602
step 5500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826403
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82653
step 5700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827296
step 5800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827933
step 5900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828189
step 6000, accuracy on validation batch: 0.953125, accuracy on mal data: 0.828316
step 6100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828571
step 6200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828826
step 6300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829081
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829592
step 6500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829847
step 6600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829974
step 6700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830867
step 6800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83125
step 6900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.831505
step 7000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831505
step 7100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831632
step 7200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831887
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832143
step 7400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832015
step 7500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832143
step 7600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832398
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832398
step 7800, accuracy on validation batch: 0.875, accuracy on mal data: 0.832398
step 7900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832398
test set: accuracy on test set: 0.911
Done training net
0.910700027347
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0975765
step 100, accuracy on validation batch: 0.203125, accuracy on mal data: 0.169133
step 200, accuracy on validation batch: 0.484375, accuracy on mal data: 0.273087
step 300, accuracy on validation batch: 0.546875, accuracy on mal data: 0.370918
step 400, accuracy on validation batch: 0.617188, accuracy on mal data: 0.461224
step 500, accuracy on validation batch: 0.742188, accuracy on mal data: 0.532398
step 600, accuracy on validation batch: 0.789062, accuracy on mal data: 0.580102
step 700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.614286
step 800, accuracy on validation batch: 0.742188, accuracy on mal data: 0.639286
step 900, accuracy on validation batch: 0.757812, accuracy on mal data: 0.665816
step 1000, accuracy on validation batch: 0.8125, accuracy on mal data: 0.68074
step 1100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.693495
step 1200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.705229
step 1300, accuracy on validation batch: 0.8125, accuracy on mal data: 0.717985
step 1400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.72602
step 1500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.734311
step 1600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.743367
step 1700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.748724
step 1800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.755995
step 1900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.762117
step 2000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.766964
step 2100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.774234
step 2200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.778189
step 2300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.783546
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.787245
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.791709
step 2600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.793367
step 2700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.795663
step 2800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.797704
step 2900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.799234
step 3000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.802296
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.804081
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.806377
step 3300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.80778
step 3400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.809694
step 3500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.811097
step 3600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.813138
step 3700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.814413
step 3800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815688
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815433
step 4000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.816964
step 4100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817857
step 4200, accuracy on validation batch: 0.875, accuracy on mal data: 0.817984
step 4300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.81875
step 4400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.820025
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821046
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821428
step 4700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822449
step 4800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823469
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823979
step 5000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825255
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825382
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82602
step 5300, accuracy on validation batch: 0.960938, accuracy on mal data: 0.825893
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825765
step 5500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.82653
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826913
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826913
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827296
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827551
step 6000, accuracy on validation batch: 0.875, accuracy on mal data: 0.828061
step 6100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828826
step 6200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828826
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828954
step 6400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828954
step 6500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829209
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829336
step 6700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829464
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829464
step 6900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829464
step 7000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829719
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830357
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830612
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830612
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830867
step 7500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830995
step 7600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830995
step 7700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831122
step 7800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83176
step 7900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832525
test set: accuracy on test set: 0.911
Done training net
0.910900027156
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0908163
step 100, accuracy on validation batch: 0.296875, accuracy on mal data: 0.156378
step 200, accuracy on validation batch: 0.46875, accuracy on mal data: 0.245153
step 300, accuracy on validation batch: 0.554688, accuracy on mal data: 0.349617
step 400, accuracy on validation batch: 0.695312, accuracy on mal data: 0.433163
step 500, accuracy on validation batch: 0.71875, accuracy on mal data: 0.505995
step 600, accuracy on validation batch: 0.8125, accuracy on mal data: 0.560459
step 700, accuracy on validation batch: 0.734375, accuracy on mal data: 0.602041
step 800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.628444
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.65051
step 1000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.66977
step 1100, accuracy on validation batch: 0.8125, accuracy on mal data: 0.686352
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.69949
step 1300, accuracy on validation batch: 0.875, accuracy on mal data: 0.713393
step 1400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.724872
step 1500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.732908
step 1600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.742474
step 1700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.753061
step 1800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.761097
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.768112
step 2000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.775893
step 2100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.779847
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.784311
step 2300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.787372
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.789668
step 2500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.791964
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.795535
step 2700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.799234
step 2800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.802296
step 2900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.804592
step 3000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.807143
step 3100, accuracy on validation batch: 0.796875, accuracy on mal data: 0.809056
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.810204
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.811479
step 3400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.812627
step 3500, accuracy on validation batch: 0.953125, accuracy on mal data: 0.813393
step 3600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.814541
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815561
step 3800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.816581
step 3900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.816709
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817729
step 4100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.81875
step 4200, accuracy on validation batch: 0.875, accuracy on mal data: 0.819387
step 4300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.820408
step 4400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.820663
step 4500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.820663
step 4600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.821173
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821683
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822704
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823597
step 5000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823979
step 5100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.824362
step 5200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824617
step 5300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825382
step 5400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.825382
step 5500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82551
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825637
step 5700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826785
step 5800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827168
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827168
step 6000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827168
step 6100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827551
step 6200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827551
step 6300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827933
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828444
step 6500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828826
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829336
step 6700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829336
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829336
step 6900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829336
step 7000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829719
step 7100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830102
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830357
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830612
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830739
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83125
step 7600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83125
step 7700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831505
step 7800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831505
step 7900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832015
test set: accuracy on test set: 0.910
Done training net
0.909900021553
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0234375, accuracy on mal data: 0.102041
step 100, accuracy on validation batch: 0.226562, accuracy on mal data: 0.154719
step 200, accuracy on validation batch: 0.453125, accuracy on mal data: 0.23852
step 300, accuracy on validation batch: 0.5625, accuracy on mal data: 0.329209
step 400, accuracy on validation batch: 0.703125, accuracy on mal data: 0.427806
step 500, accuracy on validation batch: 0.726562, accuracy on mal data: 0.500255
step 600, accuracy on validation batch: 0.695312, accuracy on mal data: 0.553316
step 700, accuracy on validation batch: 0.789062, accuracy on mal data: 0.592219
step 800, accuracy on validation batch: 0.789062, accuracy on mal data: 0.619898
step 900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.642474
step 1000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.658546
step 1100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.679337
step 1200, accuracy on validation batch: 0.875, accuracy on mal data: 0.689796
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.70051
step 1400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.711224
step 1500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.721811
step 1600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.733418
step 1700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.744388
step 1800, accuracy on validation batch: 0.875, accuracy on mal data: 0.750893
step 1900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.759311
step 2000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.765816
step 2100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.772066
step 2200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.778699
step 2300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.782143
step 2400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.787245
step 2500, accuracy on validation batch: 0.875, accuracy on mal data: 0.790433
step 2600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.794898
step 2700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.798086
step 2800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.802041
step 2900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.803444
step 3000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.806505
step 3100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.808291
step 3200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.811479
step 3300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.812245
step 3400, accuracy on validation batch: 0.828125, accuracy on mal data: 0.813648
step 3500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815178
step 3600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815944
step 3700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.816964
step 3800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.818112
step 3900, accuracy on validation batch: 0.875, accuracy on mal data: 0.81926
step 4000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.820535
step 4100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.821428
step 4200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.823087
step 4300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823214
step 4400, accuracy on validation batch: 0.875, accuracy on mal data: 0.823724
step 4500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823979
step 4600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.824107
step 4700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.824745
step 4800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826148
step 4900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826275
step 5000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.82653
step 5100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.82653
step 5200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826785
step 5300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.826785
step 5400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827168
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827296
step 5600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.827551
step 5700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828699
step 5800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828699
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828826
step 6000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828954
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828954
step 6200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829209
step 6300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.829464
step 6400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830102
step 6500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830102
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830102
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830357
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830229
step 6900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830357
step 7000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830612
step 7100, accuracy on validation batch: 0.875, accuracy on mal data: 0.830867
step 7200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830867
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831377
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831632
step 7500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831632
step 7600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831505
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83176
step 7800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832015
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83227
test set: accuracy on test set: 0.912
Done training net
0.911900026798
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 8, 'nb_neurons_2': 8, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 8, 'nb_neurons_2': 8, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.125, accuracy on mal data: 0.116199
step 100, accuracy on validation batch: 0.328125, accuracy on mal data: 0.177934
step 200, accuracy on validation batch: 0.429688, accuracy on mal data: 0.272832
step 300, accuracy on validation batch: 0.640625, accuracy on mal data: 0.379337
step 400, accuracy on validation batch: 0.6875, accuracy on mal data: 0.460587
step 500, accuracy on validation batch: 0.742188, accuracy on mal data: 0.528954
step 600, accuracy on validation batch: 0.804688, accuracy on mal data: 0.58074
step 700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.619133
step 800, accuracy on validation batch: 0.789062, accuracy on mal data: 0.642092
step 900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.662627
step 1000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.677168
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.690051
step 1200, accuracy on validation batch: 0.796875, accuracy on mal data: 0.698724
step 1300, accuracy on validation batch: 0.789062, accuracy on mal data: 0.710459
step 1400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.719515
step 1500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.729337
step 1600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.740306
step 1700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.748469
step 1800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.754719
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.760842
step 2000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.766964
step 2100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.771811
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.777423
step 2300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.784439
step 2400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.787117
step 2500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.789796
step 2600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.791581
step 2700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.795153
step 2800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.798214
step 2900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.802041
step 3000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.802933
step 3100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.804974
step 3200, accuracy on validation batch: 0.875, accuracy on mal data: 0.805995
step 3300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.809183
step 3400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.812627
step 3500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.813265
step 3600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.815051
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815816
step 3800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.816199
step 3900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.817219
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.818112
step 4100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.819005
step 4200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.820153
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820918
step 4400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821173
step 4500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821556
step 4600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821428
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821683
step 4800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823086
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823724
step 5000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.824234
step 5100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.82551
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826275
step 5300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82653
step 5400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826785
step 5500, accuracy on validation batch: 0.875, accuracy on mal data: 0.826785
step 5600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827423
step 5700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827423
step 5800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827423
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827296
step 6000, accuracy on validation batch: 0.875, accuracy on mal data: 0.827806
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827806
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827806
step 6300, accuracy on validation batch: 0.953125, accuracy on mal data: 0.828188
step 6400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828571
step 6500, accuracy on validation batch: 0.875, accuracy on mal data: 0.828699
step 6600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828954
step 6700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829081
step 6800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829209
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829464
step 7000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829847
step 7100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829974
step 7200, accuracy on validation batch: 0.875, accuracy on mal data: 0.830357
step 7300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830612
step 7400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830612
step 7500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83125
step 7600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.831377
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83176
step 7800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832143
step 7900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832653
test set: accuracy on test set: 0.911
Done training net
0.910900021195
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.140625, accuracy on mal data: 0.117602
step 100, accuracy on validation batch: 0.351562, accuracy on mal data: 0.17602
step 200, accuracy on validation batch: 0.507812, accuracy on mal data: 0.263393
step 300, accuracy on validation batch: 0.710938, accuracy on mal data: 0.358163
step 400, accuracy on validation batch: 0.75, accuracy on mal data: 0.442602
step 500, accuracy on validation batch: 0.78125, accuracy on mal data: 0.511479
step 600, accuracy on validation batch: 0.734375, accuracy on mal data: 0.561352
step 700, accuracy on validation batch: 0.773438, accuracy on mal data: 0.602168
step 800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.634566
step 900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.661224
step 1000, accuracy on validation batch: 0.773438, accuracy on mal data: 0.678571
step 1100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.696556
step 1200, accuracy on validation batch: 0.875, accuracy on mal data: 0.708546
step 1300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.722831
step 1400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.729719
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.73852
step 1600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.747066
step 1700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.756122
step 1800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.760331
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.765561
step 2000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.770408
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.775638
step 2200, accuracy on validation batch: 0.875, accuracy on mal data: 0.780867
step 2300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.785331
step 2400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.790051
step 2500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.794005
step 2600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.796173
step 2700, accuracy on validation batch: 0.875, accuracy on mal data: 0.799362
step 2800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.802041
step 2900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.803699
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.80574
step 3100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.806122
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.808546
step 3300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.809311
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.810842
step 3500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.811862
step 3600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.813648
step 3700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.814541
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815816
step 3900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816709
step 4000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.817347
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.818495
step 4200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.81926
step 4300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.819387
step 4400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.82028
step 4500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.820918
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821556
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822321
step 4800, accuracy on validation batch: 0.960938, accuracy on mal data: 0.822704
step 4900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823597
step 5000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825255
step 5100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825127
step 5200, accuracy on validation batch: 0.875, accuracy on mal data: 0.82602
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826148
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826403
step 5500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826658
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827806
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827806
step 5800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827933
step 5900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828189
step 6000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828444
step 6100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828571
step 6200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828571
step 6300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828699
step 6400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829081
step 6500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.829081
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829336
step 6700, accuracy on validation batch: 0.875, accuracy on mal data: 0.829592
step 6800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829719
step 6900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829847
step 7000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830229
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83074
step 7200, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830867
step 7300, accuracy on validation batch: 0.875, accuracy on mal data: 0.830867
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831505
step 7500, accuracy on validation batch: 0.875, accuracy on mal data: 0.832015
step 7600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83227
step 7700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832653
step 7800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.832908
step 7900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.833163
test set: accuracy on test set: 0.910
Done training net
0.909700022936
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.103061
step 100, accuracy on validation batch: 0.21875, accuracy on mal data: 0.178571
step 200, accuracy on validation batch: 0.5, accuracy on mal data: 0.264031
step 300, accuracy on validation batch: 0.695312, accuracy on mal data: 0.353061
step 400, accuracy on validation batch: 0.703125, accuracy on mal data: 0.448342
step 500, accuracy on validation batch: 0.78125, accuracy on mal data: 0.514796
step 600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.56977
step 700, accuracy on validation batch: 0.710938, accuracy on mal data: 0.610842
step 800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.640434
step 900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.660714
step 1000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.680357
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.695025
step 1200, accuracy on validation batch: 0.796875, accuracy on mal data: 0.706888
step 1300, accuracy on validation batch: 0.875, accuracy on mal data: 0.719005
step 1400, accuracy on validation batch: 0.875, accuracy on mal data: 0.732143
step 1500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.742347
step 1600, accuracy on validation batch: 0.875, accuracy on mal data: 0.748342
step 1700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.756632
step 1800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.76199
step 1900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.768622
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.777041
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.780995
step 2200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.786097
step 2300, accuracy on validation batch: 0.8125, accuracy on mal data: 0.788775
step 2400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.791326
step 2500, accuracy on validation batch: 0.875, accuracy on mal data: 0.794388
step 2600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.795791
step 2700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.798469
step 2800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.80153
step 2900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.803571
step 3000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.805102
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.806377
step 3200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.807653
step 3300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.809949
step 3400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.81199
step 3500, accuracy on validation batch: 0.875, accuracy on mal data: 0.812627
step 3600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.81352
step 3700, accuracy on validation batch: 0.875, accuracy on mal data: 0.81403
step 3800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.815306
step 3900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.816326
step 4000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816709
step 4100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.817347
step 4200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.81824
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.819132
step 4400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.820663
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822066
step 4600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.822321
step 4700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822704
step 4800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822831
step 4900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823214
step 5000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823979
step 5100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824234
step 5200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.824362
step 5300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824617
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824617
step 5500, accuracy on validation batch: 0.875, accuracy on mal data: 0.825127
step 5600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825637
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826148
step 5800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826275
step 5900, accuracy on validation batch: 0.875, accuracy on mal data: 0.826275
step 6000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826658
step 6100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82653
step 6200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827423
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827551
step 6400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827678
step 6500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828316
step 6600, accuracy on validation batch: 0.960938, accuracy on mal data: 0.828316
step 6700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828316
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828699
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828826
step 7000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829209
step 7100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829464
step 7200, accuracy on validation batch: 0.875, accuracy on mal data: 0.829592
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829464
step 7400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829592
step 7500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830102
step 7600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830102
step 7700, accuracy on validation batch: 0.875, accuracy on mal data: 0.830612
step 7800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830995
step 7900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831632
test set: accuracy on test set: 0.910
Done training net
0.910300023556
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 8, 'nb_neurons_3': 128}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 8, 'nb_neurons_3': 128}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.125, accuracy on mal data: 0.092602
step 100, accuracy on validation batch: 0.21875, accuracy on mal data: 0.159694
step 200, accuracy on validation batch: 0.523438, accuracy on mal data: 0.25102
step 300, accuracy on validation batch: 0.679688, accuracy on mal data: 0.346556
step 400, accuracy on validation batch: 0.796875, accuracy on mal data: 0.440306
step 500, accuracy on validation batch: 0.78125, accuracy on mal data: 0.512117
step 600, accuracy on validation batch: 0.789062, accuracy on mal data: 0.571684
step 700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.608291
step 800, accuracy on validation batch: 0.78125, accuracy on mal data: 0.639796
step 900, accuracy on validation batch: 0.8125, accuracy on mal data: 0.65727
step 1000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.676403
step 1100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.68903
step 1200, accuracy on validation batch: 0.804688, accuracy on mal data: 0.703699
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.717602
step 1400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.727296
step 1500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.736862
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.74528
step 1700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.753826
step 1800, accuracy on validation batch: 0.875, accuracy on mal data: 0.763138
step 1900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.768112
step 2000, accuracy on validation batch: 0.875, accuracy on mal data: 0.773852
step 2100, accuracy on validation batch: 0.820312, accuracy on mal data: 0.780229
step 2200, accuracy on validation batch: 0.875, accuracy on mal data: 0.783801
step 2300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.787117
step 2400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.790689
step 2500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.793877
step 2600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.796428
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.8
step 2800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.802041
step 2900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.804209
step 3000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.804719
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.807143
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.809183
step 3300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.810969
step 3400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.811862
step 3500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.812627
step 3600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.81352
step 3700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.814668
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816326
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817092
step 4000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817984
step 4100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.818877
step 4200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.819515
step 4300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82028
step 4400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820535
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820791
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821556
step 4700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821683
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822704
step 4900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823597
step 5000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823724
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824362
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824362
step 5300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.824107
step 5400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.825127
step 5500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826275
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826275
step 5700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.826148
step 5800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826403
step 5900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827041
step 6000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827296
step 6100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827806
step 6200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827806
step 6300, accuracy on validation batch: 0.945312, accuracy on mal data: 0.828189
step 6400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828826
step 6500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829464
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829592
step 6700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829592
step 6800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829974
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830229
step 7000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830484
step 7100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830484
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831122
step 7300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831122
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831122
step 7500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83125
step 7600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831632
step 7700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.83176
step 7800, accuracy on validation batch: 0.96875, accuracy on mal data: 0.83176
step 7900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83176
test set: accuracy on test set: 0.911
Done training net
0.910600027442
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 32, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0924745
step 100, accuracy on validation batch: 0.273438, accuracy on mal data: 0.155612
step 200, accuracy on validation batch: 0.460938, accuracy on mal data: 0.24375
step 300, accuracy on validation batch: 0.625, accuracy on mal data: 0.33852
step 400, accuracy on validation batch: 0.679688, accuracy on mal data: 0.429974
step 500, accuracy on validation batch: 0.789062, accuracy on mal data: 0.495153
step 600, accuracy on validation batch: 0.8125, accuracy on mal data: 0.550383
step 700, accuracy on validation batch: 0.773438, accuracy on mal data: 0.589923
step 800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.618112
step 900, accuracy on validation batch: 0.820312, accuracy on mal data: 0.641709
step 1000, accuracy on validation batch: 0.875, accuracy on mal data: 0.660842
step 1100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.678571
step 1200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.695408
step 1300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.708673
step 1400, accuracy on validation batch: 0.8125, accuracy on mal data: 0.720153
step 1500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.733036
step 1600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.740306
step 1700, accuracy on validation batch: 0.875, accuracy on mal data: 0.749234
step 1800, accuracy on validation batch: 0.78125, accuracy on mal data: 0.757143
step 1900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.765178
step 2000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.771684
step 2100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.778699
step 2200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.784439
step 2300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.788775
step 2400, accuracy on validation batch: 0.796875, accuracy on mal data: 0.792857
step 2500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.795408
step 2600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.799617
step 2700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.801658
step 2800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.803061
step 2900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.80625
step 3000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.808418
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.810204
step 3200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.811097
step 3300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.812372
step 3400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.813903
step 3500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.814541
step 3600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.815561
step 3700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.816199
step 3800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817092
step 3900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.818622
step 4000, accuracy on validation batch: 0.945312, accuracy on mal data: 0.819898
step 4100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.81977
step 4200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.820663
step 4300, accuracy on validation batch: 0.875, accuracy on mal data: 0.821683
step 4400, accuracy on validation batch: 0.875, accuracy on mal data: 0.822449
step 4500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822449
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822576
step 4700, accuracy on validation batch: 0.875, accuracy on mal data: 0.823469
step 4800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.82449
step 4900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825127
step 5000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82551
step 5100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.82551
step 5200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825765
step 5300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.825893
step 5400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.826658
step 5500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.827041
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827041
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827168
step 5800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827806
step 5900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828189
step 6000, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829081
step 6100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829081
step 6200, accuracy on validation batch: 0.953125, accuracy on mal data: 0.829464
step 6300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829719
step 6400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829847
step 6500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830357
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830357
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830612
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830612
step 6900, accuracy on validation batch: 0.875, accuracy on mal data: 0.830867
step 7000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830867
step 7100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830867
step 7200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830867
step 7300, accuracy on validation batch: 0.828125, accuracy on mal data: 0.831632
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831887
step 7500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831887
step 7600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832015
step 7700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.832143
step 7800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832525
step 7900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832653
test set: accuracy on test set: 0.912
Done training net
0.911600026488
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 32, 'nb_neurons_2': 8, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 8, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.103699
step 100, accuracy on validation batch: 0.25, accuracy on mal data: 0.176531
step 200, accuracy on validation batch: 0.484375, accuracy on mal data: 0.260332
step 300, accuracy on validation batch: 0.609375, accuracy on mal data: 0.369388
step 400, accuracy on validation batch: 0.726562, accuracy on mal data: 0.454847
step 500, accuracy on validation batch: 0.6875, accuracy on mal data: 0.522577
step 600, accuracy on validation batch: 0.796875, accuracy on mal data: 0.580867
step 700, accuracy on validation batch: 0.773438, accuracy on mal data: 0.61403
step 800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.641837
step 900, accuracy on validation batch: 0.765625, accuracy on mal data: 0.6625
step 1000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.680612
step 1100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.69426
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.707398
step 1300, accuracy on validation batch: 0.828125, accuracy on mal data: 0.718622
step 1400, accuracy on validation batch: 0.804688, accuracy on mal data: 0.727806
step 1500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.73699
step 1600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.745663
step 1700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.752041
step 1800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.75727
step 1900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.762245
step 2000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.766454
step 2100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.772066
step 2200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.776785
step 2300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.780995
step 2400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.783801
step 2500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.787245
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.790689
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.792857
step 2800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.795791
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.799489
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.801148
step 3100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.803061
step 3200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.805995
step 3300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.807398
step 3400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.809949
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.811479
step 3600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.812372
step 3700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.813648
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.814413
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815306
step 4000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816454
step 4100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.818495
step 4200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.819005
step 4300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.819005
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820153
step 4500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.821683
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822831
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823852
step 4800, accuracy on validation batch: 0.875, accuracy on mal data: 0.824362
step 4900, accuracy on validation batch: 0.875, accuracy on mal data: 0.825
step 5000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82602
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826658
step 5200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827168
step 5300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827168
step 5400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827168
step 5500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827296
step 5600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.827678
step 5700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828188
step 5800, accuracy on validation batch: 0.875, accuracy on mal data: 0.828444
step 5900, accuracy on validation batch: 0.875, accuracy on mal data: 0.828444
step 6000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828571
step 6100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828826
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829336
step 6300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.829336
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829464
step 6500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829719
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830612
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830612
step 6800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830739
step 6900, accuracy on validation batch: 0.875, accuracy on mal data: 0.830739
step 7000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830867
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831122
step 7200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831377
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831632
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831887
step 7500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832015
step 7600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.832143
step 7700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83278
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832908
step 7900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832908
test set: accuracy on test set: 0.911
Done training net
0.910700024366
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0917092
step 100, accuracy on validation batch: 0.28125, accuracy on mal data: 0.171301
step 200, accuracy on validation batch: 0.4375, accuracy on mal data: 0.261097
step 300, accuracy on validation batch: 0.6875, accuracy on mal data: 0.362628
step 400, accuracy on validation batch: 0.710938, accuracy on mal data: 0.460204
step 500, accuracy on validation batch: 0.773438, accuracy on mal data: 0.521173
step 600, accuracy on validation batch: 0.8125, accuracy on mal data: 0.565561
step 700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.605229
step 800, accuracy on validation batch: 0.757812, accuracy on mal data: 0.630612
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.655102
step 1000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.669388
step 1100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.684566
step 1200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.697831
step 1300, accuracy on validation batch: 0.789062, accuracy on mal data: 0.71403
step 1400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.723342
step 1500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.734311
step 1600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.744388
step 1700, accuracy on validation batch: 0.875, accuracy on mal data: 0.753954
step 1800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.757398
step 1900, accuracy on validation batch: 0.875, accuracy on mal data: 0.767857
step 2000, accuracy on validation batch: 0.875, accuracy on mal data: 0.775
step 2100, accuracy on validation batch: 0.875, accuracy on mal data: 0.779464
step 2200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.784949
step 2300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.786862
step 2400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.790561
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.795153
step 2600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.799362
step 2700, accuracy on validation batch: 0.875, accuracy on mal data: 0.799745
step 2800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.803826
step 2900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.804974
step 3000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.805612
step 3100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.80727
step 3200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.808163
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.809821
step 3400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.811097
step 3500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.81199
step 3600, accuracy on validation batch: 0.875, accuracy on mal data: 0.812755
step 3700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.81352
step 3800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.815689
step 3900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816071
step 4000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.817857
step 4100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.819515
step 4200, accuracy on validation batch: 0.875, accuracy on mal data: 0.820791
step 4300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822066
step 4400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823214
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823852
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824234
step 4700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824234
step 4800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824872
step 4900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.825255
step 5000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825893
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826403
step 5200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.826658
step 5300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.828316
step 5400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828316
step 5500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828571
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828699
step 5700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829209
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829209
step 5900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829209
step 6000, accuracy on validation batch: 0.875, accuracy on mal data: 0.829209
step 6100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829592
step 6200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829719
step 6300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829719
step 6400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829719
step 6500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829719
step 6600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830357
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830612
step 6800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830612
step 6900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830612
step 7000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831122
step 7100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.831122
step 7200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831505
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831505
step 7400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.832015
step 7500, accuracy on validation batch: 0.953125, accuracy on mal data: 0.83227
step 7600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832525
step 7700, accuracy on validation batch: 0.945312, accuracy on mal data: 0.832525
step 7800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83278
step 7900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.833291
test set: accuracy on test set: 0.910
Done training net
0.909900014997
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0917092
step 100, accuracy on validation batch: 0.234375, accuracy on mal data: 0.16148
step 200, accuracy on validation batch: 0.453125, accuracy on mal data: 0.262755
step 300, accuracy on validation batch: 0.65625, accuracy on mal data: 0.358673
step 400, accuracy on validation batch: 0.671875, accuracy on mal data: 0.444388
step 500, accuracy on validation batch: 0.773438, accuracy on mal data: 0.514031
step 600, accuracy on validation batch: 0.773438, accuracy on mal data: 0.574235
step 700, accuracy on validation batch: 0.726562, accuracy on mal data: 0.609311
step 800, accuracy on validation batch: 0.789062, accuracy on mal data: 0.6375
step 900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.658673
step 1000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.680229
step 1100, accuracy on validation batch: 0.804688, accuracy on mal data: 0.695153
step 1200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.708928
step 1300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.723469
step 1400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.736479
step 1500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.748852
step 1600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.757398
step 1700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.761352
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.76926
step 1900, accuracy on validation batch: 0.875, accuracy on mal data: 0.77653
step 2000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.781377
step 2100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.784566
step 2200, accuracy on validation batch: 0.875, accuracy on mal data: 0.789541
step 2300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.791454
step 2400, accuracy on validation batch: 0.875, accuracy on mal data: 0.795535
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.797831
step 2600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.801148
step 2700, accuracy on validation batch: 0.804688, accuracy on mal data: 0.803444
step 2800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.805229
step 2900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.807015
step 3000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.809056
step 3100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.811352
step 3200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.812882
step 3300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.813775
step 3400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.813903
step 3500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.814796
step 3600, accuracy on validation batch: 0.875, accuracy on mal data: 0.815178
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815689
step 3800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.817219
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.817729
step 4000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.817984
step 4100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.819132
step 4200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.820025
step 4300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82028
step 4400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820535
step 4500, accuracy on validation batch: 0.875, accuracy on mal data: 0.821301
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821556
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823086
step 4800, accuracy on validation batch: 0.96875, accuracy on mal data: 0.823469
step 4900, accuracy on validation batch: 0.875, accuracy on mal data: 0.823979
step 5000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825
step 5100, accuracy on validation batch: 0.875, accuracy on mal data: 0.825127
step 5200, accuracy on validation batch: 0.953125, accuracy on mal data: 0.82551
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825638
step 5400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826148
step 5500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.826148
step 5600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.826403
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827041
step 5800, accuracy on validation batch: 0.875, accuracy on mal data: 0.827168
step 5900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827678
step 6000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828188
step 6100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.828188
step 6200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828571
step 6300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828699
step 6400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829081
step 6500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829336
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829592
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829974
step 6800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829974
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830229
step 7000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.830484
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830739
step 7200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.830739
step 7300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830995
step 7400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831377
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83176
step 7600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832015
step 7700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.83278
step 7800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.833035
step 7900, accuracy on validation batch: 0.875, accuracy on mal data: 0.833035
test set: accuracy on test set: 0.909
Done training net
0.908700022101
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0770408
step 100, accuracy on validation batch: 0.273438, accuracy on mal data: 0.162117
step 200, accuracy on validation batch: 0.53125, accuracy on mal data: 0.254209
step 300, accuracy on validation batch: 0.570312, accuracy on mal data: 0.346046
step 400, accuracy on validation batch: 0.601562, accuracy on mal data: 0.436352
step 500, accuracy on validation batch: 0.664062, accuracy on mal data: 0.510332
step 600, accuracy on validation batch: 0.789062, accuracy on mal data: 0.563775
step 700, accuracy on validation batch: 0.796875, accuracy on mal data: 0.60153
step 800, accuracy on validation batch: 0.765625, accuracy on mal data: 0.629847
step 900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.648979
step 1000, accuracy on validation batch: 0.875, accuracy on mal data: 0.665816
step 1100, accuracy on validation batch: 0.796875, accuracy on mal data: 0.685076
step 1200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.700382
step 1300, accuracy on validation batch: 0.804688, accuracy on mal data: 0.71352
step 1400, accuracy on validation batch: 0.875, accuracy on mal data: 0.724745
step 1500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.735459
step 1600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.744005
step 1700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.754719
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.763138
step 1900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.77028
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.775765
step 2100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.780229
step 2200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.785842
step 2300, accuracy on validation batch: 0.828125, accuracy on mal data: 0.791581
step 2400, accuracy on validation batch: 0.875, accuracy on mal data: 0.795791
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.798086
step 2600, accuracy on validation batch: 0.875, accuracy on mal data: 0.80153
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.803826
step 2800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.805995
step 2900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.806887
step 3000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.808928
step 3100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.810969
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.811862
step 3300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.813903
step 3400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.814541
step 3500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.816964
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817602
step 3700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.819132
step 3800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.819515
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.820918
step 4000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821556
step 4100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.821683
step 4200, accuracy on validation batch: 0.875, accuracy on mal data: 0.821938
step 4300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822959
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823341
step 4500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823852
step 4600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824234
step 4700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825255
step 4800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.825382
step 4900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825637
step 5000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.82551
step 5100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.826148
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826403
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826403
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826658
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826913
step 5600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826913
step 5700, accuracy on validation batch: 0.875, accuracy on mal data: 0.827551
step 5800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827423
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828189
step 6000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828571
step 6100, accuracy on validation batch: 0.875, accuracy on mal data: 0.828699
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829464
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829592
step 6400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829719
step 6500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830102
step 6600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830102
step 6700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830229
step 6800, accuracy on validation batch: 0.875, accuracy on mal data: 0.830484
step 6900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830739
step 7000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831122
step 7100, accuracy on validation batch: 0.953125, accuracy on mal data: 0.831122
step 7200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831377
step 7300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.831632
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83176
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831887
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832525
step 7700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832653
step 7800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832908
step 7900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.833035
test set: accuracy on test set: 0.909
Done training net
0.908800022602
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 32, 'nb_neurons_2': 8, 'nb_neurons_3': 128}
training!
{'nb_neurons_1': 32, 'nb_neurons_2': 8, 'nb_neurons_3': 128}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.078125, accuracy on mal data: 0.115179
step 100, accuracy on validation batch: 0.28125, accuracy on mal data: 0.186097
step 200, accuracy on validation batch: 0.453125, accuracy on mal data: 0.282015
step 300, accuracy on validation batch: 0.695312, accuracy on mal data: 0.378189
step 400, accuracy on validation batch: 0.695312, accuracy on mal data: 0.455867
step 500, accuracy on validation batch: 0.695312, accuracy on mal data: 0.522704
step 600, accuracy on validation batch: 0.75, accuracy on mal data: 0.574617
step 700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.602041
step 800, accuracy on validation batch: 0.804688, accuracy on mal data: 0.628316
step 900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.653826
step 1000, accuracy on validation batch: 0.796875, accuracy on mal data: 0.671556
step 1100, accuracy on validation batch: 0.8125, accuracy on mal data: 0.684439
step 1200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.699235
step 1300, accuracy on validation batch: 0.828125, accuracy on mal data: 0.709056
step 1400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.720025
step 1500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.732015
step 1600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.745025
step 1700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.752933
step 1800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.760842
step 1900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.766581
step 2000, accuracy on validation batch: 0.875, accuracy on mal data: 0.771556
step 2100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.77602
step 2200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.779592
step 2300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.784438
step 2400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.790306
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.795153
step 2600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.798469
step 2700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.80102
step 2800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.803444
step 2900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.80574
step 3000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.80778
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.809183
step 3200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.810714
step 3300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.811607
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.812627
step 3500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.813903
step 3600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.814923
step 3700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815944
step 3800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.817092
step 3900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.818495
step 4000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.820025
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.820918
step 4200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.820918
step 4300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.821428
step 4400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.821811
step 4500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822066
step 4600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822576
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823086
step 4800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823214
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823597
step 5000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824362
step 5100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.824362
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825382
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826148
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826785
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827041
step 5600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.827168
step 5700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827296
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827806
step 5900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828188
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828316
step 6100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828571
step 6200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828699
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828954
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828826
step 6500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829336
step 6600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829974
step 6700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829974
step 6800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830357
step 6900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830612
step 7000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830867
step 7100, accuracy on validation batch: 0.960938, accuracy on mal data: 0.830995
step 7200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831122
step 7300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83125
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831377
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831505
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831505
step 7700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.83227
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832398
step 7900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832525
test set: accuracy on test set: 0.910
Done training net
0.910200026035
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 8, 'nb_neurons_3': 128}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 8, 'nb_neurons_3': 128}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.109375, accuracy on mal data: 0.103444
step 100, accuracy on validation batch: 0.242188, accuracy on mal data: 0.171684
step 200, accuracy on validation batch: 0.476562, accuracy on mal data: 0.271046
step 300, accuracy on validation batch: 0.609375, accuracy on mal data: 0.357653
step 400, accuracy on validation batch: 0.640625, accuracy on mal data: 0.442347
step 500, accuracy on validation batch: 0.679688, accuracy on mal data: 0.522066
step 600, accuracy on validation batch: 0.804688, accuracy on mal data: 0.567602
step 700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.607653
step 800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.633801
step 900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.656888
step 1000, accuracy on validation batch: 0.78125, accuracy on mal data: 0.677806
step 1100, accuracy on validation batch: 0.820312, accuracy on mal data: 0.690816
step 1200, accuracy on validation batch: 0.875, accuracy on mal data: 0.703699
step 1300, accuracy on validation batch: 0.804688, accuracy on mal data: 0.715051
step 1400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.72551
step 1500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.733801
step 1600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.744387
step 1700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.752551
step 1800, accuracy on validation batch: 0.875, accuracy on mal data: 0.758928
step 1900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.767092
step 2000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.774617
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.779464
step 2200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.783546
step 2300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.785714
step 2400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.788903
step 2500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.791581
step 2600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.794388
step 2700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.797194
step 2800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.800382
step 2900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.800893
step 3000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.801786
step 3100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.803954
step 3200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.807398
step 3300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.809821
step 3400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.810714
step 3500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.812372
step 3600, accuracy on validation batch: 0.875, accuracy on mal data: 0.812627
step 3700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.812627
step 3800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.813393
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.813903
step 4000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.815051
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.816199
step 4200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816454
step 4300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.817984
step 4400, accuracy on validation batch: 0.875, accuracy on mal data: 0.819643
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821046
step 4600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821428
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822066
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822831
step 4900, accuracy on validation batch: 0.875, accuracy on mal data: 0.823214
step 5000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823852
step 5100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825382
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82602
step 5300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.826275
step 5400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826785
step 5500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827041
step 5600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827551
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828061
step 5800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828444
step 5900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828444
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828699
step 6100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829081
step 6200, accuracy on validation batch: 0.875, accuracy on mal data: 0.828954
step 6300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828954
step 6400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829081
step 6500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829847
step 6600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.830102
step 6700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830484
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830739
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830995
step 7000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831122
step 7100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831377
step 7200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831377
step 7300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831377
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831632
step 7500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831887
step 7600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831887
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832143
step 7800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832398
step 7900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832398
test set: accuracy on test set: 0.912
Done training net
0.912200027108
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0955357
step 100, accuracy on validation batch: 0.382812, accuracy on mal data: 0.159056
step 200, accuracy on validation batch: 0.476562, accuracy on mal data: 0.231633
step 300, accuracy on validation batch: 0.617188, accuracy on mal data: 0.329975
step 400, accuracy on validation batch: 0.734375, accuracy on mal data: 0.42449
step 500, accuracy on validation batch: 0.757812, accuracy on mal data: 0.503571
step 600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.561607
step 700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.600127
step 800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.629592
step 900, accuracy on validation batch: 0.8125, accuracy on mal data: 0.658036
step 1000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.678699
step 1100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.70102
step 1200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.711607
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.722449
step 1400, accuracy on validation batch: 0.789062, accuracy on mal data: 0.73074
step 1500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.743877
step 1600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.751403
step 1700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.760331
step 1800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.765816
step 1900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.770663
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.776403
step 2100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.78278
step 2200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.784566
step 2300, accuracy on validation batch: 0.8125, accuracy on mal data: 0.789285
step 2400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.793877
step 2500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.796428
step 2600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.797959
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.800382
step 2800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.802168
step 2900, accuracy on validation batch: 0.875, accuracy on mal data: 0.804464
step 3000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.806377
step 3100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.807653
step 3200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.809694
step 3300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.811479
step 3400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.81352
step 3500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.814668
step 3600, accuracy on validation batch: 0.875, accuracy on mal data: 0.815688
step 3700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.816326
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.817092
step 3900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817857
step 4000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819005
step 4100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.81977
step 4200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.820153
step 4300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820153
step 4400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820663
step 4500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.821046
step 4600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.821811
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822066
step 4800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823087
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823597
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824617
step 5100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.825255
step 5200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.825255
step 5300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825637
step 5400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825893
step 5500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825893
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826148
step 5700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826148
step 5800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82653
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827423
step 6000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827933
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828316
step 6200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828826
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828954
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829209
step 6500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829719
step 6600, accuracy on validation batch: 0.875, accuracy on mal data: 0.829719
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830485
step 6800, accuracy on validation batch: 0.953125, accuracy on mal data: 0.830484
step 6900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83074
step 7000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83074
step 7100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83074
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83074
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831377
step 7400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.83125
step 7500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83125
step 7600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83125
step 7700, accuracy on validation batch: 0.953125, accuracy on mal data: 0.831377
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831377
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831377
test set: accuracy on test set: 0.910
Done training net
0.910000023842
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.132812, accuracy on mal data: 0.108036
step 100, accuracy on validation batch: 0.1875, accuracy on mal data: 0.183801
step 200, accuracy on validation batch: 0.4375, accuracy on mal data: 0.281888
step 300, accuracy on validation batch: 0.648438, accuracy on mal data: 0.36875
step 400, accuracy on validation batch: 0.664062, accuracy on mal data: 0.454974
step 500, accuracy on validation batch: 0.71875, accuracy on mal data: 0.524745
step 600, accuracy on validation batch: 0.789062, accuracy on mal data: 0.576658
step 700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.612245
step 800, accuracy on validation batch: 0.789062, accuracy on mal data: 0.641071
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.660969
step 1000, accuracy on validation batch: 0.765625, accuracy on mal data: 0.674107
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.689413
step 1200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.705867
step 1300, accuracy on validation batch: 0.804688, accuracy on mal data: 0.717729
step 1400, accuracy on validation batch: 0.789062, accuracy on mal data: 0.726403
step 1500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.7375
step 1600, accuracy on validation batch: 0.828125, accuracy on mal data: 0.746046
step 1700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.752933
step 1800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.759821
step 1900, accuracy on validation batch: 0.875, accuracy on mal data: 0.765689
step 2000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.771428
step 2100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.777296
step 2200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.781632
step 2300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.785714
step 2400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.790051
step 2500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.792219
step 2600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.794898
step 2700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.796938
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.79949
step 2900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.801658
step 3000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.803316
step 3100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.805229
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.807143
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.807525
step 3400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.809311
step 3500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.810969
step 3600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.811862
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.813393
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.814285
step 3900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.815433
step 4000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.816454
step 4100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.817857
step 4200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.81926
step 4300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819515
step 4400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.820535
step 4500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.821173
step 4600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.821556
step 4700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822449
step 4800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822704
step 4900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822959
step 5000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823342
step 5100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.823342
step 5200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823342
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823979
step 5400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824362
step 5500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82449
step 5600, accuracy on validation batch: 0.8125, accuracy on mal data: 0.825382
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825382
step 5800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.825765
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826275
step 6000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826403
step 6100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826658
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827551
step 6300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828316
step 6400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828571
step 6500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828699
step 6600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829209
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829719
step 6800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829847
step 6900, accuracy on validation batch: 0.953125, accuracy on mal data: 0.829847
step 7000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829847
step 7100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829847
step 7200, accuracy on validation batch: 0.875, accuracy on mal data: 0.830484
step 7300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830612
step 7400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830995
step 7500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830995
step 7600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831122
step 7700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831632
step 7800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832143
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83227
test set: accuracy on test set: 0.911
Done training net
0.9110000211
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.15625, accuracy on mal data: 0.0940051
step 100, accuracy on validation batch: 0.304688, accuracy on mal data: 0.164796
step 200, accuracy on validation batch: 0.546875, accuracy on mal data: 0.257398
step 300, accuracy on validation batch: 0.601562, accuracy on mal data: 0.354592
step 400, accuracy on validation batch: 0.765625, accuracy on mal data: 0.45523
step 500, accuracy on validation batch: 0.828125, accuracy on mal data: 0.531633
step 600, accuracy on validation batch: 0.804688, accuracy on mal data: 0.580612
step 700, accuracy on validation batch: 0.789062, accuracy on mal data: 0.613138
step 800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.641071
step 900, accuracy on validation batch: 0.789062, accuracy on mal data: 0.658673
step 1000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.68125
step 1100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.698979
step 1200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.713648
step 1300, accuracy on validation batch: 0.789062, accuracy on mal data: 0.725
step 1400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.736479
step 1500, accuracy on validation batch: 0.875, accuracy on mal data: 0.745918
step 1600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.752678
step 1700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.757015
step 1800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.76199
step 1900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.767984
step 2000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.772831
step 2100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.779081
step 2200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.784566
step 2300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.788775
step 2400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.791709
step 2500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.794005
step 2600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.796556
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.800127
step 2800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.801913
step 2900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.804081
step 3000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.805102
step 3100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.806505
step 3200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.807525
step 3300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.809311
step 3400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.810204
step 3500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.81199
step 3600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.813265
step 3700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.814668
step 3800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.817347
step 3900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.818622
step 4000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.819132
step 4100, accuracy on validation batch: 0.875, accuracy on mal data: 0.819642
step 4200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820535
step 4300, accuracy on validation batch: 0.945312, accuracy on mal data: 0.821556
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821938
step 4500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821938
step 4600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822831
step 4700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823469
step 4800, accuracy on validation batch: 0.875, accuracy on mal data: 0.823597
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823597
step 5000, accuracy on validation batch: 0.875, accuracy on mal data: 0.824362
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824362
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824489
step 5300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824617
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825637
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826275
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826403
step 5700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826275
step 5800, accuracy on validation batch: 0.875, accuracy on mal data: 0.826275
step 5900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826785
step 6000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827296
step 6100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827678
step 6200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827551
step 6300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828316
step 6400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828444
step 6500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828826
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829337
step 6700, accuracy on validation batch: 0.875, accuracy on mal data: 0.829974
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830229
step 6900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830229
step 7000, accuracy on validation batch: 0.875, accuracy on mal data: 0.830229
step 7100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830357
step 7200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830739
step 7300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831122
step 7400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831122
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831122
step 7600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831632
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83176
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83176
step 7900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83227
test set: accuracy on test set: 0.911
Done training net
0.910500018597
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.0876275
step 100, accuracy on validation batch: 0.195312, accuracy on mal data: 0.167602
step 200, accuracy on validation batch: 0.554688, accuracy on mal data: 0.263648
step 300, accuracy on validation batch: 0.5625, accuracy on mal data: 0.359949
step 400, accuracy on validation batch: 0.679688, accuracy on mal data: 0.451148
step 500, accuracy on validation batch: 0.75, accuracy on mal data: 0.52449
step 600, accuracy on validation batch: 0.78125, accuracy on mal data: 0.578826
step 700, accuracy on validation batch: 0.796875, accuracy on mal data: 0.617729
step 800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.64324
step 900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.658928
step 1000, accuracy on validation batch: 0.8125, accuracy on mal data: 0.678061
step 1100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.696556
step 1200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.70727
step 1300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.719388
step 1400, accuracy on validation batch: 0.875, accuracy on mal data: 0.730229
step 1500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.739286
step 1600, accuracy on validation batch: 0.796875, accuracy on mal data: 0.746046
step 1700, accuracy on validation batch: 0.875, accuracy on mal data: 0.753826
step 1800, accuracy on validation batch: 0.875, accuracy on mal data: 0.760969
step 1900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.765433
step 2000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.773342
step 2100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.778826
step 2200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.784311
step 2300, accuracy on validation batch: 0.875, accuracy on mal data: 0.78852
step 2400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.792857
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.795153
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.796811
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.800765
step 2800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.802678
step 2900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.805229
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.807015
step 3100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.808801
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.810331
step 3300, accuracy on validation batch: 0.875, accuracy on mal data: 0.811097
step 3400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.813393
step 3500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.814285
step 3600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.815561
step 3700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.816199
step 3800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.816709
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.818877
step 4000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.819515
step 4100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.819898
step 4200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820153
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820408
step 4400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821301
step 4500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821811
step 4600, accuracy on validation batch: 0.953125, accuracy on mal data: 0.822704
step 4700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.823342
step 4800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823724
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823852
step 5000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.824234
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824234
step 5200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.824745
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825382
step 5400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82551
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825893
step 5600, accuracy on validation batch: 0.953125, accuracy on mal data: 0.82653
step 5700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827551
step 5800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.827806
step 5900, accuracy on validation batch: 0.960938, accuracy on mal data: 0.827551
step 6000, accuracy on validation batch: 0.875, accuracy on mal data: 0.827806
step 6100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828061
step 6200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828189
step 6300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828571
step 6400, accuracy on validation batch: 0.875, accuracy on mal data: 0.828826
step 6500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828826
step 6600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.828954
step 6700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829209
step 6800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829336
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829719
step 7000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829719
step 7100, accuracy on validation batch: 0.875, accuracy on mal data: 0.829847
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829974
step 7300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830229
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830229
step 7500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830739
step 7600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830995
step 7700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831122
step 7800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831377
step 7900, accuracy on validation batch: 0.875, accuracy on mal data: 0.831377
test set: accuracy on test set: 0.912
Done training net
0.911500025392
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0887755
step 100, accuracy on validation batch: 0.273438, accuracy on mal data: 0.153827
step 200, accuracy on validation batch: 0.484375, accuracy on mal data: 0.236735
step 300, accuracy on validation batch: 0.585938, accuracy on mal data: 0.33176
step 400, accuracy on validation batch: 0.734375, accuracy on mal data: 0.419515
step 500, accuracy on validation batch: 0.773438, accuracy on mal data: 0.493495
step 600, accuracy on validation batch: 0.726562, accuracy on mal data: 0.549745
step 700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.587372
step 800, accuracy on validation batch: 0.757812, accuracy on mal data: 0.617347
step 900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.640051
step 1000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.66352
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.678189
step 1200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.696173
step 1300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.710331
step 1400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.723597
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.733418
step 1600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.743367
step 1700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.751148
step 1800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.7625
step 1900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.767219
step 2000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.774617
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.779081
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.785714
step 2300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.789668
step 2400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.793495
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.796046
step 2600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.798852
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.802168
step 2800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.805612
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.807653
step 3000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.808546
step 3100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.810204
step 3200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.8125
step 3300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.814413
step 3400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815561
step 3500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.817729
step 3600, accuracy on validation batch: 0.960938, accuracy on mal data: 0.819005
step 3700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819515
step 3800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.82028
step 3900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.820918
step 4000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.821811
step 4100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.821811
step 4200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822959
step 4300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.823342
step 4400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823597
step 4500, accuracy on validation batch: 0.875, accuracy on mal data: 0.823852
step 4600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823852
step 4700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824617
step 4800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825127
step 5000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825255
step 5100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826148
step 5200, accuracy on validation batch: 0.960938, accuracy on mal data: 0.826148
step 5300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826785
step 5400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.827423
step 5500, accuracy on validation batch: 0.875, accuracy on mal data: 0.827806
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827806
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827678
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827806
step 5900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827933
step 6000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827933
step 6100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827933
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828061
step 6300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828571
step 6400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828699
step 6500, accuracy on validation batch: 0.875, accuracy on mal data: 0.829464
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829719
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829974
step 6800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830229
step 6900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830357
step 7000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830357
step 7100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830995
step 7200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831122
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831377
step 7400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831377
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831888
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832143
step 7700, accuracy on validation batch: 0.953125, accuracy on mal data: 0.832653
step 7800, accuracy on validation batch: 0.875, accuracy on mal data: 0.832653
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832908
test set: accuracy on test set: 0.911
Done training net
0.910800019503
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.09375, accuracy on mal data: 0.104974
step 100, accuracy on validation batch: 0.210938, accuracy on mal data: 0.178827
step 200, accuracy on validation batch: 0.40625, accuracy on mal data: 0.266327
step 300, accuracy on validation batch: 0.664062, accuracy on mal data: 0.365561
step 400, accuracy on validation batch: 0.6875, accuracy on mal data: 0.456633
step 500, accuracy on validation batch: 0.78125, accuracy on mal data: 0.526913
step 600, accuracy on validation batch: 0.726562, accuracy on mal data: 0.571939
step 700, accuracy on validation batch: 0.8125, accuracy on mal data: 0.605357
step 800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.627041
step 900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.651786
step 1000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.671684
step 1100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.685459
step 1200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.701913
step 1300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.715051
step 1400, accuracy on validation batch: 0.820312, accuracy on mal data: 0.721301
step 1500, accuracy on validation batch: 0.828125, accuracy on mal data: 0.73074
step 1600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.739923
step 1700, accuracy on validation batch: 0.875, accuracy on mal data: 0.748342
step 1800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.757525
step 1900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.76301
step 2000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.76926
step 2100, accuracy on validation batch: 0.804688, accuracy on mal data: 0.774617
step 2200, accuracy on validation batch: 0.875, accuracy on mal data: 0.778826
step 2300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.782908
step 2400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.786479
step 2500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.788393
step 2600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.792602
step 2700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.79477
step 2800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.796428
step 2900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.799872
step 3000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.803826
step 3100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.806122
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.808928
step 3300, accuracy on validation batch: 0.828125, accuracy on mal data: 0.810331
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.813138
step 3500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.814285
step 3600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.815561
step 3700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.816709
step 3800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.817729
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.819515
step 4000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820408
step 4100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82079
step 4200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821556
step 4300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.822449
step 4400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822959
step 4500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.823214
step 4600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.823979
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824362
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825382
step 4900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826148
step 5000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826403
step 5100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826658
step 5200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826913
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826913
step 5400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827168
step 5500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827423
step 5600, accuracy on validation batch: 0.875, accuracy on mal data: 0.827551
step 5700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827551
step 5800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828188
step 5900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828316
step 6000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828571
step 6100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828826
step 6200, accuracy on validation batch: 0.960938, accuracy on mal data: 0.828826
step 6300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828826
step 6400, accuracy on validation batch: 0.875, accuracy on mal data: 0.828826
step 6500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829336
step 6600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829847
step 6700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829847
step 6800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830867
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83125
step 7000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831122
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831632
step 7200, accuracy on validation batch: 0.875, accuracy on mal data: 0.831887
step 7300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831887
step 7400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83227
step 7500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83227
step 7600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832525
step 7700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832908
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832908
step 7900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.833035
test set: accuracy on test set: 0.910
Done training net
0.910400028229
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 512, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 512, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0952806
step 100, accuracy on validation batch: 0.46875, accuracy on mal data: 0.163393
step 200, accuracy on validation batch: 0.476562, accuracy on mal data: 0.251786
step 300, accuracy on validation batch: 0.59375, accuracy on mal data: 0.359566
step 400, accuracy on validation batch: 0.734375, accuracy on mal data: 0.434821
step 500, accuracy on validation batch: 0.71875, accuracy on mal data: 0.498469
step 600, accuracy on validation batch: 0.734375, accuracy on mal data: 0.554719
step 700, accuracy on validation batch: 0.75, accuracy on mal data: 0.599617
step 800, accuracy on validation batch: 0.796875, accuracy on mal data: 0.625765
step 900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.648214
step 1000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.667602
step 1100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.683928
step 1200, accuracy on validation batch: 0.78125, accuracy on mal data: 0.698724
step 1300, accuracy on validation batch: 0.875, accuracy on mal data: 0.708928
step 1400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.723979
step 1500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.734694
step 1600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.744005
step 1700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.754592
step 1800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.761734
step 1900, accuracy on validation batch: 0.820312, accuracy on mal data: 0.766581
step 2000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.772321
step 2100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.776275
step 2200, accuracy on validation batch: 0.875, accuracy on mal data: 0.781632
step 2300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.785842
step 2400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.788775
step 2500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.792857
step 2600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.794388
step 2700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.797066
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.799489
step 2900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.801658
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.804209
step 3100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.806505
step 3200, accuracy on validation batch: 0.875, accuracy on mal data: 0.808673
step 3300, accuracy on validation batch: 0.820312, accuracy on mal data: 0.811352
step 3400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.811224
step 3500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.8125
step 3600, accuracy on validation batch: 0.875, accuracy on mal data: 0.81403
step 3700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.815944
step 3800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816836
step 3900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.81824
step 4000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.818495
step 4100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.819005
step 4200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.820791
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820791
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820918
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821811
step 4600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822194
step 4700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822194
step 4800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822831
step 4900, accuracy on validation batch: 0.875, accuracy on mal data: 0.822959
step 5000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.823469
step 5100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823597
step 5200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.824234
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824745
step 5400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82551
step 5500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825893
step 5600, accuracy on validation batch: 0.875, accuracy on mal data: 0.827041
step 5700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827551
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827551
step 5900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827551
step 6000, accuracy on validation batch: 0.875, accuracy on mal data: 0.827678
step 6100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827678
step 6200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828316
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828954
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829209
step 6500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829209
step 6600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830102
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830229
step 6800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830484
step 6900, accuracy on validation batch: 0.976562, accuracy on mal data: 0.830739
step 7000, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830739
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830739
step 7200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831122
step 7300, accuracy on validation batch: 0.960938, accuracy on mal data: 0.83176
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83176
step 7500, accuracy on validation batch: 0.953125, accuracy on mal data: 0.832015
step 7600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832015
step 7700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832015
step 7800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.832015
step 7900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83227
test set: accuracy on test set: 0.912
Done training net
0.911500022411
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0839286
step 100, accuracy on validation batch: 0.265625, accuracy on mal data: 0.161607
step 200, accuracy on validation batch: 0.539062, accuracy on mal data: 0.256505
step 300, accuracy on validation batch: 0.664062, accuracy on mal data: 0.360842
step 400, accuracy on validation batch: 0.742188, accuracy on mal data: 0.457143
step 500, accuracy on validation batch: 0.8125, accuracy on mal data: 0.519515
step 600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.56977
step 700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.609439
step 800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.635714
step 900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.65778
step 1000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.673597
step 1100, accuracy on validation batch: 0.875, accuracy on mal data: 0.689796
step 1200, accuracy on validation batch: 0.875, accuracy on mal data: 0.702934
step 1300, accuracy on validation batch: 0.8125, accuracy on mal data: 0.715051
step 1400, accuracy on validation batch: 0.828125, accuracy on mal data: 0.726275
step 1500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.735969
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.743367
step 1700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.748342
step 1800, accuracy on validation batch: 0.875, accuracy on mal data: 0.755612
step 1900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.761862
step 2000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.766837
step 2100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.773597
step 2200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.780357
step 2300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.784056
step 2400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.788393
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.790051
step 2600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.792219
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.796428
step 2800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.8
step 2900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.802041
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.803189
step 3100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.804847
step 3200, accuracy on validation batch: 0.875, accuracy on mal data: 0.80727
step 3300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.808546
step 3400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.809821
step 3500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.811734
step 3600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.813903
step 3700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.816326
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817347
step 3900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817474
step 4000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.818112
step 4100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.818877
step 4200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81926
step 4300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.81977
step 4400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82028
step 4500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820918
step 4600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821683
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822704
step 4800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823342
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823979
step 5000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.82449
step 5100, accuracy on validation batch: 0.875, accuracy on mal data: 0.825127
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82551
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826403
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82704
step 5500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827168
step 5600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.827806
step 5700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828444
step 5800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828954
step 5900, accuracy on validation batch: 0.953125, accuracy on mal data: 0.829081
step 6000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829592
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829847
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829847
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830357
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830357
step 6500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830739
step 6600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830739
step 6700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830739
step 6800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831122
step 6900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83125
step 7000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831377
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831377
step 7200, accuracy on validation batch: 0.875, accuracy on mal data: 0.83176
step 7300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832143
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832653
step 7500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832653
step 7600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.833035
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.833546
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.833673
step 7900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.833673
test set: accuracy on test set: 0.909
Done training net
0.909300022721
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.078125, accuracy on mal data: 0.105102
step 100, accuracy on validation batch: 0.234375, accuracy on mal data: 0.152934
step 200, accuracy on validation batch: 0.429688, accuracy on mal data: 0.214796
step 300, accuracy on validation batch: 0.695312, accuracy on mal data: 0.30676
step 400, accuracy on validation batch: 0.742188, accuracy on mal data: 0.405102
step 500, accuracy on validation batch: 0.765625, accuracy on mal data: 0.488265
step 600, accuracy on validation batch: 0.742188, accuracy on mal data: 0.544133
step 700, accuracy on validation batch: 0.796875, accuracy on mal data: 0.579847
step 800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.604847
step 900, accuracy on validation batch: 0.757812, accuracy on mal data: 0.629082
step 1000, accuracy on validation batch: 0.789062, accuracy on mal data: 0.647704
step 1100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.661607
step 1200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.674745
step 1300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.696301
step 1400, accuracy on validation batch: 0.875, accuracy on mal data: 0.70778
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.717474
step 1600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.727296
step 1700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.739541
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.748469
step 1900, accuracy on validation batch: 0.875, accuracy on mal data: 0.757525
step 2000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.76352
step 2100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.772066
step 2200, accuracy on validation batch: 0.875, accuracy on mal data: 0.779719
step 2300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.783673
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.786607
step 2500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.788265
step 2600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.790816
step 2700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.794387
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.798469
step 2900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.800765
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.803316
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.804719
step 3200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.807015
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.808163
step 3400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.811607
step 3500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.813648
step 3600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.815178
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816071
step 3800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817347
step 3900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.817602
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817729
step 4100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.818495
step 4200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.81875
step 4300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.81926
step 4400, accuracy on validation batch: 0.820312, accuracy on mal data: 0.820408
step 4500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.821173
step 4600, accuracy on validation batch: 0.875, accuracy on mal data: 0.822194
step 4700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822959
step 4800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823342
step 4900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.824362
step 5000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825382
step 5100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825637
step 5200, accuracy on validation batch: 0.875, accuracy on mal data: 0.826275
step 5300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.82653
step 5400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82653
step 5500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827041
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827423
step 5700, accuracy on validation batch: 0.875, accuracy on mal data: 0.827933
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828188
step 5900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828444
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828826
step 6100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829081
step 6200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.829974
step 6300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829974
step 6400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829974
step 6500, accuracy on validation batch: 0.96875, accuracy on mal data: 0.830867
step 6600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83125
step 6700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831377
step 6800, accuracy on validation batch: 0.875, accuracy on mal data: 0.831632
step 6900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83176
step 7000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832143
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832143
step 7200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832525
step 7300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832653
step 7400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832653
step 7500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832653
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83278
step 7700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.833035
step 7800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.833035
step 7900, accuracy on validation batch: 0.953125, accuracy on mal data: 0.833163
test set: accuracy on test set: 0.910
Done training net
0.910300024152
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0982143
step 100, accuracy on validation batch: 0.289062, accuracy on mal data: 0.15102
step 200, accuracy on validation batch: 0.476562, accuracy on mal data: 0.241964
step 300, accuracy on validation batch: 0.65625, accuracy on mal data: 0.340434
step 400, accuracy on validation batch: 0.726562, accuracy on mal data: 0.427551
step 500, accuracy on validation batch: 0.796875, accuracy on mal data: 0.49949
step 600, accuracy on validation batch: 0.796875, accuracy on mal data: 0.546429
step 700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.584056
step 800, accuracy on validation batch: 0.75, accuracy on mal data: 0.613393
step 900, accuracy on validation batch: 0.796875, accuracy on mal data: 0.63903
step 1000, accuracy on validation batch: 0.78125, accuracy on mal data: 0.659439
step 1100, accuracy on validation batch: 0.757812, accuracy on mal data: 0.678699
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.689796
step 1300, accuracy on validation batch: 0.78125, accuracy on mal data: 0.706505
step 1400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.720536
step 1500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.730102
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.73852
step 1700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.748979
step 1800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.75574
step 1900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.759949
step 2000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.766836
step 2100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.771556
step 2200, accuracy on validation batch: 0.875, accuracy on mal data: 0.77653
step 2300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.781377
step 2400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.785076
step 2500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.789541
step 2600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.793495
step 2700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.796811
step 2800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.799362
step 2900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.802551
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.804719
step 3100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.805995
step 3200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.809311
step 3300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.810331
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.811607
step 3500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.812627
step 3600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.81352
step 3700, accuracy on validation batch: 0.875, accuracy on mal data: 0.814923
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815816
step 3900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816581
step 4000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.817857
step 4100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.818367
step 4200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.819005
step 4300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.81977
step 4400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821428
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821939
step 4600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.822831
step 4700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.822959
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823597
step 4900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.824107
step 5000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824745
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825127
step 5200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825637
step 5300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826275
step 5400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826785
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827296
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827296
step 5700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827551
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827551
step 5900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827551
step 6000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.828571
step 6100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828826
step 6200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829336
step 6300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829974
step 6400, accuracy on validation batch: 0.875, accuracy on mal data: 0.830995
step 6500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83125
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831887
step 6700, accuracy on validation batch: 0.875, accuracy on mal data: 0.832015
step 6800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832015
step 6900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832398
step 7000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.832525
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832525
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832525
step 7300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832908
step 7400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832908
step 7500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832908
step 7600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.833163
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.833163
step 7800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.833546
step 7900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.833546
test set: accuracy on test set: 0.911
Done training net
0.911000020504
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0973214
step 100, accuracy on validation batch: 0.28125, accuracy on mal data: 0.155867
step 200, accuracy on validation batch: 0.53125, accuracy on mal data: 0.243622
step 300, accuracy on validation batch: 0.640625, accuracy on mal data: 0.348087
step 400, accuracy on validation batch: 0.789062, accuracy on mal data: 0.431505
step 500, accuracy on validation batch: 0.742188, accuracy on mal data: 0.502423
step 600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.556377
step 700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.601658
step 800, accuracy on validation batch: 0.875, accuracy on mal data: 0.630867
step 900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.655867
step 1000, accuracy on validation batch: 0.757812, accuracy on mal data: 0.675382
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.691964
step 1200, accuracy on validation batch: 0.8125, accuracy on mal data: 0.70625
step 1300, accuracy on validation batch: 0.820312, accuracy on mal data: 0.71875
step 1400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.729209
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.737117
step 1600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.746301
step 1700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.756505
step 1800, accuracy on validation batch: 0.820312, accuracy on mal data: 0.761862
step 1900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.770025
step 2000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.774362
step 2100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.778826
step 2200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.781377
step 2300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.786097
step 2400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.790433
step 2500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.792219
step 2600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.795918
step 2700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.797704
step 2800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.799617
step 2900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.802168
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.803954
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.806377
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.80778
step 3300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.810331
step 3400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.812372
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.813648
step 3600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.814796
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816199
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.817219
step 3900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.817474
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817857
step 4100, accuracy on validation batch: 0.875, accuracy on mal data: 0.818622
step 4200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.819005
step 4300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82028
step 4400, accuracy on validation batch: 0.820312, accuracy on mal data: 0.820535
step 4500, accuracy on validation batch: 0.875, accuracy on mal data: 0.821301
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821683
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822066
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823086
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823341
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823342
step 5100, accuracy on validation batch: 0.875, accuracy on mal data: 0.824107
step 5200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824107
step 5300, accuracy on validation batch: 0.96875, accuracy on mal data: 0.824362
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824745
step 5500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.825
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82602
step 5700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.826148
step 5800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826403
step 5900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826403
step 6000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82653
step 6100, accuracy on validation batch: 0.953125, accuracy on mal data: 0.827423
step 6200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827678
step 6300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828316
step 6400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828571
step 6500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828826
step 6600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828954
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829847
step 6800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830612
step 6900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830739
step 7000, accuracy on validation batch: 0.960938, accuracy on mal data: 0.830867
step 7100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830995
step 7200, accuracy on validation batch: 0.875, accuracy on mal data: 0.830995
step 7300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830995
step 7400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.831122
step 7500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831122
step 7600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831122
step 7700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.831122
step 7800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83125
step 7900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831505
test set: accuracy on test set: 0.909
Done training net
0.909100033045
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 16, 'nb_neurons_2': 256, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 256, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.108929
step 100, accuracy on validation batch: 0.234375, accuracy on mal data: 0.175893
step 200, accuracy on validation batch: 0.398438, accuracy on mal data: 0.248724
step 300, accuracy on validation batch: 0.617188, accuracy on mal data: 0.330357
step 400, accuracy on validation batch: 0.65625, accuracy on mal data: 0.414158
step 500, accuracy on validation batch: 0.679688, accuracy on mal data: 0.498852
step 600, accuracy on validation batch: 0.757812, accuracy on mal data: 0.554337
step 700, accuracy on validation batch: 0.789062, accuracy on mal data: 0.590434
step 800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.622066
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.642857
step 1000, accuracy on validation batch: 0.789062, accuracy on mal data: 0.665306
step 1100, accuracy on validation batch: 0.804688, accuracy on mal data: 0.684056
step 1200, accuracy on validation batch: 0.796875, accuracy on mal data: 0.694898
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.705102
step 1400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.71875
step 1500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.730612
step 1600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.740434
step 1700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.749872
step 1800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.757908
step 1900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.764158
step 2000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.76977
step 2100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.774107
step 2200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.779974
step 2300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.7875
step 2400, accuracy on validation batch: 0.875, accuracy on mal data: 0.792857
step 2500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.796301
step 2600, accuracy on validation batch: 0.875, accuracy on mal data: 0.798214
step 2700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.801913
step 2800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.804209
step 2900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.80574
step 3000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.808418
step 3100, accuracy on validation batch: 0.796875, accuracy on mal data: 0.810076
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.812117
step 3300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.812882
step 3400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.814413
step 3500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815944
step 3600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.816836
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817474
step 3800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.818367
step 3900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.819005
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.81977
step 4100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820918
step 4200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.822194
step 4300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.822576
step 4400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.823597
step 4500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.824234
step 4600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.824617
step 4700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.825255
step 4800, accuracy on validation batch: 0.953125, accuracy on mal data: 0.826148
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827041
step 5000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827423
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827423
step 5200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827551
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827551
step 5400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827551
step 5500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827806
step 5600, accuracy on validation batch: 0.875, accuracy on mal data: 0.828061
step 5700, accuracy on validation batch: 0.875, accuracy on mal data: 0.827933
step 5800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827933
step 5900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828444
step 6000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.829592
step 6100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829719
step 6200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829847
step 6300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829847
step 6400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830229
step 6500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830484
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830484
step 6700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830612
step 6800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830739
step 6900, accuracy on validation batch: 0.875, accuracy on mal data: 0.830867
step 7000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.831122
step 7100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831122
step 7200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831377
step 7300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83227
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83227
step 7500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832908
step 7600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.833035
step 7700, accuracy on validation batch: 0.960938, accuracy on mal data: 0.833035
step 7800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.833291
step 7900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.833291
test set: accuracy on test set: 0.910
Done training net
0.910000022054
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.117188, accuracy on mal data: 0.094898
step 100, accuracy on validation batch: 0.304688, accuracy on mal data: 0.165434
step 200, accuracy on validation batch: 0.492188, accuracy on mal data: 0.260714
step 300, accuracy on validation batch: 0.625, accuracy on mal data: 0.368878
step 400, accuracy on validation batch: 0.742188, accuracy on mal data: 0.452041
step 500, accuracy on validation batch: 0.75, accuracy on mal data: 0.52551
step 600, accuracy on validation batch: 0.78125, accuracy on mal data: 0.576531
step 700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.610842
step 800, accuracy on validation batch: 0.765625, accuracy on mal data: 0.641709
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.660459
step 1000, accuracy on validation batch: 0.796875, accuracy on mal data: 0.67602
step 1100, accuracy on validation batch: 0.78125, accuracy on mal data: 0.688775
step 1200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.705102
step 1300, accuracy on validation batch: 0.796875, accuracy on mal data: 0.715561
step 1400, accuracy on validation batch: 0.875, accuracy on mal data: 0.72551
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.732525
step 1600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.739413
step 1700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.749362
step 1800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.757398
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.761862
step 2000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.76875
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.77602
step 2200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.777041
step 2300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.781505
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.783801
step 2500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.789285
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.792474
step 2700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.79528
step 2800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.799234
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.801913
step 3000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.803954
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.80625
step 3200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.808418
step 3300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.809694
step 3400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.810842
step 3500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.81199
step 3600, accuracy on validation batch: 0.875, accuracy on mal data: 0.813393
step 3700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.815306
step 3800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816454
step 3900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.81824
step 4000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.818622
step 4100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.819005
step 4200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.820025
step 4300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.820791
step 4400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.821173
step 4500, accuracy on validation batch: 0.875, accuracy on mal data: 0.821683
step 4600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822066
step 4700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822959
step 4800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823597
step 4900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.823724
step 5000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.824234
step 5100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825382
step 5200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825255
step 5300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.82551
step 5400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825637
step 5500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82602
step 5600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826148
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826403
step 5800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.826148
step 5900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827168
step 6000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827296
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827168
step 6200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827423
step 6300, accuracy on validation batch: 0.875, accuracy on mal data: 0.827551
step 6400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828316
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828954
step 6600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.829592
step 6700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.829719
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829719
step 6900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829974
step 7000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830357
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830867
step 7200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.830867
step 7300, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830995
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830995
step 7500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830995
step 7600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83125
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83125
step 7800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831505
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831505
test set: accuracy on test set: 0.909
Done training net
0.909200021029
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0625, accuracy on mal data: 0.100128
step 100, accuracy on validation batch: 0.320312, accuracy on mal data: 0.154974
step 200, accuracy on validation batch: 0.515625, accuracy on mal data: 0.241709
step 300, accuracy on validation batch: 0.609375, accuracy on mal data: 0.340689
step 400, accuracy on validation batch: 0.726562, accuracy on mal data: 0.422449
step 500, accuracy on validation batch: 0.8125, accuracy on mal data: 0.502041
step 600, accuracy on validation batch: 0.78125, accuracy on mal data: 0.55523
step 700, accuracy on validation batch: 0.742188, accuracy on mal data: 0.588265
step 800, accuracy on validation batch: 0.875, accuracy on mal data: 0.612117
step 900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.637755
step 1000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.658163
step 1100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.673724
step 1200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.687627
step 1300, accuracy on validation batch: 0.828125, accuracy on mal data: 0.69949
step 1400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.710459
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.720153
step 1600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.730612
step 1700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.741326
step 1800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.746046
step 1900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.754974
step 2000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.761862
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.770663
step 2200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.77449
step 2300, accuracy on validation batch: 0.875, accuracy on mal data: 0.780612
step 2400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.785459
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.788648
step 2600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.792474
step 2700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.797449
step 2800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.799745
step 2900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.803699
step 3000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.806122
step 3100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.80778
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.809056
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.810204
step 3400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.812627
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.812755
step 3600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.813648
step 3700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.815178
step 3800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.816836
step 3900, accuracy on validation batch: 0.765625, accuracy on mal data: 0.817219
step 4000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.81926
step 4100, accuracy on validation batch: 0.960938, accuracy on mal data: 0.819643
step 4200, accuracy on validation batch: 0.875, accuracy on mal data: 0.820918
step 4300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.821301
step 4400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821811
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822704
step 4600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823086
step 4700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.823852
step 4800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824234
step 4900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.824872
step 5000, accuracy on validation batch: 0.953125, accuracy on mal data: 0.82551
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825893
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825765
step 5300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.826913
step 5400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827041
step 5500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827168
step 5600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.827296
step 5700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827678
step 5800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827933
step 5900, accuracy on validation batch: 0.875, accuracy on mal data: 0.828061
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828061
step 6100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.828316
step 6200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828826
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829081
step 6400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829209
step 6500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829336
step 6600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829464
step 6700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.829464
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829719
step 6900, accuracy on validation batch: 0.875, accuracy on mal data: 0.829847
step 7000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829847
step 7100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830867
step 7200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830867
step 7300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.831377
step 7400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831632
step 7500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831887
step 7600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831887
step 7700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832525
step 7800, accuracy on validation batch: 0.953125, accuracy on mal data: 0.83278
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83278
test set: accuracy on test set: 0.912
Done training net
0.911600030065
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.109821
step 100, accuracy on validation batch: 0.21875, accuracy on mal data: 0.18852
step 200, accuracy on validation batch: 0.515625, accuracy on mal data: 0.278827
step 300, accuracy on validation batch: 0.664062, accuracy on mal data: 0.371301
step 400, accuracy on validation batch: 0.710938, accuracy on mal data: 0.448469
step 500, accuracy on validation batch: 0.742188, accuracy on mal data: 0.515434
step 600, accuracy on validation batch: 0.757812, accuracy on mal data: 0.569898
step 700, accuracy on validation batch: 0.78125, accuracy on mal data: 0.607653
step 800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.633546
step 900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.657143
step 1000, accuracy on validation batch: 0.8125, accuracy on mal data: 0.677934
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.688903
step 1200, accuracy on validation batch: 0.804688, accuracy on mal data: 0.702296
step 1300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.71352
step 1400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.725127
step 1500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.733163
step 1600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.741581
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.75051
step 1800, accuracy on validation batch: 0.875, accuracy on mal data: 0.757398
step 1900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.763648
step 2000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.770663
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.777041
step 2200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.78176
step 2300, accuracy on validation batch: 0.875, accuracy on mal data: 0.784566
step 2400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.786479
step 2500, accuracy on validation batch: 0.828125, accuracy on mal data: 0.790561
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.793877
step 2700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.795536
step 2800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.797704
step 2900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.8
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.801785
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.805102
step 3200, accuracy on validation batch: 0.875, accuracy on mal data: 0.806122
step 3300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.808928
step 3400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.809949
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.811862
step 3600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81352
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.814668
step 3800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.815816
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816071
step 4000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817219
step 4100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817602
step 4200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.81875
step 4300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819515
step 4400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820153
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821811
step 4600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.822321
step 4700, accuracy on validation batch: 0.875, accuracy on mal data: 0.822576
step 4800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822959
step 4900, accuracy on validation batch: 0.875, accuracy on mal data: 0.823214
step 5000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.823979
step 5100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824489
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824489
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825382
step 5400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.82602
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82653
step 5600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826403
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826785
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827168
step 5900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828188
step 6000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828316
step 6100, accuracy on validation batch: 0.804688, accuracy on mal data: 0.828571
step 6200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828444
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828954
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829081
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829336
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829336
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829464
step 6800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829847
step 6900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830229
step 7000, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830484
step 7100, accuracy on validation batch: 0.953125, accuracy on mal data: 0.830357
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830612
step 7300, accuracy on validation batch: 0.875, accuracy on mal data: 0.830995
step 7400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831122
step 7500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831377
step 7600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831505
step 7700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831887
step 7800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831887
step 7900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.832143
test set: accuracy on test set: 0.911
Done training net
0.910800023079
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0918367
step 100, accuracy on validation batch: 0.304688, accuracy on mal data: 0.144515
step 200, accuracy on validation batch: 0.476562, accuracy on mal data: 0.230995
step 300, accuracy on validation batch: 0.585938, accuracy on mal data: 0.320536
step 400, accuracy on validation batch: 0.6875, accuracy on mal data: 0.419515
step 500, accuracy on validation batch: 0.828125, accuracy on mal data: 0.509184
step 600, accuracy on validation batch: 0.757812, accuracy on mal data: 0.568495
step 700, accuracy on validation batch: 0.804688, accuracy on mal data: 0.59949
step 800, accuracy on validation batch: 0.78125, accuracy on mal data: 0.629847
step 900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.64949
step 1000, accuracy on validation batch: 0.804688, accuracy on mal data: 0.666326
step 1100, accuracy on validation batch: 0.820312, accuracy on mal data: 0.678444
step 1200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.696301
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.710076
step 1400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.720663
step 1500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.73074
step 1600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.741199
step 1700, accuracy on validation batch: 0.765625, accuracy on mal data: 0.746428
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.755229
step 1900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.762117
step 2000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.770791
step 2100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.777423
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.782015
step 2300, accuracy on validation batch: 0.875, accuracy on mal data: 0.787117
step 2400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.790561
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.793495
step 2600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.797704
step 2700, accuracy on validation batch: 0.953125, accuracy on mal data: 0.799617
step 2800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.802168
step 2900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.805484
step 3000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.807398
step 3100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.810204
step 3200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.810969
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.813775
step 3400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.815051
step 3500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.816709
step 3600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.818495
step 3700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.819132
step 3800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.819898
step 3900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.821046
step 4000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.821173
step 4100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.821556
step 4200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822321
step 4300, accuracy on validation batch: 0.875, accuracy on mal data: 0.822576
step 4400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822959
step 4500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.823852
step 4600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824617
step 4700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825
step 4800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825255
step 4900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82551
step 5000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.825765
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82602
step 5200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826658
step 5300, accuracy on validation batch: 0.875, accuracy on mal data: 0.827296
step 5400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827423
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827423
step 5600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.827678
step 5700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827678
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827806
step 5900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828316
step 6000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829209
step 6100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829464
step 6200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829464
step 6300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829847
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830229
step 6500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830484
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830484
step 6700, accuracy on validation batch: 0.875, accuracy on mal data: 0.830612
step 6800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831122
step 6900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831505
step 7000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831505
step 7100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83176
step 7200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832015
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832143
step 7400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832143
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832143
step 7600, accuracy on validation batch: 0.960938, accuracy on mal data: 0.832525
step 7700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832525
step 7800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83278
step 7900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.833673
test set: accuracy on test set: 0.911
Done training net
0.91090002954
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.09375, accuracy on mal data: 0.103444
step 100, accuracy on validation batch: 0.289062, accuracy on mal data: 0.175638
step 200, accuracy on validation batch: 0.515625, accuracy on mal data: 0.277551
step 300, accuracy on validation batch: 0.632812, accuracy on mal data: 0.377934
step 400, accuracy on validation batch: 0.703125, accuracy on mal data: 0.459311
step 500, accuracy on validation batch: 0.6875, accuracy on mal data: 0.526275
step 600, accuracy on validation batch: 0.734375, accuracy on mal data: 0.58023
step 700, accuracy on validation batch: 0.78125, accuracy on mal data: 0.623342
step 800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.647704
step 900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.669643
step 1000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.683036
step 1100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.698979
step 1200, accuracy on validation batch: 0.8125, accuracy on mal data: 0.710969
step 1300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.726658
step 1400, accuracy on validation batch: 0.828125, accuracy on mal data: 0.735842
step 1500, accuracy on validation batch: 0.875, accuracy on mal data: 0.745918
step 1600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.756122
step 1700, accuracy on validation batch: 0.8125, accuracy on mal data: 0.764923
step 1800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.772449
step 1900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.777933
step 2000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.781888
step 2100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.786862
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.790816
step 2300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.795918
step 2400, accuracy on validation batch: 0.8125, accuracy on mal data: 0.799107
step 2500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.801148
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.804336
step 2700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.805357
step 2800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.80727
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.808163
step 3000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.809694
step 3100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.811479
step 3200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.813138
step 3300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.813903
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.814923
step 3500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.815434
step 3600, accuracy on validation batch: 0.875, accuracy on mal data: 0.816454
step 3700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.817602
step 3800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.818367
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.819515
step 4000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.820025
step 4100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820791
step 4200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.820791
step 4300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821556
step 4400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821683
step 4500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822576
step 4600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823469
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823852
step 4800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.824362
step 4900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824617
step 5000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.824745
step 5100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825127
step 5200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825893
step 5300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826275
step 5400, accuracy on validation batch: 0.875, accuracy on mal data: 0.82653
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827041
step 5600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827423
step 5700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828061
step 5800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828189
step 5900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828061
step 6000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828061
step 6100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828444
step 6200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828699
step 6300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828954
step 6400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829464
step 6500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.829464
step 6600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829719
step 6700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829974
step 6800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829974
step 6900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830357
step 7000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830357
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830612
step 7200, accuracy on validation batch: 0.875, accuracy on mal data: 0.831122
step 7300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.831122
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831377
step 7500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.831377
step 7600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831377
step 7700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832143
step 7800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832398
step 7900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.833546
test set: accuracy on test set: 0.911
Done training net
0.910600030422
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.125, accuracy on mal data: 0.0980867
step 100, accuracy on validation batch: 0.34375, accuracy on mal data: 0.168622
step 200, accuracy on validation batch: 0.484375, accuracy on mal data: 0.259566
step 300, accuracy on validation batch: 0.679688, accuracy on mal data: 0.366709
step 400, accuracy on validation batch: 0.726562, accuracy on mal data: 0.457015
step 500, accuracy on validation batch: 0.6875, accuracy on mal data: 0.530102
step 600, accuracy on validation batch: 0.789062, accuracy on mal data: 0.582525
step 700, accuracy on validation batch: 0.8125, accuracy on mal data: 0.616582
step 800, accuracy on validation batch: 0.757812, accuracy on mal data: 0.6375
step 900, accuracy on validation batch: 0.796875, accuracy on mal data: 0.654974
step 1000, accuracy on validation batch: 0.8125, accuracy on mal data: 0.670153
step 1100, accuracy on validation batch: 0.8125, accuracy on mal data: 0.684566
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.698724
step 1300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.711607
step 1400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.723852
step 1500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.735587
step 1600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.744515
step 1700, accuracy on validation batch: 0.875, accuracy on mal data: 0.753316
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.760587
step 1900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.765689
step 2000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.771428
step 2100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.777423
step 2200, accuracy on validation batch: 0.875, accuracy on mal data: 0.784439
step 2300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.7875
step 2400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.791836
step 2500, accuracy on validation batch: 0.875, accuracy on mal data: 0.795025
step 2600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.798979
step 2700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.80051
step 2800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.803189
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.80625
step 3000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.807398
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.809566
step 3200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.810587
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.812627
step 3400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.813393
step 3500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.814285
step 3600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.814668
step 3700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815689
step 3800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816964
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.817729
step 4000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.818622
step 4100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.819898
step 4200, accuracy on validation batch: 0.875, accuracy on mal data: 0.82028
step 4300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821046
step 4400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.822066
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822831
step 4600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.823214
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823979
step 4800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.824617
step 4900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.824872
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825382
step 5100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.826275
step 5200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826275
step 5300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.82653
step 5400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827041
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827168
step 5600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827041
step 5700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827168
step 5800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.827296
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827678
step 6000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828061
step 6100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.828699
step 6200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829592
step 6300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829719
step 6400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829974
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829974
step 6600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829847
step 6700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830612
step 6800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830612
step 6900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830612
step 7000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830612
step 7100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830612
step 7200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83074
step 7300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831122
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831377
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831377
step 7600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83176
step 7700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832398
step 7800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832525
step 7900, accuracy on validation batch: 0.875, accuracy on mal data: 0.833035
test set: accuracy on test set: 0.912
Done training net
0.911600027084
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.09375, accuracy on mal data: 0.100255
step 100, accuracy on validation batch: 0.34375, accuracy on mal data: 0.167857
step 200, accuracy on validation batch: 0.460938, accuracy on mal data: 0.254719
step 300, accuracy on validation batch: 0.609375, accuracy on mal data: 0.35
step 400, accuracy on validation batch: 0.773438, accuracy on mal data: 0.432398
step 500, accuracy on validation batch: 0.78125, accuracy on mal data: 0.497577
step 600, accuracy on validation batch: 0.75, accuracy on mal data: 0.563648
step 700, accuracy on validation batch: 0.742188, accuracy on mal data: 0.602168
step 800, accuracy on validation batch: 0.789062, accuracy on mal data: 0.63074
step 900, accuracy on validation batch: 0.789062, accuracy on mal data: 0.653826
step 1000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.669005
step 1100, accuracy on validation batch: 0.742188, accuracy on mal data: 0.685459
step 1200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.698724
step 1300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.711862
step 1400, accuracy on validation batch: 0.8125, accuracy on mal data: 0.725127
step 1500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.734949
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.746046
step 1700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.754337
step 1800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.763265
step 1900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.769643
step 2000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.77602
step 2100, accuracy on validation batch: 0.875, accuracy on mal data: 0.778699
step 2200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.782908
step 2300, accuracy on validation batch: 0.804688, accuracy on mal data: 0.787627
step 2400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.790944
step 2500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.792729
step 2600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.796938
step 2700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.79949
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.802296
step 2900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.803826
step 3000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.806377
step 3100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.808163
step 3200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.808928
step 3300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.810459
step 3400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.810842
step 3500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.812627
step 3600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.813775
step 3700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.814286
step 3800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.815433
step 3900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.816326
step 4000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.817602
step 4100, accuracy on validation batch: 0.875, accuracy on mal data: 0.817857
step 4200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.818495
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.818622
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820918
step 4500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.820791
step 4600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821811
step 4700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822449
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822831
step 4900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823597
step 5000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824234
step 5100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.824489
step 5200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.824617
step 5300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.825255
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825637
step 5500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826148
step 5600, accuracy on validation batch: 0.875, accuracy on mal data: 0.826148
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826785
step 5800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827041
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827551
step 6000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827678
step 6100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827806
step 6200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827806
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828699
step 6400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828571
step 6500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828699
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828954
step 6700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829974
step 6800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829974
step 6900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830484
step 7000, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830739
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831632
step 7200, accuracy on validation batch: 0.875, accuracy on mal data: 0.831632
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831505
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831505
step 7500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831887
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832143
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83227
step 7800, accuracy on validation batch: 0.960938, accuracy on mal data: 0.832525
step 7900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832653
test set: accuracy on test set: 0.910
Done training net
0.910100026727
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.103189
step 100, accuracy on validation batch: 0.304688, accuracy on mal data: 0.171046
step 200, accuracy on validation batch: 0.59375, accuracy on mal data: 0.265816
step 300, accuracy on validation batch: 0.710938, accuracy on mal data: 0.362372
step 400, accuracy on validation batch: 0.71875, accuracy on mal data: 0.443495
step 500, accuracy on validation batch: 0.757812, accuracy on mal data: 0.513265
step 600, accuracy on validation batch: 0.71875, accuracy on mal data: 0.573342
step 700, accuracy on validation batch: 0.78125, accuracy on mal data: 0.608801
step 800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.639541
step 900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.659184
step 1000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.67551
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.691454
step 1200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.704337
step 1300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.714541
step 1400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.725382
step 1500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.732398
step 1600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.740306
step 1700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.748087
step 1800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.75625
step 1900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.766454
step 2000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.771428
step 2100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.777423
step 2200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.783291
step 2300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.785586
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.789668
step 2500, accuracy on validation batch: 0.875, accuracy on mal data: 0.795025
step 2600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.797449
step 2700, accuracy on validation batch: 0.875, accuracy on mal data: 0.800893
step 2800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.803444
step 2900, accuracy on validation batch: 0.875, accuracy on mal data: 0.805102
step 3000, accuracy on validation batch: 0.945312, accuracy on mal data: 0.806887
step 3100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.80829
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.809056
step 3300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.810586
step 3400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.810842
step 3500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.812245
step 3600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.813648
step 3700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.814413
step 3800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.815306
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816199
step 4000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.817347
step 4100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.818112
step 4200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.819005
step 4300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.81926
step 4400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.820025
step 4500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821301
step 4600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.821683
step 4700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822704
step 4800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.823214
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823214
step 5000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823979
step 5100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824489
step 5200, accuracy on validation batch: 0.945312, accuracy on mal data: 0.824745
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825255
step 5400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82551
step 5500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825637
step 5600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826785
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826658
step 5800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827168
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827296
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827678
step 6100, accuracy on validation batch: 0.875, accuracy on mal data: 0.827423
step 6200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827678
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828316
step 6400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828444
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828699
step 6600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829209
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829464
step 6800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829592
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829719
step 7000, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830612
step 7100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830867
step 7200, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830995
step 7300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83125
step 7400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83176
step 7500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.83176
step 7600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83176
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83176
step 7800, accuracy on validation batch: 0.875, accuracy on mal data: 0.831887
step 7900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832143
test set: accuracy on test set: 0.910
Done training net
0.91000002563
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0625, accuracy on mal data: 0.10727
step 100, accuracy on validation batch: 0.304688, accuracy on mal data: 0.17398
step 200, accuracy on validation batch: 0.492188, accuracy on mal data: 0.252934
step 300, accuracy on validation batch: 0.625, accuracy on mal data: 0.340179
step 400, accuracy on validation batch: 0.640625, accuracy on mal data: 0.436607
step 500, accuracy on validation batch: 0.71875, accuracy on mal data: 0.515051
step 600, accuracy on validation batch: 0.765625, accuracy on mal data: 0.573469
step 700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.607143
step 800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.632908
step 900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.652806
step 1000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.669133
step 1100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.685332
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.698342
step 1300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.710587
step 1400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.722704
step 1500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.732908
step 1600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.742092
step 1700, accuracy on validation batch: 0.8125, accuracy on mal data: 0.750638
step 1800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.755867
step 1900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.763775
step 2000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.766581
step 2100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.771173
step 2200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.77449
step 2300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.779592
step 2400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.783801
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.786607
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.790433
step 2700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.794643
step 2800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.797449
step 2900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.800893
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.803444
step 3100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.804974
step 3200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.805867
step 3300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.806505
step 3400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.807908
step 3500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.808673
step 3600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.809694
step 3700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.810586
step 3800, accuracy on validation batch: 0.960938, accuracy on mal data: 0.813137
step 3900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.814285
step 4000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.814796
step 4100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.815306
step 4200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.816454
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817984
step 4400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.819387
step 4500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.820025
step 4600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.821683
step 4700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821683
step 4800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.821811
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822321
step 5000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823087
step 5100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824107
step 5200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.824107
step 5300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824362
step 5400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824872
step 5500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825
step 5600, accuracy on validation batch: 0.875, accuracy on mal data: 0.825
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.82653
step 5800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.827041
step 5900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827041
step 6000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827296
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827933
step 6200, accuracy on validation batch: 0.953125, accuracy on mal data: 0.827933
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828826
step 6400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.828826
step 6500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829081
step 6600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829592
step 6700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829974
step 6800, accuracy on validation batch: 0.953125, accuracy on mal data: 0.830102
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83074
step 7000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830739
step 7100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.83125
step 7200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83125
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832143
step 7400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83227
step 7500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83227
step 7600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83227
step 7700, accuracy on validation batch: 0.875, accuracy on mal data: 0.832653
step 7800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83278
step 7900, accuracy on validation batch: 0.875, accuracy on mal data: 0.83278
test set: accuracy on test set: 0.911
Done training net
0.911000025868
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.125, accuracy on mal data: 0.0799745
step 100, accuracy on validation batch: 0.273438, accuracy on mal data: 0.15574
step 200, accuracy on validation batch: 0.492188, accuracy on mal data: 0.241837
step 300, accuracy on validation batch: 0.710938, accuracy on mal data: 0.333546
step 400, accuracy on validation batch: 0.664062, accuracy on mal data: 0.425128
step 500, accuracy on validation batch: 0.789062, accuracy on mal data: 0.508163
step 600, accuracy on validation batch: 0.8125, accuracy on mal data: 0.573214
step 700, accuracy on validation batch: 0.804688, accuracy on mal data: 0.613138
step 800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.645153
step 900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.665434
step 1000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.681505
step 1100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.700383
step 1200, accuracy on validation batch: 0.804688, accuracy on mal data: 0.714158
step 1300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.729592
step 1400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.734949
step 1500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.742602
step 1600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.751148
step 1700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.758801
step 1800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.765051
step 1900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.770663
step 2000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.776785
step 2100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.781377
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.787245
step 2300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.791837
step 2400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.79477
step 2500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.797066
step 2600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.798342
step 2700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.80051
step 2800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.802933
step 2900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.803954
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.807015
step 3100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.809311
step 3200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.811097
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.8125
step 3400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.81301
step 3500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.814158
step 3600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.815178
step 3700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.816581
step 3800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.817857
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81824
step 4000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.819388
step 4100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.819898
step 4200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.820791
step 4300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821556
step 4400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822066
step 4500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822576
step 4600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823724
step 4700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.824362
step 4800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824745
step 4900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.824745
step 5000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825127
step 5200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825893
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826148
step 5400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826275
step 5500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.826785
step 5600, accuracy on validation batch: 0.828125, accuracy on mal data: 0.826913
step 5700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827168
step 5800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827168
step 5900, accuracy on validation batch: 0.875, accuracy on mal data: 0.827678
step 6000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828061
step 6100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828061
step 6200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828061
step 6300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828061
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828061
step 6500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828444
step 6600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828826
step 6700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829081
step 6800, accuracy on validation batch: 0.976562, accuracy on mal data: 0.829081
step 6900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829464
step 7000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829974
step 7100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830229
step 7200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830484
step 7300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831122
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831505
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831632
step 7600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832143
step 7700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83227
step 7800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832398
step 7900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832525
test set: accuracy on test set: 0.909
Done training net
0.908800023198
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 512, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 512, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0984694
step 100, accuracy on validation batch: 0.296875, accuracy on mal data: 0.170281
step 200, accuracy on validation batch: 0.476562, accuracy on mal data: 0.250765
step 300, accuracy on validation batch: 0.617188, accuracy on mal data: 0.347832
step 400, accuracy on validation batch: 0.742188, accuracy on mal data: 0.43074
step 500, accuracy on validation batch: 0.773438, accuracy on mal data: 0.512245
step 600, accuracy on validation batch: 0.757812, accuracy on mal data: 0.578061
step 700, accuracy on validation batch: 0.789062, accuracy on mal data: 0.619133
step 800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.644643
step 900, accuracy on validation batch: 0.757812, accuracy on mal data: 0.668495
step 1000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.685714
step 1100, accuracy on validation batch: 0.8125, accuracy on mal data: 0.697066
step 1200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.710204
step 1300, accuracy on validation batch: 0.875, accuracy on mal data: 0.721301
step 1400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.733801
step 1500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.74375
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.751403
step 1700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.75778
step 1800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.76199
step 1900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.767729
step 2000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.771683
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.778316
step 2200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.783163
step 2300, accuracy on validation batch: 0.875, accuracy on mal data: 0.786352
step 2400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.788903
step 2500, accuracy on validation batch: 0.828125, accuracy on mal data: 0.791581
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.795408
step 2700, accuracy on validation batch: 0.875, accuracy on mal data: 0.796939
step 2800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.799617
step 2900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.802423
step 3000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.803699
step 3100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.806505
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.808546
step 3300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.809949
step 3400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.811352
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.81199
step 3600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.81199
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.81352
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.81403
step 3900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.814923
step 4000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.815816
step 4100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817347
step 4200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817729
step 4300, accuracy on validation batch: 0.875, accuracy on mal data: 0.818367
step 4400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.819005
step 4500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.82028
step 4600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.821301
step 4700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.821301
step 4800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821938
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822831
step 5000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.823597
step 5100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.823852
step 5200, accuracy on validation batch: 0.953125, accuracy on mal data: 0.824107
step 5300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825893
step 5400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826785
step 5500, accuracy on validation batch: 0.875, accuracy on mal data: 0.827296
step 5600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827168
step 5700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827296
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827806
step 5900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828444
step 6000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828444
step 6100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.829464
step 6200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829592
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829592
step 6400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829719
step 6500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829974
step 6600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830229
step 6700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830357
step 6800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830484
step 6900, accuracy on validation batch: 0.875, accuracy on mal data: 0.830867
step 7000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831505
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832398
step 7200, accuracy on validation batch: 0.960938, accuracy on mal data: 0.832398
step 7300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832398
step 7400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832525
step 7500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83329
step 7600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.833291
step 7700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.833291
step 7800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.833291
step 7900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.833673
test set: accuracy on test set: 0.912
Done training net
0.911700023413
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.105612
step 100, accuracy on validation batch: 0.273438, accuracy on mal data: 0.179464
step 200, accuracy on validation batch: 0.625, accuracy on mal data: 0.257015
step 300, accuracy on validation batch: 0.710938, accuracy on mal data: 0.360204
step 400, accuracy on validation batch: 0.710938, accuracy on mal data: 0.452679
step 500, accuracy on validation batch: 0.703125, accuracy on mal data: 0.525383
step 600, accuracy on validation batch: 0.804688, accuracy on mal data: 0.58227
step 700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.615689
step 800, accuracy on validation batch: 0.71875, accuracy on mal data: 0.6375
step 900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.653699
step 1000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.669388
step 1100, accuracy on validation batch: 0.8125, accuracy on mal data: 0.685459
step 1200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.697194
step 1300, accuracy on validation batch: 0.828125, accuracy on mal data: 0.712245
step 1400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.720791
step 1500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.734949
step 1600, accuracy on validation batch: 0.875, accuracy on mal data: 0.744643
step 1700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.751913
step 1800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.759183
step 1900, accuracy on validation batch: 0.796875, accuracy on mal data: 0.765944
step 2000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.770791
step 2100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.775382
step 2200, accuracy on validation batch: 0.875, accuracy on mal data: 0.782398
step 2300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.787372
step 2400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.789668
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.792219
step 2600, accuracy on validation batch: 0.875, accuracy on mal data: 0.796556
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.801275
step 2800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.803571
step 2900, accuracy on validation batch: 0.875, accuracy on mal data: 0.805612
step 3000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.80676
step 3100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.809438
step 3200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.810459
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.811862
step 3400, accuracy on validation batch: 0.875, accuracy on mal data: 0.812755
step 3500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.813775
step 3600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.814413
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815178
step 3800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817219
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.818367
step 4000, accuracy on validation batch: 0.875, accuracy on mal data: 0.819005
step 4100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820408
step 4200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821428
step 4300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822066
step 4400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.822321
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822321
step 4600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823469
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823469
step 4800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824107
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825
step 5000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.82602
step 5100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826148
step 5200, accuracy on validation batch: 0.945312, accuracy on mal data: 0.82653
step 5300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.826403
step 5400, accuracy on validation batch: 0.875, accuracy on mal data: 0.826658
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827168
step 5600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827551
step 5700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827678
step 5800, accuracy on validation batch: 0.953125, accuracy on mal data: 0.828189
step 5900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.828316
step 6000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828699
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829081
step 6200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829592
step 6300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829592
step 6400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829592
step 6500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829719
step 6600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829719
step 6700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829974
step 6800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829974
step 6900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.830102
step 7000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830484
step 7100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831377
step 7200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831505
step 7300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.831887
step 7400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.83227
step 7500, accuracy on validation batch: 0.953125, accuracy on mal data: 0.83227
step 7600, accuracy on validation batch: 0.953125, accuracy on mal data: 0.832398
step 7700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832653
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83278
step 7900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83278
test set: accuracy on test set: 0.910
Done training net
0.9097000283
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.10676
step 100, accuracy on validation batch: 0.34375, accuracy on mal data: 0.191071
step 200, accuracy on validation batch: 0.4375, accuracy on mal data: 0.274107
step 300, accuracy on validation batch: 0.617188, accuracy on mal data: 0.358163
step 400, accuracy on validation batch: 0.726562, accuracy on mal data: 0.439923
step 500, accuracy on validation batch: 0.765625, accuracy on mal data: 0.508673
step 600, accuracy on validation batch: 0.804688, accuracy on mal data: 0.563393
step 700, accuracy on validation batch: 0.726562, accuracy on mal data: 0.606377
step 800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.633418
step 900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.656377
step 1000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.675127
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.691964
step 1200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.709694
step 1300, accuracy on validation batch: 0.8125, accuracy on mal data: 0.720153
step 1400, accuracy on validation batch: 0.757812, accuracy on mal data: 0.730484
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.742857
step 1600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.749872
step 1700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.75676
step 1800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.763648
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.769005
step 2000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.773979
step 2100, accuracy on validation batch: 0.875, accuracy on mal data: 0.777933
step 2200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.783546
step 2300, accuracy on validation batch: 0.828125, accuracy on mal data: 0.788137
step 2400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.790944
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.793112
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.795663
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.798342
step 2800, accuracy on validation batch: 0.820312, accuracy on mal data: 0.801148
step 2900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.802806
step 3000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.805484
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.80778
step 3200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.809821
step 3300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.810969
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.812755
step 3500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.813775
step 3600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.814668
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815688
step 3800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.816454
step 3900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816964
step 4000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.817729
step 4100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.819387
step 4200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.820025
step 4300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.820663
step 4400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.821046
step 4500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.821556
step 4600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821938
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822321
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822576
step 4900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823087
step 5000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824362
step 5100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.824872
step 5200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825637
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825765
step 5400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826403
step 5500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826403
step 5600, accuracy on validation batch: 0.960938, accuracy on mal data: 0.827041
step 5700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827168
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828189
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828189
step 6000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828316
step 6100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828444
step 6200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828699
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829336
step 6400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829464
step 6500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829464
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829592
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830229
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830995
step 6900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830995
step 7000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830995
step 7100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831122
step 7200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831632
step 7300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831887
step 7400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.83227
step 7500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83227
step 7600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832908
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832908
step 7800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.833035
step 7900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.833418
test set: accuracy on test set: 0.910
Done training net
0.909900026321
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0946428
step 100, accuracy on validation batch: 0.34375, accuracy on mal data: 0.171811
step 200, accuracy on validation batch: 0.523438, accuracy on mal data: 0.252934
step 300, accuracy on validation batch: 0.695312, accuracy on mal data: 0.357781
step 400, accuracy on validation batch: 0.695312, accuracy on mal data: 0.459821
step 500, accuracy on validation batch: 0.726562, accuracy on mal data: 0.534439
step 600, accuracy on validation batch: 0.78125, accuracy on mal data: 0.586735
step 700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.616837
step 800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.646939
step 900, accuracy on validation batch: 0.8125, accuracy on mal data: 0.664668
step 1000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.683546
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.696046
step 1200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.706888
step 1300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.720408
step 1400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.729209
step 1500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.73801
step 1600, accuracy on validation batch: 0.875, accuracy on mal data: 0.750127
step 1700, accuracy on validation batch: 0.875, accuracy on mal data: 0.756887
step 1800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.76352
step 1900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.769515
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.774362
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.779719
step 2200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.782143
step 2300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.785842
step 2400, accuracy on validation batch: 0.875, accuracy on mal data: 0.787627
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.791709
step 2600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.793877
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.796683
step 2800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.799745
step 2900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.801785
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.802806
step 3100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.804209
step 3200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.80676
step 3300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.808291
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.809949
step 3500, accuracy on validation batch: 0.875, accuracy on mal data: 0.811224
step 3600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.812882
step 3700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.813648
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.81403
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.814286
step 4000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.814923
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815306
step 4200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.816326
step 4300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816326
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816836
step 4500, accuracy on validation batch: 0.828125, accuracy on mal data: 0.817474
step 4600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.818112
step 4700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.819005
step 4800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.819388
step 4900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.820025
step 5000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.820918
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821938
step 5200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822959
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823342
step 5400, accuracy on validation batch: 0.875, accuracy on mal data: 0.824745
step 5500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.825382
step 5600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.82602
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826403
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826658
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826785
step 6000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827041
step 6100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827041
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827423
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828189
step 6400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828316
step 6500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828954
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828954
step 6700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829209
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829209
step 6900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829336
step 7000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829719
step 7100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830739
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830739
step 7300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830739
step 7400, accuracy on validation batch: 0.953125, accuracy on mal data: 0.830867
step 7500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831377
step 7600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.83176
step 7700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83176
step 7800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83227
step 7900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832398
test set: accuracy on test set: 0.910
Done training net
0.909800018668
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0625, accuracy on mal data: 0.0901786
step 100, accuracy on validation batch: 0.296875, accuracy on mal data: 0.154719
step 200, accuracy on validation batch: 0.5, accuracy on mal data: 0.254847
step 300, accuracy on validation batch: 0.625, accuracy on mal data: 0.354719
step 400, accuracy on validation batch: 0.75, accuracy on mal data: 0.446046
step 500, accuracy on validation batch: 0.710938, accuracy on mal data: 0.517219
step 600, accuracy on validation batch: 0.804688, accuracy on mal data: 0.567985
step 700, accuracy on validation batch: 0.796875, accuracy on mal data: 0.600638
step 800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.628189
step 900, accuracy on validation batch: 0.78125, accuracy on mal data: 0.645663
step 1000, accuracy on validation batch: 0.796875, accuracy on mal data: 0.666837
step 1100, accuracy on validation batch: 0.8125, accuracy on mal data: 0.68074
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.694005
step 1300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.70778
step 1400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.717347
step 1500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.728061
step 1600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.73852
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.746811
step 1800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.752423
step 1900, accuracy on validation batch: 0.820312, accuracy on mal data: 0.759694
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.765816
step 2100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.771683
step 2200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.777168
step 2300, accuracy on validation batch: 0.953125, accuracy on mal data: 0.783928
step 2400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.78699
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.789923
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.791709
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.795663
step 2800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.797194
step 2900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.800382
step 3000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.804209
step 3100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.805357
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.807653
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.810204
step 3400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.811352
step 3500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.8125
step 3600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.814413
step 3700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.815433
step 3800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817984
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.818367
step 4000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819132
step 4100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.819387
step 4200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.819898
step 4300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.820918
step 4400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822194
step 4500, accuracy on validation batch: 0.875, accuracy on mal data: 0.822194
step 4600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823214
step 4700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.823087
step 4800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823469
step 4900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824234
step 5000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825
step 5100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.825637
step 5200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826275
step 5300, accuracy on validation batch: 0.875, accuracy on mal data: 0.82653
step 5400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.826658
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827423
step 5600, accuracy on validation batch: 0.8125, accuracy on mal data: 0.827551
step 5700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827678
step 5800, accuracy on validation batch: 0.96875, accuracy on mal data: 0.828189
step 5900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828188
step 6000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828444
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828444
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828699
step 6300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829209
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829209
step 6500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829336
step 6600, accuracy on validation batch: 0.875, accuracy on mal data: 0.829464
step 6700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829719
step 6800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.829719
step 6900, accuracy on validation batch: 0.875, accuracy on mal data: 0.830357
step 7000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830739
step 7100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830995
step 7200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830995
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830995
step 7400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83125
step 7500, accuracy on validation batch: 0.960938, accuracy on mal data: 0.83125
step 7600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831632
step 7700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831505
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83176
step 7900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832015
test set: accuracy on test set: 0.911
Done training net
0.911100032926
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.109375, accuracy on mal data: 0.108929
step 100, accuracy on validation batch: 0.328125, accuracy on mal data: 0.178444
step 200, accuracy on validation batch: 0.570312, accuracy on mal data: 0.278699
step 300, accuracy on validation batch: 0.570312, accuracy on mal data: 0.371684
step 400, accuracy on validation batch: 0.804688, accuracy on mal data: 0.454719
step 500, accuracy on validation batch: 0.742188, accuracy on mal data: 0.52551
step 600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.573469
step 700, accuracy on validation batch: 0.796875, accuracy on mal data: 0.613265
step 800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.641071
step 900, accuracy on validation batch: 0.789062, accuracy on mal data: 0.660459
step 1000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.678571
step 1100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.696684
step 1200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.711352
step 1300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.722959
step 1400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.732653
step 1500, accuracy on validation batch: 0.78125, accuracy on mal data: 0.745153
step 1600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.751913
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.758418
step 1800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.766964
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.771301
step 2000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.77551
step 2100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.778189
step 2200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.781505
step 2300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.785969
step 2400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.787882
step 2500, accuracy on validation batch: 0.804688, accuracy on mal data: 0.79324
step 2600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.796556
step 2700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.799234
step 2800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.802041
step 2900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.803444
step 3000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.804719
step 3100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.806632
step 3200, accuracy on validation batch: 0.875, accuracy on mal data: 0.808418
step 3300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.809821
step 3400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.811224
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.81301
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.813648
step 3700, accuracy on validation batch: 0.875, accuracy on mal data: 0.814923
step 3800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.815433
step 3900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.816199
step 4000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817347
step 4100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.81875
step 4200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820536
step 4300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820535
step 4400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822449
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822959
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822959
step 4700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.823086
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824107
step 4900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.824107
step 5000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825127
step 5100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825765
step 5200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826658
step 5300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.826913
step 5400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827296
step 5500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827168
step 5600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827423
step 5700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827806
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827678
step 5900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827933
step 6000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828061
step 6100, accuracy on validation batch: 0.875, accuracy on mal data: 0.828699
step 6200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.828954
step 6300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829336
step 6400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829719
step 6500, accuracy on validation batch: 0.953125, accuracy on mal data: 0.829847
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830229
step 6700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830357
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830357
step 6900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830484
step 7000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830739
step 7100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830867
step 7200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831122
step 7300, accuracy on validation batch: 0.875, accuracy on mal data: 0.83125
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83125
step 7500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.83125
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83125
step 7700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831377
step 7800, accuracy on validation batch: 0.875, accuracy on mal data: 0.83176
step 7900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832525
test set: accuracy on test set: 0.911
Done training net
0.911100023985
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 512, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 512, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.0975765
step 100, accuracy on validation batch: 0.203125, accuracy on mal data: 0.164541
step 200, accuracy on validation batch: 0.453125, accuracy on mal data: 0.253189
step 300, accuracy on validation batch: 0.546875, accuracy on mal data: 0.339668
step 400, accuracy on validation batch: 0.757812, accuracy on mal data: 0.426786
step 500, accuracy on validation batch: 0.6875, accuracy on mal data: 0.510714
step 600, accuracy on validation batch: 0.804688, accuracy on mal data: 0.563903
step 700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.597704
step 800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.629082
step 900, accuracy on validation batch: 0.8125, accuracy on mal data: 0.648342
step 1000, accuracy on validation batch: 0.789062, accuracy on mal data: 0.673597
step 1100, accuracy on validation batch: 0.796875, accuracy on mal data: 0.68903
step 1200, accuracy on validation batch: 0.765625, accuracy on mal data: 0.701658
step 1300, accuracy on validation batch: 0.8125, accuracy on mal data: 0.710586
step 1400, accuracy on validation batch: 0.804688, accuracy on mal data: 0.724107
step 1500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.733163
step 1600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.742984
step 1700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.74949
step 1800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.758673
step 1900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.763775
step 2000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.768495
step 2100, accuracy on validation batch: 0.820312, accuracy on mal data: 0.776403
step 2200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.783163
step 2300, accuracy on validation batch: 0.875, accuracy on mal data: 0.78903
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.793495
step 2500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.797959
step 2600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.800382
step 2700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.801658
step 2800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.803571
step 2900, accuracy on validation batch: 0.875, accuracy on mal data: 0.80676
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.807653
step 3100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.809056
step 3200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.809949
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.812117
step 3400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.813265
step 3500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.814668
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815688
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817219
step 3800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.817857
step 3900, accuracy on validation batch: 0.875, accuracy on mal data: 0.81875
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.81926
step 4100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.819515
step 4200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.819898
step 4300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.820918
step 4400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821046
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821683
step 4600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822576
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822449
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822704
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823214
step 5000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824617
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825255
step 5200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.82551
step 5300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82602
step 5400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826148
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826403
step 5600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.826403
step 5700, accuracy on validation batch: 0.953125, accuracy on mal data: 0.827423
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827806
step 5900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828189
step 6000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828316
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828444
step 6200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828571
step 6300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828699
step 6400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828954
step 6500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829592
step 6600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.829847
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829847
step 6800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830229
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830484
step 7000, accuracy on validation batch: 0.953125, accuracy on mal data: 0.83074
step 7100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831122
step 7200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831122
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831505
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831887
step 7500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832143
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83227
step 7700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832398
step 7800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832525
step 7900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832525
test set: accuracy on test set: 0.911
Done training net
0.911100016832
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.046875, accuracy on mal data: 0.103316
step 100, accuracy on validation batch: 0.257812, accuracy on mal data: 0.169133
step 200, accuracy on validation batch: 0.492188, accuracy on mal data: 0.260077
step 300, accuracy on validation batch: 0.570312, accuracy on mal data: 0.3625
step 400, accuracy on validation batch: 0.726562, accuracy on mal data: 0.447194
step 500, accuracy on validation batch: 0.828125, accuracy on mal data: 0.515434
step 600, accuracy on validation batch: 0.78125, accuracy on mal data: 0.561735
step 700, accuracy on validation batch: 0.742188, accuracy on mal data: 0.595791
step 800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.625255
step 900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.648852
step 1000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.663775
step 1100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.683546
step 1200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.698852
step 1300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.711862
step 1400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.721428
step 1500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.729719
step 1600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.73852
step 1700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.748597
step 1800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.758036
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.763775
step 2000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.767985
step 2100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.773724
step 2200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.778444
step 2300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.783163
step 2400, accuracy on validation batch: 0.875, accuracy on mal data: 0.788265
step 2500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.793367
step 2600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.796683
step 2700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.800638
step 2800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.802933
step 2900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.803954
step 3000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.80625
step 3100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.808673
step 3200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.810076
step 3300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.811734
step 3400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.813138
step 3500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.814286
step 3600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.815944
step 3700, accuracy on validation batch: 0.875, accuracy on mal data: 0.816326
step 3800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.816709
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.817984
step 4000, accuracy on validation batch: 0.945312, accuracy on mal data: 0.818495
step 4100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.819387
step 4200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81977
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820153
step 4400, accuracy on validation batch: 0.804688, accuracy on mal data: 0.820791
step 4500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821173
step 4600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822194
step 4700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.822831
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823214
step 4900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.823852
step 5000, accuracy on validation batch: 0.875, accuracy on mal data: 0.82551
step 5100, accuracy on validation batch: 0.875, accuracy on mal data: 0.826148
step 5200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.826913
step 5300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827423
step 5400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827551
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827678
step 5600, accuracy on validation batch: 0.953125, accuracy on mal data: 0.828316
step 5700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828316
step 5800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828571
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828699
step 6000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828571
step 6100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828699
step 6200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829464
step 6300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829592
step 6400, accuracy on validation batch: 0.953125, accuracy on mal data: 0.829719
step 6500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829847
step 6600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.830357
step 6700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830484
step 6800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830484
step 6900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830612
step 7000, accuracy on validation batch: 0.875, accuracy on mal data: 0.830612
step 7100, accuracy on validation batch: 0.875, accuracy on mal data: 0.830995
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830995
step 7300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830995
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830995
step 7500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830995
step 7600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831122
step 7700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831505
step 7800, accuracy on validation batch: 0.875, accuracy on mal data: 0.831377
step 7900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83176
test set: accuracy on test set: 0.912
Done training net
0.911600026488
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0390625, accuracy on mal data: 0.102041
step 100, accuracy on validation batch: 0.28125, accuracy on mal data: 0.177296
step 200, accuracy on validation batch: 0.476562, accuracy on mal data: 0.276658
step 300, accuracy on validation batch: 0.632812, accuracy on mal data: 0.385714
step 400, accuracy on validation batch: 0.757812, accuracy on mal data: 0.46199
step 500, accuracy on validation batch: 0.742188, accuracy on mal data: 0.525893
step 600, accuracy on validation batch: 0.796875, accuracy on mal data: 0.577551
step 700, accuracy on validation batch: 0.765625, accuracy on mal data: 0.608418
step 800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.638775
step 900, accuracy on validation batch: 0.773438, accuracy on mal data: 0.660331
step 1000, accuracy on validation batch: 0.875, accuracy on mal data: 0.682653
step 1100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.698087
step 1200, accuracy on validation batch: 0.875, accuracy on mal data: 0.709439
step 1300, accuracy on validation batch: 0.804688, accuracy on mal data: 0.722194
step 1400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.736224
step 1500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.746428
step 1600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.753316
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.759821
step 1800, accuracy on validation batch: 0.875, accuracy on mal data: 0.766837
step 1900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.771428
step 2000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.778061
step 2100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.783163
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.785331
step 2300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.789668
step 2400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.792729
step 2500, accuracy on validation batch: 0.875, accuracy on mal data: 0.79528
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.797194
step 2700, accuracy on validation batch: 0.875, accuracy on mal data: 0.80051
step 2800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.802168
step 2900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.804081
step 3000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.804592
step 3100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.807143
step 3200, accuracy on validation batch: 0.945312, accuracy on mal data: 0.808291
step 3300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.810586
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.810969
step 3500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.811734
step 3600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.812117
step 3700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.81352
step 3800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.815306
step 3900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.816964
step 4000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817857
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.818495
step 4200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819898
step 4300, accuracy on validation batch: 0.820312, accuracy on mal data: 0.820408
step 4400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821173
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822066
step 4600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822831
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822959
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823214
step 4900, accuracy on validation batch: 0.953125, accuracy on mal data: 0.824489
step 5000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.824745
step 5100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825127
step 5200, accuracy on validation batch: 0.875, accuracy on mal data: 0.825127
step 5300, accuracy on validation batch: 0.875, accuracy on mal data: 0.82551
step 5400, accuracy on validation batch: 0.875, accuracy on mal data: 0.825382
step 5500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825382
step 5600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825637
step 5700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825893
step 5800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826403
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826913
step 6000, accuracy on validation batch: 0.875, accuracy on mal data: 0.827168
step 6100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827551
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827806
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828316
step 6400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828699
step 6500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829336
step 6600, accuracy on validation batch: 0.953125, accuracy on mal data: 0.829336
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829464
step 6800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830229
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830484
step 7000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830484
step 7100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830612
step 7200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830867
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830867
step 7400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831377
step 7500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832015
step 7600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832015
step 7700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832015
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832525
step 7900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832525
test set: accuracy on test set: 0.909
Done training net
0.909400028586
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.104209
step 100, accuracy on validation batch: 0.320312, accuracy on mal data: 0.16977
step 200, accuracy on validation batch: 0.476562, accuracy on mal data: 0.25574
step 300, accuracy on validation batch: 0.640625, accuracy on mal data: 0.347959
step 400, accuracy on validation batch: 0.734375, accuracy on mal data: 0.434056
step 500, accuracy on validation batch: 0.71875, accuracy on mal data: 0.504209
step 600, accuracy on validation batch: 0.773438, accuracy on mal data: 0.553189
step 700, accuracy on validation batch: 0.796875, accuracy on mal data: 0.589668
step 800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.619515
step 900, accuracy on validation batch: 0.796875, accuracy on mal data: 0.643622
step 1000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.657525
step 1100, accuracy on validation batch: 0.875, accuracy on mal data: 0.673087
step 1200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.68801
step 1300, accuracy on validation batch: 0.828125, accuracy on mal data: 0.703571
step 1400, accuracy on validation batch: 0.820312, accuracy on mal data: 0.718367
step 1500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.730102
step 1600, accuracy on validation batch: 0.875, accuracy on mal data: 0.741709
step 1700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.749872
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.755995
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.762627
step 2000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.76875
step 2100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.774235
step 2200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.778061
step 2300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.784566
step 2400, accuracy on validation batch: 0.875, accuracy on mal data: 0.788265
step 2500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.792347
step 2600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.796556
step 2700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.798979
step 2800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.801403
step 2900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.804336
step 3000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.80574
step 3100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.808291
step 3200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.810204
step 3300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.811224
step 3400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.813265
step 3500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.814541
step 3600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.815944
step 3700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.816454
step 3800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.817347
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.817984
step 4000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.819898
step 4100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.820535
step 4200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.821556
step 4300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.821811
step 4400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822449
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822576
step 4600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823214
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823852
step 4800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824107
step 4900, accuracy on validation batch: 0.976562, accuracy on mal data: 0.825
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825127
step 5100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825382
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825765
step 5300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.82602
step 5400, accuracy on validation batch: 0.875, accuracy on mal data: 0.827168
step 5500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827423
step 5600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827551
step 5700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827678
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828316
step 5900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828188
step 6000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829081
step 6100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829464
step 6200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829464
step 6300, accuracy on validation batch: 0.953125, accuracy on mal data: 0.829847
step 6400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830357
step 6500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830739
step 6600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.830739
step 6700, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830867
step 6800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830995
step 6900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831632
step 7000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832015
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83227
step 7200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83227
step 7300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832525
step 7400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832525
step 7500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83278
step 7600, accuracy on validation batch: 0.875, accuracy on mal data: 0.833035
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832653
step 7800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.833163
step 7900, accuracy on validation batch: 0.875, accuracy on mal data: 0.833163
test set: accuracy on test set: 0.911
Done training net
0.911200024486
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0903061
step 100, accuracy on validation batch: 0.195312, accuracy on mal data: 0.163265
step 200, accuracy on validation batch: 0.460938, accuracy on mal data: 0.266199
step 300, accuracy on validation batch: 0.671875, accuracy on mal data: 0.365816
step 400, accuracy on validation batch: 0.671875, accuracy on mal data: 0.443367
step 500, accuracy on validation batch: 0.710938, accuracy on mal data: 0.512628
step 600, accuracy on validation batch: 0.804688, accuracy on mal data: 0.552168
step 700, accuracy on validation batch: 0.742188, accuracy on mal data: 0.595281
step 800, accuracy on validation batch: 0.789062, accuracy on mal data: 0.626148
step 900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.649362
step 1000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.670663
step 1100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.68852
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.702041
step 1300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.713138
step 1400, accuracy on validation batch: 0.875, accuracy on mal data: 0.724107
step 1500, accuracy on validation batch: 0.8125, accuracy on mal data: 0.734183
step 1600, accuracy on validation batch: 0.765625, accuracy on mal data: 0.743877
step 1700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.754592
step 1800, accuracy on validation batch: 0.875, accuracy on mal data: 0.760331
step 1900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.767729
step 2000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.773724
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.779592
step 2200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.785204
step 2300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.788393
step 2400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.791837
step 2500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.795025
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.798087
step 2700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.800765
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.802551
step 2900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.805867
step 3000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.807653
step 3100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.810587
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.812245
step 3300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.813137
step 3400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.815306
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816837
step 3600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817857
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.819005
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.819132
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819387
step 4000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.820025
step 4100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.820408
step 4200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.821301
step 4300, accuracy on validation batch: 0.875, accuracy on mal data: 0.821938
step 4400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822321
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822449
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822831
step 4700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824107
step 4800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824107
step 4900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824362
step 5000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824872
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824872
step 5200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825127
step 5300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82551
step 5400, accuracy on validation batch: 0.953125, accuracy on mal data: 0.82551
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825765
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82602
step 5700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.826403
step 5800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827168
step 5900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827423
step 6000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828188
step 6100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828699
step 6200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829209
step 6300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829719
step 6400, accuracy on validation batch: 0.820312, accuracy on mal data: 0.830102
step 6500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830229
step 6600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830357
step 6700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830612
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830739
step 6900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831632
step 7000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831887
step 7100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83227
step 7200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83227
step 7300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832398
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832525
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832398
step 7600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832525
step 7700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832653
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832653
step 7900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832653
test set: accuracy on test set: 0.910
Done training net
0.910400029421
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 512, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 512, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0936224
step 100, accuracy on validation batch: 0.3125, accuracy on mal data: 0.167857
step 200, accuracy on validation batch: 0.523438, accuracy on mal data: 0.261225
step 300, accuracy on validation batch: 0.664062, accuracy on mal data: 0.353699
step 400, accuracy on validation batch: 0.75, accuracy on mal data: 0.449107
step 500, accuracy on validation batch: 0.796875, accuracy on mal data: 0.528061
step 600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.572959
step 700, accuracy on validation batch: 0.75, accuracy on mal data: 0.605357
step 800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.625765
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.640433
step 1000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.656505
step 1100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.669898
step 1200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.686734
step 1300, accuracy on validation batch: 0.828125, accuracy on mal data: 0.699745
step 1400, accuracy on validation batch: 0.8125, accuracy on mal data: 0.710842
step 1500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.723214
step 1600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.73125
step 1700, accuracy on validation batch: 0.875, accuracy on mal data: 0.741071
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.75
step 1900, accuracy on validation batch: 0.875, accuracy on mal data: 0.758928
step 2000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.767347
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.773342
step 2200, accuracy on validation batch: 0.789062, accuracy on mal data: 0.778699
step 2300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.784311
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.786862
step 2500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.792729
step 2600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.796556
step 2700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.800893
step 2800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.803061
step 2900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.804336
step 3000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.806122
step 3100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.808291
step 3200, accuracy on validation batch: 0.796875, accuracy on mal data: 0.809566
step 3300, accuracy on validation batch: 0.953125, accuracy on mal data: 0.810969
step 3400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.812755
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.813648
step 3600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.814413
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815433
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.816454
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817474
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.818367
step 4100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.819132
step 4200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.820025
step 4300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.821556
step 4400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822704
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823342
step 4600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823469
step 4700, accuracy on validation batch: 0.875, accuracy on mal data: 0.823724
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824107
step 4900, accuracy on validation batch: 0.96875, accuracy on mal data: 0.824107
step 5000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824362
step 5100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824872
step 5200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825382
step 5300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826148
step 5400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826658
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827168
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827423
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827933
step 5800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828061
step 5900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828188
step 6000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828571
step 6100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828826
step 6200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828826
step 6300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829209
step 6400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.829209
step 6500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829592
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829974
step 6700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830102
step 6800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830229
step 6900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830612
step 7000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.83125
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831505
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832015
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83227
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832525
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832653
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832653
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83278
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83278
step 7900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.83278
test set: accuracy on test set: 0.911
Done training net
0.911000027657
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.108418
step 100, accuracy on validation batch: 0.296875, accuracy on mal data: 0.185969
step 200, accuracy on validation batch: 0.445312, accuracy on mal data: 0.283546
step 300, accuracy on validation batch: 0.640625, accuracy on mal data: 0.372959
step 400, accuracy on validation batch: 0.789062, accuracy on mal data: 0.459439
step 500, accuracy on validation batch: 0.734375, accuracy on mal data: 0.538393
step 600, accuracy on validation batch: 0.875, accuracy on mal data: 0.596811
step 700, accuracy on validation batch: 0.765625, accuracy on mal data: 0.628699
step 800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.658291
step 900, accuracy on validation batch: 0.796875, accuracy on mal data: 0.680229
step 1000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.695536
step 1100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.707908
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.720408
step 1300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.730102
step 1400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.736352
step 1500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.741581
step 1600, accuracy on validation batch: 0.828125, accuracy on mal data: 0.747321
step 1700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.755867
step 1800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.763775
step 1900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.770791
step 2000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.775
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.779592
step 2200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.782908
step 2300, accuracy on validation batch: 0.945312, accuracy on mal data: 0.786862
step 2400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.791326
step 2500, accuracy on validation batch: 0.875, accuracy on mal data: 0.79375
step 2600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.795791
step 2700, accuracy on validation batch: 0.953125, accuracy on mal data: 0.797959
step 2800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.80051
step 2900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.802041
step 3000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.803826
step 3100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.805229
step 3200, accuracy on validation batch: 0.875, accuracy on mal data: 0.805995
step 3300, accuracy on validation batch: 0.875, accuracy on mal data: 0.807525
step 3400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.809438
step 3500, accuracy on validation batch: 0.875, accuracy on mal data: 0.811097
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.8125
step 3700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.813648
step 3800, accuracy on validation batch: 0.953125, accuracy on mal data: 0.815051
step 3900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.815816
step 4000, accuracy on validation batch: 0.875, accuracy on mal data: 0.816964
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.817602
step 4200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817984
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.818622
step 4400, accuracy on validation batch: 0.875, accuracy on mal data: 0.819005
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.819387
step 4600, accuracy on validation batch: 0.875, accuracy on mal data: 0.82028
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821428
step 4800, accuracy on validation batch: 0.875, accuracy on mal data: 0.821938
step 4900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.822194
step 5000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822959
step 5100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823342
step 5200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823724
step 5300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824234
step 5400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824489
step 5500, accuracy on validation batch: 0.875, accuracy on mal data: 0.824872
step 5600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825893
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826275
step 5800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826275
step 5900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82704
step 6000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827423
step 6100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827678
step 6200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828189
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828444
step 6400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828826
step 6500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829081
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829464
step 6700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830229
step 6800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830229
step 6900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830739
step 7000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831122
step 7100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831632
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832015
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832143
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832143
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83227
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832398
step 7700, accuracy on validation batch: 0.960938, accuracy on mal data: 0.832653
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832908
step 7900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83278
test set: accuracy on test set: 0.910
Done training net
0.909600026608
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.109375, accuracy on mal data: 0.094898
step 100, accuracy on validation batch: 0.304688, accuracy on mal data: 0.174617
step 200, accuracy on validation batch: 0.484375, accuracy on mal data: 0.26352
step 300, accuracy on validation batch: 0.726562, accuracy on mal data: 0.363265
step 400, accuracy on validation batch: 0.734375, accuracy on mal data: 0.443367
step 500, accuracy on validation batch: 0.773438, accuracy on mal data: 0.518495
step 600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.572576
step 700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.61301
step 800, accuracy on validation batch: 0.796875, accuracy on mal data: 0.639413
step 900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.664541
step 1000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.683163
step 1100, accuracy on validation batch: 0.875, accuracy on mal data: 0.699107
step 1200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.709821
step 1300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.717602
step 1400, accuracy on validation batch: 0.8125, accuracy on mal data: 0.727806
step 1500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.739158
step 1600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.748979
step 1700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.752934
step 1800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.759694
step 1900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.764158
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.770536
step 2100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.776148
step 2200, accuracy on validation batch: 0.804688, accuracy on mal data: 0.780612
step 2300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.784821
step 2400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.788903
step 2500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.791837
step 2600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.79477
step 2700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.797576
step 2800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.8
step 2900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.802423
step 3000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.803699
step 3100, accuracy on validation batch: 0.820312, accuracy on mal data: 0.804336
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.806632
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.807525
step 3400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.809949
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.810586
step 3600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.811224
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.812627
step 3800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.81352
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815178
step 4000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.816199
step 4100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.816581
step 4200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.817602
step 4300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.817857
step 4400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.819643
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820918
step 4600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822576
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822704
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822959
step 4900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822959
step 5000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823214
step 5100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823979
step 5200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824107
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825
step 5400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825382
step 5500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.82551
step 5600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.825637
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825893
step 5800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82653
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827551
step 6000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827551
step 6100, accuracy on validation batch: 0.953125, accuracy on mal data: 0.827423
step 6200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827423
step 6300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827551
step 6400, accuracy on validation batch: 0.875, accuracy on mal data: 0.828444
step 6500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828444
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828571
step 6700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.829209
step 6800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.829209
step 6900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829464
step 7000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830102
step 7100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830229
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830484
step 7300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830739
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830867
step 7500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.830867
step 7600, accuracy on validation batch: 0.875, accuracy on mal data: 0.830867
step 7700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830995
step 7800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830995
step 7900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.831505
test set: accuracy on test set: 0.911
Done training net
0.911300029159
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.125, accuracy on mal data: 0.105102
step 100, accuracy on validation batch: 0.359375, accuracy on mal data: 0.169515
step 200, accuracy on validation batch: 0.546875, accuracy on mal data: 0.269515
step 300, accuracy on validation batch: 0.640625, accuracy on mal data: 0.371684
step 400, accuracy on validation batch: 0.789062, accuracy on mal data: 0.452168
step 500, accuracy on validation batch: 0.742188, accuracy on mal data: 0.522959
step 600, accuracy on validation batch: 0.796875, accuracy on mal data: 0.571428
step 700, accuracy on validation batch: 0.773438, accuracy on mal data: 0.598852
step 800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.622704
step 900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.644132
step 1000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.666709
step 1100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.686097
step 1200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.7
step 1300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.718622
step 1400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.728189
step 1500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.737245
step 1600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.745918
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.756632
step 1800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.761862
step 1900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.767857
step 2000, accuracy on validation batch: 0.875, accuracy on mal data: 0.774234
step 2100, accuracy on validation batch: 0.804688, accuracy on mal data: 0.779464
step 2200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.784056
step 2300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.789158
step 2400, accuracy on validation batch: 0.875, accuracy on mal data: 0.792857
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.796301
step 2600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.798979
step 2700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.801275
step 2800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.803826
step 2900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.806632
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.809438
step 3100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.810842
step 3200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.811479
step 3300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.812627
step 3400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.814285
step 3500, accuracy on validation batch: 0.875, accuracy on mal data: 0.815306
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815688
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816199
step 3800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817219
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.818367
step 4000, accuracy on validation batch: 0.945312, accuracy on mal data: 0.818877
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81926
step 4200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820025
step 4300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821173
step 4400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821556
step 4500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.821939
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822831
step 4700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823979
step 4800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.824107
step 4900, accuracy on validation batch: 0.875, accuracy on mal data: 0.824234
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824745
step 5100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824745
step 5200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825255
step 5300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825638
step 5400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.82602
step 5500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826275
step 5600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.827678
step 5700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828061
step 5800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828061
step 5900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.828571
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828571
step 6100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828571
step 6200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829464
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830102
step 6400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830229
step 6500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830229
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830229
step 6700, accuracy on validation batch: 0.960938, accuracy on mal data: 0.830612
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830612
step 6900, accuracy on validation batch: 0.875, accuracy on mal data: 0.830739
step 7000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83125
step 7100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831505
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831632
step 7300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.831632
step 7400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831632
step 7500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.83176
step 7600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832015
step 7700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832015
step 7800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832398
step 7900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832908
test set: accuracy on test set: 0.911
Done training net
0.911400026083
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.109375, accuracy on mal data: 0.098852
step 100, accuracy on validation batch: 0.328125, accuracy on mal data: 0.154974
step 200, accuracy on validation batch: 0.507812, accuracy on mal data: 0.240306
step 300, accuracy on validation batch: 0.65625, accuracy on mal data: 0.329337
step 400, accuracy on validation batch: 0.65625, accuracy on mal data: 0.422959
step 500, accuracy on validation batch: 0.734375, accuracy on mal data: 0.494005
step 600, accuracy on validation batch: 0.75, accuracy on mal data: 0.54949
step 700, accuracy on validation batch: 0.789062, accuracy on mal data: 0.58648
step 800, accuracy on validation batch: 0.78125, accuracy on mal data: 0.61824
step 900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.642347
step 1000, accuracy on validation batch: 0.875, accuracy on mal data: 0.656505
step 1100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.674745
step 1200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.689413
step 1300, accuracy on validation batch: 0.804688, accuracy on mal data: 0.707398
step 1400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.722066
step 1500, accuracy on validation batch: 0.8125, accuracy on mal data: 0.732653
step 1600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.742219
step 1700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.748597
step 1800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.756887
step 1900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.763265
step 2000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.770791
step 2100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.775893
step 2200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.780484
step 2300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.783163
step 2400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.788648
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.790561
step 2600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.794005
step 2700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.798342
step 2800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.802041
step 2900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.804081
step 3000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.807525
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.80778
step 3200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.809566
step 3300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.811097
step 3400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.813138
step 3500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.814668
step 3600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816199
step 3700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.816964
step 3800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.818495
step 3900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.819387
step 4000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.820025
step 4100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820918
step 4200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821301
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821939
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822321
step 4500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.823342
step 4600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823342
step 4700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823979
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824234
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825127
step 5000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82551
step 5100, accuracy on validation batch: 0.953125, accuracy on mal data: 0.825382
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825637
step 5300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82602
step 5400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82602
step 5500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.82653
step 5600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826785
step 5700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827423
step 5800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.827678
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828061
step 6000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828444
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828444
step 6200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828571
step 6300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828826
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828954
step 6500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829081
step 6600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829081
step 6700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829464
step 6800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830612
step 6900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830612
step 7000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830867
step 7100, accuracy on validation batch: 0.953125, accuracy on mal data: 0.83125
step 7200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831505
step 7300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83176
step 7400, accuracy on validation batch: 0.953125, accuracy on mal data: 0.832015
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832015
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832653
step 7700, accuracy on validation batch: 0.875, accuracy on mal data: 0.832908
step 7800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.833035
step 7900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83278
test set: accuracy on test set: 0.910
Done training net
0.910100029111
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.03125, accuracy on mal data: 0.105612
step 100, accuracy on validation batch: 0.328125, accuracy on mal data: 0.164796
step 200, accuracy on validation batch: 0.570312, accuracy on mal data: 0.255485
step 300, accuracy on validation batch: 0.648438, accuracy on mal data: 0.353954
step 400, accuracy on validation batch: 0.78125, accuracy on mal data: 0.445536
step 500, accuracy on validation batch: 0.757812, accuracy on mal data: 0.514158
step 600, accuracy on validation batch: 0.757812, accuracy on mal data: 0.560969
step 700, accuracy on validation batch: 0.804688, accuracy on mal data: 0.594643
step 800, accuracy on validation batch: 0.789062, accuracy on mal data: 0.624107
step 900, accuracy on validation batch: 0.875, accuracy on mal data: 0.644515
step 1000, accuracy on validation batch: 0.804688, accuracy on mal data: 0.662117
step 1100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.677168
step 1200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.693622
step 1300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.707398
step 1400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.71977
step 1500, accuracy on validation batch: 0.875, accuracy on mal data: 0.731632
step 1600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.742729
step 1700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.75051
step 1800, accuracy on validation batch: 0.875, accuracy on mal data: 0.757653
step 1900, accuracy on validation batch: 0.820312, accuracy on mal data: 0.764796
step 2000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.76977
step 2100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.774234
step 2200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.782398
step 2300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.786862
step 2400, accuracy on validation batch: 0.875, accuracy on mal data: 0.791581
step 2500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.796173
step 2600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.798852
step 2700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.800255
step 2800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.802678
step 2900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.804719
step 3000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.80574
step 3100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.80778
step 3200, accuracy on validation batch: 0.875, accuracy on mal data: 0.809311
step 3300, accuracy on validation batch: 0.875, accuracy on mal data: 0.810714
step 3400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.811862
step 3500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.813265
step 3600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.814796
step 3700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.815433
step 3800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.815816
step 3900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.816836
step 4000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.818367
step 4100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.81926
step 4200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.819387
step 4300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.819643
step 4400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.821301
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822449
step 4600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.822704
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823086
step 4800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823469
step 4900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824745
step 5000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825382
step 5100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825637
step 5200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.826275
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826403
step 5400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826658
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827168
step 5600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.827168
step 5700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827806
step 5800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828444
step 5900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.828826
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828954
step 6100, accuracy on validation batch: 0.875, accuracy on mal data: 0.828954
step 6200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829081
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829336
step 6400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829719
step 6500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829974
step 6600, accuracy on validation batch: 0.875, accuracy on mal data: 0.830229
step 6700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830229
step 6800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830612
step 6900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831122
step 7000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831122
step 7100, accuracy on validation batch: 0.875, accuracy on mal data: 0.831377
step 7200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831505
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831632
step 7400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83176
step 7500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.83176
step 7600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.83176
step 7700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.83176
step 7800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83227
step 7900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832398
test set: accuracy on test set: 0.912
Done training net
0.911700022817
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0933673
step 100, accuracy on validation batch: 0.296875, accuracy on mal data: 0.144898
step 200, accuracy on validation batch: 0.554688, accuracy on mal data: 0.234694
step 300, accuracy on validation batch: 0.671875, accuracy on mal data: 0.336735
step 400, accuracy on validation batch: 0.75, accuracy on mal data: 0.424872
step 500, accuracy on validation batch: 0.765625, accuracy on mal data: 0.494388
step 600, accuracy on validation batch: 0.78125, accuracy on mal data: 0.544643
step 700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.584694
step 800, accuracy on validation batch: 0.78125, accuracy on mal data: 0.614286
step 900, accuracy on validation batch: 0.875, accuracy on mal data: 0.637755
step 1000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.656632
step 1100, accuracy on validation batch: 0.820312, accuracy on mal data: 0.671684
step 1200, accuracy on validation batch: 0.8125, accuracy on mal data: 0.689286
step 1300, accuracy on validation batch: 0.8125, accuracy on mal data: 0.702041
step 1400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.713903
step 1500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.727423
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.741071
step 1700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.75051
step 1800, accuracy on validation batch: 0.804688, accuracy on mal data: 0.755995
step 1900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.76403
step 2000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.770791
step 2100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.776148
step 2200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.781122
step 2300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.785714
step 2400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.789158
step 2500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.791964
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.795791
step 2700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.799107
step 2800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.801913
step 2900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.803954
step 3000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.80574
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.807015
step 3200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.808418
step 3300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.810204
step 3400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.811734
step 3500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.81301
step 3600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.814413
step 3700, accuracy on validation batch: 0.945312, accuracy on mal data: 0.815944
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816964
step 3900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.81824
step 4000, accuracy on validation batch: 0.804688, accuracy on mal data: 0.819005
step 4100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.819898
step 4200, accuracy on validation batch: 0.875, accuracy on mal data: 0.820408
step 4300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.821046
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821938
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822704
step 4600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822959
step 4700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823086
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823597
step 4900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.823852
step 5000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823852
step 5100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.823979
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824489
step 5300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824489
step 5400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.825255
step 5500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825765
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82602
step 5700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826658
step 5800, accuracy on validation batch: 0.960938, accuracy on mal data: 0.826658
step 5900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827168
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827678
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828188
step 6200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828189
step 6300, accuracy on validation batch: 0.875, accuracy on mal data: 0.828571
step 6400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828699
step 6500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829336
step 6600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829847
step 6700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830229
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830229
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830357
step 7000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830357
step 7100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830739
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83125
step 7300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831377
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831632
step 7500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831632
step 7600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831887
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832143
step 7800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832653
step 7900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832653
test set: accuracy on test set: 0.910
Done training net
0.9103000319
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 16, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0993622
step 100, accuracy on validation batch: 0.203125, accuracy on mal data: 0.174235
step 200, accuracy on validation batch: 0.367188, accuracy on mal data: 0.260587
step 300, accuracy on validation batch: 0.632812, accuracy on mal data: 0.348852
step 400, accuracy on validation batch: 0.679688, accuracy on mal data: 0.428189
step 500, accuracy on validation batch: 0.757812, accuracy on mal data: 0.496173
step 600, accuracy on validation batch: 0.773438, accuracy on mal data: 0.554082
step 700, accuracy on validation batch: 0.773438, accuracy on mal data: 0.593367
step 800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.623724
step 900, accuracy on validation batch: 0.78125, accuracy on mal data: 0.648087
step 1000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.67028
step 1100, accuracy on validation batch: 0.804688, accuracy on mal data: 0.685969
step 1200, accuracy on validation batch: 0.804688, accuracy on mal data: 0.699234
step 1300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.710076
step 1400, accuracy on validation batch: 0.8125, accuracy on mal data: 0.724617
step 1500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.732653
step 1600, accuracy on validation batch: 0.828125, accuracy on mal data: 0.74375
step 1700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.750127
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.759056
step 1900, accuracy on validation batch: 0.875, accuracy on mal data: 0.764286
step 2000, accuracy on validation batch: 0.875, accuracy on mal data: 0.770535
step 2100, accuracy on validation batch: 0.789062, accuracy on mal data: 0.779847
step 2200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.783673
step 2300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.788265
step 2400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.791581
step 2500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.793877
step 2600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.796301
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.799234
step 2800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.801658
step 2900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.804209
step 3000, accuracy on validation batch: 0.945312, accuracy on mal data: 0.807653
step 3100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.809183
step 3200, accuracy on validation batch: 0.875, accuracy on mal data: 0.811479
step 3300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.812755
step 3400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.814541
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.815306
step 3600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.816581
step 3700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.817474
step 3800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.819005
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.81977
step 4000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.82028
step 4100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82079
step 4200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.822321
step 4300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823086
step 4400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823341
step 4500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.823342
step 4600, accuracy on validation batch: 0.875, accuracy on mal data: 0.823597
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823979
step 4800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824362
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825255
step 5000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82551
step 5100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.82551
step 5200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.825893
step 5300, accuracy on validation batch: 0.875, accuracy on mal data: 0.82653
step 5400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826403
step 5500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.826403
step 5600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.826913
step 5700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.826913
step 5800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827041
step 5900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827168
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827806
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828061
step 6200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828316
step 6300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828444
step 6400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828444
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829209
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829464
step 6700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829464
step 6800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830484
step 6900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830612
step 7000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830612
step 7100, accuracy on validation batch: 0.875, accuracy on mal data: 0.830867
step 7200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831122
step 7300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83125
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831505
step 7500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.832525
step 7600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.832653
step 7700, accuracy on validation batch: 0.945312, accuracy on mal data: 0.832653
step 7800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83278
step 7900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.83278
test set: accuracy on test set: 0.910
Done training net
0.910200021267
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 512, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 512, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.09375, accuracy on mal data: 0.114158
step 100, accuracy on validation batch: 0.34375, accuracy on mal data: 0.189541
step 200, accuracy on validation batch: 0.632812, accuracy on mal data: 0.289158
step 300, accuracy on validation batch: 0.632812, accuracy on mal data: 0.385459
step 400, accuracy on validation batch: 0.734375, accuracy on mal data: 0.467092
step 500, accuracy on validation batch: 0.742188, accuracy on mal data: 0.523342
step 600, accuracy on validation batch: 0.8125, accuracy on mal data: 0.575893
step 700, accuracy on validation batch: 0.789062, accuracy on mal data: 0.604592
step 800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.633928
step 900, accuracy on validation batch: 0.820312, accuracy on mal data: 0.657525
step 1000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.675638
step 1100, accuracy on validation batch: 0.820312, accuracy on mal data: 0.688393
step 1200, accuracy on validation batch: 0.773438, accuracy on mal data: 0.699872
step 1300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.710459
step 1400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.719898
step 1500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.731122
step 1600, accuracy on validation batch: 0.875, accuracy on mal data: 0.741199
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.750382
step 1800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.75676
step 1900, accuracy on validation batch: 0.875, accuracy on mal data: 0.762372
step 2000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.76824
step 2100, accuracy on validation batch: 0.875, accuracy on mal data: 0.773214
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.77653
step 2300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.780612
step 2400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.785459
step 2500, accuracy on validation batch: 0.828125, accuracy on mal data: 0.78903
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.791326
step 2700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.794005
step 2800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.796173
step 2900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.798342
step 3000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.80102
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.802678
step 3200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.804337
step 3300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.807653
step 3400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.808035
step 3500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.809821
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.810714
step 3700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.812755
step 3800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.81352
step 3900, accuracy on validation batch: 0.875, accuracy on mal data: 0.814413
step 4000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.816071
step 4100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.816836
step 4200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817729
step 4300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.818112
step 4400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.819387
step 4500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.819643
step 4600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820153
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821173
step 4800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822066
step 4900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.823087
step 5000, accuracy on validation batch: 0.875, accuracy on mal data: 0.824107
step 5100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823979
step 5200, accuracy on validation batch: 0.875, accuracy on mal data: 0.823979
step 5300, accuracy on validation batch: 0.875, accuracy on mal data: 0.825127
step 5400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826148
step 5500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826275
step 5600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826148
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827041
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827296
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827423
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827806
step 6100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828189
step 6200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828061
step 6300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828699
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828954
step 6500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829464
step 6600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830102
step 6700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830357
step 6800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.830484
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830484
step 7000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.830612
step 7100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830995
step 7200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830995
step 7300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83125
step 7400, accuracy on validation batch: 0.953125, accuracy on mal data: 0.83125
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83125
step 7600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83125
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831377
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831377
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83176
test set: accuracy on test set: 0.911
Done training net
0.910700027347
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.140625, accuracy on mal data: 0.115179
step 100, accuracy on validation batch: 0.460938, accuracy on mal data: 0.172832
step 200, accuracy on validation batch: 0.46875, accuracy on mal data: 0.258291
step 300, accuracy on validation batch: 0.648438, accuracy on mal data: 0.356122
step 400, accuracy on validation batch: 0.773438, accuracy on mal data: 0.449107
step 500, accuracy on validation batch: 0.75, accuracy on mal data: 0.521429
step 600, accuracy on validation batch: 0.765625, accuracy on mal data: 0.574872
step 700, accuracy on validation batch: 0.765625, accuracy on mal data: 0.608163
step 800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.635332
step 900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.657398
step 1000, accuracy on validation batch: 0.804688, accuracy on mal data: 0.672959
step 1100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.690816
step 1200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.704464
step 1300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.716964
step 1400, accuracy on validation batch: 0.875, accuracy on mal data: 0.725255
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.733801
step 1600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.744898
step 1700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.754081
step 1800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.760587
step 1900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.76352
step 2000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.768877
step 2100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.772831
step 2200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.779719
step 2300, accuracy on validation batch: 0.875, accuracy on mal data: 0.784056
step 2400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.7875
step 2500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.790561
step 2600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.794005
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.798342
step 2800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.801403
step 2900, accuracy on validation batch: 0.960938, accuracy on mal data: 0.804081
step 3000, accuracy on validation batch: 0.8125, accuracy on mal data: 0.804592
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.806122
step 3200, accuracy on validation batch: 0.8125, accuracy on mal data: 0.80829
step 3300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.810459
step 3400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.811479
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.812627
step 3600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.814158
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816326
step 3800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.817984
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.818495
step 4000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.818877
step 4100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.819387
step 4200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.820025
step 4300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.820791
step 4400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821301
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821939
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822576
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822831
step 4800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822831
step 4900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823214
step 5000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824107
step 5100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.825127
step 5200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.82602
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82602
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82602
step 5500, accuracy on validation batch: 0.875, accuracy on mal data: 0.82653
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826658
step 5700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826785
step 5800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.826913
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827933
step 6000, accuracy on validation batch: 0.953125, accuracy on mal data: 0.828444
step 6100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.829081
step 6200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829081
step 6300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829336
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829336
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829592
step 6600, accuracy on validation batch: 0.953125, accuracy on mal data: 0.829719
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829592
step 6800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830229
step 6900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830229
step 7000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830612
step 7100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830612
step 7200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.830612
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830867
step 7400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831377
step 7500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83176
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831887
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83227
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832908
step 7900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832908
test set: accuracy on test set: 0.910
Done training net
0.910300021768
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.09375
step 100, accuracy on validation batch: 0.445312, accuracy on mal data: 0.164923
step 200, accuracy on validation batch: 0.523438, accuracy on mal data: 0.243495
step 300, accuracy on validation batch: 0.640625, accuracy on mal data: 0.342347
step 400, accuracy on validation batch: 0.765625, accuracy on mal data: 0.439668
step 500, accuracy on validation batch: 0.78125, accuracy on mal data: 0.50523
step 600, accuracy on validation batch: 0.8125, accuracy on mal data: 0.566199
step 700, accuracy on validation batch: 0.78125, accuracy on mal data: 0.601531
step 800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.63699
step 900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.663648
step 1000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.686735
step 1100, accuracy on validation batch: 0.78125, accuracy on mal data: 0.703316
step 1200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.72028
step 1300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.73278
step 1400, accuracy on validation batch: 0.8125, accuracy on mal data: 0.740306
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.746301
step 1600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.755229
step 1700, accuracy on validation batch: 0.8125, accuracy on mal data: 0.762245
step 1800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.769643
step 1900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.777168
step 2000, accuracy on validation batch: 0.8125, accuracy on mal data: 0.780484
step 2100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.784183
step 2200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.78903
step 2300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.792474
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.794643
step 2500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.797576
step 2600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.799872
step 2700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.802041
step 2800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.803699
step 2900, accuracy on validation batch: 0.875, accuracy on mal data: 0.805867
step 3000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.807398
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.808801
step 3200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.809949
step 3300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.811224
step 3400, accuracy on validation batch: 0.875, accuracy on mal data: 0.813393
step 3500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.813903
step 3600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.815178
step 3700, accuracy on validation batch: 0.789062, accuracy on mal data: 0.815944
step 3800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816454
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.818367
step 4000, accuracy on validation batch: 0.875, accuracy on mal data: 0.81875
step 4100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.81926
step 4200, accuracy on validation batch: 0.875, accuracy on mal data: 0.82028
step 4300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820918
step 4400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821683
step 4500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822704
step 4600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822831
step 4700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823341
step 4800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823852
step 4900, accuracy on validation batch: 0.875, accuracy on mal data: 0.824362
step 5000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.824362
step 5100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824745
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825
step 5300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.825765
step 5400, accuracy on validation batch: 0.960938, accuracy on mal data: 0.826148
step 5500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.826275
step 5600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826275
step 5700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826658
step 5800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827168
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828188
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828571
step 6100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828954
step 6200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.829081
step 6300, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829336
step 6400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829847
step 6500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829974
step 6600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830102
step 6700, accuracy on validation batch: 0.875, accuracy on mal data: 0.830612
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830739
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831377
step 7000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831377
step 7100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831377
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831505
step 7300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83176
step 7400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832143
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832525
step 7600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832525
step 7700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.832525
step 7800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832908
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83329
test set: accuracy on test set: 0.910
Done training net
0.910000027418
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 512, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 512, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.132812, accuracy on mal data: 0.108291
step 100, accuracy on validation batch: 0.34375, accuracy on mal data: 0.189158
step 200, accuracy on validation batch: 0.578125, accuracy on mal data: 0.273469
step 300, accuracy on validation batch: 0.632812, accuracy on mal data: 0.368367
step 400, accuracy on validation batch: 0.703125, accuracy on mal data: 0.460459
step 500, accuracy on validation batch: 0.734375, accuracy on mal data: 0.532653
step 600, accuracy on validation batch: 0.710938, accuracy on mal data: 0.569643
step 700, accuracy on validation batch: 0.757812, accuracy on mal data: 0.604592
step 800, accuracy on validation batch: 0.765625, accuracy on mal data: 0.629592
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.645153
step 1000, accuracy on validation batch: 0.804688, accuracy on mal data: 0.66403
step 1100, accuracy on validation batch: 0.875, accuracy on mal data: 0.677423
step 1200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.690434
step 1300, accuracy on validation batch: 0.804688, accuracy on mal data: 0.701148
step 1400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.71301
step 1500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.722831
step 1600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.73227
step 1700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.739541
step 1800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.747831
step 1900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.754209
step 2000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.759566
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.765306
step 2200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.771811
step 2300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.776913
step 2400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.781122
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.783418
step 2600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.7875
step 2700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.791199
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.794388
step 2900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.798724
step 3000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.803189
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.80778
step 3200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.810076
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.810459
step 3400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.8125
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.814285
step 3600, accuracy on validation batch: 0.875, accuracy on mal data: 0.815816
step 3700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817219
step 3800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817857
step 3900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.818495
step 4000, accuracy on validation batch: 0.953125, accuracy on mal data: 0.819643
step 4100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.820535
step 4200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821683
step 4300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.822194
step 4400, accuracy on validation batch: 0.953125, accuracy on mal data: 0.822959
step 4500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823597
step 4600, accuracy on validation batch: 0.875, accuracy on mal data: 0.823724
step 4700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.824107
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824362
step 4900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824745
step 5000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825
step 5100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825638
step 5200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.825765
step 5300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.826658
step 5400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826785
step 5500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.827041
step 5600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.827551
step 5700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827423
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827678
step 5900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.827933
step 6000, accuracy on validation batch: 0.875, accuracy on mal data: 0.828444
step 6100, accuracy on validation batch: 0.875, accuracy on mal data: 0.828826
step 6200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829592
step 6300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830229
step 6400, accuracy on validation batch: 0.875, accuracy on mal data: 0.830229
step 6500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830739
step 6600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.83125
step 6700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83125
step 6800, accuracy on validation batch: 0.875, accuracy on mal data: 0.83125
step 6900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.831377
step 7000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83125
step 7100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831377
step 7200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.831505
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832015
step 7400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.832143
step 7500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832398
step 7600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832908
step 7700, accuracy on validation batch: 0.875, accuracy on mal data: 0.832908
step 7800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.833163
step 7900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.833418
test set: accuracy on test set: 0.911
Done training net
0.910700025558
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 64}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 64}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0892857
step 100, accuracy on validation batch: 0.367188, accuracy on mal data: 0.162628
step 200, accuracy on validation batch: 0.609375, accuracy on mal data: 0.247577
step 300, accuracy on validation batch: 0.617188, accuracy on mal data: 0.343367
step 400, accuracy on validation batch: 0.671875, accuracy on mal data: 0.439158
step 500, accuracy on validation batch: 0.734375, accuracy on mal data: 0.510204
step 600, accuracy on validation batch: 0.804688, accuracy on mal data: 0.562883
step 700, accuracy on validation batch: 0.742188, accuracy on mal data: 0.597194
step 800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.624872
step 900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.649235
step 1000, accuracy on validation batch: 0.796875, accuracy on mal data: 0.672449
step 1100, accuracy on validation batch: 0.875, accuracy on mal data: 0.685587
step 1200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.700382
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.715561
step 1400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.72449
step 1500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.735331
step 1600, accuracy on validation batch: 0.789062, accuracy on mal data: 0.744643
step 1700, accuracy on validation batch: 0.875, accuracy on mal data: 0.752933
step 1800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.760969
step 1900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.766709
step 2000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.772704
step 2100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.777933
step 2200, accuracy on validation batch: 0.875, accuracy on mal data: 0.784694
step 2300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.788138
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.791837
step 2500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.795918
step 2600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.798597
step 2700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.80153
step 2800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.805102
step 2900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.807525
step 3000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.809056
step 3100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.811352
step 3200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.812627
step 3300, accuracy on validation batch: 0.875, accuracy on mal data: 0.815178
step 3400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815433
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816071
step 3600, accuracy on validation batch: 0.875, accuracy on mal data: 0.81824
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.819898
step 3800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.819643
step 3900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.820153
step 4000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820791
step 4100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.821173
step 4200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.822194
step 4300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822831
step 4400, accuracy on validation batch: 0.875, accuracy on mal data: 0.823086
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823342
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823852
step 4700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.824107
step 4800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825255
step 5000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825637
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825893
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826148
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826275
step 5400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.826658
step 5500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827041
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828188
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828826
step 5800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828826
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828699
step 6000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829464
step 6100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829847
step 6200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829974
step 6300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829974
step 6400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830102
step 6500, accuracy on validation batch: 0.875, accuracy on mal data: 0.83074
step 6600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83074
step 6700, accuracy on validation batch: 0.953125, accuracy on mal data: 0.831122
step 6800, accuracy on validation batch: 0.875, accuracy on mal data: 0.831377
step 6900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831505
step 7000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.831377
step 7100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831632
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831887
step 7300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832015
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83278
step 7500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832398
step 7600, accuracy on validation batch: 0.875, accuracy on mal data: 0.832653
step 7700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83278
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83278
step 7900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832908
test set: accuracy on test set: 0.912
Done training net
0.912000027299
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0625, accuracy on mal data: 0.113776
step 100, accuracy on validation batch: 0.25, accuracy on mal data: 0.173469
step 200, accuracy on validation batch: 0.460938, accuracy on mal data: 0.256505
step 300, accuracy on validation batch: 0.648438, accuracy on mal data: 0.346046
step 400, accuracy on validation batch: 0.734375, accuracy on mal data: 0.434311
step 500, accuracy on validation batch: 0.703125, accuracy on mal data: 0.50574
step 600, accuracy on validation batch: 0.789062, accuracy on mal data: 0.562245
step 700, accuracy on validation batch: 0.8125, accuracy on mal data: 0.598087
step 800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.629719
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.653954
step 1000, accuracy on validation batch: 0.757812, accuracy on mal data: 0.673469
step 1100, accuracy on validation batch: 0.765625, accuracy on mal data: 0.687627
step 1200, accuracy on validation batch: 0.765625, accuracy on mal data: 0.70051
step 1300, accuracy on validation batch: 0.804688, accuracy on mal data: 0.71403
step 1400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.726275
step 1500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.736224
step 1600, accuracy on validation batch: 0.875, accuracy on mal data: 0.743622
step 1700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.751275
step 1800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.760204
step 1900, accuracy on validation batch: 0.875, accuracy on mal data: 0.770663
step 2000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.776148
step 2100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.782398
step 2200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.784949
step 2300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.788138
step 2400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.792474
step 2500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.795408
step 2600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.797194
step 2700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.800127
step 2800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.802423
step 2900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.803699
step 3000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.805229
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.80574
step 3200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.807398
step 3300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.808546
step 3400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.810586
step 3500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.811097
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.811352
step 3700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.812245
step 3800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.812755
step 3900, accuracy on validation batch: 0.953125, accuracy on mal data: 0.815051
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817092
step 4100, accuracy on validation batch: 0.953125, accuracy on mal data: 0.817347
step 4200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817857
step 4300, accuracy on validation batch: 0.820312, accuracy on mal data: 0.818877
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820153
step 4500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.821301
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821556
step 4700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822449
step 4800, accuracy on validation batch: 0.875, accuracy on mal data: 0.822704
step 4900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.822831
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822959
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823086
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823724
step 5300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823852
step 5400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.824107
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824362
step 5600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824872
step 5700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825382
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826275
step 5900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.82653
step 6000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82653
step 6100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.827296
step 6200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827296
step 6300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828316
step 6400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828826
step 6500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828826
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828954
step 6700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829336
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829464
step 6900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829719
step 7000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829719
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829719
step 7200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830102
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830357
step 7400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830612
step 7500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831377
step 7600, accuracy on validation batch: 0.875, accuracy on mal data: 0.831377
step 7700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831632
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831632
step 7900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83176
test set: accuracy on test set: 0.910
Done training net
0.90980002284
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0625, accuracy on mal data: 0.11148
step 100, accuracy on validation batch: 0.351562, accuracy on mal data: 0.195918
step 200, accuracy on validation batch: 0.492188, accuracy on mal data: 0.289031
step 300, accuracy on validation batch: 0.679688, accuracy on mal data: 0.361352
step 400, accuracy on validation batch: 0.695312, accuracy on mal data: 0.443112
step 500, accuracy on validation batch: 0.734375, accuracy on mal data: 0.504847
step 600, accuracy on validation batch: 0.796875, accuracy on mal data: 0.556505
step 700, accuracy on validation batch: 0.804688, accuracy on mal data: 0.595791
step 800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.628189
step 900, accuracy on validation batch: 0.78125, accuracy on mal data: 0.650765
step 1000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.664923
step 1100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.682398
step 1200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.698087
step 1300, accuracy on validation batch: 0.789062, accuracy on mal data: 0.711479
step 1400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.720918
step 1500, accuracy on validation batch: 0.796875, accuracy on mal data: 0.730612
step 1600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.73852
step 1700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.747066
step 1800, accuracy on validation batch: 0.820312, accuracy on mal data: 0.755357
step 1900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.761224
step 2000, accuracy on validation batch: 0.8125, accuracy on mal data: 0.770408
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.776913
step 2200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.780995
step 2300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.785714
step 2400, accuracy on validation batch: 0.875, accuracy on mal data: 0.790689
step 2500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.793622
step 2600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.798214
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.800255
step 2800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.803061
step 2900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.805357
step 3000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.806377
step 3100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.807908
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.808418
step 3300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.809694
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.812882
step 3500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.813903
step 3600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.814285
step 3700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.815433
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816326
step 3900, accuracy on validation batch: 0.875, accuracy on mal data: 0.817857
step 4000, accuracy on validation batch: 0.875, accuracy on mal data: 0.819005
step 4100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.819898
step 4200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.820535
step 4300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.821683
step 4400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822194
step 4500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.822194
step 4600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822831
step 4700, accuracy on validation batch: 0.953125, accuracy on mal data: 0.823087
step 4800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.823087
step 4900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.823852
step 5000, accuracy on validation batch: 0.875, accuracy on mal data: 0.82449
step 5100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824745
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825637
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825637
step 5400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.82602
step 5500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82653
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826913
step 5700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827168
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827423
step 5900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.827423
step 6000, accuracy on validation batch: 0.953125, accuracy on mal data: 0.827678
step 6100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827933
step 6200, accuracy on validation batch: 0.875, accuracy on mal data: 0.828188
step 6300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828189
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828826
step 6500, accuracy on validation batch: 0.953125, accuracy on mal data: 0.828954
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829592
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830102
step 6800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830102
step 6900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830484
step 7000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.830867
step 7100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830867
step 7200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830867
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831377
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83176
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832015
step 7600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832653
step 7700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83278
step 7800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.833035
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.833163
test set: accuracy on test set: 0.910
Done training net
0.910000025034
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0869898
step 100, accuracy on validation batch: 0.414062, accuracy on mal data: 0.149872
step 200, accuracy on validation batch: 0.632812, accuracy on mal data: 0.246301
step 300, accuracy on validation batch: 0.71875, accuracy on mal data: 0.347321
step 400, accuracy on validation batch: 0.648438, accuracy on mal data: 0.436862
step 500, accuracy on validation batch: 0.75, accuracy on mal data: 0.510969
step 600, accuracy on validation batch: 0.734375, accuracy on mal data: 0.562245
step 700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.599617
step 800, accuracy on validation batch: 0.820312, accuracy on mal data: 0.625638
step 900, accuracy on validation batch: 0.75, accuracy on mal data: 0.65051
step 1000, accuracy on validation batch: 0.804688, accuracy on mal data: 0.671046
step 1100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.687117
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.703061
step 1300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.716326
step 1400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.724745
step 1500, accuracy on validation batch: 0.828125, accuracy on mal data: 0.736862
step 1600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.744643
step 1700, accuracy on validation batch: 0.875, accuracy on mal data: 0.752551
step 1800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.759056
step 1900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.767092
step 2000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.771046
step 2100, accuracy on validation batch: 0.875, accuracy on mal data: 0.777041
step 2200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.779592
step 2300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.781505
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.785459
step 2500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.790051
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.791581
step 2700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.794515
step 2800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.796556
step 2900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.798469
step 3000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.800255
step 3100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.803571
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.804464
step 3300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.806377
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.808928
step 3500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.809821
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.810459
step 3700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.812627
step 3800, accuracy on validation batch: 0.953125, accuracy on mal data: 0.813775
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.814413
step 4000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815816
step 4100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816326
step 4200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.817474
step 4300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.818877
step 4400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.819898
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821939
step 4600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822194
step 4700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822576
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823087
step 4900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823342
step 5000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.823979
step 5100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824234
step 5200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.824617
step 5300, accuracy on validation batch: 0.945312, accuracy on mal data: 0.825638
step 5400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826148
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826148
step 5600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826275
step 5700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827168
step 5800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.827678
step 5900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.828189
step 6000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828571
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828699
step 6200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828826
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829336
step 6400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829336
step 6500, accuracy on validation batch: 0.875, accuracy on mal data: 0.829592
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829592
step 6700, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829719
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829719
step 6900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.829719
step 7000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829719
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829974
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829974
step 7300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830484
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83074
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831505
step 7600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832398
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832525
step 7800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83278
step 7900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.833035
test set: accuracy on test set: 0.910
Done training net
0.910400019288
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.109375, accuracy on mal data: 0.105102
step 100, accuracy on validation batch: 0.335938, accuracy on mal data: 0.18648
step 200, accuracy on validation batch: 0.523438, accuracy on mal data: 0.26773
step 300, accuracy on validation batch: 0.648438, accuracy on mal data: 0.364158
step 400, accuracy on validation batch: 0.8125, accuracy on mal data: 0.452679
step 500, accuracy on validation batch: 0.757812, accuracy on mal data: 0.520025
step 600, accuracy on validation batch: 0.695312, accuracy on mal data: 0.573087
step 700, accuracy on validation batch: 0.742188, accuracy on mal data: 0.612245
step 800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.639158
step 900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.659694
step 1000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.677296
step 1100, accuracy on validation batch: 0.8125, accuracy on mal data: 0.692602
step 1200, accuracy on validation batch: 0.757812, accuracy on mal data: 0.704719
step 1300, accuracy on validation batch: 0.875, accuracy on mal data: 0.716454
step 1400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.726403
step 1500, accuracy on validation batch: 0.875, accuracy on mal data: 0.73801
step 1600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.744515
step 1700, accuracy on validation batch: 0.875, accuracy on mal data: 0.753699
step 1800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.76301
step 1900, accuracy on validation batch: 0.875, accuracy on mal data: 0.76977
step 2000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.775765
step 2100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.780995
step 2200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.785204
step 2300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.788393
step 2400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.792347
step 2500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.795408
step 2600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.799362
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.801913
step 2800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.804337
step 2900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.805357
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.806122
step 3100, accuracy on validation batch: 0.8125, accuracy on mal data: 0.807653
step 3200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.809821
step 3300, accuracy on validation batch: 0.945312, accuracy on mal data: 0.812245
step 3400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.813265
step 3500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.814541
step 3600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.815561
step 3700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.817602
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.81824
step 3900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.819387
step 4000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.81926
step 4100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.820025
step 4200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820791
step 4300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821556
step 4400, accuracy on validation batch: 0.875, accuracy on mal data: 0.822449
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823214
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823341
step 4700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.823852
step 4800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824872
step 4900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.825382
step 5000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826148
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826275
step 5200, accuracy on validation batch: 0.875, accuracy on mal data: 0.826913
step 5300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826913
step 5400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.827041
step 5500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827296
step 5600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827296
step 5700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827423
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827296
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827296
step 6000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.827551
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828061
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828826
step 6300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828826
step 6400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829081
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829209
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829209
step 6700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829336
step 6800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829592
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829592
step 7000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829592
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829974
step 7200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830357
step 7300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830357
step 7400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.830612
step 7500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831377
step 7600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831377
step 7700, accuracy on validation batch: 0.875, accuracy on mal data: 0.831377
step 7800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831377
step 7900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83176
test set: accuracy on test set: 0.910
Done training net
0.909900014997
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0982143
step 100, accuracy on validation batch: 0.21875, accuracy on mal data: 0.167985
step 200, accuracy on validation batch: 0.476562, accuracy on mal data: 0.251531
step 300, accuracy on validation batch: 0.5625, accuracy on mal data: 0.335587
step 400, accuracy on validation batch: 0.71875, accuracy on mal data: 0.426275
step 500, accuracy on validation batch: 0.695312, accuracy on mal data: 0.496684
step 600, accuracy on validation batch: 0.8125, accuracy on mal data: 0.553189
step 700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.591837
step 800, accuracy on validation batch: 0.820312, accuracy on mal data: 0.626531
step 900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.648469
step 1000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.665306
step 1100, accuracy on validation batch: 0.875, accuracy on mal data: 0.679081
step 1200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.698852
step 1300, accuracy on validation batch: 0.8125, accuracy on mal data: 0.710587
step 1400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.724235
step 1500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.736224
step 1600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.746939
step 1700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.752551
step 1800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.760587
step 1900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.766199
step 2000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.771046
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.775127
step 2200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.778444
step 2300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.783035
step 2400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.786224
step 2500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.790561
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.793495
step 2700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.796428
step 2800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.798086
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.800638
step 3000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.802806
step 3100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.805102
step 3200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.80727
step 3300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.809311
step 3400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.810331
step 3500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.811607
step 3600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.812755
step 3700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.814413
step 3800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816071
step 3900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.817092
step 4000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.817602
step 4100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.81926
step 4200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82028
step 4300, accuracy on validation batch: 0.875, accuracy on mal data: 0.821046
step 4400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.821811
step 4500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.822704
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823342
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824107
step 4800, accuracy on validation batch: 0.953125, accuracy on mal data: 0.824617
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825
step 5000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825
step 5100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.825255
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82653
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826785
step 5400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.826785
step 5500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.826785
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827168
step 5700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827551
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827551
step 5900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.827806
step 6000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828444
step 6100, accuracy on validation batch: 0.875, accuracy on mal data: 0.828699
step 6200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829081
step 6300, accuracy on validation batch: 0.875, accuracy on mal data: 0.829209
step 6400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829209
step 6500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829847
step 6600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829847
step 6700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830229
step 6800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830612
step 6900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830995
step 7000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831122
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831887
step 7200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831887
step 7300, accuracy on validation batch: 0.875, accuracy on mal data: 0.83176
step 7400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.831887
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831887
step 7600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832525
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832525
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832525
step 7900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832653
test set: accuracy on test set: 0.909
Done training net
0.909100016952
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 512, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 512, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0868622
step 100, accuracy on validation batch: 0.203125, accuracy on mal data: 0.147577
step 200, accuracy on validation batch: 0.484375, accuracy on mal data: 0.232398
step 300, accuracy on validation batch: 0.617188, accuracy on mal data: 0.317857
step 400, accuracy on validation batch: 0.703125, accuracy on mal data: 0.414158
step 500, accuracy on validation batch: 0.78125, accuracy on mal data: 0.485587
step 600, accuracy on validation batch: 0.789062, accuracy on mal data: 0.541709
step 700, accuracy on validation batch: 0.804688, accuracy on mal data: 0.58023
step 800, accuracy on validation batch: 0.78125, accuracy on mal data: 0.60574
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.628699
step 1000, accuracy on validation batch: 0.765625, accuracy on mal data: 0.652551
step 1100, accuracy on validation batch: 0.875, accuracy on mal data: 0.673852
step 1200, accuracy on validation batch: 0.875, accuracy on mal data: 0.692092
step 1300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.710842
step 1400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.723852
step 1500, accuracy on validation batch: 0.796875, accuracy on mal data: 0.733673
step 1600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.742474
step 1700, accuracy on validation batch: 0.789062, accuracy on mal data: 0.748979
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.758036
step 1900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.766709
step 2000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.771556
step 2100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.777933
step 2200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.783673
step 2300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.788903
step 2400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.792474
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.796173
step 2600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.798597
step 2700, accuracy on validation batch: 0.875, accuracy on mal data: 0.803061
step 2800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.804336
step 2900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.807015
step 3000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.809439
step 3100, accuracy on validation batch: 0.953125, accuracy on mal data: 0.811607
step 3200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.812755
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815433
step 3400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.816581
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817857
step 3600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.819132
step 3700, accuracy on validation batch: 0.875, accuracy on mal data: 0.819515
step 3800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.820408
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821683
step 4000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.821683
step 4100, accuracy on validation batch: 0.875, accuracy on mal data: 0.822831
step 4200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823214
step 4300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822959
step 4400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823087
step 4500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.823852
step 4600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.824107
step 4700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.825255
step 4800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.82551
step 4900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825637
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825765
step 5100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.825893
step 5200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826658
step 5300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827678
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827806
step 5500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828189
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828444
step 5700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828826
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828954
step 5900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829592
step 6000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829592
step 6100, accuracy on validation batch: 0.875, accuracy on mal data: 0.829592
step 6200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.829847
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829847
step 6400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830229
step 6500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830484
step 6600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830612
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830739
step 6800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.831122
step 6900, accuracy on validation batch: 0.953125, accuracy on mal data: 0.83125
step 7000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83125
step 7100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83125
step 7200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83125
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831377
step 7400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831505
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831505
step 7600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83176
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83227
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832525
step 7900, accuracy on validation batch: 0.875, accuracy on mal data: 0.832525
test set: accuracy on test set: 0.910
Done training net
0.910400019884
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.117188, accuracy on mal data: 0.10574
step 100, accuracy on validation batch: 0.335938, accuracy on mal data: 0.175765
step 200, accuracy on validation batch: 0.484375, accuracy on mal data: 0.264286
step 300, accuracy on validation batch: 0.65625, accuracy on mal data: 0.365051
step 400, accuracy on validation batch: 0.75, accuracy on mal data: 0.44477
step 500, accuracy on validation batch: 0.75, accuracy on mal data: 0.513393
step 600, accuracy on validation batch: 0.828125, accuracy on mal data: 0.562245
step 700, accuracy on validation batch: 0.875, accuracy on mal data: 0.598724
step 800, accuracy on validation batch: 0.796875, accuracy on mal data: 0.63125
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.655612
step 1000, accuracy on validation batch: 0.75, accuracy on mal data: 0.673724
step 1100, accuracy on validation batch: 0.820312, accuracy on mal data: 0.694515
step 1200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.708673
step 1300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.720408
step 1400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.730612
step 1500, accuracy on validation batch: 0.789062, accuracy on mal data: 0.739923
step 1600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.748214
step 1700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.754081
step 1800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.761224
step 1900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.767729
step 2000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.774234
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.780229
step 2200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.783546
step 2300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.78801
step 2400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.790689
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.79324
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.796301
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.797831
step 2800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.799234
step 2900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.800127
step 3000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.80153
step 3100, accuracy on validation batch: 0.796875, accuracy on mal data: 0.803954
step 3200, accuracy on validation batch: 0.875, accuracy on mal data: 0.805867
step 3300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.806632
step 3400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.808801
step 3500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.810459
step 3600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.811607
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.812755
step 3800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.814413
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815688
step 4000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.816071
step 4100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817092
step 4200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.81824
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.818877
step 4400, accuracy on validation batch: 0.875, accuracy on mal data: 0.81977
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820791
step 4600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821556
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821811
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822704
step 4900, accuracy on validation batch: 0.875, accuracy on mal data: 0.822831
step 5000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822831
step 5100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823597
step 5200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824107
step 5300, accuracy on validation batch: 0.953125, accuracy on mal data: 0.825255
step 5400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.82551
step 5500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825893
step 5600, accuracy on validation batch: 0.953125, accuracy on mal data: 0.826148
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82653
step 5800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827168
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827551
step 6000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828316
step 6100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828699
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829209
step 6300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829719
step 6400, accuracy on validation batch: 0.875, accuracy on mal data: 0.829719
step 6500, accuracy on validation batch: 0.875, accuracy on mal data: 0.829974
step 6600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830102
step 6700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.830102
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830229
step 6900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830612
step 7000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830612
step 7100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830739
step 7200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830739
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83125
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831887
step 7500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83176
step 7600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831887
step 7700, accuracy on validation batch: 0.875, accuracy on mal data: 0.83227
step 7800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832398
step 7900, accuracy on validation batch: 0.875, accuracy on mal data: 0.832398
test set: accuracy on test set: 0.911
Done training net
0.911200023293
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0883928
step 100, accuracy on validation batch: 0.296875, accuracy on mal data: 0.155102
step 200, accuracy on validation batch: 0.53125, accuracy on mal data: 0.255485
step 300, accuracy on validation batch: 0.632812, accuracy on mal data: 0.353954
step 400, accuracy on validation batch: 0.726562, accuracy on mal data: 0.447576
step 500, accuracy on validation batch: 0.726562, accuracy on mal data: 0.524235
step 600, accuracy on validation batch: 0.773438, accuracy on mal data: 0.575765
step 700, accuracy on validation batch: 0.78125, accuracy on mal data: 0.614031
step 800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.6375
step 900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.660459
step 1000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.680102
step 1100, accuracy on validation batch: 0.875, accuracy on mal data: 0.698087
step 1200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.708163
step 1300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.72028
step 1400, accuracy on validation batch: 0.875, accuracy on mal data: 0.737117
step 1500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.744515
step 1600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.753444
step 1700, accuracy on validation batch: 0.796875, accuracy on mal data: 0.760076
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.766454
step 1900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.771428
step 2000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.777678
step 2100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.78125
step 2200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.784566
step 2300, accuracy on validation batch: 0.8125, accuracy on mal data: 0.7875
step 2400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.790944
step 2500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.794643
step 2600, accuracy on validation batch: 0.875, accuracy on mal data: 0.797449
step 2700, accuracy on validation batch: 0.875, accuracy on mal data: 0.800637
step 2800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.802423
step 2900, accuracy on validation batch: 0.875, accuracy on mal data: 0.804336
step 3000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.806122
step 3100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.80778
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.809821
step 3300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.810331
step 3400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.811352
step 3500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.812755
step 3600, accuracy on validation batch: 0.804688, accuracy on mal data: 0.814541
step 3700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.815816
step 3800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.816581
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.817602
step 4000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.81824
step 4100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.819388
step 4200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.820535
step 4300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.821301
step 4400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821683
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822321
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823214
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823597
step 4800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824107
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824107
step 5000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823979
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824745
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825127
step 5300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.825637
step 5400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.82602
step 5500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826275
step 5600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826403
step 5700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826658
step 5800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826785
step 5900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826913
step 6000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827423
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827551
step 6200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.827551
step 6300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827551
step 6400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827933
step 6500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828316
step 6600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829209
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829336
step 6800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829592
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829592
step 7000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829592
step 7100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829719
step 7200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830357
step 7300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830739
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83125
step 7500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83125
step 7600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831377
step 7700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831632
step 7800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832015
step 7900, accuracy on validation batch: 0.960938, accuracy on mal data: 0.831887
test set: accuracy on test set: 0.909
Done training net
0.909100027084
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0993622
step 100, accuracy on validation batch: 0.382812, accuracy on mal data: 0.159566
step 200, accuracy on validation batch: 0.539062, accuracy on mal data: 0.232526
step 300, accuracy on validation batch: 0.640625, accuracy on mal data: 0.327041
step 400, accuracy on validation batch: 0.773438, accuracy on mal data: 0.427806
step 500, accuracy on validation batch: 0.804688, accuracy on mal data: 0.499362
step 600, accuracy on validation batch: 0.789062, accuracy on mal data: 0.556888
step 700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.595153
step 800, accuracy on validation batch: 0.773438, accuracy on mal data: 0.62551
step 900, accuracy on validation batch: 0.8125, accuracy on mal data: 0.64528
step 1000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.666709
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.683546
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.696683
step 1300, accuracy on validation batch: 0.820312, accuracy on mal data: 0.707015
step 1400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.719388
step 1500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.727933
step 1600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.734949
step 1700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.744515
step 1800, accuracy on validation batch: 0.875, accuracy on mal data: 0.753189
step 1900, accuracy on validation batch: 0.875, accuracy on mal data: 0.758801
step 2000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.766071
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.772831
step 2200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.779592
step 2300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.783291
step 2400, accuracy on validation batch: 0.828125, accuracy on mal data: 0.785331
step 2500, accuracy on validation batch: 0.875, accuracy on mal data: 0.788137
step 2600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.791964
step 2700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.795791
step 2800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.8
step 2900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.802933
step 3000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.80574
step 3100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.808673
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.809439
step 3300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.811352
step 3400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.812755
step 3500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.814796
step 3600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816709
step 3700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.81824
step 3800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.819005
step 3900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.820663
step 4000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.821811
step 4100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822959
step 4200, accuracy on validation batch: 0.875, accuracy on mal data: 0.823724
step 4300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823852
step 4400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.824362
step 4500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.824872
step 4600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825255
step 4700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825255
step 4800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825893
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825893
step 5000, accuracy on validation batch: 0.875, accuracy on mal data: 0.82602
step 5100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.82653
step 5200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827168
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827296
step 5400, accuracy on validation batch: 0.875, accuracy on mal data: 0.827423
step 5500, accuracy on validation batch: 0.875, accuracy on mal data: 0.827806
step 5600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828188
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828188
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828699
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828954
step 6000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.829336
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829209
step 6200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829209
step 6300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829209
step 6400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829719
step 6500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829847
step 6600, accuracy on validation batch: 0.953125, accuracy on mal data: 0.830357
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830739
step 6800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.830867
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83125
step 7000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831505
step 7100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831505
step 7200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83176
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832143
step 7400, accuracy on validation batch: 0.96875, accuracy on mal data: 0.832143
step 7500, accuracy on validation batch: 0.960938, accuracy on mal data: 0.832525
step 7600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832525
step 7700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.832653
step 7800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.833035
step 7900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.833035
test set: accuracy on test set: 0.908
Done training net
0.908400017619
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.103444
step 100, accuracy on validation batch: 0.328125, accuracy on mal data: 0.166327
step 200, accuracy on validation batch: 0.484375, accuracy on mal data: 0.255867
step 300, accuracy on validation batch: 0.632812, accuracy on mal data: 0.347832
step 400, accuracy on validation batch: 0.742188, accuracy on mal data: 0.431378
step 500, accuracy on validation batch: 0.796875, accuracy on mal data: 0.504337
step 600, accuracy on validation batch: 0.78125, accuracy on mal data: 0.562372
step 700, accuracy on validation batch: 0.804688, accuracy on mal data: 0.603061
step 800, accuracy on validation batch: 0.757812, accuracy on mal data: 0.632143
step 900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.651913
step 1000, accuracy on validation batch: 0.765625, accuracy on mal data: 0.669133
step 1100, accuracy on validation batch: 0.789062, accuracy on mal data: 0.685204
step 1200, accuracy on validation batch: 0.976562, accuracy on mal data: 0.702041
step 1300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.715689
step 1400, accuracy on validation batch: 0.8125, accuracy on mal data: 0.72602
step 1500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.737117
step 1600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.746301
step 1700, accuracy on validation batch: 0.875, accuracy on mal data: 0.755485
step 1800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.764541
step 1900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.770918
step 2000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.777041
step 2100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.78227
step 2200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.785331
step 2300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.788775
step 2400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.793367
step 2500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.796173
step 2600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.800255
step 2700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.803571
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.80574
step 2900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.807398
step 3000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.808291
step 3100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.809694
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.811479
step 3300, accuracy on validation batch: 0.875, accuracy on mal data: 0.812882
step 3400, accuracy on validation batch: 0.828125, accuracy on mal data: 0.813903
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.815688
step 3600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.816199
step 3700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816326
step 3800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816836
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.817219
step 4000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817857
step 4100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.817984
step 4200, accuracy on validation batch: 0.945312, accuracy on mal data: 0.818622
step 4300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.81926
step 4400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.819643
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819643
step 4600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.82028
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82028
step 4800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.820791
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821046
step 5000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821811
step 5100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822321
step 5200, accuracy on validation batch: 0.875, accuracy on mal data: 0.822194
step 5300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823214
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823342
step 5500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824362
step 5600, accuracy on validation batch: 0.804688, accuracy on mal data: 0.824617
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825382
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82551
step 5900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82653
step 6000, accuracy on validation batch: 0.945312, accuracy on mal data: 0.826913
step 6100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827041
step 6200, accuracy on validation batch: 0.953125, accuracy on mal data: 0.827168
step 6300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827423
step 6400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827678
step 6500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828699
step 6600, accuracy on validation batch: 0.953125, accuracy on mal data: 0.829209
step 6700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829464
step 6800, accuracy on validation batch: 0.875, accuracy on mal data: 0.830102
step 6900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830229
step 7000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830995
step 7100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830995
step 7200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.831377
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831377
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831632
step 7500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831887
step 7600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832143
step 7700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832143
step 7800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832143
step 7900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832143
test set: accuracy on test set: 0.911
Done training net
0.911000022888
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.140625, accuracy on mal data: 0.112883
step 100, accuracy on validation batch: 0.328125, accuracy on mal data: 0.188393
step 200, accuracy on validation batch: 0.539062, accuracy on mal data: 0.276403
step 300, accuracy on validation batch: 0.609375, accuracy on mal data: 0.369643
step 400, accuracy on validation batch: 0.71875, accuracy on mal data: 0.455357
step 500, accuracy on validation batch: 0.726562, accuracy on mal data: 0.516837
step 600, accuracy on validation batch: 0.796875, accuracy on mal data: 0.569005
step 700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.604337
step 800, accuracy on validation batch: 0.734375, accuracy on mal data: 0.629592
step 900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.65
step 1000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.669133
step 1100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.683673
step 1200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.694898
step 1300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.706505
step 1400, accuracy on validation batch: 0.804688, accuracy on mal data: 0.720025
step 1500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.729464
step 1600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.739158
step 1700, accuracy on validation batch: 0.796875, accuracy on mal data: 0.745791
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.752041
step 1900, accuracy on validation batch: 0.789062, accuracy on mal data: 0.758928
step 2000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.765051
step 2100, accuracy on validation batch: 0.820312, accuracy on mal data: 0.769388
step 2200, accuracy on validation batch: 0.875, accuracy on mal data: 0.775638
step 2300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.780867
step 2400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.783801
step 2500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.790051
step 2600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.792219
step 2700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.794515
step 2800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.79477
step 2900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.796939
step 3000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.799362
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.801658
step 3200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.804847
step 3300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.805995
step 3400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.806888
step 3500, accuracy on validation batch: 0.8125, accuracy on mal data: 0.809311
step 3600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.811862
step 3700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.814285
step 3800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.815561
step 3900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816964
step 4000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.817984
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.817857
step 4200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.819132
step 4300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.819515
step 4400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.82028
step 4500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821173
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821683
step 4700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822959
step 4800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.823469
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824745
step 5000, accuracy on validation batch: 0.875, accuracy on mal data: 0.824872
step 5100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825127
step 5200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.82551
step 5300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825893
step 5400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.826403
step 5500, accuracy on validation batch: 0.875, accuracy on mal data: 0.826403
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827041
step 5700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827551
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828061
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828316
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828316
step 6100, accuracy on validation batch: 0.875, accuracy on mal data: 0.828316
step 6200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828444
step 6300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828571
step 6400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829336
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830102
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830102
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830484
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830612
step 6900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.83074
step 7000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.83074
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830995
step 7200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831122
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831632
step 7400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.831632
step 7500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832143
step 7600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.832398
step 7700, accuracy on validation batch: 0.953125, accuracy on mal data: 0.832525
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83278
step 7900, accuracy on validation batch: 0.875, accuracy on mal data: 0.83278
test set: accuracy on test set: 0.910
Done training net
0.910400021076
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 512, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 512, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0991071
step 100, accuracy on validation batch: 0.359375, accuracy on mal data: 0.185459
step 200, accuracy on validation batch: 0.523438, accuracy on mal data: 0.280357
step 300, accuracy on validation batch: 0.65625, accuracy on mal data: 0.375765
step 400, accuracy on validation batch: 0.71875, accuracy on mal data: 0.463903
step 500, accuracy on validation batch: 0.734375, accuracy on mal data: 0.541071
step 600, accuracy on validation batch: 0.78125, accuracy on mal data: 0.590051
step 700, accuracy on validation batch: 0.765625, accuracy on mal data: 0.621428
step 800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.648724
step 900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.664541
step 1000, accuracy on validation batch: 0.804688, accuracy on mal data: 0.679847
step 1100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.694515
step 1200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.706632
step 1300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.719132
step 1400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.730867
step 1500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.73801
step 1600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.748852
step 1700, accuracy on validation batch: 0.789062, accuracy on mal data: 0.756122
step 1800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.764668
step 1900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.769515
step 2000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.77449
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.780357
step 2200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.785076
step 2300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.7875
step 2400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.791326
step 2500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.79426
step 2600, accuracy on validation batch: 0.875, accuracy on mal data: 0.796683
step 2700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.798852
step 2800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.801275
step 2900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.802551
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.804464
step 3100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.805357
step 3200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.808801
step 3300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.810587
step 3400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.811479
step 3500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.8125
step 3600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.813903
step 3700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.815944
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816836
step 3900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817092
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817984
step 4100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.819387
step 4200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.819643
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820025
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820408
step 4500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820918
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821301
step 4700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821811
step 4800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.822066
step 4900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823087
step 5000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823469
step 5100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.823852
step 5200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824362
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824362
step 5400, accuracy on validation batch: 0.96875, accuracy on mal data: 0.825127
step 5500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.82602
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826785
step 5700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.826785
step 5800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827041
step 5900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827296
step 6000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.827423
step 6100, accuracy on validation batch: 0.875, accuracy on mal data: 0.827551
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827551
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827678
step 6400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827806
step 6500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827933
step 6600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828699
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829081
step 6800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829209
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829719
step 7000, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829847
step 7100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830102
step 7200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830484
step 7300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831122
step 7400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.831505
step 7500, accuracy on validation batch: 0.875, accuracy on mal data: 0.83176
step 7600, accuracy on validation batch: 0.875, accuracy on mal data: 0.831887
step 7700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832398
step 7800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832398
step 7900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832398
test set: accuracy on test set: 0.911
Done training net
0.911100024581
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0908163
step 100, accuracy on validation batch: 0.179688, accuracy on mal data: 0.167985
step 200, accuracy on validation batch: 0.492188, accuracy on mal data: 0.259566
step 300, accuracy on validation batch: 0.695312, accuracy on mal data: 0.365944
step 400, accuracy on validation batch: 0.71875, accuracy on mal data: 0.447449
step 500, accuracy on validation batch: 0.765625, accuracy on mal data: 0.511735
step 600, accuracy on validation batch: 0.773438, accuracy on mal data: 0.557143
step 700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.595408
step 800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.615434
step 900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.640306
step 1000, accuracy on validation batch: 0.804688, accuracy on mal data: 0.661607
step 1100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.677806
step 1200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.692219
step 1300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.705867
step 1400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.71977
step 1500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.727678
step 1600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.736352
step 1700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.744388
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.753061
step 1900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.758291
step 2000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.763648
step 2100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.769387
step 2200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.775127
step 2300, accuracy on validation batch: 0.875, accuracy on mal data: 0.779209
step 2400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.785331
step 2500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.788775
step 2600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.792347
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.795663
step 2800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.798342
step 2900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.80051
step 3000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.804336
step 3100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.805867
step 3200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.807653
step 3300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.809183
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.810331
step 3500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.811607
step 3600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.813648
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.814541
step 3800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815178
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815561
step 4000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815944
step 4100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817219
step 4200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.819005
step 4300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.819387
step 4400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.81977
step 4500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.820408
step 4600, accuracy on validation batch: 0.875, accuracy on mal data: 0.821428
step 4700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.821939
step 4800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822959
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823342
step 5000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824617
step 5100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825
step 5200, accuracy on validation batch: 0.875, accuracy on mal data: 0.825255
step 5300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825893
step 5400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.825765
step 5500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.826658
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827041
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827041
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827678
step 5900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827678
step 6000, accuracy on validation batch: 0.945312, accuracy on mal data: 0.828316
step 6100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828444
step 6200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.828571
step 6300, accuracy on validation batch: 0.945312, accuracy on mal data: 0.828571
step 6400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828444
step 6500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828571
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828699
step 6700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829081
step 6800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829592
step 6900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829719
step 7000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.830484
step 7100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830739
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830867
step 7300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830995
step 7400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830995
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831122
step 7600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831122
step 7700, accuracy on validation batch: 0.875, accuracy on mal data: 0.831505
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831505
step 7900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.831632
test set: accuracy on test set: 0.910
Done training net
0.910300021172
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0234375, accuracy on mal data: 0.0831633
step 100, accuracy on validation batch: 0.195312, accuracy on mal data: 0.144388
step 200, accuracy on validation batch: 0.492188, accuracy on mal data: 0.221301
step 300, accuracy on validation batch: 0.695312, accuracy on mal data: 0.305485
step 400, accuracy on validation batch: 0.726562, accuracy on mal data: 0.40051
step 500, accuracy on validation batch: 0.789062, accuracy on mal data: 0.48176
step 600, accuracy on validation batch: 0.796875, accuracy on mal data: 0.537883
step 700, accuracy on validation batch: 0.78125, accuracy on mal data: 0.584694
step 800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.615944
step 900, accuracy on validation batch: 0.875, accuracy on mal data: 0.642092
step 1000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.666709
step 1100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.682015
step 1200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.695408
step 1300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.707653
step 1400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.720791
step 1500, accuracy on validation batch: 0.828125, accuracy on mal data: 0.73074
step 1600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.740306
step 1700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.748979
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.75625
step 1900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.766581
step 2000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.772576
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.779337
step 2200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.783928
step 2300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.78801
step 2400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.790816
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.794898
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.797959
step 2700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.799872
step 2800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.802933
step 2900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.806505
step 3000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.808546
step 3100, accuracy on validation batch: 0.820312, accuracy on mal data: 0.809949
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.811479
step 3300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.812627
step 3400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.814796
step 3500, accuracy on validation batch: 0.828125, accuracy on mal data: 0.815306
step 3600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816326
step 3700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.816836
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.818495
step 3900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.818495
step 4000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.820025
step 4100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.820408
step 4200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822194
step 4300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823469
step 4400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823724
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823724
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823979
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824362
step 4800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825255
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825765
step 5000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826275
step 5100, accuracy on validation batch: 0.875, accuracy on mal data: 0.826785
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827041
step 5300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827168
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827168
step 5500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827423
step 5600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827806
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827551
step 5800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827678
step 5900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828061
step 6000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828189
step 6100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828954
step 6200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829336
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829337
step 6400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829974
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830739
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830867
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831377
step 6800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831377
step 6900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.831122
step 7000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831377
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831377
step 7200, accuracy on validation batch: 0.945312, accuracy on mal data: 0.831505
step 7300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832143
step 7400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832143
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832143
step 7600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.83227
step 7700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832525
step 7800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.832525
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832653
test set: accuracy on test set: 0.910
Done training net
0.909700017571
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0922194
step 100, accuracy on validation batch: 0.273438, accuracy on mal data: 0.160842
step 200, accuracy on validation batch: 0.445312, accuracy on mal data: 0.257526
step 300, accuracy on validation batch: 0.617188, accuracy on mal data: 0.360204
step 400, accuracy on validation batch: 0.695312, accuracy on mal data: 0.454464
step 500, accuracy on validation batch: 0.757812, accuracy on mal data: 0.530612
step 600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.582015
step 700, accuracy on validation batch: 0.773438, accuracy on mal data: 0.613393
step 800, accuracy on validation batch: 0.78125, accuracy on mal data: 0.640178
step 900, accuracy on validation batch: 0.8125, accuracy on mal data: 0.661224
step 1000, accuracy on validation batch: 0.804688, accuracy on mal data: 0.679974
step 1100, accuracy on validation batch: 0.796875, accuracy on mal data: 0.695536
step 1200, accuracy on validation batch: 0.804688, accuracy on mal data: 0.707653
step 1300, accuracy on validation batch: 0.820312, accuracy on mal data: 0.718622
step 1400, accuracy on validation batch: 0.828125, accuracy on mal data: 0.72551
step 1500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.733928
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.742602
step 1700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.751913
step 1800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.758801
step 1900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.765178
step 2000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.769898
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.775765
step 2200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.780612
step 2300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.784183
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.788648
step 2500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.792857
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.794515
step 2700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.797831
step 2800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.8
step 2900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.801275
step 3000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.804592
step 3100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.80676
step 3200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.807525
step 3300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.808418
step 3400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.809821
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.811352
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.811734
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.813265
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815306
step 3900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815944
step 4000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816454
step 4100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.817347
step 4200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.817857
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.818877
step 4400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.819643
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821301
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821683
step 4700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822576
step 4800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.822704
step 4900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.823852
step 5000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824617
step 5100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824872
step 5200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.82551
step 5300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.825637
step 5400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.82602
step 5500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82602
step 5600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82653
step 5700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826913
step 5800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827423
step 5900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827678
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828188
step 6100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828571
step 6200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828699
step 6300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828699
step 6400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828826
step 6500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829081
step 6600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829464
step 6700, accuracy on validation batch: 0.960938, accuracy on mal data: 0.829464
step 6800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829464
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829719
step 7000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829974
step 7100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830357
step 7200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830484
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830612
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830867
step 7500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831122
step 7600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831377
step 7700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831377
step 7800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832143
step 7900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832398
test set: accuracy on test set: 0.909
Done training net
0.908900019526
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0885204
step 100, accuracy on validation batch: 0.34375, accuracy on mal data: 0.160842
step 200, accuracy on validation batch: 0.539062, accuracy on mal data: 0.248597
step 300, accuracy on validation batch: 0.71875, accuracy on mal data: 0.349872
step 400, accuracy on validation batch: 0.703125, accuracy on mal data: 0.44273
step 500, accuracy on validation batch: 0.703125, accuracy on mal data: 0.513393
step 600, accuracy on validation batch: 0.796875, accuracy on mal data: 0.562245
step 700, accuracy on validation batch: 0.742188, accuracy on mal data: 0.598852
step 800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.627551
step 900, accuracy on validation batch: 0.757812, accuracy on mal data: 0.648597
step 1000, accuracy on validation batch: 0.8125, accuracy on mal data: 0.665434
step 1100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.68227
step 1200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.69477
step 1300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.710204
step 1400, accuracy on validation batch: 0.820312, accuracy on mal data: 0.719898
step 1500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.732015
step 1600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.741071
step 1700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.748724
step 1800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.756377
step 1900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.7625
step 2000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.768239
step 2100, accuracy on validation batch: 0.875, accuracy on mal data: 0.773214
step 2200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.778699
step 2300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.782908
step 2400, accuracy on validation batch: 0.796875, accuracy on mal data: 0.789413
step 2500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.79375
step 2600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.797066
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.801148
step 2800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.802933
step 2900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.804081
step 3000, accuracy on validation batch: 0.8125, accuracy on mal data: 0.807015
step 3100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.808546
step 3200, accuracy on validation batch: 0.945312, accuracy on mal data: 0.809949
step 3300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.810969
step 3400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.811734
step 3500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.812245
step 3600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.813393
step 3700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.815051
step 3800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817347
step 3900, accuracy on validation batch: 0.875, accuracy on mal data: 0.81824
step 4000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.818495
step 4100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.819387
step 4200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.819898
step 4300, accuracy on validation batch: 0.875, accuracy on mal data: 0.821428
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822194
step 4500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822959
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824107
step 4700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824489
step 4800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824872
step 4900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824745
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825127
step 5100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825255
step 5200, accuracy on validation batch: 0.875, accuracy on mal data: 0.825637
step 5300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825893
step 5400, accuracy on validation batch: 0.875, accuracy on mal data: 0.826403
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826658
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827168
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827551
step 5800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827933
step 5900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828061
step 6000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828189
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828444
step 6200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828954
step 6300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829592
step 6400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829719
step 6500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830102
step 6600, accuracy on validation batch: 0.875, accuracy on mal data: 0.830102
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830357
step 6800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830612
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830612
step 7000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830867
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830867
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830867
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831122
step 7400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83125
step 7500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831505
step 7600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831505
step 7700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831505
step 7800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831505
step 7900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83176
test set: accuracy on test set: 0.911
Done training net
0.910500019193
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 512, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 512, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.104592
step 100, accuracy on validation batch: 0.195312, accuracy on mal data: 0.16977
step 200, accuracy on validation batch: 0.390625, accuracy on mal data: 0.259056
step 300, accuracy on validation batch: 0.671875, accuracy on mal data: 0.366837
step 400, accuracy on validation batch: 0.726562, accuracy on mal data: 0.445663
step 500, accuracy on validation batch: 0.789062, accuracy on mal data: 0.523597
step 600, accuracy on validation batch: 0.671875, accuracy on mal data: 0.57398
step 700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.612883
step 800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.64324
step 900, accuracy on validation batch: 0.796875, accuracy on mal data: 0.66199
step 1000, accuracy on validation batch: 0.796875, accuracy on mal data: 0.676913
step 1100, accuracy on validation batch: 0.875, accuracy on mal data: 0.692474
step 1200, accuracy on validation batch: 0.796875, accuracy on mal data: 0.704081
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.716837
step 1400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.727934
step 1500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.734183
step 1600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.744515
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.754464
step 1800, accuracy on validation batch: 0.875, accuracy on mal data: 0.760714
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.766071
step 2000, accuracy on validation batch: 0.875, accuracy on mal data: 0.773214
step 2100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.776403
step 2200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.780102
step 2300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.784694
step 2400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.788138
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.791709
step 2600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.79477
step 2700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.797066
step 2800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.800127
step 2900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.803699
step 3000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.805229
step 3100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.805995
step 3200, accuracy on validation batch: 0.875, accuracy on mal data: 0.809694
step 3300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.811607
step 3400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.812245
step 3500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.813775
step 3600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815306
step 3700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815816
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816836
step 3900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.81824
step 4000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.818877
step 4100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.819132
step 4200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.819515
step 4300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.820663
step 4400, accuracy on validation batch: 0.875, accuracy on mal data: 0.821173
step 4500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.821301
step 4600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.821556
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822449
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823342
step 4900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823724
step 5000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825127
step 5100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825255
step 5200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825893
step 5300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826275
step 5400, accuracy on validation batch: 0.875, accuracy on mal data: 0.82653
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827168
step 5600, accuracy on validation batch: 0.875, accuracy on mal data: 0.827423
step 5700, accuracy on validation batch: 0.875, accuracy on mal data: 0.827423
step 5800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827423
step 5900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.827551
step 6000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828061
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828189
step 6200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828316
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828826
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829081
step 6500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829209
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829464
step 6700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.829464
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829719
step 6900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829719
step 7000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829847
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830102
step 7200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830867
step 7300, accuracy on validation batch: 0.875, accuracy on mal data: 0.831377
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831505
step 7500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83176
step 7600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831887
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83227
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832525
step 7900, accuracy on validation batch: 0.953125, accuracy on mal data: 0.832525
test set: accuracy on test set: 0.911
Done training net
0.910700019598
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 64}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 64}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.101562, accuracy on mal data: 0.106505
step 100, accuracy on validation batch: 0.40625, accuracy on mal data: 0.17551
step 200, accuracy on validation batch: 0.617188, accuracy on mal data: 0.252168
step 300, accuracy on validation batch: 0.695312, accuracy on mal data: 0.339796
step 400, accuracy on validation batch: 0.71875, accuracy on mal data: 0.429847
step 500, accuracy on validation batch: 0.796875, accuracy on mal data: 0.50574
step 600, accuracy on validation batch: 0.773438, accuracy on mal data: 0.563648
step 700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.603954
step 800, accuracy on validation batch: 0.789062, accuracy on mal data: 0.633163
step 900, accuracy on validation batch: 0.796875, accuracy on mal data: 0.655229
step 1000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.668622
step 1100, accuracy on validation batch: 0.796875, accuracy on mal data: 0.687372
step 1200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.699617
step 1300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.711607
step 1400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.723214
step 1500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.733291
step 1600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.742474
step 1700, accuracy on validation batch: 0.789062, accuracy on mal data: 0.747959
step 1800, accuracy on validation batch: 0.796875, accuracy on mal data: 0.754464
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.76301
step 2000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.767729
step 2100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.772321
step 2200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.775765
step 2300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.779719
step 2400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.783801
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.790178
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.792219
step 2700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.795408
step 2800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.798342
step 2900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.801148
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.802678
step 3100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.805484
step 3200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.806377
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.80778
step 3400, accuracy on validation batch: 0.820312, accuracy on mal data: 0.810076
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.812755
step 3600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.813775
step 3700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.815306
step 3800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815944
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816326
step 4000, accuracy on validation batch: 0.875, accuracy on mal data: 0.817219
step 4100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.81926
step 4200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.819132
step 4300, accuracy on validation batch: 0.875, accuracy on mal data: 0.82028
step 4400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.821683
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822321
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822449
step 4700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823597
step 4800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824489
step 4900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824489
step 5000, accuracy on validation batch: 0.953125, accuracy on mal data: 0.825382
step 5100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826275
step 5200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.82653
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826785
step 5400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827296
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827296
step 5600, accuracy on validation batch: 0.875, accuracy on mal data: 0.827678
step 5700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827933
step 5800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828189
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828444
step 6000, accuracy on validation batch: 0.875, accuracy on mal data: 0.828444
step 6100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828571
step 6200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828954
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829336
step 6400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829337
step 6500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829592
step 6600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829847
step 6700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.829847
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830357
step 6900, accuracy on validation batch: 0.953125, accuracy on mal data: 0.830357
step 7000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830612
step 7100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830739
step 7200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.830867
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830995
step 7400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831377
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831632
step 7600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83176
step 7700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831887
step 7800, accuracy on validation batch: 0.875, accuracy on mal data: 0.83227
step 7900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832525
test set: accuracy on test set: 0.911
Done training net
0.910500019789
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0876276
step 100, accuracy on validation batch: 0.351562, accuracy on mal data: 0.155357
step 200, accuracy on validation batch: 0.65625, accuracy on mal data: 0.247066
step 300, accuracy on validation batch: 0.640625, accuracy on mal data: 0.354847
step 400, accuracy on validation batch: 0.703125, accuracy on mal data: 0.441582
step 500, accuracy on validation batch: 0.757812, accuracy on mal data: 0.505867
step 600, accuracy on validation batch: 0.796875, accuracy on mal data: 0.559694
step 700, accuracy on validation batch: 0.789062, accuracy on mal data: 0.600383
step 800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.623597
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.641837
step 1000, accuracy on validation batch: 0.796875, accuracy on mal data: 0.66199
step 1100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.677168
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.691326
step 1300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.703826
step 1400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.716964
step 1500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.727041
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.737882
step 1700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.749617
step 1800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.755229
step 1900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.76352
step 2000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.769515
step 2100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.775638
step 2200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.779337
step 2300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.782653
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.785204
step 2500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.788775
step 2600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.792729
step 2700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.795408
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.798852
step 2900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.801658
step 3000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.804464
step 3100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.807015
step 3200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.808673
step 3300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.809566
step 3400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.812627
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.814541
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815689
step 3700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.816326
step 3800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817219
step 3900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.819132
step 4000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.820025
step 4100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820408
step 4200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821173
step 4300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822194
step 4400, accuracy on validation batch: 0.875, accuracy on mal data: 0.822959
step 4500, accuracy on validation batch: 0.875, accuracy on mal data: 0.823469
step 4600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82449
step 4700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.824617
step 4800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825382
step 5000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.82551
step 5100, accuracy on validation batch: 0.875, accuracy on mal data: 0.825637
step 5200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826403
step 5300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826658
step 5400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827296
step 5500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.827933
step 5600, accuracy on validation batch: 0.953125, accuracy on mal data: 0.828189
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827933
step 5800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828316
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828444
step 6000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828444
step 6100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828826
step 6200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828826
step 6300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829209
step 6400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829209
step 6500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829336
step 6600, accuracy on validation batch: 0.953125, accuracy on mal data: 0.829464
step 6700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829592
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829847
step 6900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.830229
step 7000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830357
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830739
step 7200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831632
step 7300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83176
step 7400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.832143
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832653
step 7600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83278
step 7700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832908
step 7800, accuracy on validation batch: 0.960938, accuracy on mal data: 0.833163
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.833291
test set: accuracy on test set: 0.910
Done training net
0.910400027037
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 512, 'nb_neurons_2': 128, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 512, 'nb_neurons_2': 128, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0938775
step 100, accuracy on validation batch: 0.265625, accuracy on mal data: 0.166964
step 200, accuracy on validation batch: 0.585938, accuracy on mal data: 0.266071
step 300, accuracy on validation batch: 0.601562, accuracy on mal data: 0.355995
step 400, accuracy on validation batch: 0.75, accuracy on mal data: 0.447959
step 500, accuracy on validation batch: 0.804688, accuracy on mal data: 0.519515
step 600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.573214
step 700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.607908
step 800, accuracy on validation batch: 0.804688, accuracy on mal data: 0.634694
step 900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.659056
step 1000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.678189
step 1100, accuracy on validation batch: 0.8125, accuracy on mal data: 0.697449
step 1200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.714413
step 1300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.723852
step 1400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.734311
step 1500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.742219
step 1600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.748597
step 1700, accuracy on validation batch: 0.875, accuracy on mal data: 0.755485
step 1800, accuracy on validation batch: 0.820312, accuracy on mal data: 0.761097
step 1900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.764541
step 2000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.769515
step 2100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.776403
step 2200, accuracy on validation batch: 0.875, accuracy on mal data: 0.780867
step 2300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.784056
step 2400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.786734
step 2500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.790051
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.79324
step 2700, accuracy on validation batch: 0.875, accuracy on mal data: 0.795918
step 2800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.797321
step 2900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.799362
step 3000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.802678
step 3100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.806122
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.80778
step 3300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.809183
step 3400, accuracy on validation batch: 0.875, accuracy on mal data: 0.811479
step 3500, accuracy on validation batch: 0.875, accuracy on mal data: 0.8125
step 3600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.81352
step 3700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.815051
step 3800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.815944
step 3900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816326
step 4000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817219
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.818877
step 4200, accuracy on validation batch: 0.953125, accuracy on mal data: 0.819515
step 4300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820535
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820663
step 4500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.820663
step 4600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821556
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822576
step 4800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.823214
step 4900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.824234
step 5000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824745
step 5100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825382
step 5200, accuracy on validation batch: 0.875, accuracy on mal data: 0.82653
step 5300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.826275
step 5400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826658
step 5500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827041
step 5600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827678
step 5700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828316
step 5800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828316
step 5900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828188
step 6000, accuracy on validation batch: 0.875, accuracy on mal data: 0.828699
step 6100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.828954
step 6200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828826
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829081
step 6400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829974
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830357
step 6600, accuracy on validation batch: 0.875, accuracy on mal data: 0.830867
step 6700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831122
step 6800, accuracy on validation batch: 0.953125, accuracy on mal data: 0.83125
step 6900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83125
step 7000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831505
step 7100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831632
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831632
step 7300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832015
step 7400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832015
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832143
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832143
step 7700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832398
step 7800, accuracy on validation batch: 0.875, accuracy on mal data: 0.832398
step 7900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832398
test set: accuracy on test set: 0.911
Done training net
0.910700027347
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 256, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 256, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.117188, accuracy on mal data: 0.11301
step 100, accuracy on validation batch: 0.34375, accuracy on mal data: 0.183036
step 200, accuracy on validation batch: 0.429688, accuracy on mal data: 0.282398
step 300, accuracy on validation batch: 0.585938, accuracy on mal data: 0.372959
step 400, accuracy on validation batch: 0.671875, accuracy on mal data: 0.45574
step 500, accuracy on validation batch: 0.789062, accuracy on mal data: 0.519005
step 600, accuracy on validation batch: 0.757812, accuracy on mal data: 0.566709
step 700, accuracy on validation batch: 0.765625, accuracy on mal data: 0.602041
step 800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.630485
step 900, accuracy on validation batch: 0.8125, accuracy on mal data: 0.648852
step 1000, accuracy on validation batch: 0.804688, accuracy on mal data: 0.666837
step 1100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.679974
step 1200, accuracy on validation batch: 0.875, accuracy on mal data: 0.695791
step 1300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.705995
step 1400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.72028
step 1500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.728061
step 1600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.738903
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.745918
step 1800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.752933
step 1900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.760331
step 2000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.76875
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.772831
step 2200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.780102
step 2300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.782015
step 2400, accuracy on validation batch: 0.875, accuracy on mal data: 0.786352
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.791199
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.793877
step 2700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.79579
step 2800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.798979
step 2900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.802678
step 3000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.805229
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.80727
step 3200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.808418
step 3300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.809566
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.811352
step 3500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.8125
step 3600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.814285
step 3700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815306
step 3800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816071
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.816709
step 4000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817219
step 4100, accuracy on validation batch: 0.875, accuracy on mal data: 0.818112
step 4200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.818367
step 4300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.820153
step 4400, accuracy on validation batch: 0.875, accuracy on mal data: 0.82028
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821556
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821938
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823214
step 4800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823724
step 4900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824107
step 5000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824745
step 5100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825
step 5200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.825765
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826148
step 5400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.826785
step 5500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826785
step 5600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.827041
step 5700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827296
step 5800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827806
step 5900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827551
step 6000, accuracy on validation batch: 0.945312, accuracy on mal data: 0.827933
step 6100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827933
step 6200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827933
step 6300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828316
step 6400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828571
step 6500, accuracy on validation batch: 0.875, accuracy on mal data: 0.828571
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828699
step 6700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828954
step 6800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829592
step 6900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829974
step 7000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830357
step 7100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830357
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830739
step 7300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830739
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830867
step 7500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830995
step 7600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.830995
step 7700, accuracy on validation batch: 0.945312, accuracy on mal data: 0.831377
step 7800, accuracy on validation batch: 0.960938, accuracy on mal data: 0.831632
step 7900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832143
test set: accuracy on test set: 0.912
Done training net
0.911500020623
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0989796
step 100, accuracy on validation batch: 0.25, accuracy on mal data: 0.160077
step 200, accuracy on validation batch: 0.554688, accuracy on mal data: 0.253444
step 300, accuracy on validation batch: 0.632812, accuracy on mal data: 0.341964
step 400, accuracy on validation batch: 0.757812, accuracy on mal data: 0.435587
step 500, accuracy on validation batch: 0.695312, accuracy on mal data: 0.515179
step 600, accuracy on validation batch: 0.828125, accuracy on mal data: 0.56926
step 700, accuracy on validation batch: 0.75, accuracy on mal data: 0.604974
step 800, accuracy on validation batch: 0.78125, accuracy on mal data: 0.634821
step 900, accuracy on validation batch: 0.78125, accuracy on mal data: 0.658801
step 1000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.68125
step 1100, accuracy on validation batch: 0.796875, accuracy on mal data: 0.695791
step 1200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.706505
step 1300, accuracy on validation batch: 0.804688, accuracy on mal data: 0.718112
step 1400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.728189
step 1500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.739541
step 1600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.746556
step 1700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.756632
step 1800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.760969
step 1900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.768112
step 2000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.775
step 2100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.782525
step 2200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.788775
step 2300, accuracy on validation batch: 0.875, accuracy on mal data: 0.790178
step 2400, accuracy on validation batch: 0.875, accuracy on mal data: 0.792729
step 2500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.796173
step 2600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.799617
step 2700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.802423
step 2800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.802933
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.805357
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.807525
step 3100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.810076
step 3200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.810969
step 3300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.811607
step 3400, accuracy on validation batch: 0.875, accuracy on mal data: 0.814541
step 3500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.815561
step 3600, accuracy on validation batch: 0.8125, accuracy on mal data: 0.816071
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816581
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816964
step 3900, accuracy on validation batch: 0.875, accuracy on mal data: 0.818112
step 4000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.819132
step 4100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.81977
step 4200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821301
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822321
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822449
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822831
step 4600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.823597
step 4700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823724
step 4800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824107
step 4900, accuracy on validation batch: 0.960938, accuracy on mal data: 0.824617
step 5000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824745
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825382
step 5200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825765
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825765
step 5400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825893
step 5500, accuracy on validation batch: 0.875, accuracy on mal data: 0.82653
step 5600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.826658
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827168
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827423
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827551
step 6000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827551
step 6100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827933
step 6200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827933
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828188
step 6400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829209
step 6500, accuracy on validation batch: 0.875, accuracy on mal data: 0.829464
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829464
step 6700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829464
step 6800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829847
step 6900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829974
step 7000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.830102
step 7100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830102
step 7200, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829974
step 7300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830612
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831122
step 7500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832015
step 7600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832525
step 7700, accuracy on validation batch: 0.875, accuracy on mal data: 0.832398
step 7800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832653
step 7900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832908
test set: accuracy on test set: 0.912
Done training net
0.91180003345
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.113903
step 100, accuracy on validation batch: 0.3125, accuracy on mal data: 0.183036
step 200, accuracy on validation batch: 0.601562, accuracy on mal data: 0.27449
step 300, accuracy on validation batch: 0.695312, accuracy on mal data: 0.364668
step 400, accuracy on validation batch: 0.726562, accuracy on mal data: 0.44477
step 500, accuracy on validation batch: 0.765625, accuracy on mal data: 0.525638
step 600, accuracy on validation batch: 0.796875, accuracy on mal data: 0.589158
step 700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.623214
step 800, accuracy on validation batch: 0.796875, accuracy on mal data: 0.646046
step 900, accuracy on validation batch: 0.796875, accuracy on mal data: 0.666326
step 1000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.685076
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.703189
step 1200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.712245
step 1300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.722066
step 1400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.732525
step 1500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.740433
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.750765
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.756377
step 1800, accuracy on validation batch: 0.773438, accuracy on mal data: 0.762245
step 1900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.766454
step 2000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.771811
step 2100, accuracy on validation batch: 0.875, accuracy on mal data: 0.775893
step 2200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.780102
step 2300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.783801
step 2400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.787117
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.790433
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.795663
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.797066
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.799617
step 2900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.802041
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.803571
step 3100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.805357
step 3200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.808418
step 3300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.809566
step 3400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.811862
step 3500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.813393
step 3600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.814923
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815433
step 3800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.816581
step 3900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817347
step 4000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.81926
step 4100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.819388
step 4200, accuracy on validation batch: 0.875, accuracy on mal data: 0.82028
step 4300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821301
step 4400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821939
step 4500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.822194
step 4600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822831
step 4700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822959
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823214
step 4900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.823597
step 5000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.823852
step 5100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824107
step 5200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824617
step 5300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.824745
step 5400, accuracy on validation batch: 0.953125, accuracy on mal data: 0.825127
step 5500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826275
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827041
step 5700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.827551
step 5800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827933
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828444
step 6000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828699
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829336
step 6200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829719
step 6300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829719
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829974
step 6500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829974
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829974
step 6700, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830102
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830357
step 6900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830867
step 7000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831122
step 7100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83125
step 7200, accuracy on validation batch: 0.875, accuracy on mal data: 0.831505
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831505
step 7400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831505
step 7500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831632
step 7600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832525
step 7700, accuracy on validation batch: 0.945312, accuracy on mal data: 0.832525
step 7800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.832525
step 7900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832653
test set: accuracy on test set: 0.911
Done training net
0.910800022483
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.108929
step 100, accuracy on validation batch: 0.289062, accuracy on mal data: 0.180612
step 200, accuracy on validation batch: 0.546875, accuracy on mal data: 0.266199
step 300, accuracy on validation batch: 0.625, accuracy on mal data: 0.360969
step 400, accuracy on validation batch: 0.734375, accuracy on mal data: 0.446811
step 500, accuracy on validation batch: 0.757812, accuracy on mal data: 0.51773
step 600, accuracy on validation batch: 0.78125, accuracy on mal data: 0.570791
step 700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.604592
step 800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.633036
step 900, accuracy on validation batch: 0.820312, accuracy on mal data: 0.653316
step 1000, accuracy on validation batch: 0.773438, accuracy on mal data: 0.671939
step 1100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.687883
step 1200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.700127
step 1300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.712755
step 1400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.724745
step 1500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.734183
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.746046
step 1700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.751913
step 1800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.758546
step 1900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.764413
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.768112
step 2100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.771556
step 2200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.775382
step 2300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.780867
step 2400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.784183
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.786862
step 2600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.789923
step 2700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.791964
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.79477
step 2900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.797321
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.8
step 3100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.802423
step 3200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.804974
step 3300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.80676
step 3400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.809183
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.811352
step 3600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.813138
step 3700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.815051
step 3800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.816326
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.817729
step 4000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.819005
step 4100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.820153
step 4200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820535
step 4300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.821173
step 4400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.821683
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821938
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822959
step 4700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823852
step 4800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.824362
step 4900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824745
step 5000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824745
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825127
step 5200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825893
step 5300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826148
step 5400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826148
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826658
step 5600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826913
step 5700, accuracy on validation batch: 0.960938, accuracy on mal data: 0.827168
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827168
step 5900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827168
step 6000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827296
step 6100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828316
step 6200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828316
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828826
step 6400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829081
step 6500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829209
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829464
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829847
step 6800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830102
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830229
step 7000, accuracy on validation batch: 0.875, accuracy on mal data: 0.830867
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831505
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831632
step 7300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.831632
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83176
step 7500, accuracy on validation batch: 0.875, accuracy on mal data: 0.83227
step 7600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.83227
step 7700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.832398
step 7800, accuracy on validation batch: 0.953125, accuracy on mal data: 0.832398
step 7900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.833035
test set: accuracy on test set: 0.911
Done training net
0.911400021315
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.102296
step 100, accuracy on validation batch: 0.234375, accuracy on mal data: 0.160587
step 200, accuracy on validation batch: 0.34375, accuracy on mal data: 0.260204
step 300, accuracy on validation batch: 0.679688, accuracy on mal data: 0.358673
step 400, accuracy on validation batch: 0.742188, accuracy on mal data: 0.434056
step 500, accuracy on validation batch: 0.78125, accuracy on mal data: 0.50574
step 600, accuracy on validation batch: 0.804688, accuracy on mal data: 0.562372
step 700, accuracy on validation batch: 0.734375, accuracy on mal data: 0.601403
step 800, accuracy on validation batch: 0.742188, accuracy on mal data: 0.627934
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.651148
step 1000, accuracy on validation batch: 0.875, accuracy on mal data: 0.666837
step 1100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.679081
step 1200, accuracy on validation batch: 0.8125, accuracy on mal data: 0.694643
step 1300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.706632
step 1400, accuracy on validation batch: 0.875, accuracy on mal data: 0.717857
step 1500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.728571
step 1600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.73699
step 1700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.744643
step 1800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.752806
step 1900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.759439
step 2000, accuracy on validation batch: 0.875, accuracy on mal data: 0.766071
step 2100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.773597
step 2200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.777551
step 2300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.784056
step 2400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.789158
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.792092
step 2600, accuracy on validation batch: 0.875, accuracy on mal data: 0.79528
step 2700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.798087
step 2800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.801403
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.803061
step 3000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.806377
step 3100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.806888
step 3200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.809566
step 3300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.811607
step 3400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.812627
step 3500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.813393
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.81403
step 3700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.815561
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.816454
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.817984
step 4000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.819643
step 4100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.820791
step 4200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.821173
step 4300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821428
step 4400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.822321
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823086
step 4600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.823597
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824489
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824489
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824489
step 5000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.824872
step 5100, accuracy on validation batch: 0.875, accuracy on mal data: 0.825255
step 5200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.825893
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825893
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826403
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82704
step 5600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.827041
step 5700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828061
step 5800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828316
step 5900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828316
step 6000, accuracy on validation batch: 0.804688, accuracy on mal data: 0.828444
step 6100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.828571
step 6200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828826
step 6300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829209
step 6400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829592
step 6500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829719
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829974
step 6700, accuracy on validation batch: 0.875, accuracy on mal data: 0.830229
step 6800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830484
step 6900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830484
step 7000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830739
step 7100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830995
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831122
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831377
step 7400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831632
step 7500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83176
step 7600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831887
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832015
step 7800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83227
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83227
test set: accuracy on test set: 0.911
Done training net
0.91130002439
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0934949
step 100, accuracy on validation batch: 0.375, accuracy on mal data: 0.156505
step 200, accuracy on validation batch: 0.648438, accuracy on mal data: 0.235204
step 300, accuracy on validation batch: 0.6875, accuracy on mal data: 0.334694
step 400, accuracy on validation batch: 0.75, accuracy on mal data: 0.437883
step 500, accuracy on validation batch: 0.796875, accuracy on mal data: 0.50676
step 600, accuracy on validation batch: 0.804688, accuracy on mal data: 0.558036
step 700, accuracy on validation batch: 0.71875, accuracy on mal data: 0.601658
step 800, accuracy on validation batch: 0.804688, accuracy on mal data: 0.630867
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.651275
step 1000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.665816
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.687882
step 1200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.703316
step 1300, accuracy on validation batch: 0.875, accuracy on mal data: 0.715689
step 1400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.724617
step 1500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.736224
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.744515
step 1700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.752423
step 1800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.759439
step 1900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.765051
step 2000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.771046
step 2100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.776403
step 2200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.780357
step 2300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.785842
step 2400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.790816
step 2500, accuracy on validation batch: 0.796875, accuracy on mal data: 0.793112
step 2600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.797321
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.800765
step 2800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.803699
step 2900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.80574
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.807525
step 3100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.809438
step 3200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.810076
step 3300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.812755
step 3400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.814668
step 3500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.815178
step 3600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815944
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815816
step 3800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.816199
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.817602
step 4000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.818495
step 4100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.819132
step 4200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820025
step 4300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.82028
step 4400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.820663
step 4500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.821683
step 4600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822066
step 4700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.822831
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823597
step 4900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.824745
step 5000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825127
step 5100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825255
step 5200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82602
step 5300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82602
step 5400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.826275
step 5500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826785
step 5600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827678
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828061
step 5800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828189
step 5900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828571
step 6000, accuracy on validation batch: 0.953125, accuracy on mal data: 0.828571
step 6100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828699
step 6200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828954
step 6300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829336
step 6400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829592
step 6500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829719
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829847
step 6700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830102
step 6800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830102
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830739
step 7000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830995
step 7100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831122
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83125
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831505
step 7400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83176
step 7500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.831887
step 7600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832143
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832398
step 7800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832653
step 7900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832908
test set: accuracy on test set: 0.912
Done training net
0.912000030279
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 512, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 512, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.109375, accuracy on mal data: 0.0936224
step 100, accuracy on validation batch: 0.34375, accuracy on mal data: 0.158291
step 200, accuracy on validation batch: 0.507812, accuracy on mal data: 0.240816
step 300, accuracy on validation batch: 0.554688, accuracy on mal data: 0.345918
step 400, accuracy on validation batch: 0.71875, accuracy on mal data: 0.440944
step 500, accuracy on validation batch: 0.757812, accuracy on mal data: 0.516964
step 600, accuracy on validation batch: 0.789062, accuracy on mal data: 0.561607
step 700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.592857
step 800, accuracy on validation batch: 0.796875, accuracy on mal data: 0.614286
step 900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.640306
step 1000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.66199
step 1100, accuracy on validation batch: 0.8125, accuracy on mal data: 0.677934
step 1200, accuracy on validation batch: 0.804688, accuracy on mal data: 0.690434
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.701658
step 1400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.717474
step 1500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.729464
step 1600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.741071
step 1700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.751658
step 1800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.760331
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.765816
step 2000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.771428
step 2100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.777168
step 2200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.783163
step 2300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.788903
step 2400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.792602
step 2500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.795153
step 2600, accuracy on validation batch: 0.828125, accuracy on mal data: 0.799107
step 2700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.80153
step 2800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.804337
step 2900, accuracy on validation batch: 0.875, accuracy on mal data: 0.808035
step 3000, accuracy on validation batch: 0.804688, accuracy on mal data: 0.808801
step 3100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.810586
step 3200, accuracy on validation batch: 0.875, accuracy on mal data: 0.812245
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.812882
step 3400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.816199
step 3500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.816581
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817984
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.818495
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.819132
step 3900, accuracy on validation batch: 0.875, accuracy on mal data: 0.819898
step 4000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821173
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821173
step 4200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.821173
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821556
step 4400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822704
step 4500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823086
step 4600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.823597
step 4700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.823724
step 4800, accuracy on validation batch: 0.875, accuracy on mal data: 0.825
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825255
step 5000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82551
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825637
step 5200, accuracy on validation batch: 0.945312, accuracy on mal data: 0.825893
step 5300, accuracy on validation batch: 0.945312, accuracy on mal data: 0.826148
step 5400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826658
step 5500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.826658
step 5600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.82704
step 5700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827423
step 5800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.827933
step 5900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828444
step 6000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.828826
step 6100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829464
step 6200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829847
step 6300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.830229
step 6400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830612
step 6500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830739
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830867
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830867
step 6800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830995
step 6900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83125
step 7000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83125
step 7100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.83125
step 7200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831377
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831632
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832143
step 7500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832398
step 7600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832398
step 7700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832398
step 7800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832525
step 7900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83278
test set: accuracy on test set: 0.909
Done training net
0.909300022721
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 512, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 512, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.09375, accuracy on mal data: 0.098852
step 100, accuracy on validation batch: 0.367188, accuracy on mal data: 0.172704
step 200, accuracy on validation batch: 0.609375, accuracy on mal data: 0.253061
step 300, accuracy on validation batch: 0.71875, accuracy on mal data: 0.346684
step 400, accuracy on validation batch: 0.75, accuracy on mal data: 0.438648
step 500, accuracy on validation batch: 0.734375, accuracy on mal data: 0.504719
step 600, accuracy on validation batch: 0.804688, accuracy on mal data: 0.558673
step 700, accuracy on validation batch: 0.789062, accuracy on mal data: 0.596046
step 800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.620408
step 900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.647576
step 1000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.667985
step 1100, accuracy on validation batch: 0.8125, accuracy on mal data: 0.681632
step 1200, accuracy on validation batch: 0.796875, accuracy on mal data: 0.698342
step 1300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.714668
step 1400, accuracy on validation batch: 0.875, accuracy on mal data: 0.72653
step 1500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.73852
step 1600, accuracy on validation batch: 0.875, accuracy on mal data: 0.746428
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.755995
step 1800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.763903
step 1900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.770535
step 2000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.775638
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.780357
step 2200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.785204
step 2300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.788265
step 2400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.792474
step 2500, accuracy on validation batch: 0.875, accuracy on mal data: 0.795408
step 2600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.797066
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.798979
step 2800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.801403
step 2900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.804592
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.804847
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.806122
step 3200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.808163
step 3300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.809821
step 3400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.811352
step 3500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.812755
step 3600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.813775
step 3700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.815051
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816071
step 3900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.816454
step 4000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.817474
step 4100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.818877
step 4200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.81977
step 4300, accuracy on validation batch: 0.945312, accuracy on mal data: 0.820791
step 4400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821556
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822066
step 4600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822959
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823214
step 4800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823214
step 4900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823597
step 5000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823852
step 5100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823979
step 5200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.824362
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825127
step 5400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825382
step 5500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.82602
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826275
step 5700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.826403
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826785
step 5900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827168
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827678
step 6100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828189
step 6200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828571
step 6300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828699
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828826
step 6500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828954
step 6600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829209
step 6700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829209
step 6800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829209
step 6900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829974
step 7000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829974
step 7100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.830229
step 7200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830357
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830612
step 7400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830995
step 7500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.831632
step 7600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831632
step 7700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831632
step 7800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831632
step 7900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831887
test set: accuracy on test set: 0.911
Done training net
0.910900030136
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.125, accuracy on mal data: 0.102679
step 100, accuracy on validation batch: 0.335938, accuracy on mal data: 0.171556
step 200, accuracy on validation batch: 0.5625, accuracy on mal data: 0.247832
step 300, accuracy on validation batch: 0.632812, accuracy on mal data: 0.349107
step 400, accuracy on validation batch: 0.773438, accuracy on mal data: 0.44324
step 500, accuracy on validation batch: 0.71875, accuracy on mal data: 0.520791
step 600, accuracy on validation batch: 0.78125, accuracy on mal data: 0.561862
step 700, accuracy on validation batch: 0.734375, accuracy on mal data: 0.601658
step 800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.63278
step 900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.65625
step 1000, accuracy on validation batch: 0.796875, accuracy on mal data: 0.67653
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.690561
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.704337
step 1300, accuracy on validation batch: 0.789062, accuracy on mal data: 0.717092
step 1400, accuracy on validation batch: 0.875, accuracy on mal data: 0.73074
step 1500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.743495
step 1600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.753571
step 1700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.760459
step 1800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.766326
step 1900, accuracy on validation batch: 0.875, accuracy on mal data: 0.770663
step 2000, accuracy on validation batch: 0.8125, accuracy on mal data: 0.776148
step 2100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.780357
step 2200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.784694
step 2300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.78852
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.791071
step 2500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.794515
step 2600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.797831
step 2700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.799362
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.801658
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.804209
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.805995
step 3100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.808673
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.809438
step 3300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.811224
step 3400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.81301
step 3500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.814158
step 3600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.816071
step 3700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817219
step 3800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.817857
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81926
step 4000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.81977
step 4100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820025
step 4200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821428
step 4300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821811
step 4400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.822066
step 4500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.822959
step 4600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823469
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824234
step 4800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824489
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824872
step 5000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.825
step 5100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826148
step 5200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826148
step 5300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.826275
step 5400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826275
step 5500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82653
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826658
step 5700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827041
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827678
step 5900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.827933
step 6000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828061
step 6100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828061
step 6200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828188
step 6300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828188
step 6400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828444
step 6500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828699
step 6600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.828699
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829719
step 6800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.829719
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829847
step 7000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830357
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830357
step 7200, accuracy on validation batch: 0.875, accuracy on mal data: 0.830357
step 7300, accuracy on validation batch: 0.875, accuracy on mal data: 0.830612
step 7400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830995
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83125
step 7600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83125
step 7700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831505
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831505
step 7900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832143
test set: accuracy on test set: 0.909
Done training net
0.908500027061
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.117188, accuracy on mal data: 0.100383
step 100, accuracy on validation batch: 0.367188, accuracy on mal data: 0.177041
step 200, accuracy on validation batch: 0.546875, accuracy on mal data: 0.252934
step 300, accuracy on validation batch: 0.601562, accuracy on mal data: 0.347577
step 400, accuracy on validation batch: 0.601562, accuracy on mal data: 0.440561
step 500, accuracy on validation batch: 0.75, accuracy on mal data: 0.516454
step 600, accuracy on validation batch: 0.804688, accuracy on mal data: 0.561862
step 700, accuracy on validation batch: 0.765625, accuracy on mal data: 0.598469
step 800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.630102
step 900, accuracy on validation batch: 0.796875, accuracy on mal data: 0.653826
step 1000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.671556
step 1100, accuracy on validation batch: 0.796875, accuracy on mal data: 0.689796
step 1200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.704719
step 1300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.714923
step 1400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.727806
step 1500, accuracy on validation batch: 0.828125, accuracy on mal data: 0.735842
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.746046
step 1700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.753699
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.760714
step 1900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.766836
step 2000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.773469
step 2100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.778444
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.781505
step 2300, accuracy on validation batch: 0.8125, accuracy on mal data: 0.785586
step 2400, accuracy on validation batch: 0.8125, accuracy on mal data: 0.789796
step 2500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.792474
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.796173
step 2700, accuracy on validation batch: 0.875, accuracy on mal data: 0.799234
step 2800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.801658
step 2900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.804464
step 3000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.807525
step 3100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.809821
step 3200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.810459
step 3300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.81199
step 3400, accuracy on validation batch: 0.875, accuracy on mal data: 0.813903
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.814796
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815561
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816199
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816709
step 3900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.817474
step 4000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.819005
step 4100, accuracy on validation batch: 0.875, accuracy on mal data: 0.819515
step 4200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819898
step 4300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.820408
step 4400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.820918
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821811
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822831
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823214
step 4800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823852
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824872
step 5000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825255
step 5100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825255
step 5200, accuracy on validation batch: 0.875, accuracy on mal data: 0.825637
step 5300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825382
step 5400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826148
step 5500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826275
step 5600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826913
step 5700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827423
step 5800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.827933
step 5900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828189
step 6000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.828189
step 6100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828444
step 6200, accuracy on validation batch: 0.804688, accuracy on mal data: 0.828571
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828826
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829336
step 6500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829592
step 6600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829719
step 6700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829974
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830229
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830612
step 7000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830612
step 7100, accuracy on validation batch: 0.960938, accuracy on mal data: 0.830995
step 7200, accuracy on validation batch: 0.953125, accuracy on mal data: 0.83125
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831377
step 7400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.83227
step 7500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832015
step 7600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.83227
step 7700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.83227
step 7800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.832653
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.833418
test set: accuracy on test set: 0.909
Done training net
0.908600016236
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.132812, accuracy on mal data: 0.101786
step 100, accuracy on validation batch: 0.28125, accuracy on mal data: 0.166837
step 200, accuracy on validation batch: 0.476562, accuracy on mal data: 0.248087
step 300, accuracy on validation batch: 0.617188, accuracy on mal data: 0.348469
step 400, accuracy on validation batch: 0.742188, accuracy on mal data: 0.437245
step 500, accuracy on validation batch: 0.773438, accuracy on mal data: 0.50102
step 600, accuracy on validation batch: 0.765625, accuracy on mal data: 0.547321
step 700, accuracy on validation batch: 0.8125, accuracy on mal data: 0.586735
step 800, accuracy on validation batch: 0.804688, accuracy on mal data: 0.61824
step 900, accuracy on validation batch: 0.8125, accuracy on mal data: 0.639158
step 1000, accuracy on validation batch: 0.78125, accuracy on mal data: 0.661224
step 1100, accuracy on validation batch: 0.789062, accuracy on mal data: 0.681377
step 1200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.696556
step 1300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.710714
step 1400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.721556
step 1500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.734949
step 1600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.744898
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.754592
step 1800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.762755
step 1900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.767984
step 2000, accuracy on validation batch: 0.875, accuracy on mal data: 0.773597
step 2100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.777933
step 2200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.783418
step 2300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.785586
step 2400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.789796
step 2500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.793112
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.797704
step 2700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.798597
step 2800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.799745
step 2900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.802678
step 3000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.805867
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.807143
step 3200, accuracy on validation batch: 0.875, accuracy on mal data: 0.809438
step 3300, accuracy on validation batch: 0.875, accuracy on mal data: 0.809821
step 3400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.811097
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.812117
step 3600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.8125
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.813775
step 3800, accuracy on validation batch: 0.960938, accuracy on mal data: 0.815178
step 3900, accuracy on validation batch: 0.875, accuracy on mal data: 0.816199
step 4000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817729
step 4100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817984
step 4200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819005
step 4300, accuracy on validation batch: 0.875, accuracy on mal data: 0.81977
step 4400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821046
step 4500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821301
step 4600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821556
step 4700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822321
step 4800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822831
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823214
step 5000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823979
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824234
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825255
step 5300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825893
step 5400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.82602
step 5500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.826785
step 5600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.827551
step 5700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827933
step 5800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.828699
step 5900, accuracy on validation batch: 0.875, accuracy on mal data: 0.828826
step 6000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829336
step 6100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829464
step 6200, accuracy on validation batch: 0.96875, accuracy on mal data: 0.829464
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829592
step 6400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.829592
step 6500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829974
step 6600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830357
step 6700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830357
step 6800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.830484
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830357
step 7000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831377
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832015
step 7200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83227
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83227
step 7400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832525
step 7500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832653
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832653
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.833035
step 7800, accuracy on validation batch: 0.960938, accuracy on mal data: 0.833291
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.833163
test set: accuracy on test set: 0.911
Done training net
0.911200020909
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 512, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 512, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.101148
step 100, accuracy on validation batch: 0.203125, accuracy on mal data: 0.170918
step 200, accuracy on validation batch: 0.539062, accuracy on mal data: 0.257908
step 300, accuracy on validation batch: 0.601562, accuracy on mal data: 0.354592
step 400, accuracy on validation batch: 0.65625, accuracy on mal data: 0.446173
step 500, accuracy on validation batch: 0.742188, accuracy on mal data: 0.523724
step 600, accuracy on validation batch: 0.765625, accuracy on mal data: 0.572832
step 700, accuracy on validation batch: 0.789062, accuracy on mal data: 0.607908
step 800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.630229
step 900, accuracy on validation batch: 0.820312, accuracy on mal data: 0.646684
step 1000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.665051
step 1100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.680229
step 1200, accuracy on validation batch: 0.804688, accuracy on mal data: 0.696428
step 1300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.709056
step 1400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.722449
step 1500, accuracy on validation batch: 0.828125, accuracy on mal data: 0.732398
step 1600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.741836
step 1700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.750127
step 1800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.759949
step 1900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.766454
step 2000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.771556
step 2100, accuracy on validation batch: 0.875, accuracy on mal data: 0.77602
step 2200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.780102
step 2300, accuracy on validation batch: 0.875, accuracy on mal data: 0.785331
step 2400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.788648
step 2500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.791964
step 2600, accuracy on validation batch: 0.828125, accuracy on mal data: 0.795918
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.799745
step 2800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.802423
step 2900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.805229
step 3000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.80676
step 3100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.808291
step 3200, accuracy on validation batch: 0.875, accuracy on mal data: 0.810331
step 3300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.8125
step 3400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.813648
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.814541
step 3600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.816581
step 3700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.817729
step 3800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.818877
step 3900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820025
step 4000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.820791
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821811
step 4200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.822449
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823087
step 4400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823469
step 4500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82449
step 4600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.824617
step 4700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.825382
step 4800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825637
step 4900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82602
step 5000, accuracy on validation batch: 0.960938, accuracy on mal data: 0.826785
step 5100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.826785
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827168
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827806
step 5400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828188
step 5500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828699
step 5600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829209
step 5700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829847
step 5800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829719
step 5900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829592
step 6000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829719
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829719
step 6200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829847
step 6300, accuracy on validation batch: 0.875, accuracy on mal data: 0.829719
step 6400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829847
step 6500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829974
step 6600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830612
step 6700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830867
step 6800, accuracy on validation batch: 0.875, accuracy on mal data: 0.830867
step 6900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830995
step 7000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831505
step 7100, accuracy on validation batch: 0.875, accuracy on mal data: 0.83176
step 7200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.83176
step 7300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831887
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831887
step 7500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832015
step 7600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832398
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83227
step 7800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832908
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.833035
test set: accuracy on test set: 0.910
Done training net
0.909600023031
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.210938, accuracy on mal data: 0.108801
step 100, accuracy on validation batch: 0.351562, accuracy on mal data: 0.178954
step 200, accuracy on validation batch: 0.585938, accuracy on mal data: 0.259566
step 300, accuracy on validation batch: 0.632812, accuracy on mal data: 0.347959
step 400, accuracy on validation batch: 0.757812, accuracy on mal data: 0.433673
step 500, accuracy on validation batch: 0.703125, accuracy on mal data: 0.498087
step 600, accuracy on validation batch: 0.789062, accuracy on mal data: 0.561735
step 700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.594898
step 800, accuracy on validation batch: 0.804688, accuracy on mal data: 0.621173
step 900, accuracy on validation batch: 0.789062, accuracy on mal data: 0.641837
step 1000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.664413
step 1100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.684183
step 1200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.698852
step 1300, accuracy on validation batch: 0.875, accuracy on mal data: 0.709949
step 1400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.723597
step 1500, accuracy on validation batch: 0.828125, accuracy on mal data: 0.735331
step 1600, accuracy on validation batch: 0.875, accuracy on mal data: 0.745025
step 1700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.753061
step 1800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.758801
step 1900, accuracy on validation batch: 0.875, accuracy on mal data: 0.767347
step 2000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.772321
step 2100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.778316
step 2200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.784949
step 2300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.78852
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.791581
step 2500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.793495
step 2600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.797449
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.799745
step 2800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.801403
step 2900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.802806
step 3000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.804464
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.806632
step 3200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.807525
step 3300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.808673
step 3400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.810076
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.811734
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.812627
step 3700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.813648
step 3800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.814413
step 3900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.815306
step 4000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.816836
step 4100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817474
step 4200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.81824
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.818495
step 4400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.819387
step 4500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.820918
step 4600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821811
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822321
step 4800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.823214
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823342
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823724
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824107
step 5200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.824362
step 5300, accuracy on validation batch: 0.953125, accuracy on mal data: 0.824617
step 5400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.825255
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825255
step 5600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.825255
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825637
step 5800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826658
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827041
step 6000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827423
step 6100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827806
step 6200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827933
step 6300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828444
step 6400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828444
step 6500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828699
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828954
step 6700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829336
step 6800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829847
step 6900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830484
step 7000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830357
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830995
step 7200, accuracy on validation batch: 0.875, accuracy on mal data: 0.830995
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830995
step 7400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831505
step 7500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831632
step 7600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831887
step 7700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832398
step 7800, accuracy on validation batch: 0.875, accuracy on mal data: 0.832653
step 7900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832653
test set: accuracy on test set: 0.910
Done training net
0.910300027132
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 256, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 256, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.148438, accuracy on mal data: 0.0991071
step 100, accuracy on validation batch: 0.476562, accuracy on mal data: 0.177806
step 200, accuracy on validation batch: 0.5, accuracy on mal data: 0.270536
step 300, accuracy on validation batch: 0.75, accuracy on mal data: 0.371429
step 400, accuracy on validation batch: 0.664062, accuracy on mal data: 0.452296
step 500, accuracy on validation batch: 0.757812, accuracy on mal data: 0.522449
step 600, accuracy on validation batch: 0.734375, accuracy on mal data: 0.567474
step 700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.60676
step 800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.631888
step 900, accuracy on validation batch: 0.820312, accuracy on mal data: 0.656122
step 1000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.672449
step 1100, accuracy on validation batch: 0.804688, accuracy on mal data: 0.691581
step 1200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.708928
step 1300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.718877
step 1400, accuracy on validation batch: 0.820312, accuracy on mal data: 0.729847
step 1500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.740944
step 1600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.748469
step 1700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.757143
step 1800, accuracy on validation batch: 0.875, accuracy on mal data: 0.764541
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.770791
step 2000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.77602
step 2100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.779592
step 2200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.783418
step 2300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.786352
step 2400, accuracy on validation batch: 0.828125, accuracy on mal data: 0.790051
step 2500, accuracy on validation batch: 0.875, accuracy on mal data: 0.793877
step 2600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.797066
step 2700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.799362
step 2800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.800637
step 2900, accuracy on validation batch: 0.875, accuracy on mal data: 0.803189
step 3000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.805229
step 3100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.807015
step 3200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.808928
step 3300, accuracy on validation batch: 0.945312, accuracy on mal data: 0.809311
step 3400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.811224
step 3500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.812372
step 3600, accuracy on validation batch: 0.78125, accuracy on mal data: 0.813775
step 3700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.814285
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815816
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816836
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.818112
step 4100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.81875
step 4200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819643
step 4300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.820663
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821046
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821428
step 4600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821811
step 4700, accuracy on validation batch: 0.960938, accuracy on mal data: 0.822959
step 4800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823979
step 4900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.824362
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824617
step 5100, accuracy on validation batch: 0.875, accuracy on mal data: 0.824745
step 5200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825255
step 5300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825638
step 5400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826275
step 5500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82653
step 5600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826913
step 5700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827423
step 5800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827423
step 5900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828188
step 6000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828826
step 6100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829081
step 6200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829336
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829336
step 6400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829719
step 6500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829974
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829974
step 6700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.830229
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830995
step 6900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830995
step 7000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83125
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831632
step 7200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.832015
step 7300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83227
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832525
step 7500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832525
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832653
step 7700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83278
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.833163
step 7900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.833163
test set: accuracy on test set: 0.911
Done training net
0.910900027752
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.121429
step 100, accuracy on validation batch: 0.21875, accuracy on mal data: 0.188393
step 200, accuracy on validation batch: 0.546875, accuracy on mal data: 0.267985
step 300, accuracy on validation batch: 0.601562, accuracy on mal data: 0.355995
step 400, accuracy on validation batch: 0.75, accuracy on mal data: 0.433418
step 500, accuracy on validation batch: 0.765625, accuracy on mal data: 0.503699
step 600, accuracy on validation batch: 0.757812, accuracy on mal data: 0.559439
step 700, accuracy on validation batch: 0.765625, accuracy on mal data: 0.60102
step 800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.629592
step 900, accuracy on validation batch: 0.78125, accuracy on mal data: 0.653826
step 1000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.677041
step 1100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.693367
step 1200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.704081
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.714541
step 1400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.726786
step 1500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.73699
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.745025
step 1700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.752551
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.759949
step 1900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.764541
step 2000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.76926
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.77449
step 2200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.779974
step 2300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.784694
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.789923
step 2500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.792474
step 2600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.79477
step 2700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.796556
step 2800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.800765
step 2900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.802551
step 3000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.804974
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.805995
step 3200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.808546
step 3300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.810714
step 3400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.81199
step 3500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.814158
step 3600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.814923
step 3700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.815433
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.816709
step 3900, accuracy on validation batch: 0.875, accuracy on mal data: 0.817984
step 4000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.818495
step 4100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.819005
step 4200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819388
step 4300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.82028
step 4400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.820663
step 4500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.820918
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821811
step 4700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821811
step 4800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823214
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823342
step 5000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.823469
step 5100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823469
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823979
step 5300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825382
step 5400, accuracy on validation batch: 0.875, accuracy on mal data: 0.82602
step 5500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82653
step 5600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826785
step 5700, accuracy on validation batch: 0.875, accuracy on mal data: 0.827168
step 5800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.827423
step 5900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827551
step 6000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828061
step 6100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828571
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828826
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829081
step 6400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829209
step 6500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829464
step 6600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829592
step 6700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829592
step 6800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829719
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829974
step 7000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829974
step 7100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830229
step 7200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830612
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830612
step 7400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830867
step 7500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83125
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831505
step 7700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831632
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832525
step 7900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.833418
test set: accuracy on test set: 0.911
Done training net
0.911000020504
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.094898
step 100, accuracy on validation batch: 0.3125, accuracy on mal data: 0.165561
step 200, accuracy on validation batch: 0.445312, accuracy on mal data: 0.25102
step 300, accuracy on validation batch: 0.710938, accuracy on mal data: 0.343367
step 400, accuracy on validation batch: 0.71875, accuracy on mal data: 0.434566
step 500, accuracy on validation batch: 0.773438, accuracy on mal data: 0.512372
step 600, accuracy on validation batch: 0.875, accuracy on mal data: 0.565816
step 700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.604464
step 800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.634439
step 900, accuracy on validation batch: 0.8125, accuracy on mal data: 0.654337
step 1000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.672831
step 1100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.684821
step 1200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.696811
step 1300, accuracy on validation batch: 0.820312, accuracy on mal data: 0.714158
step 1400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.726913
step 1500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.732908
step 1600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.744388
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.754337
step 1800, accuracy on validation batch: 0.757812, accuracy on mal data: 0.76352
step 1900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.76926
step 2000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.77602
step 2100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.78176
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.785076
step 2300, accuracy on validation batch: 0.828125, accuracy on mal data: 0.789668
step 2400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.792729
step 2500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.795663
step 2600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.797831
step 2700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.80102
step 2800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.802678
step 2900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.804336
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.805612
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.808291
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.810459
step 3300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.811734
step 3400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.812627
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.814923
step 3600, accuracy on validation batch: 0.875, accuracy on mal data: 0.815178
step 3700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.815688
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.817092
step 3900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.817602
step 4000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.818622
step 4100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.819643
step 4200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.820025
step 4300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820408
step 4400, accuracy on validation batch: 0.8125, accuracy on mal data: 0.820535
step 4500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.821301
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821683
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822066
step 4800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.822449
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822704
step 5000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822959
step 5100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.824107
step 5200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.82449
step 5300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.824489
step 5400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825127
step 5500, accuracy on validation batch: 0.875, accuracy on mal data: 0.825
step 5600, accuracy on validation batch: 0.960938, accuracy on mal data: 0.82602
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826658
step 5800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827168
step 5900, accuracy on validation batch: 0.875, accuracy on mal data: 0.827806
step 6000, accuracy on validation batch: 0.875, accuracy on mal data: 0.827806
step 6100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827806
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827806
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828061
step 6400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828316
step 6500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828571
step 6600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829209
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829464
step 6800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829337
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829719
step 7000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830102
step 7100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830612
step 7200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83074
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830867
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83125
step 7500, accuracy on validation batch: 0.875, accuracy on mal data: 0.83125
step 7600, accuracy on validation batch: 0.875, accuracy on mal data: 0.831377
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831887
step 7800, accuracy on validation batch: 0.953125, accuracy on mal data: 0.83227
step 7900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.832398
test set: accuracy on test set: 0.910
Done training net
0.91030002892
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.125, accuracy on mal data: 0.0951531
step 100, accuracy on validation batch: 0.367188, accuracy on mal data: 0.17551
step 200, accuracy on validation batch: 0.570312, accuracy on mal data: 0.270663
step 300, accuracy on validation batch: 0.679688, accuracy on mal data: 0.363393
step 400, accuracy on validation batch: 0.632812, accuracy on mal data: 0.454082
step 500, accuracy on validation batch: 0.765625, accuracy on mal data: 0.524872
step 600, accuracy on validation batch: 0.734375, accuracy on mal data: 0.574362
step 700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.614413
step 800, accuracy on validation batch: 0.804688, accuracy on mal data: 0.637755
step 900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.662755
step 1000, accuracy on validation batch: 0.804688, accuracy on mal data: 0.682525
step 1100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.697704
step 1200, accuracy on validation batch: 0.789062, accuracy on mal data: 0.711352
step 1300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.722704
step 1400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.732653
step 1500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.742984
step 1600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.75102
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.759439
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.765561
step 1900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.770918
step 2000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.777551
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.782653
step 2200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.787245
step 2300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.790689
step 2400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.79375
step 2500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.796811
step 2600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.798342
step 2700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.800382
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.801658
step 2900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.803316
step 3000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.804974
step 3100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.807398
step 3200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.810842
step 3300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.812755
step 3400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.813775
step 3500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.814541
step 3600, accuracy on validation batch: 0.875, accuracy on mal data: 0.816709
step 3700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.817984
step 3800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.818622
step 3900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.819132
step 4000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81977
step 4100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82028
step 4200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.820918
step 4300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821556
step 4400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.822576
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822321
step 4600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.823214
step 4700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.823852
step 4800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824107
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824745
step 5000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824872
step 5100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.825255
step 5200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.82653
step 5300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82704
step 5400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827168
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828061
step 5600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828444
step 5700, accuracy on validation batch: 0.875, accuracy on mal data: 0.828444
step 5800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828316
step 5900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828571
step 6000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.828826
step 6100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829081
step 6200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829209
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829336
step 6400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.829336
step 6500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829336
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829592
step 6700, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829847
step 6800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830357
step 6900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830612
step 7000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830867
step 7100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831122
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83125
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831505
step 7400, accuracy on validation batch: 0.875, accuracy on mal data: 0.831887
step 7500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83227
step 7600, accuracy on validation batch: 0.875, accuracy on mal data: 0.83227
step 7700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83227
step 7800, accuracy on validation batch: 0.953125, accuracy on mal data: 0.832398
step 7900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832653
test set: accuracy on test set: 0.910
Done training net
0.910300020576
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 512, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 512, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.132812, accuracy on mal data: 0.105995
step 100, accuracy on validation batch: 0.367188, accuracy on mal data: 0.159694
step 200, accuracy on validation batch: 0.476562, accuracy on mal data: 0.240434
step 300, accuracy on validation batch: 0.71875, accuracy on mal data: 0.330102
step 400, accuracy on validation batch: 0.710938, accuracy on mal data: 0.416837
step 500, accuracy on validation batch: 0.8125, accuracy on mal data: 0.497449
step 600, accuracy on validation batch: 0.75, accuracy on mal data: 0.55102
step 700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.590944
step 800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.617474
step 900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.637245
step 1000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.659821
step 1100, accuracy on validation batch: 0.78125, accuracy on mal data: 0.672704
step 1200, accuracy on validation batch: 0.8125, accuracy on mal data: 0.692857
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.70574
step 1400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.717984
step 1500, accuracy on validation batch: 0.796875, accuracy on mal data: 0.730229
step 1600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.738903
step 1700, accuracy on validation batch: 0.875, accuracy on mal data: 0.746939
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.754719
step 1900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.761735
step 2000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.767602
step 2100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.772321
step 2200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.780229
step 2300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.782525
step 2400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.785204
step 2500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.788648
step 2600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.791709
step 2700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.794643
step 2800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.797704
step 2900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.80153
step 3000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.804974
step 3100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.80676
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.809821
step 3300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.811097
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.812627
step 3500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.813903
step 3600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.815051
step 3700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.816071
step 3800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816964
step 3900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817602
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.819132
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.820153
step 4200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820791
step 4300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.821683
step 4400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.822194
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822704
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824107
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825382
step 4800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825637
step 4900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82551
step 5000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.826275
step 5100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826658
step 5200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827296
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827296
step 5400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827678
step 5500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827806
step 5600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827806
step 5700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.827933
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827933
step 5900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828061
step 6000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828316
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828699
step 6200, accuracy on validation batch: 0.875, accuracy on mal data: 0.829081
step 6300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829336
step 6400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829592
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830229
step 6600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830357
step 6700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830484
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830867
step 6900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830867
step 7000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830995
step 7100, accuracy on validation batch: 0.953125, accuracy on mal data: 0.831122
step 7200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83125
step 7300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83125
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83125
step 7500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831887
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832015
step 7700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832015
step 7800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832015
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832015
test set: accuracy on test set: 0.911
Done training net
0.910900027156
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.0938776
step 100, accuracy on validation batch: 0.34375, accuracy on mal data: 0.167219
step 200, accuracy on validation batch: 0.570312, accuracy on mal data: 0.258418
step 300, accuracy on validation batch: 0.726562, accuracy on mal data: 0.353316
step 400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.434184
step 500, accuracy on validation batch: 0.78125, accuracy on mal data: 0.509184
step 600, accuracy on validation batch: 0.828125, accuracy on mal data: 0.566709
step 700, accuracy on validation batch: 0.789062, accuracy on mal data: 0.60727
step 800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.633036
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.658801
step 1000, accuracy on validation batch: 0.789062, accuracy on mal data: 0.678444
step 1100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.69477
step 1200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.71301
step 1300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.722449
step 1400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.732015
step 1500, accuracy on validation batch: 0.875, accuracy on mal data: 0.743877
step 1600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.751275
step 1700, accuracy on validation batch: 0.875, accuracy on mal data: 0.758291
step 1800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.762372
step 1900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.769898
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.774872
step 2100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.779847
step 2200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.786479
step 2300, accuracy on validation batch: 0.820312, accuracy on mal data: 0.790561
step 2400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.795153
step 2500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.797449
step 2600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.8
step 2700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.802806
step 2800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.804974
step 2900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.80778
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.808928
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.810331
step 3200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.811479
step 3300, accuracy on validation batch: 0.875, accuracy on mal data: 0.812882
step 3400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.813775
step 3500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.815051
step 3600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.815561
step 3700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.816964
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.818112
step 3900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.818622
step 4000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.819515
step 4100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.820153
step 4200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.821046
step 4300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821046
step 4400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.821428
step 4500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821811
step 4600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.822704
step 4700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823342
step 4800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.82449
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82449
step 5000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824745
step 5100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.824745
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824872
step 5300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825127
step 5400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825893
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826785
step 5600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.826785
step 5700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827423
step 5800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827678
step 5900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828188
step 6000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828699
step 6100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829209
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829336
step 6300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829847
step 6400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829847
step 6500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829847
step 6600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.829847
step 6700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829974
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830357
step 6900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830867
step 7000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83125
step 7100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83125
step 7200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831377
step 7300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831377
step 7400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.831632
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831632
step 7600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831632
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832015
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83227
step 7900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832398
test set: accuracy on test set: 0.910
Done training net
0.910000019073
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.140625, accuracy on mal data: 0.0869898
step 100, accuracy on validation batch: 0.335938, accuracy on mal data: 0.152041
step 200, accuracy on validation batch: 0.546875, accuracy on mal data: 0.239923
step 300, accuracy on validation batch: 0.6875, accuracy on mal data: 0.340306
step 400, accuracy on validation batch: 0.679688, accuracy on mal data: 0.438648
step 500, accuracy on validation batch: 0.773438, accuracy on mal data: 0.514286
step 600, accuracy on validation batch: 0.734375, accuracy on mal data: 0.566071
step 700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.605485
step 800, accuracy on validation batch: 0.820312, accuracy on mal data: 0.632143
step 900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.651148
step 1000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.667857
step 1100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.684566
step 1200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.7
step 1300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.714285
step 1400, accuracy on validation batch: 0.828125, accuracy on mal data: 0.727551
step 1500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.736479
step 1600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.749745
step 1700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.758291
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.764158
step 1900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.77028
step 2000, accuracy on validation batch: 0.875, accuracy on mal data: 0.774872
step 2100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.779209
step 2200, accuracy on validation batch: 0.875, accuracy on mal data: 0.785586
step 2300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.789923
step 2400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.793622
step 2500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.797321
step 2600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.799234
step 2700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.801148
step 2800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.804847
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.806122
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.808546
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.810459
step 3200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.812117
step 3300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.813903
step 3400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.814541
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.815561
step 3600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816199
step 3700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.816964
step 3800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817092
step 3900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817602
step 4000, accuracy on validation batch: 0.875, accuracy on mal data: 0.818622
step 4100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.81926
step 4200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81977
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820025
step 4400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821428
step 4500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.822321
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822831
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822959
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823469
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824234
step 5000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.82449
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824872
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825382
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825382
step 5400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825382
step 5500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826148
step 5600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826658
step 5700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82704
step 5800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827296
step 5900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827678
step 6000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828061
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828316
step 6200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828571
step 6300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828699
step 6400, accuracy on validation batch: 0.875, accuracy on mal data: 0.829209
step 6500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829336
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830229
step 6700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830102
step 6800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830484
step 6900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.830867
step 7000, accuracy on validation batch: 0.875, accuracy on mal data: 0.830612
step 7100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831122
step 7200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831122
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831377
step 7400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83176
step 7500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.83227
step 7600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83227
step 7700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832398
step 7800, accuracy on validation batch: 0.875, accuracy on mal data: 0.832398
step 7900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832653
test set: accuracy on test set: 0.909
Done training net
0.90890001893
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.078125, accuracy on mal data: 0.103189
step 100, accuracy on validation batch: 0.34375, accuracy on mal data: 0.18227
step 200, accuracy on validation batch: 0.570312, accuracy on mal data: 0.27449
step 300, accuracy on validation batch: 0.765625, accuracy on mal data: 0.36148
step 400, accuracy on validation batch: 0.757812, accuracy on mal data: 0.440944
step 500, accuracy on validation batch: 0.765625, accuracy on mal data: 0.516837
step 600, accuracy on validation batch: 0.773438, accuracy on mal data: 0.571301
step 700, accuracy on validation batch: 0.796875, accuracy on mal data: 0.609949
step 800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.636607
step 900, accuracy on validation batch: 0.75, accuracy on mal data: 0.655995
step 1000, accuracy on validation batch: 0.875, accuracy on mal data: 0.672959
step 1100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.689923
step 1200, accuracy on validation batch: 0.8125, accuracy on mal data: 0.702551
step 1300, accuracy on validation batch: 0.8125, accuracy on mal data: 0.715178
step 1400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.725893
step 1500, accuracy on validation batch: 0.875, accuracy on mal data: 0.735331
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.745791
step 1700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.752678
step 1800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.760076
step 1900, accuracy on validation batch: 0.820312, accuracy on mal data: 0.769643
step 2000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.774872
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.778316
step 2200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.783291
step 2300, accuracy on validation batch: 0.828125, accuracy on mal data: 0.786607
step 2400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.789413
step 2500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.794388
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.797194
step 2700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.798724
step 2800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.799745
step 2900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.803316
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.804209
step 3100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.804847
step 3200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.807398
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.808928
step 3400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.810969
step 3500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.812245
step 3600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.813137
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.813393
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.814158
step 3900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.815433
step 4000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.816454
step 4100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816964
step 4200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.818622
step 4300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.819515
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.81977
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820918
step 4600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822831
step 4700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823086
step 4800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.823597
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823852
step 5000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.823852
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824617
step 5200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.825
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825637
step 5400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826275
step 5500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.826275
step 5600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827041
step 5700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.826913
step 5800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827168
step 5900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827168
step 6000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827296
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827678
step 6200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828188
step 6300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.828954
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828954
step 6500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829081
step 6600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829081
step 6700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829209
step 6800, accuracy on validation batch: 0.875, accuracy on mal data: 0.829336
step 6900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829974
step 7000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830102
step 7100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830229
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83074
step 7300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.83074
step 7400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.83125
step 7500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831377
step 7600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832015
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832015
step 7800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832143
step 7900, accuracy on validation batch: 0.875, accuracy on mal data: 0.832143
test set: accuracy on test set: 0.910
Done training net
0.910300024748
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.171875, accuracy on mal data: 0.102423
step 100, accuracy on validation batch: 0.40625, accuracy on mal data: 0.173214
step 200, accuracy on validation batch: 0.523438, accuracy on mal data: 0.257015
step 300, accuracy on validation batch: 0.648438, accuracy on mal data: 0.353189
step 400, accuracy on validation batch: 0.65625, accuracy on mal data: 0.444133
step 500, accuracy on validation batch: 0.789062, accuracy on mal data: 0.517347
step 600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.567474
step 700, accuracy on validation batch: 0.773438, accuracy on mal data: 0.607143
step 800, accuracy on validation batch: 0.820312, accuracy on mal data: 0.633291
step 900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.655612
step 1000, accuracy on validation batch: 0.875, accuracy on mal data: 0.66977
step 1100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.684566
step 1200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.698214
step 1300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.710204
step 1400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.723724
step 1500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.735204
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.743495
step 1700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.753316
step 1800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.758291
step 1900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.764668
step 2000, accuracy on validation batch: 0.875, accuracy on mal data: 0.76875
step 2100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.773086
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.779592
step 2300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.782908
step 2400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.786734
step 2500, accuracy on validation batch: 0.875, accuracy on mal data: 0.788903
step 2600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.790816
step 2700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.792602
step 2800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.79528
step 2900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.798852
step 3000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.802168
step 3100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.804847
step 3200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.806377
step 3300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.807908
step 3400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.809311
step 3500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.810714
step 3600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.811097
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.812117
step 3800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.813903
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815688
step 4000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.816709
step 4100, accuracy on validation batch: 0.953125, accuracy on mal data: 0.816964
step 4200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817474
step 4300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.819388
step 4400, accuracy on validation batch: 0.875, accuracy on mal data: 0.820535
step 4500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.820918
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821556
step 4700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822449
step 4800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.822959
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823214
step 5000, accuracy on validation batch: 0.875, accuracy on mal data: 0.823979
step 5100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.825
step 5200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825127
step 5300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.82551
step 5400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.826275
step 5500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826913
step 5600, accuracy on validation batch: 0.875, accuracy on mal data: 0.827168
step 5700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827678
step 5800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827933
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828061
step 6000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828188
step 6100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828444
step 6200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.828444
step 6300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828699
step 6400, accuracy on validation batch: 0.960938, accuracy on mal data: 0.828954
step 6500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829209
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829719
step 6700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829974
step 6800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830229
step 6900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830484
step 7000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83074
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83074
step 7200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830867
step 7300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830739
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831377
step 7500, accuracy on validation batch: 0.875, accuracy on mal data: 0.831632
step 7600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83176
step 7700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83176
step 7800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832398
step 7900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832525
test set: accuracy on test set: 0.912
Done training net
0.911800026298
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 64, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 64, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.171875, accuracy on mal data: 0.098852
step 100, accuracy on validation batch: 0.34375, accuracy on mal data: 0.156378
step 200, accuracy on validation batch: 0.632812, accuracy on mal data: 0.228444
step 300, accuracy on validation batch: 0.742188, accuracy on mal data: 0.34375
step 400, accuracy on validation batch: 0.75, accuracy on mal data: 0.440306
step 500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.50676
step 600, accuracy on validation batch: 0.757812, accuracy on mal data: 0.553189
step 700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.592857
step 800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.61875
step 900, accuracy on validation batch: 0.765625, accuracy on mal data: 0.640944
step 1000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.663775
step 1100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.680612
step 1200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.696556
step 1300, accuracy on validation batch: 0.820312, accuracy on mal data: 0.71352
step 1400, accuracy on validation batch: 0.875, accuracy on mal data: 0.723979
step 1500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.736479
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.742984
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.747576
step 1800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.753954
step 1900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.760587
step 2000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.769643
step 2100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.775382
step 2200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.780739
step 2300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.784311
step 2400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.787882
step 2500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.791837
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.794643
step 2700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.798469
step 2800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.800765
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.801913
step 3000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.803954
step 3100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.805484
step 3200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.808035
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.808928
step 3400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.809694
step 3500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.811862
step 3600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.813648
step 3700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.814158
step 3800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815433
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816071
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816199
step 4100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817857
step 4200, accuracy on validation batch: 0.875, accuracy on mal data: 0.81977
step 4300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.820535
step 4400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.820918
step 4500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821301
step 4600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.821683
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821939
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823214
step 4900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.823469
step 5000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.824362
step 5100, accuracy on validation batch: 0.875, accuracy on mal data: 0.824745
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825382
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825638
step 5400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.82602
step 5500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.826275
step 5600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.82653
step 5700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826913
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827423
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827551
step 6000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827806
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828189
step 6200, accuracy on validation batch: 0.945312, accuracy on mal data: 0.828699
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828954
step 6400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829209
step 6500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830102
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830612
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830612
step 6800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831377
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831377
step 7000, accuracy on validation batch: 0.953125, accuracy on mal data: 0.83176
step 7100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832015
step 7200, accuracy on validation batch: 0.960938, accuracy on mal data: 0.832015
step 7300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832015
step 7400, accuracy on validation batch: 0.875, accuracy on mal data: 0.832143
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832143
step 7600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832143
step 7700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832143
step 7800, accuracy on validation batch: 0.875, accuracy on mal data: 0.832398
step 7900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.832653
test set: accuracy on test set: 0.909
Done training net
0.909200026393
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.101562, accuracy on mal data: 0.103061
step 100, accuracy on validation batch: 0.257812, accuracy on mal data: 0.167219
step 200, accuracy on validation batch: 0.546875, accuracy on mal data: 0.262372
step 300, accuracy on validation batch: 0.601562, accuracy on mal data: 0.346046
step 400, accuracy on validation batch: 0.773438, accuracy on mal data: 0.435587
step 500, accuracy on validation batch: 0.78125, accuracy on mal data: 0.508801
step 600, accuracy on validation batch: 0.8125, accuracy on mal data: 0.559184
step 700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.59273
step 800, accuracy on validation batch: 0.796875, accuracy on mal data: 0.625255
step 900, accuracy on validation batch: 0.8125, accuracy on mal data: 0.649745
step 1000, accuracy on validation batch: 0.796875, accuracy on mal data: 0.665306
step 1100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.682398
step 1200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.702041
step 1300, accuracy on validation batch: 0.8125, accuracy on mal data: 0.716071
step 1400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.725638
step 1500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.7375
step 1600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.745025
step 1700, accuracy on validation batch: 0.78125, accuracy on mal data: 0.752168
step 1800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.759949
step 1900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.767602
step 2000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.772576
step 2100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.778061
step 2200, accuracy on validation batch: 0.875, accuracy on mal data: 0.78074
step 2300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.783801
step 2400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.785586
step 2500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.789541
step 2600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.792347
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.796428
step 2800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.797576
step 2900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.799617
step 3000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.801913
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.805357
step 3200, accuracy on validation batch: 0.875, accuracy on mal data: 0.806632
step 3300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.808035
step 3400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.809949
step 3500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.811224
step 3600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81352
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815051
step 3800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816071
step 3900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816964
step 4000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.818112
step 4100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.819643
step 4200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.820791
step 4300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822831
step 4400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823469
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823597
step 4600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.824107
step 4700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825
step 4800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825382
step 4900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825255
step 5000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825893
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825893
step 5200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.82602
step 5300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.826148
step 5400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.82653
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827041
step 5600, accuracy on validation batch: 0.875, accuracy on mal data: 0.828061
step 5700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.828188
step 5800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828188
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828699
step 6000, accuracy on validation batch: 0.953125, accuracy on mal data: 0.828699
step 6100, accuracy on validation batch: 0.953125, accuracy on mal data: 0.828954
step 6200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829336
step 6300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829592
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829592
step 6500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829719
step 6600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829974
step 6700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829974
step 6800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830357
step 6900, accuracy on validation batch: 0.875, accuracy on mal data: 0.830612
step 7000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83125
step 7100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83125
step 7200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831505
step 7300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83176
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831887
step 7500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83227
step 7600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83227
step 7700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.833163
step 7800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.833035
step 7900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.833163
test set: accuracy on test set: 0.912
Done training net
0.911900020242
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 8, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 8, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0234375, accuracy on mal data: 0.0961735
step 100, accuracy on validation batch: 0.117188, accuracy on mal data: 0.168367
step 200, accuracy on validation batch: 0.34375, accuracy on mal data: 0.262755
step 300, accuracy on validation batch: 0.617188, accuracy on mal data: 0.369643
step 400, accuracy on validation batch: 0.617188, accuracy on mal data: 0.459311
step 500, accuracy on validation batch: 0.671875, accuracy on mal data: 0.524872
step 600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.578444
step 700, accuracy on validation batch: 0.804688, accuracy on mal data: 0.610587
step 800, accuracy on validation batch: 0.765625, accuracy on mal data: 0.636735
step 900, accuracy on validation batch: 0.765625, accuracy on mal data: 0.651913
step 1000, accuracy on validation batch: 0.8125, accuracy on mal data: 0.672449
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.689286
step 1200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.703444
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.713265
step 1400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.721556
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.730485
step 1600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.740051
step 1700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.750382
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.75676
step 1900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.765051
step 2000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.773724
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.778061
step 2200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.782908
step 2300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.786097
step 2400, accuracy on validation batch: 0.875, accuracy on mal data: 0.78852
step 2500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.791071
step 2600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.79528
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.798852
step 2800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.801403
step 2900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.803699
step 3000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.805229
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.806888
step 3200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.808801
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.809311
step 3400, accuracy on validation batch: 0.875, accuracy on mal data: 0.811862
step 3500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.812627
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.813903
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815051
step 3800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.816199
step 3900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817474
step 4000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.818367
step 4100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.819005
step 4200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.819898
step 4300, accuracy on validation batch: 0.875, accuracy on mal data: 0.82028
step 4400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.820918
step 4500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821811
step 4600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822194
step 4700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822831
step 4800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823087
step 4900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.823852
step 5000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82449
step 5100, accuracy on validation batch: 0.875, accuracy on mal data: 0.824617
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824617
step 5300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825
step 5400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.824872
step 5500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825255
step 5700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.82551
step 5800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.825765
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826148
step 6000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.826658
step 6100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827296
step 6200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827423
step 6300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.827933
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828571
step 6500, accuracy on validation batch: 0.960938, accuracy on mal data: 0.828954
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829592
step 6700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829847
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829974
step 6900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830102
step 7000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830229
step 7100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830229
step 7200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830739
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830612
step 7400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831122
step 7500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831505
step 7600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831632
step 7700, accuracy on validation batch: 0.945312, accuracy on mal data: 0.83227
step 7800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83227
step 7900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.832398
test set: accuracy on test set: 0.910
Done training net
0.910400025249
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.046875, accuracy on mal data: 0.11301
step 100, accuracy on validation batch: 0.265625, accuracy on mal data: 0.183673
step 200, accuracy on validation batch: 0.484375, accuracy on mal data: 0.272449
step 300, accuracy on validation batch: 0.71875, accuracy on mal data: 0.355485
step 400, accuracy on validation batch: 0.734375, accuracy on mal data: 0.43648
step 500, accuracy on validation batch: 0.679688, accuracy on mal data: 0.503061
step 600, accuracy on validation batch: 0.804688, accuracy on mal data: 0.562883
step 700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.594005
step 800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.620918
step 900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.645281
step 1000, accuracy on validation batch: 0.796875, accuracy on mal data: 0.664923
step 1100, accuracy on validation batch: 0.757812, accuracy on mal data: 0.679337
step 1200, accuracy on validation batch: 0.8125, accuracy on mal data: 0.695408
step 1300, accuracy on validation batch: 0.796875, accuracy on mal data: 0.706888
step 1400, accuracy on validation batch: 0.820312, accuracy on mal data: 0.718622
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.726786
step 1600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.735969
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.745025
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.752678
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.759566
step 2000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.767857
step 2100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.772321
step 2200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.776658
step 2300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.782015
step 2400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.787882
step 2500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.791581
step 2600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.794643
step 2700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.798086
step 2800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.799872
step 2900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.803061
step 3000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.805995
step 3100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.80676
step 3200, accuracy on validation batch: 0.953125, accuracy on mal data: 0.809438
step 3300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.811734
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.813137
step 3500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.814668
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.814923
step 3700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.815178
step 3800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.816454
step 3900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817729
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.818112
step 4100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819387
step 4200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.820918
step 4300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821301
step 4400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.821811
step 4500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.823214
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823597
step 4700, accuracy on validation batch: 0.875, accuracy on mal data: 0.823852
step 4800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824617
step 4900, accuracy on validation batch: 0.953125, accuracy on mal data: 0.824872
step 5000, accuracy on validation batch: 0.960938, accuracy on mal data: 0.825255
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82551
step 5200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825637
step 5300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825765
step 5400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826785
step 5500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827168
step 5600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827806
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827933
step 5800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828188
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828699
step 6000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828826
step 6100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829336
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829847
step 6300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.829847
step 6400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830102
step 6500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830229
step 6600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830484
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830612
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830867
step 6900, accuracy on validation batch: 0.953125, accuracy on mal data: 0.831122
step 7000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831377
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832015
step 7200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832015
step 7300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832653
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832653
step 7500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83278
step 7600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.832908
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832908
step 7800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.833035
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.833163
test set: accuracy on test set: 0.911
Done training net
0.911300016046
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 256, 'nb_neurons_2': 8, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 256, 'nb_neurons_2': 8, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.132812, accuracy on mal data: 0.119005
step 100, accuracy on validation batch: 0.25, accuracy on mal data: 0.176148
step 200, accuracy on validation batch: 0.414062, accuracy on mal data: 0.25574
step 300, accuracy on validation batch: 0.664062, accuracy on mal data: 0.336097
step 400, accuracy on validation batch: 0.765625, accuracy on mal data: 0.419388
step 500, accuracy on validation batch: 0.75, accuracy on mal data: 0.49477
step 600, accuracy on validation batch: 0.71875, accuracy on mal data: 0.553699
step 700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.596429
step 800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.61926
step 900, accuracy on validation batch: 0.796875, accuracy on mal data: 0.639286
step 1000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.658673
step 1100, accuracy on validation batch: 0.8125, accuracy on mal data: 0.672321
step 1200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.686224
step 1300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.700638
step 1400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.711224
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.722831
step 1600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.732398
step 1700, accuracy on validation batch: 0.875, accuracy on mal data: 0.741709
step 1800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.748597
step 1900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.754337
step 2000, accuracy on validation batch: 0.875, accuracy on mal data: 0.759694
step 2100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.764286
step 2200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.772959
step 2300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.779464
step 2400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.784438
step 2500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.789923
step 2600, accuracy on validation batch: 0.828125, accuracy on mal data: 0.792092
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.79528
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.797704
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.802551
step 3000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.803954
step 3100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.805995
step 3200, accuracy on validation batch: 0.875, accuracy on mal data: 0.807015
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.808546
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.812245
step 3500, accuracy on validation batch: 0.875, accuracy on mal data: 0.81403
step 3600, accuracy on validation batch: 0.875, accuracy on mal data: 0.815178
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816454
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.816836
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.818112
step 4000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.819388
step 4100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820535
step 4200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821173
step 4300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.821301
step 4400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821811
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822321
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822831
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823214
step 4800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.824234
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82449
step 5000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825
step 5100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825382
step 5200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825382
step 5300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.825765
step 5400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82653
step 5500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826785
step 5600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827168
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827168
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827296
step 5900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.827933
step 6000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827933
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828316
step 6200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828444
step 6300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828699
step 6400, accuracy on validation batch: 0.960938, accuracy on mal data: 0.828826
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829464
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829336
step 6700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829592
step 6800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829591
step 6900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829719
step 7000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829974
step 7100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830229
step 7200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830484
step 7300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830612
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830612
step 7500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830739
step 7600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830995
step 7700, accuracy on validation batch: 0.875, accuracy on mal data: 0.83125
step 7800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831505
step 7900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831505
test set: accuracy on test set: 0.910
Done training net
0.910400019884
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.105995
step 100, accuracy on validation batch: 0.382812, accuracy on mal data: 0.18176
step 200, accuracy on validation batch: 0.53125, accuracy on mal data: 0.267219
step 300, accuracy on validation batch: 0.601562, accuracy on mal data: 0.360332
step 400, accuracy on validation batch: 0.703125, accuracy on mal data: 0.447832
step 500, accuracy on validation batch: 0.710938, accuracy on mal data: 0.51824
step 600, accuracy on validation batch: 0.78125, accuracy on mal data: 0.570025
step 700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.6125
step 800, accuracy on validation batch: 0.773438, accuracy on mal data: 0.646046
step 900, accuracy on validation batch: 0.796875, accuracy on mal data: 0.665816
step 1000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.68278
step 1100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.699745
step 1200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.713903
step 1300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.726148
step 1400, accuracy on validation batch: 0.796875, accuracy on mal data: 0.735842
step 1500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.746683
step 1600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.756887
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.762372
step 1800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.767857
step 1900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.773214
step 2000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.779974
step 2100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.784438
step 2200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.788775
step 2300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.792602
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.794898
step 2500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.797321
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.79949
step 2700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.800893
step 2800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.803189
step 2900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.805229
step 3000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.805867
step 3100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.807015
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.807525
step 3300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.809694
step 3400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.812117
step 3500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.813138
step 3600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.81352
step 3700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.814668
step 3800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.815178
step 3900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816836
step 4000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817092
step 4100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.817347
step 4200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.818622
step 4300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.819132
step 4400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819515
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820025
step 4600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.820408
step 4700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820918
step 4800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.821683
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823979
step 5000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.824362
step 5100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824745
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825255
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82551
step 5400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825765
step 5500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825893
step 5600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826275
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827296
step 5800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827423
step 5900, accuracy on validation batch: 0.953125, accuracy on mal data: 0.827551
step 6000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827551
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828061
step 6200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828189
step 6300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828316
step 6400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828316
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828444
step 6600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829081
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829592
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829719
step 6900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829719
step 7000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829719
step 7100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829719
step 7200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.830612
step 7300, accuracy on validation batch: 0.953125, accuracy on mal data: 0.830995
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831632
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831632
step 7600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.83176
step 7700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83227
step 7800, accuracy on validation batch: 0.875, accuracy on mal data: 0.832653
step 7900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832653
test set: accuracy on test set: 0.910
Done training net
0.909800024033
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.078125, accuracy on mal data: 0.101913
step 100, accuracy on validation batch: 0.296875, accuracy on mal data: 0.160714
step 200, accuracy on validation batch: 0.515625, accuracy on mal data: 0.246811
step 300, accuracy on validation batch: 0.710938, accuracy on mal data: 0.345791
step 400, accuracy on validation batch: 0.710938, accuracy on mal data: 0.441199
step 500, accuracy on validation batch: 0.765625, accuracy on mal data: 0.517474
step 600, accuracy on validation batch: 0.695312, accuracy on mal data: 0.571939
step 700, accuracy on validation batch: 0.8125, accuracy on mal data: 0.615434
step 800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.642219
step 900, accuracy on validation batch: 0.765625, accuracy on mal data: 0.663138
step 1000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.679209
step 1100, accuracy on validation batch: 0.8125, accuracy on mal data: 0.692602
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.703699
step 1300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.716071
step 1400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.72653
step 1500, accuracy on validation batch: 0.875, accuracy on mal data: 0.735204
step 1600, accuracy on validation batch: 0.828125, accuracy on mal data: 0.740561
step 1700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.748342
step 1800, accuracy on validation batch: 0.820312, accuracy on mal data: 0.756122
step 1900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.764158
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.769388
step 2100, accuracy on validation batch: 0.875, accuracy on mal data: 0.776785
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.781505
step 2300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.785969
step 2400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.788648
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.792474
step 2600, accuracy on validation batch: 0.765625, accuracy on mal data: 0.795408
step 2700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.796938
step 2800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.799745
step 2900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.800127
step 3000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.802296
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.805229
step 3200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.807015
step 3300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.809183
step 3400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.811224
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.812372
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.814541
step 3700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.814923
step 3800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.816581
step 3900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817857
step 4000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.818367
step 4100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.819387
step 4200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.820918
step 4300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821428
step 4400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821938
step 4500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822066
step 4600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822576
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822576
step 4800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823214
step 4900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823214
step 5000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823979
step 5100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824872
step 5200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825255
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825638
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826148
step 5500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82653
step 5600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.827041
step 5700, accuracy on validation batch: 0.796875, accuracy on mal data: 0.827168
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827551
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827678
step 6000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827806
step 6100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828316
step 6200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828316
step 6300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828444
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828444
step 6500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828571
step 6600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829209
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829592
step 6800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829847
step 6900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830357
step 7000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830739
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830867
step 7200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83125
step 7300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83125
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831377
step 7500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831377
step 7600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831632
step 7700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831632
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832015
step 7900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832653
test set: accuracy on test set: 0.910
Done training net
0.909700022936
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 256, 'nb_neurons_2': 8, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 256, 'nb_neurons_2': 8, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.109375, accuracy on mal data: 0.109821
step 100, accuracy on validation batch: 0.328125, accuracy on mal data: 0.159821
step 200, accuracy on validation batch: 0.5, accuracy on mal data: 0.250128
step 300, accuracy on validation batch: 0.703125, accuracy on mal data: 0.339668
step 400, accuracy on validation batch: 0.71875, accuracy on mal data: 0.427551
step 500, accuracy on validation batch: 0.796875, accuracy on mal data: 0.496556
step 600, accuracy on validation batch: 0.828125, accuracy on mal data: 0.541964
step 700, accuracy on validation batch: 0.757812, accuracy on mal data: 0.584694
step 800, accuracy on validation batch: 0.820312, accuracy on mal data: 0.617985
step 900, accuracy on validation batch: 0.757812, accuracy on mal data: 0.641709
step 1000, accuracy on validation batch: 0.789062, accuracy on mal data: 0.663903
step 1100, accuracy on validation batch: 0.820312, accuracy on mal data: 0.682653
step 1200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.698979
step 1300, accuracy on validation batch: 0.757812, accuracy on mal data: 0.714541
step 1400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.725765
step 1500, accuracy on validation batch: 0.804688, accuracy on mal data: 0.736479
step 1600, accuracy on validation batch: 0.773438, accuracy on mal data: 0.744005
step 1700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.75153
step 1800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.758546
step 1900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.765816
step 2000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.771173
step 2100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.775638
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.780995
step 2300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.786352
step 2400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.788648
step 2500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.790816
step 2600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.792984
step 2700, accuracy on validation batch: 0.875, accuracy on mal data: 0.797066
step 2800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.798979
step 2900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.801913
step 3000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.804847
step 3100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.805612
step 3200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.807525
step 3300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.809566
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.811097
step 3500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.812755
step 3600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.813903
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.814796
step 3800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816964
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.817602
step 4000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817857
step 4100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.819515
step 4200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820408
step 4300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.821173
step 4400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.821811
step 4500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.823087
step 4600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823087
step 4700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824107
step 4800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824617
step 4900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825382
step 5000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.826148
step 5100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826403
step 5200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827041
step 5300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827041
step 5400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828316
step 5500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829209
step 5600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829847
step 5700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829719
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829592
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829847
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829847
step 6100, accuracy on validation batch: 0.820312, accuracy on mal data: 0.829847
step 6200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.830229
step 6300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830229
step 6400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.830357
step 6500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830995
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831377
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83125
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831632
step 6900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.831632
step 7000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831632
step 7100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.832015
step 7200, accuracy on validation batch: 0.875, accuracy on mal data: 0.83227
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832525
step 7400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.832653
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832653
step 7600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83278
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.833035
step 7800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.833291
step 7900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.833546
test set: accuracy on test set: 0.912
Done training net
0.911500018239
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 512, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 512, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.125, accuracy on mal data: 0.105102
step 100, accuracy on validation batch: 0.234375, accuracy on mal data: 0.163138
step 200, accuracy on validation batch: 0.492188, accuracy on mal data: 0.249617
step 300, accuracy on validation batch: 0.679688, accuracy on mal data: 0.353826
step 400, accuracy on validation batch: 0.664062, accuracy on mal data: 0.441837
step 500, accuracy on validation batch: 0.734375, accuracy on mal data: 0.509439
step 600, accuracy on validation batch: 0.789062, accuracy on mal data: 0.559439
step 700, accuracy on validation batch: 0.78125, accuracy on mal data: 0.597194
step 800, accuracy on validation batch: 0.789062, accuracy on mal data: 0.629592
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.653571
step 1000, accuracy on validation batch: 0.742188, accuracy on mal data: 0.67449
step 1100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.696684
step 1200, accuracy on validation batch: 0.804688, accuracy on mal data: 0.710459
step 1300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.72602
step 1400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.733673
step 1500, accuracy on validation batch: 0.875, accuracy on mal data: 0.742729
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.750127
step 1700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.759056
step 1800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.765178
step 1900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.772194
step 2000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.776785
step 2100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.780484
step 2200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.784949
step 2300, accuracy on validation batch: 0.8125, accuracy on mal data: 0.7875
step 2400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.792474
step 2500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.79528
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.797194
step 2700, accuracy on validation batch: 0.804688, accuracy on mal data: 0.80051
step 2800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.802296
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.804847
step 3000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.804974
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.80676
step 3200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.808673
step 3300, accuracy on validation batch: 0.945312, accuracy on mal data: 0.809566
step 3400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.810587
step 3500, accuracy on validation batch: 0.828125, accuracy on mal data: 0.8125
step 3600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.81352
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.814541
step 3800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817092
step 3900, accuracy on validation batch: 0.875, accuracy on mal data: 0.817729
step 4000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.81875
step 4100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.82028
step 4200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.821173
step 4300, accuracy on validation batch: 0.875, accuracy on mal data: 0.822066
step 4400, accuracy on validation batch: 0.953125, accuracy on mal data: 0.823086
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823469
step 4600, accuracy on validation batch: 0.875, accuracy on mal data: 0.823469
step 4700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823724
step 4800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.824617
step 4900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824745
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.82551
step 5100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825765
step 5200, accuracy on validation batch: 0.945312, accuracy on mal data: 0.825637
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82653
step 5400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.82653
step 5500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826785
step 5600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826913
step 5700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827423
step 5800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827423
step 5900, accuracy on validation batch: 0.875, accuracy on mal data: 0.828061
step 6000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828699
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829337
step 6200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829719
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829847
step 6400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.830229
step 6500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830229
step 6600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.830102
step 6700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830357
step 6800, accuracy on validation batch: 0.875, accuracy on mal data: 0.830229
step 6900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830229
step 7000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.830229
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830229
step 7200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830229
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830229
step 7400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830357
step 7500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830484
step 7600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830867
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83125
step 7800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831632
step 7900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831632
test set: accuracy on test set: 0.910
Done training net
0.909600027204
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.125, accuracy on mal data: 0.0799745
step 100, accuracy on validation batch: 0.359375, accuracy on mal data: 0.157781
step 200, accuracy on validation batch: 0.554688, accuracy on mal data: 0.239668
step 300, accuracy on validation batch: 0.695312, accuracy on mal data: 0.326148
step 400, accuracy on validation batch: 0.765625, accuracy on mal data: 0.423087
step 500, accuracy on validation batch: 0.757812, accuracy on mal data: 0.499617
step 600, accuracy on validation batch: 0.726562, accuracy on mal data: 0.551531
step 700, accuracy on validation batch: 0.757812, accuracy on mal data: 0.590051
step 800, accuracy on validation batch: 0.773438, accuracy on mal data: 0.621811
step 900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.646811
step 1000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.663648
step 1100, accuracy on validation batch: 0.875, accuracy on mal data: 0.680867
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.699235
step 1300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.715561
step 1400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.727678
step 1500, accuracy on validation batch: 0.78125, accuracy on mal data: 0.735969
step 1600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.747959
step 1700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.755485
step 1800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.763265
step 1900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.771428
step 2000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.778699
step 2100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.782143
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.786862
step 2300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.790689
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.792984
step 2500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.797321
step 2600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.801148
step 2700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.801785
step 2800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.803444
step 2900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.804719
step 3000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.80727
step 3100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.809183
step 3200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.809694
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.810331
step 3400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.811224
step 3500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.81199
step 3600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.813265
step 3700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.81403
step 3800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.814541
step 3900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.815689
step 4000, accuracy on validation batch: 0.875, accuracy on mal data: 0.816709
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.817729
step 4200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.818495
step 4300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.819005
step 4400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.819387
step 4500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.819898
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82028
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821428
step 4800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.823214
step 4900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.823724
step 5000, accuracy on validation batch: 0.875, accuracy on mal data: 0.824107
step 5100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824489
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825255
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82551
step 5400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82551
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825893
step 5600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826148
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826913
step 5800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826913
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827423
step 6000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827551
step 6100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827551
step 6200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828188
step 6300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828571
step 6400, accuracy on validation batch: 0.96875, accuracy on mal data: 0.828571
step 6500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829209
step 6600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829336
step 6700, accuracy on validation batch: 0.953125, accuracy on mal data: 0.829592
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829847
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830612
step 7000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830995
step 7100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830995
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83125
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831377
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831887
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831887
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831887
step 7700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831887
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831887
step 7900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.832015
test set: accuracy on test set: 0.910
Done training net
0.909700024724
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 8, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 8, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0934949
step 100, accuracy on validation batch: 0.367188, accuracy on mal data: 0.172321
step 200, accuracy on validation batch: 0.609375, accuracy on mal data: 0.251658
step 300, accuracy on validation batch: 0.734375, accuracy on mal data: 0.333929
step 400, accuracy on validation batch: 0.773438, accuracy on mal data: 0.429974
step 500, accuracy on validation batch: 0.78125, accuracy on mal data: 0.508163
step 600, accuracy on validation batch: 0.796875, accuracy on mal data: 0.569005
step 700, accuracy on validation batch: 0.734375, accuracy on mal data: 0.611607
step 800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.638903
step 900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.653826
step 1000, accuracy on validation batch: 0.875, accuracy on mal data: 0.671939
step 1100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.68903
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.703189
step 1300, accuracy on validation batch: 0.796875, accuracy on mal data: 0.71824
step 1400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.729974
step 1500, accuracy on validation batch: 0.875, accuracy on mal data: 0.739923
step 1600, accuracy on validation batch: 0.796875, accuracy on mal data: 0.748979
step 1700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.755995
step 1800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.759566
step 1900, accuracy on validation batch: 0.875, accuracy on mal data: 0.767347
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.770153
step 2100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.775638
step 2200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.779592
step 2300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.783035
step 2400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.788775
step 2500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.791454
step 2600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.79426
step 2700, accuracy on validation batch: 0.875, accuracy on mal data: 0.796683
step 2800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.799617
step 2900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.801403
step 3000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.804719
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.805484
step 3200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.807525
step 3300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.810076
step 3400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.811607
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.813138
step 3600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.813903
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.814541
step 3800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.814923
step 3900, accuracy on validation batch: 0.875, accuracy on mal data: 0.816071
step 4000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817219
step 4100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.818367
step 4200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.819387
step 4300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.819643
step 4400, accuracy on validation batch: 0.875, accuracy on mal data: 0.820535
step 4500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.821683
step 4600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822194
step 4700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.822959
step 4800, accuracy on validation batch: 0.960938, accuracy on mal data: 0.823214
step 4900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.823342
step 5000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823342
step 5100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823469
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824617
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824745
step 5400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.825382
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825893
step 5600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.826148
step 5700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.826403
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827168
step 5900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827296
step 6000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827423
step 6100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827806
step 6200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827806
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828189
step 6400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828444
step 6500, accuracy on validation batch: 0.875, accuracy on mal data: 0.828826
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829337
step 6700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829336
step 6800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829592
step 6900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829974
step 7000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830357
step 7100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830612
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830739
step 7300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830739
step 7400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83125
step 7500, accuracy on validation batch: 0.875, accuracy on mal data: 0.83125
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831632
step 7700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831632
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831887
step 7900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832143
test set: accuracy on test set: 0.910
Done training net
0.90970001936
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.10574
step 100, accuracy on validation batch: 0.304688, accuracy on mal data: 0.172194
step 200, accuracy on validation batch: 0.585938, accuracy on mal data: 0.258163
step 300, accuracy on validation batch: 0.65625, accuracy on mal data: 0.344133
step 400, accuracy on validation batch: 0.757812, accuracy on mal data: 0.434311
step 500, accuracy on validation batch: 0.757812, accuracy on mal data: 0.508673
step 600, accuracy on validation batch: 0.796875, accuracy on mal data: 0.559439
step 700, accuracy on validation batch: 0.804688, accuracy on mal data: 0.600127
step 800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.626275
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.650893
step 1000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.671173
step 1100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.691709
step 1200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.705229
step 1300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.716709
step 1400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.725765
step 1500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.734694
step 1600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.744898
step 1700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.752041
step 1800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.760714
step 1900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.766837
step 2000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.771683
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.779592
step 2200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.783546
step 2300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.789796
step 2400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.792474
step 2500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.795918
step 2600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.798342
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.799234
step 2800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.801658
step 2900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.802678
step 3000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.804592
step 3100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.806888
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.808801
step 3300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.810331
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.812117
step 3500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.81352
step 3600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.814541
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.814796
step 3800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.815816
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.817219
step 4000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.818367
step 4100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.819132
step 4200, accuracy on validation batch: 0.875, accuracy on mal data: 0.819515
step 4300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82028
step 4400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821046
step 4500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.822704
step 4600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823086
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823724
step 4800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824489
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824617
step 5000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825
step 5100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.825765
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82602
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827168
step 5400, accuracy on validation batch: 0.875, accuracy on mal data: 0.827296
step 5500, accuracy on validation batch: 0.875, accuracy on mal data: 0.827423
step 5600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827296
step 5700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827296
step 5800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827551
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828061
step 6000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828316
step 6100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828954
step 6200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829464
step 6300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.829847
step 6400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829847
step 6500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829974
step 6600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.830357
step 6700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830612
step 6800, accuracy on validation batch: 0.875, accuracy on mal data: 0.830867
step 6900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830867
step 7000, accuracy on validation batch: 0.875, accuracy on mal data: 0.830995
step 7100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83125
step 7200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831632
step 7300, accuracy on validation batch: 0.875, accuracy on mal data: 0.831887
step 7400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83176
step 7500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832143
step 7600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832143
step 7700, accuracy on validation batch: 0.960938, accuracy on mal data: 0.832525
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832525
step 7900, accuracy on validation batch: 0.875, accuracy on mal data: 0.832525
test set: accuracy on test set: 0.912
Done training net
0.911500026584
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.125, accuracy on mal data: 0.100128
step 100, accuracy on validation batch: 0.296875, accuracy on mal data: 0.177806
step 200, accuracy on validation batch: 0.4375, accuracy on mal data: 0.266709
step 300, accuracy on validation batch: 0.65625, accuracy on mal data: 0.363903
step 400, accuracy on validation batch: 0.695312, accuracy on mal data: 0.457398
step 500, accuracy on validation batch: 0.703125, accuracy on mal data: 0.529209
step 600, accuracy on validation batch: 0.78125, accuracy on mal data: 0.578571
step 700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.615816
step 800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.638138
step 900, accuracy on validation batch: 0.796875, accuracy on mal data: 0.660459
step 1000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.677678
step 1100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.69426
step 1200, accuracy on validation batch: 0.804688, accuracy on mal data: 0.70676
step 1300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.720025
step 1400, accuracy on validation batch: 0.820312, accuracy on mal data: 0.731887
step 1500, accuracy on validation batch: 0.804688, accuracy on mal data: 0.73801
step 1600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.746811
step 1700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.75102
step 1800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.760714
step 1900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.767347
step 2000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.774234
step 2100, accuracy on validation batch: 0.875, accuracy on mal data: 0.780357
step 2200, accuracy on validation batch: 0.875, accuracy on mal data: 0.783418
step 2300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.787245
step 2400, accuracy on validation batch: 0.820312, accuracy on mal data: 0.791199
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.794005
step 2600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.797831
step 2700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.800255
step 2800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.803061
step 2900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.804209
step 3000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.805995
step 3100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.80727
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.808163
step 3300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.809438
step 3400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.810586
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.81199
step 3600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.813138
step 3700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.814413
step 3800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815689
step 3900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.816964
step 4000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817602
step 4100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.818495
step 4200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.819005
step 4300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.820408
step 4400, accuracy on validation batch: 0.875, accuracy on mal data: 0.821301
step 4500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821173
step 4600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821556
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821811
step 4800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.822831
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823086
step 5000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.823979
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824107
step 5200, accuracy on validation batch: 0.875, accuracy on mal data: 0.824617
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825
step 5400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82551
step 5500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825637
step 5600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826403
step 5700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827296
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827423
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827423
step 6000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827551
step 6100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.827933
step 6200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828699
step 6300, accuracy on validation batch: 0.96875, accuracy on mal data: 0.828699
step 6400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828954
step 6500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829209
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829464
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829592
step 6800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829719
step 6900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830102
step 7000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830484
step 7100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830484
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830484
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831122
step 7400, accuracy on validation batch: 0.875, accuracy on mal data: 0.831377
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831377
step 7600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831632
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831887
step 7800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832143
step 7900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.832653
test set: accuracy on test set: 0.910
Done training net
0.909800028801
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0834184
step 100, accuracy on validation batch: 0.226562, accuracy on mal data: 0.145791
step 200, accuracy on validation batch: 0.40625, accuracy on mal data: 0.229847
step 300, accuracy on validation batch: 0.59375, accuracy on mal data: 0.320153
step 400, accuracy on validation batch: 0.710938, accuracy on mal data: 0.406505
step 500, accuracy on validation batch: 0.726562, accuracy on mal data: 0.491837
step 600, accuracy on validation batch: 0.726562, accuracy on mal data: 0.547576
step 700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.58227
step 800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.616454
step 900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.637117
step 1000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.661479
step 1100, accuracy on validation batch: 0.8125, accuracy on mal data: 0.677806
step 1200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.694515
step 1300, accuracy on validation batch: 0.8125, accuracy on mal data: 0.707398
step 1400, accuracy on validation batch: 0.875, accuracy on mal data: 0.721684
step 1500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.732525
step 1600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.742474
step 1700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.750382
step 1800, accuracy on validation batch: 0.820312, accuracy on mal data: 0.755867
step 1900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.761734
step 2000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.769132
step 2100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.773342
step 2200, accuracy on validation batch: 0.875, accuracy on mal data: 0.780357
step 2300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.786097
step 2400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.792474
step 2500, accuracy on validation batch: 0.875, accuracy on mal data: 0.797449
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.800637
step 2700, accuracy on validation batch: 0.875, accuracy on mal data: 0.803826
step 2800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.805995
step 2900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.808163
step 3000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.809183
step 3100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.811097
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.81352
step 3300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.814158
step 3400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815178
step 3500, accuracy on validation batch: 0.875, accuracy on mal data: 0.816199
step 3600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817347
step 3700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81824
step 3800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.81926
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820153
step 4000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.821046
step 4100, accuracy on validation batch: 0.875, accuracy on mal data: 0.821811
step 4200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822576
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822831
step 4400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823724
step 4500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823724
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824107
step 4700, accuracy on validation batch: 0.875, accuracy on mal data: 0.823979
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824872
step 4900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825637
step 5000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.825637
step 5100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826148
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826403
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826785
step 5400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826785
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827551
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827806
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827933
step 5800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828316
step 5900, accuracy on validation batch: 0.875, accuracy on mal data: 0.828316
step 6000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828316
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828699
step 6200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828954
step 6300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828954
step 6400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829209
step 6500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829974
step 6600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830357
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830612
step 6800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830867
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830995
step 7000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83125
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83125
step 7200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831632
step 7300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83176
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83176
step 7500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831887
step 7600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83227
step 7700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83227
step 7800, accuracy on validation batch: 0.875, accuracy on mal data: 0.83227
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832398
test set: accuracy on test set: 0.911
Done training net
0.910500022173
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0914541
step 100, accuracy on validation batch: 0.257812, accuracy on mal data: 0.15574
step 200, accuracy on validation batch: 0.53125, accuracy on mal data: 0.247194
step 300, accuracy on validation batch: 0.609375, accuracy on mal data: 0.347449
step 400, accuracy on validation batch: 0.71875, accuracy on mal data: 0.439541
step 500, accuracy on validation batch: 0.734375, accuracy on mal data: 0.522194
step 600, accuracy on validation batch: 0.71875, accuracy on mal data: 0.572832
step 700, accuracy on validation batch: 0.71875, accuracy on mal data: 0.611224
step 800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.640051
step 900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.658546
step 1000, accuracy on validation batch: 0.765625, accuracy on mal data: 0.673979
step 1100, accuracy on validation batch: 0.8125, accuracy on mal data: 0.687627
step 1200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.702678
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.713138
step 1400, accuracy on validation batch: 0.8125, accuracy on mal data: 0.721428
step 1500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.728189
step 1600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.741199
step 1700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.747066
step 1800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.753444
step 1900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.758928
step 2000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.764668
step 2100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.772576
step 2200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.778954
step 2300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.784949
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.785842
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.790178
step 2600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.793367
step 2700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.796173
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.798214
step 2900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.800382
step 3000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.802423
step 3100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.803699
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.805102
step 3300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.808035
step 3400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.809056
step 3500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.809949
step 3600, accuracy on validation batch: 0.953125, accuracy on mal data: 0.810331
step 3700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.811479
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.81199
step 3900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.812755
step 4000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.81403
step 4100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.815306
step 4200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.816836
step 4300, accuracy on validation batch: 0.875, accuracy on mal data: 0.817602
step 4400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.818622
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.819898
step 4600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.820791
step 4700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.821683
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822194
step 4900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822959
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823214
step 5100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823342
step 5200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823469
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823724
step 5400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.82449
step 5500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82449
step 5600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825127
step 5700, accuracy on validation batch: 0.945312, accuracy on mal data: 0.825637
step 5800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826403
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826658
step 6000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827423
step 6100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827678
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827806
step 6300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828061
step 6400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828444
step 6500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829209
step 6600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829209
step 6700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829464
step 6800, accuracy on validation batch: 0.875, accuracy on mal data: 0.829974
step 6900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830102
step 7000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830995
step 7100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831122
step 7200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831122
step 7300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831122
step 7400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.831377
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831632
step 7600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831887
step 7700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831887
step 7800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832015
step 7900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83176
test set: accuracy on test set: 0.911
Done training net
0.911000022888
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0625, accuracy on mal data: 0.101786
step 100, accuracy on validation batch: 0.273438, accuracy on mal data: 0.181888
step 200, accuracy on validation batch: 0.476562, accuracy on mal data: 0.266837
step 300, accuracy on validation batch: 0.632812, accuracy on mal data: 0.364286
step 400, accuracy on validation batch: 0.664062, accuracy on mal data: 0.449872
step 500, accuracy on validation batch: 0.734375, accuracy on mal data: 0.524235
step 600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.579337
step 700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.61301
step 800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.640306
step 900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.657398
step 1000, accuracy on validation batch: 0.804688, accuracy on mal data: 0.671046
step 1100, accuracy on validation batch: 0.8125, accuracy on mal data: 0.688648
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.70153
step 1300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.716326
step 1400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.728189
step 1500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.737372
step 1600, accuracy on validation batch: 0.875, accuracy on mal data: 0.746811
step 1700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.754081
step 1800, accuracy on validation batch: 0.875, accuracy on mal data: 0.761352
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.767219
step 2000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.773724
step 2100, accuracy on validation batch: 0.875, accuracy on mal data: 0.778826
step 2200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.782653
step 2300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.788137
step 2400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.791326
step 2500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.79528
step 2600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.798086
step 2700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.801148
step 2800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.803316
step 2900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.805995
step 3000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.807908
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.808801
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.809183
step 3300, accuracy on validation batch: 0.875, accuracy on mal data: 0.810714
step 3400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.812627
step 3500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.813138
step 3600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.814668
step 3700, accuracy on validation batch: 0.875, accuracy on mal data: 0.815816
step 3800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.816709
step 3900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.818112
step 4000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.81926
step 4100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.820153
step 4200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821301
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822066
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822449
step 4500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.823086
step 4600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823597
step 4700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.824234
step 4800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824489
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825127
step 5000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825127
step 5100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825382
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825637
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825765
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826658
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827423
step 5600, accuracy on validation batch: 0.960938, accuracy on mal data: 0.827806
step 5700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828061
step 5800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828699
step 5900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828699
step 6000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828954
step 6100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829209
step 6200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829209
step 6300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829209
step 6400, accuracy on validation batch: 0.953125, accuracy on mal data: 0.829464
step 6500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.830357
step 6600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.830484
step 6700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830484
step 6800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830484
step 6900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83074
step 7000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830995
step 7100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831122
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831505
step 7300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83227
step 7400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.832653
step 7500, accuracy on validation batch: 0.875, accuracy on mal data: 0.832653
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83278
step 7700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.833035
step 7800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.833163
step 7900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.833673
test set: accuracy on test set: 0.911
Done training net
0.910900024176
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 8, 'nb_neurons_3': 64}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 8, 'nb_neurons_3': 64}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.109375, accuracy on mal data: 0.102168
step 100, accuracy on validation batch: 0.359375, accuracy on mal data: 0.16977
step 200, accuracy on validation batch: 0.59375, accuracy on mal data: 0.247704
step 300, accuracy on validation batch: 0.679688, accuracy on mal data: 0.342602
step 400, accuracy on validation batch: 0.796875, accuracy on mal data: 0.437883
step 500, accuracy on validation batch: 0.710938, accuracy on mal data: 0.514923
step 600, accuracy on validation batch: 0.757812, accuracy on mal data: 0.562883
step 700, accuracy on validation batch: 0.804688, accuracy on mal data: 0.601531
step 800, accuracy on validation batch: 0.796875, accuracy on mal data: 0.629719
step 900, accuracy on validation batch: 0.820312, accuracy on mal data: 0.648469
step 1000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.662627
step 1100, accuracy on validation batch: 0.820312, accuracy on mal data: 0.680102
step 1200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.7
step 1300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.710459
step 1400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.722576
step 1500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.732653
step 1600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.742729
step 1700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.751785
step 1800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.756632
step 1900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.762882
step 2000, accuracy on validation batch: 0.875, accuracy on mal data: 0.768112
step 2100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.773214
step 2200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.778444
step 2300, accuracy on validation batch: 0.875, accuracy on mal data: 0.783928
step 2400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.788137
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.791581
step 2600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.796301
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.8
step 2800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.801913
step 2900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.804209
step 3000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.806505
step 3100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.808291
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.811097
step 3300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81301
step 3400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.813648
step 3500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.814923
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815944
step 3700, accuracy on validation batch: 0.875, accuracy on mal data: 0.817347
step 3800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817984
step 3900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.819005
step 4000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.819898
step 4100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820791
step 4200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821173
step 4300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.821301
step 4400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.821811
step 4500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821939
step 4600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.822704
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823597
step 4800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.824489
step 4900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.824617
step 5000, accuracy on validation batch: 0.875, accuracy on mal data: 0.825
step 5100, accuracy on validation batch: 0.875, accuracy on mal data: 0.825893
step 5200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.82602
step 5300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826658
step 5400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827296
step 5500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827806
step 5600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827933
step 5700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827933
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827933
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828061
step 6000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828188
step 6100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828571
step 6200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.829592
step 6300, accuracy on validation batch: 0.875, accuracy on mal data: 0.829847
step 6400, accuracy on validation batch: 0.953125, accuracy on mal data: 0.830102
step 6500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830229
step 6600, accuracy on validation batch: 0.875, accuracy on mal data: 0.830229
step 6700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830484
step 6800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830484
step 6900, accuracy on validation batch: 0.875, accuracy on mal data: 0.830739
step 7000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831377
step 7100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.831505
step 7200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831505
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832015
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832015
step 7500, accuracy on validation batch: 0.875, accuracy on mal data: 0.832015
step 7600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832143
step 7700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832143
step 7800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832143
step 7900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83278
test set: accuracy on test set: 0.910
Done training net
0.910300028324
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 256, 'nb_neurons_2': 8, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 256, 'nb_neurons_2': 8, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.1875, accuracy on mal data: 0.092602
step 100, accuracy on validation batch: 0.28125, accuracy on mal data: 0.160332
step 200, accuracy on validation batch: 0.453125, accuracy on mal data: 0.232398
step 300, accuracy on validation batch: 0.65625, accuracy on mal data: 0.321684
step 400, accuracy on validation batch: 0.695312, accuracy on mal data: 0.409056
step 500, accuracy on validation batch: 0.671875, accuracy on mal data: 0.486735
step 600, accuracy on validation batch: 0.796875, accuracy on mal data: 0.552806
step 700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.59477
step 800, accuracy on validation batch: 0.804688, accuracy on mal data: 0.626913
step 900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.650893
step 1000, accuracy on validation batch: 0.804688, accuracy on mal data: 0.66926
step 1100, accuracy on validation batch: 0.75, accuracy on mal data: 0.685587
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.701403
step 1300, accuracy on validation batch: 0.828125, accuracy on mal data: 0.714413
step 1400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.724872
step 1500, accuracy on validation batch: 0.796875, accuracy on mal data: 0.733418
step 1600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.743877
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.751403
step 1800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.756122
step 1900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.76301
step 2000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.768622
step 2100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.775
step 2200, accuracy on validation batch: 0.804688, accuracy on mal data: 0.779336
step 2300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.785076
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.78852
step 2500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.791454
step 2600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.795535
step 2700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.798724
step 2800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.801148
step 2900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.804847
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.807143
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.809949
step 3200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.811734
step 3300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.812627
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.814413
step 3500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.815178
step 3600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.816199
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817474
step 3800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.817984
step 3900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.819005
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.818877
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.819515
step 4200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82028
step 4300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820791
step 4400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821301
step 4500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.822194
step 4600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822704
step 4700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.823724
step 4800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.824617
step 4900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825255
step 5000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825382
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825382
step 5200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82551
step 5300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.82551
step 5400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82551
step 5500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825637
step 5600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.825893
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.82704
step 5800, accuracy on validation batch: 0.960938, accuracy on mal data: 0.827168
step 5900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827933
step 6000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.828316
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828826
step 6200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828826
step 6300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828954
step 6400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829337
step 6500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829336
step 6600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.829464
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829719
step 6800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829974
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830484
step 7000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830612
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83074
step 7200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83125
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831377
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831505
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831505
step 7600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831887
step 7700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832143
step 7800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83227
step 7900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.832525
test set: accuracy on test set: 0.908
Done training net
0.908000021577
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.104592
step 100, accuracy on validation batch: 0.289062, accuracy on mal data: 0.179974
step 200, accuracy on validation batch: 0.5, accuracy on mal data: 0.253189
step 300, accuracy on validation batch: 0.601562, accuracy on mal data: 0.349872
step 400, accuracy on validation batch: 0.742188, accuracy on mal data: 0.441582
step 500, accuracy on validation batch: 0.71875, accuracy on mal data: 0.511225
step 600, accuracy on validation batch: 0.796875, accuracy on mal data: 0.565434
step 700, accuracy on validation batch: 0.8125, accuracy on mal data: 0.598852
step 800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.623724
step 900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.643877
step 1000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.660714
step 1100, accuracy on validation batch: 0.820312, accuracy on mal data: 0.678316
step 1200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.69324
step 1300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.707015
step 1400, accuracy on validation batch: 0.8125, accuracy on mal data: 0.717219
step 1500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.728826
step 1600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.740434
step 1700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.749362
step 1800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.755102
step 1900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.763648
step 2000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.770918
step 2100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.777551
step 2200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.782143
step 2300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.785841
step 2400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.788265
step 2500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.791581
step 2600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.794515
step 2700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.797831
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.80102
step 2900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.803826
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.807398
step 3100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.808546
step 3200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.809311
step 3300, accuracy on validation batch: 0.875, accuracy on mal data: 0.811224
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.813775
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.815433
step 3600, accuracy on validation batch: 0.875, accuracy on mal data: 0.816199
step 3700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.816964
step 3800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.81824
step 3900, accuracy on validation batch: 0.953125, accuracy on mal data: 0.818367
step 4000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819132
step 4100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.820153
step 4200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821046
step 4300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821301
step 4400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821683
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823086
step 4600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823852
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824745
step 4800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825765
step 4900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825765
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825637
step 5100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825637
step 5200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825638
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82653
step 5400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82653
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82704
step 5600, accuracy on validation batch: 0.875, accuracy on mal data: 0.827551
step 5700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827806
step 5800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827806
step 5900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.827806
step 6000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828061
step 6100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828061
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828826
step 6300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828954
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829464
step 6500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829464
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829464
step 6700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829847
step 6800, accuracy on validation batch: 0.875, accuracy on mal data: 0.830484
step 6900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830995
step 7000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830995
step 7100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831505
step 7200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831505
step 7300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831505
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831887
step 7500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83227
step 7600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832398
step 7700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83227
step 7800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832653
step 7900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832908
test set: accuracy on test set: 0.910
Done training net
0.909700019956
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 8, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 8, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0996173
step 100, accuracy on validation batch: 0.289062, accuracy on mal data: 0.163265
step 200, accuracy on validation batch: 0.484375, accuracy on mal data: 0.249617
step 300, accuracy on validation batch: 0.523438, accuracy on mal data: 0.343367
step 400, accuracy on validation batch: 0.710938, accuracy on mal data: 0.434184
step 500, accuracy on validation batch: 0.757812, accuracy on mal data: 0.498087
step 600, accuracy on validation batch: 0.765625, accuracy on mal data: 0.546046
step 700, accuracy on validation batch: 0.765625, accuracy on mal data: 0.582781
step 800, accuracy on validation batch: 0.820312, accuracy on mal data: 0.613393
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.640178
step 1000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.660587
step 1100, accuracy on validation batch: 0.8125, accuracy on mal data: 0.678316
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.695663
step 1300, accuracy on validation batch: 0.828125, accuracy on mal data: 0.708673
step 1400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.720153
step 1500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.731888
step 1600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.743622
step 1700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.756377
step 1800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.763903
step 1900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.769643
step 2000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.775638
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.780102
step 2200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.783673
step 2300, accuracy on validation batch: 0.828125, accuracy on mal data: 0.786224
step 2400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.789413
step 2500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.792984
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.795918
step 2700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.80051
step 2800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.803316
step 2900, accuracy on validation batch: 0.875, accuracy on mal data: 0.805867
step 3000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.808673
step 3100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.809311
step 3200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.811607
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.812627
step 3400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.813265
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.814668
step 3600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.815433
step 3700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.815816
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.817857
step 3900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.819388
step 4000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.819898
step 4100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.820408
step 4200, accuracy on validation batch: 0.945312, accuracy on mal data: 0.820918
step 4300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821301
step 4400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821556
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821811
step 4600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822194
step 4700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822831
step 4800, accuracy on validation batch: 0.960938, accuracy on mal data: 0.824872
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825
step 5000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.824872
step 5100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825127
step 5200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826275
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826785
step 5400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.826658
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826785
step 5600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826913
step 5700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827678
step 5800, accuracy on validation batch: 0.875, accuracy on mal data: 0.828571
step 5900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828954
step 6000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829081
step 6100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829464
step 6200, accuracy on validation batch: 0.875, accuracy on mal data: 0.829464
step 6300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830102
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830102
step 6500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830229
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830229
step 6700, accuracy on validation batch: 0.875, accuracy on mal data: 0.830612
step 6800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830867
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830995
step 7000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831377
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83176
step 7200, accuracy on validation batch: 0.953125, accuracy on mal data: 0.832015
step 7300, accuracy on validation batch: 0.953125, accuracy on mal data: 0.832143
step 7400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832143
step 7500, accuracy on validation batch: 0.953125, accuracy on mal data: 0.832143
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832525
step 7700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83278
step 7800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.833035
step 7900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.833035
test set: accuracy on test set: 0.911
Done training net
0.910600017905
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.117188, accuracy on mal data: 0.109439
step 100, accuracy on validation batch: 0.25, accuracy on mal data: 0.195918
step 200, accuracy on validation batch: 0.601562, accuracy on mal data: 0.295153
step 300, accuracy on validation batch: 0.695312, accuracy on mal data: 0.37398
step 400, accuracy on validation batch: 0.71875, accuracy on mal data: 0.457908
step 500, accuracy on validation batch: 0.765625, accuracy on mal data: 0.528954
step 600, accuracy on validation batch: 0.765625, accuracy on mal data: 0.580102
step 700, accuracy on validation batch: 0.742188, accuracy on mal data: 0.61403
step 800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.641581
step 900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.656377
step 1000, accuracy on validation batch: 0.789062, accuracy on mal data: 0.673469
step 1100, accuracy on validation batch: 0.796875, accuracy on mal data: 0.689668
step 1200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.70102
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.711735
step 1400, accuracy on validation batch: 0.828125, accuracy on mal data: 0.722449
step 1500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.735969
step 1600, accuracy on validation batch: 0.875, accuracy on mal data: 0.74324
step 1700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.751275
step 1800, accuracy on validation batch: 0.875, accuracy on mal data: 0.759694
step 1900, accuracy on validation batch: 0.875, accuracy on mal data: 0.764286
step 2000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.768622
step 2100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.774107
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.779209
step 2300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.784183
step 2400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.787117
step 2500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.792347
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.795663
step 2700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.798214
step 2800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.801148
step 2900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.805229
step 3000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.80676
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.808673
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.810459
step 3300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.811862
step 3400, accuracy on validation batch: 0.875, accuracy on mal data: 0.813265
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.814923
step 3600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815688
step 3700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.816836
step 3800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.818112
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.818367
step 4000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.818877
step 4100, accuracy on validation batch: 0.875, accuracy on mal data: 0.818877
step 4200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820663
step 4300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.821428
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822449
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822449
step 4600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822576
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823214
step 4800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823724
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825127
step 5000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825637
step 5100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825637
step 5200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82602
step 5300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826275
step 5400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826275
step 5500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.826403
step 5600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826403
step 5700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826658
step 5800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827168
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827806
step 6000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828188
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828316
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828699
step 6300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828699
step 6400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828826
step 6500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828954
step 6600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829337
step 6700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829336
step 6800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829336
step 6900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.829592
step 7000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829719
step 7100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829719
step 7200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829719
step 7300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829847
step 7400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829847
step 7500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830484
step 7600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830612
step 7700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830867
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830995
step 7900, accuracy on validation batch: 0.875, accuracy on mal data: 0.831377
test set: accuracy on test set: 0.910
Done training net
0.910000028014
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.0848214
step 100, accuracy on validation batch: 0.25, accuracy on mal data: 0.151658
step 200, accuracy on validation batch: 0.460938, accuracy on mal data: 0.232143
step 300, accuracy on validation batch: 0.671875, accuracy on mal data: 0.320408
step 400, accuracy on validation batch: 0.6875, accuracy on mal data: 0.421173
step 500, accuracy on validation batch: 0.734375, accuracy on mal data: 0.505995
step 600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.566837
step 700, accuracy on validation batch: 0.804688, accuracy on mal data: 0.603571
step 800, accuracy on validation batch: 0.773438, accuracy on mal data: 0.630485
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.651913
step 1000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.66977
step 1100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.68699
step 1200, accuracy on validation batch: 0.8125, accuracy on mal data: 0.703316
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.720536
step 1400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.729464
step 1500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.737627
step 1600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.747831
step 1700, accuracy on validation batch: 0.796875, accuracy on mal data: 0.754464
step 1800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.760459
step 1900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.764158
step 2000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.770663
step 2100, accuracy on validation batch: 0.875, accuracy on mal data: 0.776148
step 2200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.779592
step 2300, accuracy on validation batch: 0.875, accuracy on mal data: 0.780995
step 2400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.784821
step 2500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.789158
step 2600, accuracy on validation batch: 0.8125, accuracy on mal data: 0.794005
step 2700, accuracy on validation batch: 0.875, accuracy on mal data: 0.797066
step 2800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.800382
step 2900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.803189
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.803699
step 3100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.80625
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.808546
step 3300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.809566
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.810459
step 3500, accuracy on validation batch: 0.875, accuracy on mal data: 0.812245
step 3600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.813775
step 3700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.814923
step 3800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.815944
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.816454
step 4000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817474
step 4100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817474
step 4200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.818622
step 4300, accuracy on validation batch: 0.945312, accuracy on mal data: 0.818495
step 4400, accuracy on validation batch: 0.875, accuracy on mal data: 0.81926
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82028
step 4600, accuracy on validation batch: 0.875, accuracy on mal data: 0.82028
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821173
step 4800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821301
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822066
step 5000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822831
step 5100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.823087
step 5200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823852
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824107
step 5400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824362
step 5500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.825
step 5600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82551
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825637
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826403
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827041
step 6000, accuracy on validation batch: 0.875, accuracy on mal data: 0.827296
step 6100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827551
step 6200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827678
step 6300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827806
step 6400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829209
step 6500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829464
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829464
step 6700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829719
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829719
step 6900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829974
step 7000, accuracy on validation batch: 0.875, accuracy on mal data: 0.830102
step 7100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830229
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830229
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830229
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830612
step 7500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831632
step 7600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83176
step 7700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83176
step 7800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83227
step 7900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83227
test set: accuracy on test set: 0.909
Done training net
0.90920001924
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 256, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 256, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.117188, accuracy on mal data: 0.0966837
step 100, accuracy on validation batch: 0.210938, accuracy on mal data: 0.169898
step 200, accuracy on validation batch: 0.523438, accuracy on mal data: 0.253699
step 300, accuracy on validation batch: 0.585938, accuracy on mal data: 0.358673
step 400, accuracy on validation batch: 0.796875, accuracy on mal data: 0.453061
step 500, accuracy on validation batch: 0.757812, accuracy on mal data: 0.51926
step 600, accuracy on validation batch: 0.75, accuracy on mal data: 0.572449
step 700, accuracy on validation batch: 0.742188, accuracy on mal data: 0.601786
step 800, accuracy on validation batch: 0.820312, accuracy on mal data: 0.633673
step 900, accuracy on validation batch: 0.796875, accuracy on mal data: 0.654719
step 1000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.674235
step 1100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.686479
step 1200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.701913
step 1300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.715944
step 1400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.728571
step 1500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.738265
step 1600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.745663
step 1700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.751275
step 1800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.75778
step 1900, accuracy on validation batch: 0.875, accuracy on mal data: 0.765178
step 2000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.771046
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.776913
step 2200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.786224
step 2300, accuracy on validation batch: 0.820312, accuracy on mal data: 0.788775
step 2400, accuracy on validation batch: 0.875, accuracy on mal data: 0.792729
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.796301
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.799362
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.802678
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.804464
step 2900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.805995
step 3000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.807653
step 3100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.810204
step 3200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.811224
step 3300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.8125
step 3400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.813265
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.814923
step 3600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.816199
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816836
step 3800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.817474
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81875
step 4000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.81977
step 4100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821046
step 4200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821428
step 4300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821683
step 4400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822321
step 4500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.823087
step 4600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824107
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824362
step 4800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825255
step 4900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.825382
step 5000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.825382
step 5100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825637
step 5200, accuracy on validation batch: 0.875, accuracy on mal data: 0.825637
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826403
step 5400, accuracy on validation batch: 0.875, accuracy on mal data: 0.826913
step 5500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827806
step 5600, accuracy on validation batch: 0.875, accuracy on mal data: 0.827806
step 5700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827933
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828061
step 5900, accuracy on validation batch: 0.875, accuracy on mal data: 0.828316
step 6000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828444
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829209
step 6200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829209
step 6300, accuracy on validation batch: 0.875, accuracy on mal data: 0.829847
step 6400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830102
step 6500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830484
step 6600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830612
step 6700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830612
step 6800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830612
step 6900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831122
step 7000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.83125
step 7100, accuracy on validation batch: 0.953125, accuracy on mal data: 0.83125
step 7200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831505
step 7300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83176
step 7400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832398
step 7500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83278
step 7600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832908
step 7700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.833035
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.833035
step 7900, accuracy on validation batch: 0.875, accuracy on mal data: 0.833291
test set: accuracy on test set: 0.911
Done training net
0.911400020719
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 128, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 128, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0867347
step 100, accuracy on validation batch: 0.304688, accuracy on mal data: 0.14949
step 200, accuracy on validation batch: 0.429688, accuracy on mal data: 0.235077
step 300, accuracy on validation batch: 0.585938, accuracy on mal data: 0.339923
step 400, accuracy on validation batch: 0.703125, accuracy on mal data: 0.438776
step 500, accuracy on validation batch: 0.734375, accuracy on mal data: 0.511352
step 600, accuracy on validation batch: 0.78125, accuracy on mal data: 0.565816
step 700, accuracy on validation batch: 0.789062, accuracy on mal data: 0.599745
step 800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.634439
step 900, accuracy on validation batch: 0.75, accuracy on mal data: 0.65727
step 1000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.671556
step 1100, accuracy on validation batch: 0.820312, accuracy on mal data: 0.686479
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.702423
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.713775
step 1400, accuracy on validation batch: 0.765625, accuracy on mal data: 0.726403
step 1500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.736862
step 1600, accuracy on validation batch: 0.828125, accuracy on mal data: 0.745535
step 1700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.751275
step 1800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.758291
step 1900, accuracy on validation batch: 0.820312, accuracy on mal data: 0.764285
step 2000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.770025
step 2100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.775
step 2200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.78074
step 2300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.786097
step 2400, accuracy on validation batch: 0.875, accuracy on mal data: 0.790178
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.79426
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.797194
step 2700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.799234
step 2800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.801785
step 2900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.803061
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.805102
step 3100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.807653
step 3200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.810459
step 3300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.811097
step 3400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.812245
step 3500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.81352
step 3600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.814541
step 3700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.815688
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816709
step 3900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817857
step 4000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.818622
step 4100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.819643
step 4200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.82028
step 4300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820535
step 4400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821301
step 4500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822066
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822066
step 4700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822576
step 4800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822959
step 4900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.823469
step 5000, accuracy on validation batch: 0.875, accuracy on mal data: 0.823979
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82449
step 5200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824872
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825
step 5400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825127
step 5500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825127
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825127
step 5700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825765
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.82602
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826403
step 6000, accuracy on validation batch: 0.875, accuracy on mal data: 0.826403
step 6100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827041
step 6200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827806
step 6300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828316
step 6400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828316
step 6500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829336
step 6600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829592
step 6700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829592
step 6800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829719
step 6900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830102
step 7000, accuracy on validation batch: 0.875, accuracy on mal data: 0.830484
step 7100, accuracy on validation batch: 0.875, accuracy on mal data: 0.830484
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830995
step 7300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831122
step 7400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831632
step 7500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83176
step 7600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832015
step 7700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832525
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832653
step 7900, accuracy on validation batch: 0.953125, accuracy on mal data: 0.832908
test set: accuracy on test set: 0.911
Done training net
0.910700022578
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.078125, accuracy on mal data: 0.100893
step 100, accuracy on validation batch: 0.335938, accuracy on mal data: 0.165306
step 200, accuracy on validation batch: 0.523438, accuracy on mal data: 0.226148
step 300, accuracy on validation batch: 0.671875, accuracy on mal data: 0.318622
step 400, accuracy on validation batch: 0.757812, accuracy on mal data: 0.413648
step 500, accuracy on validation batch: 0.78125, accuracy on mal data: 0.494388
step 600, accuracy on validation batch: 0.828125, accuracy on mal data: 0.55051
step 700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.592347
step 800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.622576
step 900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.642602
step 1000, accuracy on validation batch: 0.875, accuracy on mal data: 0.659694
step 1100, accuracy on validation batch: 0.820312, accuracy on mal data: 0.674235
step 1200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.685714
step 1300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.700765
step 1400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.707143
step 1500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.72028
step 1600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.731505
step 1700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.741454
step 1800, accuracy on validation batch: 0.820312, accuracy on mal data: 0.750638
step 1900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.757908
step 2000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.76352
step 2100, accuracy on validation batch: 0.796875, accuracy on mal data: 0.771939
step 2200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.775382
step 2300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.780995
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.785714
step 2500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.789923
step 2600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.794898
step 2700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.798724
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.801658
step 2900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.803571
step 3000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.80574
step 3100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.809311
step 3200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.810842
step 3300, accuracy on validation batch: 0.875, accuracy on mal data: 0.81199
step 3400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.812882
step 3500, accuracy on validation batch: 0.875, accuracy on mal data: 0.814668
step 3600, accuracy on validation batch: 0.875, accuracy on mal data: 0.815433
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815688
step 3800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.817729
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.818622
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820153
step 4100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.820663
step 4200, accuracy on validation batch: 0.953125, accuracy on mal data: 0.820918
step 4300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820918
step 4400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821046
step 4500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821301
step 4600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822321
step 4700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824107
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824362
step 4900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.824489
step 5000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824745
step 5100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.825127
step 5200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82551
step 5300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.825893
step 5400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826403
step 5500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826658
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827041
step 5700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827678
step 5800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828188
step 5900, accuracy on validation batch: 0.875, accuracy on mal data: 0.828444
step 6000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828571
step 6100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828954
step 6200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829081
step 6300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829209
step 6400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829336
step 6500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.829719
step 6600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830229
step 6700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830484
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830739
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831122
step 7000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831122
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83125
step 7200, accuracy on validation batch: 0.945312, accuracy on mal data: 0.831377
step 7300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831377
step 7400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831887
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832015
step 7600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83227
step 7700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83227
step 7800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83227
step 7900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83227
test set: accuracy on test set: 0.910
Done training net
0.910100026727
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 64, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 64, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.132812, accuracy on mal data: 0.0813776
step 100, accuracy on validation batch: 0.382812, accuracy on mal data: 0.149617
step 200, accuracy on validation batch: 0.632812, accuracy on mal data: 0.240816
step 300, accuracy on validation batch: 0.65625, accuracy on mal data: 0.340561
step 400, accuracy on validation batch: 0.695312, accuracy on mal data: 0.440689
step 500, accuracy on validation batch: 0.78125, accuracy on mal data: 0.516582
step 600, accuracy on validation batch: 0.71875, accuracy on mal data: 0.573724
step 700, accuracy on validation batch: 0.8125, accuracy on mal data: 0.611862
step 800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.644133
step 900, accuracy on validation batch: 0.773438, accuracy on mal data: 0.664923
step 1000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.685076
step 1100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.703061
step 1200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.71824
step 1300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.73278
step 1400, accuracy on validation batch: 0.875, accuracy on mal data: 0.743112
step 1500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.752551
step 1600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.759566
step 1700, accuracy on validation batch: 0.875, accuracy on mal data: 0.763648
step 1800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.770918
step 1900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.776148
step 2000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.781887
step 2100, accuracy on validation batch: 0.875, accuracy on mal data: 0.78801
step 2200, accuracy on validation batch: 0.875, accuracy on mal data: 0.792474
step 2300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.795025
step 2400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.798086
step 2500, accuracy on validation batch: 0.875, accuracy on mal data: 0.799234
step 2600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.802423
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.804592
step 2800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.805229
step 2900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.806505
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.808801
step 3100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.809694
step 3200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.811224
step 3300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.812245
step 3400, accuracy on validation batch: 0.820312, accuracy on mal data: 0.812245
step 3500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.812755
step 3600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.814541
step 3700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.815688
step 3800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.816709
step 3900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817857
step 4000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.818495
step 4100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.81875
step 4200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.818877
step 4300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819387
step 4400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.819898
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820535
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821046
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822066
step 4800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.822831
step 4900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823214
step 5000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.824107
step 5100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824234
step 5200, accuracy on validation batch: 0.875, accuracy on mal data: 0.824745
step 5300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.825127
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825255
step 5500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825255
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82551
step 5700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.82551
step 5800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825893
step 5900, accuracy on validation batch: 0.953125, accuracy on mal data: 0.826785
step 6000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827041
step 6100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827168
step 6200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827296
step 6300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827423
step 6400, accuracy on validation batch: 0.875, accuracy on mal data: 0.827806
step 6500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828061
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828444
step 6700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828444
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828444
step 6900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828444
step 7000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828699
step 7100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.828954
step 7200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829464
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829847
step 7400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.829847
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829974
step 7600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830357
step 7700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830867
step 7800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.831122
step 7900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.831122
test set: accuracy on test set: 0.909
Done training net
0.908900024295
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.21875, accuracy on mal data: 0.109821
step 100, accuracy on validation batch: 0.46875, accuracy on mal data: 0.169643
step 200, accuracy on validation batch: 0.546875, accuracy on mal data: 0.25523
step 300, accuracy on validation batch: 0.710938, accuracy on mal data: 0.354975
step 400, accuracy on validation batch: 0.71875, accuracy on mal data: 0.451148
step 500, accuracy on validation batch: 0.765625, accuracy on mal data: 0.522194
step 600, accuracy on validation batch: 0.8125, accuracy on mal data: 0.571811
step 700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.602296
step 800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.625
step 900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.645791
step 1000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.665051
step 1100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.679337
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.694643
step 1300, accuracy on validation batch: 0.8125, accuracy on mal data: 0.704081
step 1400, accuracy on validation batch: 0.875, accuracy on mal data: 0.716964
step 1500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.725255
step 1600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.73278
step 1700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.741071
step 1800, accuracy on validation batch: 0.804688, accuracy on mal data: 0.750255
step 1900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.761479
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.769132
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.773597
step 2200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.777678
step 2300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.78176
step 2400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.7875
step 2500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.790306
step 2600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.793495
step 2700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.796811
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.798469
step 2900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.800893
step 3000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.803444
step 3100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.805229
step 3200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.807015
step 3300, accuracy on validation batch: 0.8125, accuracy on mal data: 0.807908
step 3400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.810331
step 3500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.813138
step 3600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.81403
step 3700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.816071
step 3800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816326
step 3900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817347
step 4000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.818877
step 4100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.819515
step 4200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.819898
step 4300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.820535
step 4400, accuracy on validation batch: 0.875, accuracy on mal data: 0.821301
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822194
step 4600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822194
step 4700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822959
step 4800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.822959
step 4900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823214
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823852
step 5100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824745
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825637
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826148
step 5400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826403
step 5500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.82653
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827806
step 5700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827678
step 5800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827806
step 5900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827933
step 6000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828188
step 6100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828954
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829209
step 6300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829336
step 6400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829847
step 6500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829847
step 6600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830102
step 6700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830229
step 6800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830229
step 6900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830357
step 7000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830612
step 7100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830357
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830357
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83074
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830739
step 7500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.830995
step 7600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830995
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831122
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83176
step 7900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83176
test set: accuracy on test set: 0.911
Done training net
0.911000025272
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 64, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 64, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.15625, accuracy on mal data: 0.097449
step 100, accuracy on validation batch: 0.398438, accuracy on mal data: 0.168112
step 200, accuracy on validation batch: 0.585938, accuracy on mal data: 0.271429
step 300, accuracy on validation batch: 0.671875, accuracy on mal data: 0.365306
step 400, accuracy on validation batch: 0.726562, accuracy on mal data: 0.45102
step 500, accuracy on validation batch: 0.742188, accuracy on mal data: 0.519643
step 600, accuracy on validation batch: 0.710938, accuracy on mal data: 0.577551
step 700, accuracy on validation batch: 0.8125, accuracy on mal data: 0.610842
step 800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.636735
step 900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.655867
step 1000, accuracy on validation batch: 0.78125, accuracy on mal data: 0.677806
step 1100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.691709
step 1200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.705867
step 1300, accuracy on validation batch: 0.875, accuracy on mal data: 0.717857
step 1400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.72551
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.735587
step 1600, accuracy on validation batch: 0.875, accuracy on mal data: 0.745918
step 1700, accuracy on validation batch: 0.8125, accuracy on mal data: 0.752423
step 1800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.75778
step 1900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.764796
step 2000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.768877
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.776913
step 2200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.779847
step 2300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.785076
step 2400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.789541
step 2500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.792984
step 2600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.795663
step 2700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.799362
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.803571
step 2900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.805612
step 3000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.80727
step 3100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.808546
step 3200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.810331
step 3300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.810714
step 3400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.811862
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.81301
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.81352
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815051
step 3800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.817474
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.818112
step 4000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.818877
step 4100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.819898
step 4200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.820663
step 4300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.820918
step 4400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821301
step 4500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821556
step 4600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821811
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823086
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823469
step 4900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.823469
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823724
step 5100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.824234
step 5200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824872
step 5300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.825382
step 5400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82602
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826148
step 5600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826658
step 5700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826658
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826658
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826785
step 6000, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827806
step 6100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.827933
step 6200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828061
step 6300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828316
step 6400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828699
step 6500, accuracy on validation batch: 0.875, accuracy on mal data: 0.828954
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829081
step 6700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829209
step 6800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829719
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829719
step 7000, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829847
step 7100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829847
step 7200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.829847
step 7300, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830612
step 7400, accuracy on validation batch: 0.875, accuracy on mal data: 0.830867
step 7500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.83125
step 7600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831887
step 7700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831887
step 7800, accuracy on validation batch: 0.960938, accuracy on mal data: 0.832398
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832525
test set: accuracy on test set: 0.911
Done training net
0.910700021386
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.234375, accuracy on mal data: 0.0808674
step 100, accuracy on validation batch: 0.375, accuracy on mal data: 0.146684
step 200, accuracy on validation batch: 0.5625, accuracy on mal data: 0.228827
step 300, accuracy on validation batch: 0.640625, accuracy on mal data: 0.333418
step 400, accuracy on validation batch: 0.734375, accuracy on mal data: 0.438648
step 500, accuracy on validation batch: 0.695312, accuracy on mal data: 0.526658
step 600, accuracy on validation batch: 0.757812, accuracy on mal data: 0.576531
step 700, accuracy on validation batch: 0.804688, accuracy on mal data: 0.609949
step 800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.636224
step 900, accuracy on validation batch: 0.765625, accuracy on mal data: 0.659184
step 1000, accuracy on validation batch: 0.773438, accuracy on mal data: 0.676658
step 1100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.693367
step 1200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.706505
step 1300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.719898
step 1400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.732015
step 1500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.740051
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.748214
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.756122
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.763265
step 1900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.768367
step 2000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.775382
step 2100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.780612
step 2200, accuracy on validation batch: 0.875, accuracy on mal data: 0.784821
step 2300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.788648
step 2400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.794132
step 2500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.797704
step 2600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.799362
step 2700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.801148
step 2800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.805484
step 2900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.80625
step 3000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.808035
step 3100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.810076
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.811479
step 3300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.812117
step 3400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.814158
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815178
step 3600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.815944
step 3700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.817092
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.817857
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.818622
step 4000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.819132
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.819898
step 4200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.820408
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820408
step 4400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821173
step 4500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822066
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822576
step 4700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823214
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823979
step 4900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824489
step 5000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825
step 5100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825382
step 5200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825637
step 5300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.825765
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826913
step 5500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827168
step 5600, accuracy on validation batch: 0.953125, accuracy on mal data: 0.827806
step 5700, accuracy on validation batch: 0.875, accuracy on mal data: 0.827933
step 5800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828189
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828444
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828571
step 6100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828954
step 6200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828954
step 6300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829081
step 6400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829336
step 6500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.829592
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830484
step 6700, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830484
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830867
step 6900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830995
step 7000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83125
step 7100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831505
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831505
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831887
step 7400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832015
step 7500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832143
step 7600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832143
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83227
step 7800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832653
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832653
test set: accuracy on test set: 0.912
Done training net
0.911800020933
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 512, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 512, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.1875, accuracy on mal data: 0.101276
step 100, accuracy on validation batch: 0.34375, accuracy on mal data: 0.170663
step 200, accuracy on validation batch: 0.585938, accuracy on mal data: 0.246811
step 300, accuracy on validation batch: 0.625, accuracy on mal data: 0.352423
step 400, accuracy on validation batch: 0.71875, accuracy on mal data: 0.44949
step 500, accuracy on validation batch: 0.625, accuracy on mal data: 0.525765
step 600, accuracy on validation batch: 0.765625, accuracy on mal data: 0.576275
step 700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.610204
step 800, accuracy on validation batch: 0.796875, accuracy on mal data: 0.640816
step 900, accuracy on validation batch: 0.742188, accuracy on mal data: 0.659184
step 1000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.678444
step 1100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.692729
step 1200, accuracy on validation batch: 0.875, accuracy on mal data: 0.706122
step 1300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.71824
step 1400, accuracy on validation batch: 0.804688, accuracy on mal data: 0.729719
step 1500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.736862
step 1600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.744898
step 1700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.754719
step 1800, accuracy on validation batch: 0.789062, accuracy on mal data: 0.763265
step 1900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.767092
step 2000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.770918
step 2100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.776275
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.779719
step 2300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.785204
step 2400, accuracy on validation batch: 0.820312, accuracy on mal data: 0.78852
step 2500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.791199
step 2600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.794898
step 2700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.795918
step 2800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.799107
step 2900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.800382
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.803699
step 3100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.807143
step 3200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.808801
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.811224
step 3400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.811862
step 3500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.813393
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.814285
step 3700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815178
step 3800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.816581
step 3900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.816964
step 4000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.81824
step 4100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.81875
step 4200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819898
step 4300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.820535
step 4400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821683
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822831
step 4600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823087
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823469
step 4800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823979
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824107
step 5000, accuracy on validation batch: 0.875, accuracy on mal data: 0.824872
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824872
step 5200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825765
step 5300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.82602
step 5400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826148
step 5500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826786
step 5600, accuracy on validation batch: 0.875, accuracy on mal data: 0.826913
step 5700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827678
step 5800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827933
step 5900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.828188
step 6000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828189
step 6100, accuracy on validation batch: 0.875, accuracy on mal data: 0.828444
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828699
step 6300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828954
step 6400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829081
step 6500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829209
step 6600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829336
step 6700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.829592
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830102
step 6900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830357
step 7000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830357
step 7100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830995
step 7200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83125
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83125
step 7400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83125
step 7500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831377
step 7600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831632
step 7700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831632
step 7800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.831887
step 7900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832143
test set: accuracy on test set: 0.910
Done training net
0.909700024128
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0546875, accuracy on mal data: 0.0994898
step 100, accuracy on validation batch: 0.164062, accuracy on mal data: 0.162883
step 200, accuracy on validation batch: 0.4375, accuracy on mal data: 0.245026
step 300, accuracy on validation batch: 0.578125, accuracy on mal data: 0.34477
step 400, accuracy on validation batch: 0.726562, accuracy on mal data: 0.432653
step 500, accuracy on validation batch: 0.734375, accuracy on mal data: 0.510842
step 600, accuracy on validation batch: 0.757812, accuracy on mal data: 0.565434
step 700, accuracy on validation batch: 0.804688, accuracy on mal data: 0.599235
step 800, accuracy on validation batch: 0.796875, accuracy on mal data: 0.62551
step 900, accuracy on validation batch: 0.8125, accuracy on mal data: 0.646811
step 1000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.664541
step 1100, accuracy on validation batch: 0.765625, accuracy on mal data: 0.677934
step 1200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.689413
step 1300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.705612
step 1400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.71977
step 1500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.729847
step 1600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.738393
step 1700, accuracy on validation batch: 0.78125, accuracy on mal data: 0.745918
step 1800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.753444
step 1900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.760842
step 2000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.765816
step 2100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.772066
step 2200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.777168
step 2300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.781505
step 2400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.785459
step 2500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.78903
step 2600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.791837
step 2700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.79477
step 2800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.798214
step 2900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.801403
step 3000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.803189
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.805357
step 3200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.807653
step 3300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.809566
step 3400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.811224
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.812627
step 3600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.813775
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.814668
step 3800, accuracy on validation batch: 0.875, accuracy on mal data: 0.816199
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.817219
step 4000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817857
step 4100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.81926
step 4200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820025
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820791
step 4400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821173
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821428
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821811
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822066
step 4800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823214
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823979
step 5000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825127
step 5100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825637
step 5200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.82602
step 5300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826148
step 5400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826148
step 5500, accuracy on validation batch: 0.875, accuracy on mal data: 0.826403
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826658
step 5700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827168
step 5800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827678
step 5900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827678
step 6000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827933
step 6100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.827933
step 6200, accuracy on validation batch: 0.875, accuracy on mal data: 0.827933
step 6300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828826
step 6400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828699
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829336
step 6600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829336
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829592
step 6800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829974
step 6900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830357
step 7000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.830357
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830739
step 7200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830995
step 7300, accuracy on validation batch: 0.96875, accuracy on mal data: 0.83125
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83125
step 7500, accuracy on validation batch: 0.875, accuracy on mal data: 0.831505
step 7600, accuracy on validation batch: 0.953125, accuracy on mal data: 0.831632
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832143
step 7800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832908
step 7900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832908
test set: accuracy on test set: 0.911
Done training net
0.910700019002
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.046875, accuracy on mal data: 0.105485
step 100, accuracy on validation batch: 0.21875, accuracy on mal data: 0.166582
step 200, accuracy on validation batch: 0.453125, accuracy on mal data: 0.255357
step 300, accuracy on validation batch: 0.59375, accuracy on mal data: 0.345663
step 400, accuracy on validation batch: 0.679688, accuracy on mal data: 0.431122
step 500, accuracy on validation batch: 0.765625, accuracy on mal data: 0.505102
step 600, accuracy on validation batch: 0.796875, accuracy on mal data: 0.557143
step 700, accuracy on validation batch: 0.8125, accuracy on mal data: 0.590561
step 800, accuracy on validation batch: 0.796875, accuracy on mal data: 0.621301
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.640306
step 1000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.662627
step 1100, accuracy on validation batch: 0.8125, accuracy on mal data: 0.677806
step 1200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.692474
step 1300, accuracy on validation batch: 0.875, accuracy on mal data: 0.706377
step 1400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.722449
step 1500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.729464
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.740306
step 1700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.749234
step 1800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.756377
step 1900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.761097
step 2000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.766709
step 2100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.773724
step 2200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.779847
step 2300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.787117
step 2400, accuracy on validation batch: 0.875, accuracy on mal data: 0.79375
step 2500, accuracy on validation batch: 0.828125, accuracy on mal data: 0.796939
step 2600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.799745
step 2700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.801658
step 2800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.804974
step 2900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.808546
step 3000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.809438
step 3100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.811352
step 3200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.812372
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.814158
step 3400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.814796
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.815433
step 3600, accuracy on validation batch: 0.875, accuracy on mal data: 0.816709
step 3700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817347
step 3800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.818622
step 3900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.819132
step 4000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.81926
step 4100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820408
step 4200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821428
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822449
step 4400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823214
step 4500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823342
step 4600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823341
step 4700, accuracy on validation batch: 0.945312, accuracy on mal data: 0.823852
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824234
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824362
step 5000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824872
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825255
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825893
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826148
step 5400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826148
step 5500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827168
step 5600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827423
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827933
step 5800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827933
step 5900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828571
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828699
step 6100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829464
step 6200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829592
step 6300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830229
step 6400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830229
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830867
step 6600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830739
step 6700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83125
step 6800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831505
step 6900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831632
step 7000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831632
step 7100, accuracy on validation batch: 0.875, accuracy on mal data: 0.83176
step 7200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831887
step 7300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.832143
step 7400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832143
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832398
step 7600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832525
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832525
step 7800, accuracy on validation batch: 0.875, accuracy on mal data: 0.83278
step 7900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83278
test set: accuracy on test set: 0.911
Done training net
0.911000018716
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.078125, accuracy on mal data: 0.0920918
step 100, accuracy on validation batch: 0.335938, accuracy on mal data: 0.16926
step 200, accuracy on validation batch: 0.5, accuracy on mal data: 0.248724
step 300, accuracy on validation batch: 0.734375, accuracy on mal data: 0.344898
step 400, accuracy on validation batch: 0.773438, accuracy on mal data: 0.434949
step 500, accuracy on validation batch: 0.796875, accuracy on mal data: 0.511224
step 600, accuracy on validation batch: 0.78125, accuracy on mal data: 0.564796
step 700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.603061
step 800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.629719
step 900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.652041
step 1000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.668622
step 1100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.683546
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.699617
step 1300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.714541
step 1400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.725255
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.733673
step 1600, accuracy on validation batch: 0.875, accuracy on mal data: 0.742474
step 1700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.750893
step 1800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.759949
step 1900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.765816
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.770535
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.778316
step 2200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.783673
step 2300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.787627
step 2400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.791199
step 2500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.793495
step 2600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.797066
step 2700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.8
step 2800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.802933
step 2900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.804464
step 3000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.806122
step 3100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.808418
step 3200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.808928
step 3300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.810842
step 3400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.811607
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.812627
step 3600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.813775
step 3700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.814796
step 3800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.815689
step 3900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817092
step 4000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.819005
step 4100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.818877
step 4200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819898
step 4300, accuracy on validation batch: 0.875, accuracy on mal data: 0.820918
step 4400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.821428
step 4500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821556
step 4600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.822066
step 4700, accuracy on validation batch: 0.945312, accuracy on mal data: 0.823342
step 4800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823724
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824107
step 5000, accuracy on validation batch: 0.875, accuracy on mal data: 0.824617
step 5100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.825255
step 5200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.826148
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826403
step 5400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826913
step 5500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826785
step 5600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826913
step 5700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827551
step 5800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827678
step 5900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828061
step 6000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828316
step 6100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.828954
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829847
step 6300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829719
step 6400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829719
step 6500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829847
step 6600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830229
step 6700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830229
step 6800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830357
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830612
step 7000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830484
step 7100, accuracy on validation batch: 0.960938, accuracy on mal data: 0.830612
step 7200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830612
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830612
step 7400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.830612
step 7500, accuracy on validation batch: 0.875, accuracy on mal data: 0.830612
step 7600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83074
step 7700, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831632
step 7800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83176
step 7900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832398
test set: accuracy on test set: 0.910
Done training net
0.910000024438
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 8, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 8, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0703125, accuracy on mal data: 0.122449
step 100, accuracy on validation batch: 0.179688, accuracy on mal data: 0.182908
step 200, accuracy on validation batch: 0.5, accuracy on mal data: 0.274235
step 300, accuracy on validation batch: 0.578125, accuracy on mal data: 0.364413
step 400, accuracy on validation batch: 0.671875, accuracy on mal data: 0.452679
step 500, accuracy on validation batch: 0.757812, accuracy on mal data: 0.51824
step 600, accuracy on validation batch: 0.78125, accuracy on mal data: 0.571428
step 700, accuracy on validation batch: 0.78125, accuracy on mal data: 0.606377
step 800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.63176
step 900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.650893
step 1000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.668877
step 1100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.687117
step 1200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.703571
step 1300, accuracy on validation batch: 0.8125, accuracy on mal data: 0.714413
step 1400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.726913
step 1500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.739285
step 1600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.747704
step 1700, accuracy on validation batch: 0.875, accuracy on mal data: 0.757143
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.764285
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.770791
step 2000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.774617
step 2100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.78176
step 2200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.784056
step 2300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.78852
step 2400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.791581
step 2500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.793622
step 2600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.795791
step 2700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.798214
step 2800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.800637
step 2900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.802423
step 3000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.803444
step 3100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.80625
step 3200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.808163
step 3300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.808928
step 3400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.810459
step 3500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.814285
step 3600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.814923
step 3700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.815944
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816581
step 3900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.817729
step 4000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817984
step 4100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.819132
step 4200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.820025
step 4300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.820663
step 4400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.821428
step 4500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.821939
step 4600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.822194
step 4700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823087
step 4800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823724
step 4900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824362
step 5000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824489
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825
step 5200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824745
step 5300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.825893
step 5400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.82602
step 5500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826913
step 5600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827423
step 5700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.827678
step 5800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827933
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828316
step 6000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828444
step 6100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829209
step 6200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829592
step 6300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829974
step 6400, accuracy on validation batch: 0.945312, accuracy on mal data: 0.830484
step 6500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830739
step 6600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83125
step 6700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831377
step 6800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831377
step 6900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.831377
step 7000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831505
step 7100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831505
step 7200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831505
step 7300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.831505
step 7400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832015
step 7500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832015
step 7600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832143
step 7700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832143
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.83278
step 7900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.832908
test set: accuracy on test set: 0.908
Done training net
0.908300022483
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0950255
step 100, accuracy on validation batch: 0.265625, accuracy on mal data: 0.173214
step 200, accuracy on validation batch: 0.429688, accuracy on mal data: 0.250765
step 300, accuracy on validation batch: 0.625, accuracy on mal data: 0.34273
step 400, accuracy on validation batch: 0.773438, accuracy on mal data: 0.421684
step 500, accuracy on validation batch: 0.734375, accuracy on mal data: 0.489158
step 600, accuracy on validation batch: 0.789062, accuracy on mal data: 0.545918
step 700, accuracy on validation batch: 0.789062, accuracy on mal data: 0.588775
step 800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.621556
step 900, accuracy on validation batch: 0.789062, accuracy on mal data: 0.642474
step 1000, accuracy on validation batch: 0.8125, accuracy on mal data: 0.664796
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.68176
step 1200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.697194
step 1300, accuracy on validation batch: 0.828125, accuracy on mal data: 0.71352
step 1400, accuracy on validation batch: 0.8125, accuracy on mal data: 0.723852
step 1500, accuracy on validation batch: 0.820312, accuracy on mal data: 0.733673
step 1600, accuracy on validation batch: 0.789062, accuracy on mal data: 0.744898
step 1700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.753954
step 1800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.761607
step 1900, accuracy on validation batch: 0.804688, accuracy on mal data: 0.767857
step 2000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.773852
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.778571
step 2200, accuracy on validation batch: 0.875, accuracy on mal data: 0.784439
step 2300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.787117
step 2400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.790306
step 2500, accuracy on validation batch: 0.78125, accuracy on mal data: 0.793495
step 2600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.79528
step 2700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.800255
step 2800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.802423
step 2900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.803954
step 3000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.807525
step 3100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.808673
step 3200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.810076
step 3300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.811862
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.81403
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815561
step 3600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.816199
step 3700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.816709
step 3800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.817984
step 3900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.819132
step 4000, accuracy on validation batch: 0.875, accuracy on mal data: 0.819643
step 4100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.820663
step 4200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821428
step 4300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822066
step 4400, accuracy on validation batch: 0.875, accuracy on mal data: 0.822576
step 4500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823597
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823724
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824107
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824617
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824617
step 5000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.825
step 5100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825893
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826275
step 5300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.826403
step 5400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.826785
step 5500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826785
step 5600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82704
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827296
step 5800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.828188
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828316
step 6000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828826
step 6100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828826
step 6200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828699
step 6300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829081
step 6400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829209
step 6500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829209
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829209
step 6700, accuracy on validation batch: 0.945312, accuracy on mal data: 0.829719
step 6800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829719
step 6900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829719
step 7000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829719
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829974
step 7200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829974
step 7300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830357
step 7400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830229
step 7500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830484
step 7600, accuracy on validation batch: 0.953125, accuracy on mal data: 0.830995
step 7700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83176
step 7800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831887
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831887
test set: accuracy on test set: 0.911
Done training net
0.911000019908
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 512, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 512, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.101562, accuracy on mal data: 0.0760204
step 100, accuracy on validation batch: 0.382812, accuracy on mal data: 0.152423
step 200, accuracy on validation batch: 0.546875, accuracy on mal data: 0.256122
step 300, accuracy on validation batch: 0.695312, accuracy on mal data: 0.351658
step 400, accuracy on validation batch: 0.734375, accuracy on mal data: 0.443495
step 500, accuracy on validation batch: 0.773438, accuracy on mal data: 0.523214
step 600, accuracy on validation batch: 0.804688, accuracy on mal data: 0.578316
step 700, accuracy on validation batch: 0.796875, accuracy on mal data: 0.614796
step 800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.642347
step 900, accuracy on validation batch: 0.820312, accuracy on mal data: 0.66199
step 1000, accuracy on validation batch: 0.796875, accuracy on mal data: 0.677934
step 1100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.694515
step 1200, accuracy on validation batch: 0.875, accuracy on mal data: 0.708801
step 1300, accuracy on validation batch: 0.804688, accuracy on mal data: 0.722449
step 1400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.73278
step 1500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.742602
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.749872
step 1700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.757015
step 1800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.763648
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.768877
step 2000, accuracy on validation batch: 0.875, accuracy on mal data: 0.77653
step 2100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.781122
step 2200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.785331
step 2300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.789158
step 2400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.791964
step 2500, accuracy on validation batch: 0.875, accuracy on mal data: 0.797321
step 2600, accuracy on validation batch: 0.828125, accuracy on mal data: 0.799872
step 2700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.800638
step 2800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.802806
step 2900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.804336
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.805484
step 3100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.806632
step 3200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.807398
step 3300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.808801
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.811607
step 3500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.812117
step 3600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.814541
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815433
step 3800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.816454
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817219
step 4000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817729
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.819132
step 4200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.81926
step 4300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.81926
step 4400, accuracy on validation batch: 0.875, accuracy on mal data: 0.819005
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.819515
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.821301
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822194
step 4800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.823086
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823214
step 5000, accuracy on validation batch: 0.96875, accuracy on mal data: 0.824234
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824617
step 5200, accuracy on validation batch: 0.875, accuracy on mal data: 0.825382
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825765
step 5400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.825765
step 5500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.826275
step 5600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.826785
step 5700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827168
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827296
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827296
step 6000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827933
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828444
step 6200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.828699
step 6300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829081
step 6400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.829974
step 6500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.830229
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830739
step 6700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830739
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830739
step 6900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.830739
step 7000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830995
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831122
step 7200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831632
step 7300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83176
step 7400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83176
step 7500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83176
step 7600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.83176
step 7700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832143
step 7800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832398
step 7900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832525
test set: accuracy on test set: 0.912
Done training net
0.911800029874
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 512, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 512, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.179688, accuracy on mal data: 0.0984694
step 100, accuracy on validation batch: 0.320312, accuracy on mal data: 0.162755
step 200, accuracy on validation batch: 0.625, accuracy on mal data: 0.242347
step 300, accuracy on validation batch: 0.734375, accuracy on mal data: 0.33801
step 400, accuracy on validation batch: 0.71875, accuracy on mal data: 0.433673
step 500, accuracy on validation batch: 0.734375, accuracy on mal data: 0.510204
step 600, accuracy on validation batch: 0.78125, accuracy on mal data: 0.567857
step 700, accuracy on validation batch: 0.78125, accuracy on mal data: 0.610587
step 800, accuracy on validation batch: 0.828125, accuracy on mal data: 0.641071
step 900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.658418
step 1000, accuracy on validation batch: 0.765625, accuracy on mal data: 0.67449
step 1100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.691709
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.705102
step 1300, accuracy on validation batch: 0.796875, accuracy on mal data: 0.717984
step 1400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.730867
step 1500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.740561
step 1600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.749234
step 1700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.759183
step 1800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.766709
step 1900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.773979
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.778954
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.784694
step 2200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.786607
step 2300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.789668
step 2400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.793877
step 2500, accuracy on validation batch: 0.875, accuracy on mal data: 0.796046
step 2600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.798597
step 2700, accuracy on validation batch: 0.875, accuracy on mal data: 0.800382
step 2800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.803061
step 2900, accuracy on validation batch: 0.875, accuracy on mal data: 0.804719
step 3000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.806505
step 3100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.807398
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.809566
step 3300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.810586
step 3400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.811479
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.812882
step 3600, accuracy on validation batch: 0.875, accuracy on mal data: 0.814796
step 3700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.814923
step 3800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.815433
step 3900, accuracy on validation batch: 0.875, accuracy on mal data: 0.817347
step 4000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.81875
step 4100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.819898
step 4200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.82028
step 4300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82079
step 4400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821173
step 4500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821428
step 4600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.822321
step 4700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822576
step 4800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.822831
step 4900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.823724
step 5000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823852
step 5100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823852
step 5200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.824617
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824489
step 5400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825127
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825765
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82653
step 5700, accuracy on validation batch: 0.929688, accuracy on mal data: 0.82653
step 5800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827041
step 5900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827041
step 6000, accuracy on validation batch: 0.804688, accuracy on mal data: 0.827296
step 6100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827423
step 6200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827423
step 6300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827806
step 6400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.828189
step 6500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829081
step 6600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829464
step 6700, accuracy on validation batch: 0.875, accuracy on mal data: 0.829847
step 6800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830102
step 6900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830357
step 7000, accuracy on validation batch: 0.953125, accuracy on mal data: 0.830357
step 7100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830357
step 7200, accuracy on validation batch: 0.875, accuracy on mal data: 0.830612
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830867
step 7400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831122
step 7500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.831122
step 7600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830995
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830995
step 7800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.831122
step 7900, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831122
test set: accuracy on test set: 0.912
Done training net
0.911800023913
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.164062, accuracy on mal data: 0.106505
step 100, accuracy on validation batch: 0.328125, accuracy on mal data: 0.18176
step 200, accuracy on validation batch: 0.546875, accuracy on mal data: 0.267985
step 300, accuracy on validation batch: 0.679688, accuracy on mal data: 0.355357
step 400, accuracy on validation batch: 0.734375, accuracy on mal data: 0.439286
step 500, accuracy on validation batch: 0.726562, accuracy on mal data: 0.510842
step 600, accuracy on validation batch: 0.820312, accuracy on mal data: 0.56148
step 700, accuracy on validation batch: 0.765625, accuracy on mal data: 0.601403
step 800, accuracy on validation batch: 0.820312, accuracy on mal data: 0.635842
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.653061
step 1000, accuracy on validation batch: 0.875, accuracy on mal data: 0.667347
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.682908
step 1200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.697959
step 1300, accuracy on validation batch: 0.789062, accuracy on mal data: 0.71301
step 1400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.724107
step 1500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.736479
step 1600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.747194
step 1700, accuracy on validation batch: 0.859375, accuracy on mal data: 0.755995
step 1800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.764285
step 1900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.770153
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.776913
step 2100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.78176
step 2200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.786607
step 2300, accuracy on validation batch: 0.796875, accuracy on mal data: 0.791964
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.794005
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.797704
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.799872
step 2700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.801658
step 2800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.805484
step 2900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.80676
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.807398
step 3100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.809821
step 3200, accuracy on validation batch: 0.8125, accuracy on mal data: 0.811734
step 3300, accuracy on validation batch: 0.875, accuracy on mal data: 0.813775
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.814286
step 3500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.815688
step 3600, accuracy on validation batch: 0.84375, accuracy on mal data: 0.816326
step 3700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.817219
step 3800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.819898
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.820153
step 4000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.820918
step 4100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821556
step 4200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.821683
step 4300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821811
step 4400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.822321
step 4500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.822959
step 4600, accuracy on validation batch: 0.875, accuracy on mal data: 0.824234
step 4700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824745
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.824745
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825
step 5000, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825765
step 5100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826275
step 5200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.827168
step 5300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827678
step 5400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827678
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827678
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828061
step 5700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828444
step 5800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828826
step 5900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829081
step 6000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829081
step 6100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830102
step 6200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830102
step 6300, accuracy on validation batch: 0.859375, accuracy on mal data: 0.830739
step 6400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830739
step 6500, accuracy on validation batch: 0.875, accuracy on mal data: 0.831122
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83125
step 6700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831122
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831122
step 6900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.831122
step 7000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831505
step 7100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83176
step 7200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.832015
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.83278
step 7400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83278
step 7500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.833291
step 7600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.833291
step 7700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.833418
step 7800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.833546
step 7900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.833546
test set: accuracy on test set: 0.911
Done training net
0.911000027061
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 64, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 64, 'nb_neurons_2': 64, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0899235
step 100, accuracy on validation batch: 0.273438, accuracy on mal data: 0.150638
step 200, accuracy on validation batch: 0.5, accuracy on mal data: 0.227806
step 300, accuracy on validation batch: 0.632812, accuracy on mal data: 0.321684
step 400, accuracy on validation batch: 0.765625, accuracy on mal data: 0.416071
step 500, accuracy on validation batch: 0.765625, accuracy on mal data: 0.494388
step 600, accuracy on validation batch: 0.8125, accuracy on mal data: 0.552551
step 700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.591454
step 800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.61926
step 900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.64324
step 1000, accuracy on validation batch: 0.875, accuracy on mal data: 0.663393
step 1100, accuracy on validation batch: 0.835938, accuracy on mal data: 0.68176
step 1200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.69528
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.708163
step 1400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.72028
step 1500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.734183
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.744898
step 1700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.752296
step 1800, accuracy on validation batch: 0.804688, accuracy on mal data: 0.759439
step 1900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.766964
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.773852
step 2100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.778826
step 2200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.782908
step 2300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.787882
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.789668
step 2500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.792219
step 2600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.796046
step 2700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.799107
step 2800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.802041
step 2900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.803571
step 3000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.805484
step 3100, accuracy on validation batch: 0.875, accuracy on mal data: 0.807143
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.808801
step 3300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.810714
step 3400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.812117
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.813903
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.815561
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815944
step 3800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817347
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.817984
step 4000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.818367
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.819005
step 4200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81977
step 4300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.820025
step 4400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.820025
step 4500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.820791
step 4600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821428
step 4700, accuracy on validation batch: 0.875, accuracy on mal data: 0.822321
step 4800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822449
step 4900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822704
step 5000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823979
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825382
step 5200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826148
step 5300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.826275
step 5400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.826913
step 5500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.827423
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827423
step 5700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827933
step 5800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828061
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828061
step 6000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.828188
step 6100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828316
step 6200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828316
step 6300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828826
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829209
step 6500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.829592
step 6600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829719
step 6700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830102
step 6800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830102
step 6900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830229
step 7000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830995
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831122
step 7200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.831377
step 7300, accuracy on validation batch: 0.875, accuracy on mal data: 0.831505
step 7400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.83176
step 7500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832015
step 7600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832398
step 7700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.832525
step 7800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832525
step 7900, accuracy on validation batch: 0.953125, accuracy on mal data: 0.83278
test set: accuracy on test set: 0.912
Done training net
0.911900020838
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 64, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 64, 'nb_neurons_2': 512, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.046875, accuracy on mal data: 0.0897959
step 100, accuracy on validation batch: 0.25, accuracy on mal data: 0.160459
step 200, accuracy on validation batch: 0.351562, accuracy on mal data: 0.239158
step 300, accuracy on validation batch: 0.578125, accuracy on mal data: 0.331888
step 400, accuracy on validation batch: 0.71875, accuracy on mal data: 0.429337
step 500, accuracy on validation batch: 0.710938, accuracy on mal data: 0.503189
step 600, accuracy on validation batch: 0.765625, accuracy on mal data: 0.561735
step 700, accuracy on validation batch: 0.757812, accuracy on mal data: 0.596429
step 800, accuracy on validation batch: 0.796875, accuracy on mal data: 0.626148
step 900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.65
step 1000, accuracy on validation batch: 0.796875, accuracy on mal data: 0.668877
step 1100, accuracy on validation batch: 0.804688, accuracy on mal data: 0.685714
step 1200, accuracy on validation batch: 0.875, accuracy on mal data: 0.701148
step 1300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.713393
step 1400, accuracy on validation batch: 0.835938, accuracy on mal data: 0.723342
step 1500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.733801
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.746428
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.752934
step 1800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.760587
step 1900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.768622
step 2000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.775127
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.78074
step 2200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.785969
step 2300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.7875
step 2400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.790433
step 2500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.792857
step 2600, accuracy on validation batch: 0.875, accuracy on mal data: 0.795918
step 2700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.798979
step 2800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.801913
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.803444
step 3000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.805229
step 3100, accuracy on validation batch: 0.828125, accuracy on mal data: 0.807398
step 3200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.809439
step 3300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.810076
step 3400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.811479
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.812117
step 3600, accuracy on validation batch: 0.859375, accuracy on mal data: 0.81301
step 3700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.81352
step 3800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.814796
step 3900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.816836
step 4000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.818112
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.818877
step 4200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.819643
step 4300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.820025
step 4400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.82028
step 4500, accuracy on validation batch: 0.851562, accuracy on mal data: 0.821556
step 4600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.822194
step 4700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.822449
step 4800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823341
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823214
step 5000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823852
step 5100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.824107
step 5200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.82551
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.825637
step 5400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825765
step 5500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826403
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826403
step 5700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827168
step 5800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827678
step 5900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.827933
step 6000, accuracy on validation batch: 0.945312, accuracy on mal data: 0.828189
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828316
step 6200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828571
step 6300, accuracy on validation batch: 0.875, accuracy on mal data: 0.828826
step 6400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828826
step 6500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828826
step 6600, accuracy on validation batch: 0.8125, accuracy on mal data: 0.829336
step 6700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830357
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830612
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.83074
step 7000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830739
step 7100, accuracy on validation batch: 0.875, accuracy on mal data: 0.831122
step 7200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.831377
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831632
step 7400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.832015
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83227
step 7600, accuracy on validation batch: 0.875, accuracy on mal data: 0.83227
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832525
step 7800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83278
step 7900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.833163
test set: accuracy on test set: 0.911
Done training net
0.911200022697
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 512, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 512, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0859375, accuracy on mal data: 0.109949
step 100, accuracy on validation batch: 0.179688, accuracy on mal data: 0.176786
step 200, accuracy on validation batch: 0.515625, accuracy on mal data: 0.264031
step 300, accuracy on validation batch: 0.625, accuracy on mal data: 0.348597
step 400, accuracy on validation batch: 0.65625, accuracy on mal data: 0.425765
step 500, accuracy on validation batch: 0.757812, accuracy on mal data: 0.501148
step 600, accuracy on validation batch: 0.8125, accuracy on mal data: 0.553189
step 700, accuracy on validation batch: 0.828125, accuracy on mal data: 0.592219
step 800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.61977
step 900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.641199
step 1000, accuracy on validation batch: 0.820312, accuracy on mal data: 0.66199
step 1100, accuracy on validation batch: 0.820312, accuracy on mal data: 0.679974
step 1200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.693495
step 1300, accuracy on validation batch: 0.796875, accuracy on mal data: 0.709949
step 1400, accuracy on validation batch: 0.820312, accuracy on mal data: 0.720918
step 1500, accuracy on validation batch: 0.875, accuracy on mal data: 0.733546
step 1600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.742474
step 1700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.74949
step 1800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.756122
step 1900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.759821
step 2000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.765433
step 2100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.773469
step 2200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.777551
step 2300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.781505
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.785842
step 2500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.789541
step 2600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.792219
step 2700, accuracy on validation batch: 0.875, accuracy on mal data: 0.796683
step 2800, accuracy on validation batch: 0.859375, accuracy on mal data: 0.799362
step 2900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.801148
step 3000, accuracy on validation batch: 0.875, accuracy on mal data: 0.802806
step 3100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.804336
step 3200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.805995
step 3300, accuracy on validation batch: 0.945312, accuracy on mal data: 0.808546
step 3400, accuracy on validation batch: 0.84375, accuracy on mal data: 0.809694
step 3500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.810331
step 3600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.81199
step 3700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.812627
step 3800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81352
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.814286
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815051
step 4100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.816581
step 4200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.817857
step 4300, accuracy on validation batch: 0.875, accuracy on mal data: 0.819387
step 4400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.820408
step 4500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.820918
step 4600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.821046
step 4700, accuracy on validation batch: 0.875, accuracy on mal data: 0.821811
step 4800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822449
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822704
step 5000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.823342
step 5100, accuracy on validation batch: 0.875, accuracy on mal data: 0.823597
step 5200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824362
step 5300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825
step 5400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825255
step 5500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.826148
step 5600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.82704
step 5700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827041
step 5800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827168
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827678
step 6000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.828188
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828954
step 6200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.829081
step 6300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.829336
step 6400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829974
step 6500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.830102
step 6600, accuracy on validation batch: 0.835938, accuracy on mal data: 0.830102
step 6700, accuracy on validation batch: 0.875, accuracy on mal data: 0.830357
step 6800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830612
step 6900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830995
step 7000, accuracy on validation batch: 0.875, accuracy on mal data: 0.831122
step 7100, accuracy on validation batch: 0.953125, accuracy on mal data: 0.831377
step 7200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831632
step 7300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.832143
step 7400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832398
step 7500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832398
step 7600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832653
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832908
step 7800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.833291
step 7900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.833163
test set: accuracy on test set: 0.910
Done training net
0.909800029397
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.132812, accuracy on mal data: 0.103061
step 100, accuracy on validation batch: 0.203125, accuracy on mal data: 0.172577
step 200, accuracy on validation batch: 0.515625, accuracy on mal data: 0.261097
step 300, accuracy on validation batch: 0.625, accuracy on mal data: 0.367474
step 400, accuracy on validation batch: 0.726562, accuracy on mal data: 0.446939
step 500, accuracy on validation batch: 0.726562, accuracy on mal data: 0.51977
step 600, accuracy on validation batch: 0.757812, accuracy on mal data: 0.56977
step 700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.604209
step 800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.631888
step 900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.652806
step 1000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.666709
step 1100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.680995
step 1200, accuracy on validation batch: 0.851562, accuracy on mal data: 0.695791
step 1300, accuracy on validation batch: 0.84375, accuracy on mal data: 0.709183
step 1400, accuracy on validation batch: 0.867188, accuracy on mal data: 0.718622
step 1500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.727168
step 1600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.738648
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.748724
step 1800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.756377
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.762627
step 2000, accuracy on validation batch: 0.796875, accuracy on mal data: 0.76824
step 2100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.772576
step 2200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.778061
step 2300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.78074
step 2400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.78278
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.787882
step 2600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.789158
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.792092
step 2800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.797576
step 2900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.800127
step 3000, accuracy on validation batch: 0.9375, accuracy on mal data: 0.802041
step 3100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.804337
step 3200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.805229
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.80727
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.808928
step 3500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.810331
step 3600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.810969
step 3700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.811734
step 3800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81301
step 3900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.814158
step 4000, accuracy on validation batch: 0.90625, accuracy on mal data: 0.815051
step 4100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816199
step 4200, accuracy on validation batch: 0.882812, accuracy on mal data: 0.817092
step 4300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.817729
step 4400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.818622
step 4500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.820408
step 4600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821046
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.822831
step 4800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823086
step 4900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.823342
step 5000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824362
step 5100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.824362
step 5200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824872
step 5300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825382
step 5400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825765
step 5500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825765
step 5600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.826403
step 5700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826785
step 5800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827551
step 5900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828316
step 6000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828571
step 6100, accuracy on validation batch: 0.945312, accuracy on mal data: 0.828699
step 6200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829464
step 6300, accuracy on validation batch: 0.953125, accuracy on mal data: 0.829719
step 6400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830102
step 6500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830229
step 6600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.830229
step 6700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830867
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830867
step 6900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831122
step 7000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83125
step 7100, accuracy on validation batch: 0.9375, accuracy on mal data: 0.831505
step 7200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832143
step 7300, accuracy on validation batch: 0.875, accuracy on mal data: 0.83227
step 7400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832398
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832908
step 7600, accuracy on validation batch: 0.875, accuracy on mal data: 0.832908
step 7700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.833418
step 7800, accuracy on validation batch: 0.929688, accuracy on mal data: 0.833673
step 7900, accuracy on validation batch: 0.96875, accuracy on mal data: 0.833673
test set: accuracy on test set: 0.910
Done training net
0.910200026035
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 64, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 64, 'nb_neurons_2': 256, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.125, accuracy on mal data: 0.105357
step 100, accuracy on validation batch: 0.164062, accuracy on mal data: 0.187245
step 200, accuracy on validation batch: 0.421875, accuracy on mal data: 0.273214
step 300, accuracy on validation batch: 0.632812, accuracy on mal data: 0.368878
step 400, accuracy on validation batch: 0.742188, accuracy on mal data: 0.457526
step 500, accuracy on validation batch: 0.710938, accuracy on mal data: 0.519388
step 600, accuracy on validation batch: 0.734375, accuracy on mal data: 0.567219
step 700, accuracy on validation batch: 0.8125, accuracy on mal data: 0.597194
step 800, accuracy on validation batch: 0.789062, accuracy on mal data: 0.623342
step 900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.647449
step 1000, accuracy on validation batch: 0.828125, accuracy on mal data: 0.667347
step 1100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.683418
step 1200, accuracy on validation batch: 0.820312, accuracy on mal data: 0.697321
step 1300, accuracy on validation batch: 0.828125, accuracy on mal data: 0.709566
step 1400, accuracy on validation batch: 0.828125, accuracy on mal data: 0.719388
step 1500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.728316
step 1600, accuracy on validation batch: 0.773438, accuracy on mal data: 0.738648
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.746428
step 1800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.753699
step 1900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.762755
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.769388
step 2100, accuracy on validation batch: 0.820312, accuracy on mal data: 0.774872
step 2200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.778699
step 2300, accuracy on validation batch: 0.875, accuracy on mal data: 0.783928
step 2400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.787245
step 2500, accuracy on validation batch: 0.867188, accuracy on mal data: 0.790816
step 2600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.794898
step 2700, accuracy on validation batch: 0.875, accuracy on mal data: 0.798852
step 2800, accuracy on validation batch: 0.851562, accuracy on mal data: 0.801148
step 2900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.803316
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.805357
step 3100, accuracy on validation batch: 0.851562, accuracy on mal data: 0.807015
step 3200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.808801
step 3300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.809566
step 3400, accuracy on validation batch: 0.828125, accuracy on mal data: 0.810586
step 3500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.811352
step 3600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.81199
step 3700, accuracy on validation batch: 0.882812, accuracy on mal data: 0.812882
step 3800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.81403
step 3900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.814796
step 4000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.816199
step 4100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.816454
step 4200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.816964
step 4300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817857
step 4400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.817984
step 4500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819132
step 4600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82028
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.820918
step 4800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821046
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821939
step 5000, accuracy on validation batch: 0.875, accuracy on mal data: 0.822831
step 5100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.823341
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823469
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823852
step 5400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824617
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82551
step 5600, accuracy on validation batch: 0.875, accuracy on mal data: 0.82602
step 5700, accuracy on validation batch: 0.953125, accuracy on mal data: 0.826148
step 5800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827168
step 5900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.827806
step 6000, accuracy on validation batch: 0.875, accuracy on mal data: 0.827678
step 6100, accuracy on validation batch: 0.953125, accuracy on mal data: 0.828061
step 6200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828954
step 6300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829081
step 6400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829464
step 6500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830357
step 6600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.830995
step 6700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830995
step 6800, accuracy on validation batch: 0.875, accuracy on mal data: 0.830995
step 6900, accuracy on validation batch: 0.875, accuracy on mal data: 0.831505
step 7000, accuracy on validation batch: 0.875, accuracy on mal data: 0.831505
step 7100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83176
step 7200, accuracy on validation batch: 0.945312, accuracy on mal data: 0.83176
step 7300, accuracy on validation batch: 0.945312, accuracy on mal data: 0.832015
step 7400, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83227
step 7500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.83227
step 7600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.832525
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832525
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832525
step 7900, accuracy on validation batch: 0.953125, accuracy on mal data: 0.83278
test set: accuracy on test set: 0.911
Done training net
0.91130002737
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 128, 'nb_neurons_2': 8, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 128, 'nb_neurons_2': 8, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0625, accuracy on mal data: 0.106378
step 100, accuracy on validation batch: 0.3125, accuracy on mal data: 0.184184
step 200, accuracy on validation batch: 0.523438, accuracy on mal data: 0.267857
step 300, accuracy on validation batch: 0.648438, accuracy on mal data: 0.363265
step 400, accuracy on validation batch: 0.742188, accuracy on mal data: 0.453571
step 500, accuracy on validation batch: 0.726562, accuracy on mal data: 0.530995
step 600, accuracy on validation batch: 0.757812, accuracy on mal data: 0.582398
step 700, accuracy on validation batch: 0.804688, accuracy on mal data: 0.619005
step 800, accuracy on validation batch: 0.789062, accuracy on mal data: 0.647066
step 900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.670791
step 1000, accuracy on validation batch: 0.84375, accuracy on mal data: 0.68903
step 1100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.702551
step 1200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.712245
step 1300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.72602
step 1400, accuracy on validation batch: 0.78125, accuracy on mal data: 0.736479
step 1500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.747321
step 1600, accuracy on validation batch: 0.828125, accuracy on mal data: 0.754209
step 1700, accuracy on validation batch: 0.8125, accuracy on mal data: 0.7625
step 1800, accuracy on validation batch: 0.875, accuracy on mal data: 0.767857
step 1900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.773852
step 2000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.777551
step 2100, accuracy on validation batch: 0.875, accuracy on mal data: 0.784056
step 2200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.785969
step 2300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.790433
step 2400, accuracy on validation batch: 0.875, accuracy on mal data: 0.792347
step 2500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.795408
step 2600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.796683
step 2700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.798724
step 2800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.800382
step 2900, accuracy on validation batch: 0.8125, accuracy on mal data: 0.802423
step 3000, accuracy on validation batch: 0.953125, accuracy on mal data: 0.804336
step 3100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.806122
step 3200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.808291
step 3300, accuracy on validation batch: 0.882812, accuracy on mal data: 0.809439
step 3400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.811352
step 3500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.812245
step 3600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.813393
step 3700, accuracy on validation batch: 0.851562, accuracy on mal data: 0.814413
step 3800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.815561
step 3900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.817602
step 4000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.81824
step 4100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.818495
step 4200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.819132
step 4300, accuracy on validation batch: 0.835938, accuracy on mal data: 0.820153
step 4400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.820791
step 4500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820663
step 4600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.821428
step 4700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821428
step 4800, accuracy on validation batch: 0.898438, accuracy on mal data: 0.822066
step 4900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822831
step 5000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823469
step 5100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.823979
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824107
step 5300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.824234
step 5400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824617
step 5500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.825
step 5600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82602
step 5700, accuracy on validation batch: 0.84375, accuracy on mal data: 0.826275
step 5800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.82653
step 5900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826785
step 6000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826785
step 6100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.826785
step 6200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827041
step 6300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.827423
step 6400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828061
step 6500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828444
step 6600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828444
step 6700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828571
step 6800, accuracy on validation batch: 0.875, accuracy on mal data: 0.829081
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829464
step 7000, accuracy on validation batch: 0.875, accuracy on mal data: 0.830229
step 7100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830484
step 7200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.830612
step 7300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830867
step 7400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.830995
step 7500, accuracy on validation batch: 0.914062, accuracy on mal data: 0.831632
step 7600, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83176
step 7700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831887
step 7800, accuracy on validation batch: 0.875, accuracy on mal data: 0.831632
step 7900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831632
test set: accuracy on test set: 0.911
Done training net
0.911100021601
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 512, 'nb_neurons_2': 8, 'nb_neurons_3': 8}
training!
{'nb_neurons_1': 512, 'nb_neurons_2': 8, 'nb_neurons_3': 8}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.0625, accuracy on mal data: 0.104847
step 100, accuracy on validation batch: 0.234375, accuracy on mal data: 0.167474
step 200, accuracy on validation batch: 0.46875, accuracy on mal data: 0.240434
step 300, accuracy on validation batch: 0.6875, accuracy on mal data: 0.335714
step 400, accuracy on validation batch: 0.695312, accuracy on mal data: 0.416454
step 500, accuracy on validation batch: 0.796875, accuracy on mal data: 0.484184
step 600, accuracy on validation batch: 0.742188, accuracy on mal data: 0.547704
step 700, accuracy on validation batch: 0.875, accuracy on mal data: 0.595918
step 800, accuracy on validation batch: 0.835938, accuracy on mal data: 0.62449
step 900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.645536
step 1000, accuracy on validation batch: 0.859375, accuracy on mal data: 0.666326
step 1100, accuracy on validation batch: 0.859375, accuracy on mal data: 0.683801
step 1200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.694643
step 1300, accuracy on validation batch: 0.820312, accuracy on mal data: 0.705485
step 1400, accuracy on validation batch: 0.8125, accuracy on mal data: 0.714796
step 1500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.727041
step 1600, accuracy on validation batch: 0.8125, accuracy on mal data: 0.737882
step 1700, accuracy on validation batch: 0.8125, accuracy on mal data: 0.747194
step 1800, accuracy on validation batch: 0.84375, accuracy on mal data: 0.752168
step 1900, accuracy on validation batch: 0.882812, accuracy on mal data: 0.761862
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.767602
step 2100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.774107
step 2200, accuracy on validation batch: 0.828125, accuracy on mal data: 0.779592
step 2300, accuracy on validation batch: 0.875, accuracy on mal data: 0.784821
step 2400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.788393
step 2500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.791837
step 2600, accuracy on validation batch: 0.851562, accuracy on mal data: 0.795663
step 2700, accuracy on validation batch: 0.820312, accuracy on mal data: 0.799617
step 2800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.80051
step 2900, accuracy on validation batch: 0.851562, accuracy on mal data: 0.802933
step 3000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.804209
step 3100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.80676
step 3200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.80829
step 3300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.811097
step 3400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.8125
step 3500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.813137
step 3600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.81403
step 3700, accuracy on validation batch: 0.875, accuracy on mal data: 0.815561
step 3800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.816071
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.817602
step 4000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.818622
step 4100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.819643
step 4200, accuracy on validation batch: 0.859375, accuracy on mal data: 0.820791
step 4300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.821938
step 4400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.822704
step 4500, accuracy on validation batch: 0.945312, accuracy on mal data: 0.823214
step 4600, accuracy on validation batch: 0.890625, accuracy on mal data: 0.823342
step 4700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823979
step 4800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824872
step 4900, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824872
step 5000, accuracy on validation batch: 0.921875, accuracy on mal data: 0.824872
step 5100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.825255
step 5200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.825637
step 5300, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826148
step 5400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.82704
step 5500, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827296
step 5600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.827551
step 5700, accuracy on validation batch: 0.875, accuracy on mal data: 0.827678
step 5800, accuracy on validation batch: 0.9375, accuracy on mal data: 0.827678
step 5900, accuracy on validation batch: 0.875, accuracy on mal data: 0.827806
step 6000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.828061
step 6100, accuracy on validation batch: 0.90625, accuracy on mal data: 0.828444
step 6200, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828571
step 6300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828826
step 6400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.828826
step 6500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829209
step 6600, accuracy on validation batch: 0.90625, accuracy on mal data: 0.829847
step 6700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830102
step 6800, accuracy on validation batch: 0.875, accuracy on mal data: 0.830229
step 6900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.830612
step 7000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830995
step 7100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831505
step 7200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831505
step 7300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.831505
step 7400, accuracy on validation batch: 0.875, accuracy on mal data: 0.832015
step 7500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832015
step 7600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.832015
step 7700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.832143
step 7800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.832143
step 7900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832398
test set: accuracy on test set: 0.912
Done training net
0.912400028706
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 512, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 512, 'nb_neurons_2': 512, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.171875, accuracy on mal data: 0.104209
step 100, accuracy on validation batch: 0.320312, accuracy on mal data: 0.196173
step 200, accuracy on validation batch: 0.492188, accuracy on mal data: 0.289668
step 300, accuracy on validation batch: 0.710938, accuracy on mal data: 0.365944
step 400, accuracy on validation batch: 0.757812, accuracy on mal data: 0.445918
step 500, accuracy on validation batch: 0.773438, accuracy on mal data: 0.509184
step 600, accuracy on validation batch: 0.75, accuracy on mal data: 0.560204
step 700, accuracy on validation batch: 0.765625, accuracy on mal data: 0.595536
step 800, accuracy on validation batch: 0.8125, accuracy on mal data: 0.622066
step 900, accuracy on validation batch: 0.828125, accuracy on mal data: 0.641326
step 1000, accuracy on validation batch: 0.835938, accuracy on mal data: 0.659439
step 1100, accuracy on validation batch: 0.8125, accuracy on mal data: 0.677551
step 1200, accuracy on validation batch: 0.84375, accuracy on mal data: 0.689668
step 1300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.69949
step 1400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.714923
step 1500, accuracy on validation batch: 0.84375, accuracy on mal data: 0.726403
step 1600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.735204
step 1700, accuracy on validation batch: 0.835938, accuracy on mal data: 0.745535
step 1800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.752168
step 1900, accuracy on validation batch: 0.875, accuracy on mal data: 0.762117
step 2000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.766709
step 2100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.772449
step 2200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.778444
step 2300, accuracy on validation batch: 0.90625, accuracy on mal data: 0.782143
step 2400, accuracy on validation batch: 0.851562, accuracy on mal data: 0.785714
step 2500, accuracy on validation batch: 0.90625, accuracy on mal data: 0.789158
step 2600, accuracy on validation batch: 0.929688, accuracy on mal data: 0.792984
step 2700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.795918
step 2800, accuracy on validation batch: 0.875, accuracy on mal data: 0.798597
step 2900, accuracy on validation batch: 0.890625, accuracy on mal data: 0.800893
step 3000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.802423
step 3100, accuracy on validation batch: 0.84375, accuracy on mal data: 0.804592
step 3200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.807015
step 3300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.808035
step 3400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.810714
step 3500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.813265
step 3600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.81352
step 3700, accuracy on validation batch: 0.890625, accuracy on mal data: 0.814541
step 3800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.814923
step 3900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.816964
step 4000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.817602
step 4100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.818495
step 4200, accuracy on validation batch: 0.90625, accuracy on mal data: 0.818495
step 4300, accuracy on validation batch: 0.898438, accuracy on mal data: 0.81977
step 4400, accuracy on validation batch: 0.859375, accuracy on mal data: 0.820025
step 4500, accuracy on validation batch: 0.898438, accuracy on mal data: 0.82028
step 4600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.821173
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.821173
step 4800, accuracy on validation batch: 0.867188, accuracy on mal data: 0.822066
step 4900, accuracy on validation batch: 0.945312, accuracy on mal data: 0.823086
step 5000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823852
step 5100, accuracy on validation batch: 0.929688, accuracy on mal data: 0.824107
step 5200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.824234
step 5300, accuracy on validation batch: 0.851562, accuracy on mal data: 0.824617
step 5400, accuracy on validation batch: 0.914062, accuracy on mal data: 0.825127
step 5500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.82602
step 5600, accuracy on validation batch: 0.9375, accuracy on mal data: 0.82602
step 5700, accuracy on validation batch: 0.921875, accuracy on mal data: 0.826785
step 5800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.827296
step 5900, accuracy on validation batch: 0.867188, accuracy on mal data: 0.827806
step 6000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.827933
step 6100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.828061
step 6200, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828699
step 6300, accuracy on validation batch: 0.945312, accuracy on mal data: 0.828699
step 6400, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828571
step 6500, accuracy on validation batch: 0.929688, accuracy on mal data: 0.829081
step 6600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.829847
step 6700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.829847
step 6800, accuracy on validation batch: 0.882812, accuracy on mal data: 0.830484
step 6900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.830484
step 7000, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830867
step 7100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.831122
step 7200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.831122
step 7300, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831122
step 7400, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831632
step 7500, accuracy on validation batch: 0.875, accuracy on mal data: 0.832143
step 7600, accuracy on validation batch: 0.953125, accuracy on mal data: 0.83227
step 7700, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832398
step 7800, accuracy on validation batch: 0.890625, accuracy on mal data: 0.832398
step 7900, accuracy on validation batch: 0.929688, accuracy on mal data: 0.832653
test set: accuracy on test set: 0.912
Done training net
0.911700023413
Net accuracy:0.91

Net accuracy mal:0.83

training in perm
{'nb_neurons_1': 512, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training!
{'nb_neurons_1': 512, 'nb_neurons_2': 64, 'nb_neurons_3': 256}
training net
Extracting MNIST-data/train-images-idx3-ubyte.gz
Extracting MNIST-data/train-labels-idx1-ubyte.gz
Extracting MNIST-data/t10k-images-idx3-ubyte.gz
Extracting MNIST-data/t10k-labels-idx1-ubyte.gz
step 0, accuracy on validation batch: 0.09375, accuracy on mal data: 0.0917092
step 100, accuracy on validation batch: 0.234375, accuracy on mal data: 0.147704
step 200, accuracy on validation batch: 0.539062, accuracy on mal data: 0.224107
step 300, accuracy on validation batch: 0.640625, accuracy on mal data: 0.314413
step 400, accuracy on validation batch: 0.679688, accuracy on mal data: 0.404082
step 500, accuracy on validation batch: 0.773438, accuracy on mal data: 0.48648
step 600, accuracy on validation batch: 0.796875, accuracy on mal data: 0.548214
step 700, accuracy on validation batch: 0.757812, accuracy on mal data: 0.591454
step 800, accuracy on validation batch: 0.78125, accuracy on mal data: 0.61875
step 900, accuracy on validation batch: 0.875, accuracy on mal data: 0.643367
step 1000, accuracy on validation batch: 0.796875, accuracy on mal data: 0.660204
step 1100, accuracy on validation batch: 0.804688, accuracy on mal data: 0.675765
step 1200, accuracy on validation batch: 0.78125, accuracy on mal data: 0.687372
step 1300, accuracy on validation batch: 0.804688, accuracy on mal data: 0.701403
step 1400, accuracy on validation batch: 0.898438, accuracy on mal data: 0.712245
step 1500, accuracy on validation batch: 0.828125, accuracy on mal data: 0.727168
step 1600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.73699
step 1700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.74324
step 1800, accuracy on validation batch: 0.804688, accuracy on mal data: 0.754209
step 1900, accuracy on validation batch: 0.835938, accuracy on mal data: 0.763265
step 2000, accuracy on validation batch: 0.882812, accuracy on mal data: 0.769132
step 2100, accuracy on validation batch: 0.898438, accuracy on mal data: 0.773342
step 2200, accuracy on validation batch: 0.835938, accuracy on mal data: 0.779081
step 2300, accuracy on validation batch: 0.867188, accuracy on mal data: 0.783418
step 2400, accuracy on validation batch: 0.875, accuracy on mal data: 0.788775
step 2500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.793112
step 2600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.796428
step 2700, accuracy on validation batch: 0.875, accuracy on mal data: 0.800893
step 2800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.803188
step 2900, accuracy on validation batch: 0.859375, accuracy on mal data: 0.804719
step 3000, accuracy on validation batch: 0.914062, accuracy on mal data: 0.80676
step 3100, accuracy on validation batch: 0.914062, accuracy on mal data: 0.808546
step 3200, accuracy on validation batch: 0.929688, accuracy on mal data: 0.810459
step 3300, accuracy on validation batch: 0.914062, accuracy on mal data: 0.811734
step 3400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.813393
step 3500, accuracy on validation batch: 0.882812, accuracy on mal data: 0.814285
step 3600, accuracy on validation batch: 0.882812, accuracy on mal data: 0.815944
step 3700, accuracy on validation batch: 0.875, accuracy on mal data: 0.816454
step 3800, accuracy on validation batch: 0.914062, accuracy on mal data: 0.817729
step 3900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.819132
step 4000, accuracy on validation batch: 0.875, accuracy on mal data: 0.81977
step 4100, accuracy on validation batch: 0.890625, accuracy on mal data: 0.820408
step 4200, accuracy on validation batch: 0.867188, accuracy on mal data: 0.821301
step 4300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.821939
step 4400, accuracy on validation batch: 0.90625, accuracy on mal data: 0.822831
step 4500, accuracy on validation batch: 0.859375, accuracy on mal data: 0.822831
step 4600, accuracy on validation batch: 0.945312, accuracy on mal data: 0.823597
step 4700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.823724
step 4800, accuracy on validation batch: 0.921875, accuracy on mal data: 0.823597
step 4900, accuracy on validation batch: 0.90625, accuracy on mal data: 0.824107
step 5000, accuracy on validation batch: 0.875, accuracy on mal data: 0.825127
step 5100, accuracy on validation batch: 0.921875, accuracy on mal data: 0.825765
step 5200, accuracy on validation batch: 0.890625, accuracy on mal data: 0.826148
step 5300, accuracy on validation batch: 0.9375, accuracy on mal data: 0.82653
step 5400, accuracy on validation batch: 0.882812, accuracy on mal data: 0.826658
step 5500, accuracy on validation batch: 0.835938, accuracy on mal data: 0.827041
step 5600, accuracy on validation batch: 0.898438, accuracy on mal data: 0.827296
step 5700, accuracy on validation batch: 0.914062, accuracy on mal data: 0.827806
step 5800, accuracy on validation batch: 0.945312, accuracy on mal data: 0.828061
step 5900, accuracy on validation batch: 0.898438, accuracy on mal data: 0.828444
step 6000, accuracy on validation batch: 0.851562, accuracy on mal data: 0.828699
step 6100, accuracy on validation batch: 0.882812, accuracy on mal data: 0.828954
step 6200, accuracy on validation batch: 0.9375, accuracy on mal data: 0.828826
step 6300, accuracy on validation batch: 0.875, accuracy on mal data: 0.829336
step 6400, accuracy on validation batch: 0.960938, accuracy on mal data: 0.829336
step 6500, accuracy on validation batch: 0.921875, accuracy on mal data: 0.829464
step 6600, accuracy on validation batch: 0.867188, accuracy on mal data: 0.829847
step 6700, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830102
step 6800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.830229
step 6900, accuracy on validation batch: 0.84375, accuracy on mal data: 0.830229
step 7000, accuracy on validation batch: 0.890625, accuracy on mal data: 0.830612
step 7100, accuracy on validation batch: 0.867188, accuracy on mal data: 0.830867
step 7200, accuracy on validation batch: 0.921875, accuracy on mal data: 0.83125
step 7300, accuracy on validation batch: 0.929688, accuracy on mal data: 0.83125
step 7400, accuracy on validation batch: 0.921875, accuracy on mal data: 0.831377
step 7500, accuracy on validation batch: 0.890625, accuracy on mal data: 0.831632
step 7600, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83176
step 7700, accuracy on validation batch: 0.898438, accuracy on mal data: 0.832015
step 7800, accuracy on validation batch: 0.90625, accuracy on mal data: 0.832908
step 7900, accuracy on validation batch: 0.914062, accuracy on mal data: 0.83329
test set: accuracy on test set: 0.910
Done training net
0.910000024438
Net accuracy:0.91

Net accuracy mal:0.83

